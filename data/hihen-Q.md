# QA Report

## Summary

### Low Issues

Total **176 instances** over **24 issues**:

|ID|Issue|Instances|
|:--:|:---|:--:|
| [[L&#x2011;01]](#l01-variables-shadowing-other-definitions) | Variables shadowing other definitions | 3 |
| [[L&#x2011;02]](#l02-missing-zero-address-check-in-constructor) | Missing zero address check in constructor | 50 |
| [[L&#x2011;03]](#l03-function-receivepayable-fallback-does-not-authorize-sender) | Function `receive()`/`payable fallback()` does not authorize sender | 2 |
| [[L&#x2011;04]](#l04-revert-on-transfer-to-the-zero-address) | Revert on transfer to the zero address | 4 |
| [[L&#x2011;05]](#l05-array-is-pushed-but-not-poped) | Array is `push()`ed but not `pop()`ed | 1 |
| [[L&#x2011;06]](#l06-state-variables-not-limited-to-reasonable-values) | State variables not limited to reasonable values | 2 |
| [[L&#x2011;07]](#l07-tokens-may-be-minted-to-the-zero-address) | Tokens may be minted to the zero address | 1 |
| [[L&#x2011;08]](#l08-consider-implementing-two-step-procedure-for-updating-protocol-addresses) | Consider implementing two-step procedure for updating protocol addresses | 1 |
| [[L&#x2011;09]](#l09-downcasting-other-types-to-an-address-can-cause-collisions) | Downcasting other types to an address can cause collisions | 1 |
| [[L&#x2011;10]](#l10-vulnerable-versions-of-packages-are-being-used) | Vulnerable versions of packages are being used | 4 |
| [[L&#x2011;11]](#l11-constructor--initialization-function-lacks-parameter-validation) | Constructor / initialization function lacks parameter validation | 1 |
| [[L&#x2011;12]](#l12-contracts-are-vulnerable-to-fee-on-transfer-accounting-related-issues) | Contracts are vulnerable to fee-on-transfer accounting-related issues | 8 |
| [[L&#x2011;13]](#l13-functions-calling-contractsaddresses-with-transfer-hooks-should-be-protected-by-reentrancy-guard) | Functions calling contracts/addresses with transfer hooks should be protected by reentrancy guard | 6 |
| [[L&#x2011;14]](#l14-critical-functions-should-be-controlled-by-time-locks) | Critical functions should be controlled by time locks | 23 |
| [[L&#x2011;15]](#l15-division-by-zero-not-prevented) | Division by zero not prevented | 11 |
| [[L&#x2011;16]](#l16-external-function-calls-within-loops) | External function calls within loops | 3 |
| [[L&#x2011;17]](#l17-some-tokens-may-revert-when-zero-value-transfers-are-made) | Some tokens may revert when zero value transfers are made | 2 |
| [[L&#x2011;18]](#l18-use-safecast-to-downcast-safely) | Use `SafeCast` to downcast safely | 2 |
| [[L&#x2011;19]](#l19-use-descriptive-constant-instead-of-0-as-a-parameter) | Use descriptive constant instead of 0 as a parameter | 19 |
| [[L&#x2011;20]](#l20-large-approvals-may-not-work-with-some-erc20-tokens) | Large approvals may not work with some `ERC20` tokens | 2 |
| [[L&#x2011;21]](#l21-use-increaseallowancedecreaseallowance-instead-of-approvesafeapprove) | Use `increaseAllowance()`/`decreaseAllowance()` instead of `approve()`/`safeApprove()` | 2 |
| [[L&#x2011;22]](#l22-code-does-not-follow-the-best-practice-of-check-effects-interaction) | Code does not follow the best practice of check-effects-interaction | 17 |
| [[L&#x2011;23]](#l23-some-tokens-may-revert-when-large-transfers-are-made) | Some tokens may revert when large transfers are made | 8 |
| [[L&#x2011;24]](#l24-contracts-are-vulnerable-to-rebasing-accounting-related-issues) | Contracts are vulnerable to rebasing accounting-related issues | 3 |

### Non Critical Issues

Total **4057 instances** over **112 issues**:

|ID|Issue|Instances|
|:--:|:---|:--:|
| [[N&#x2011;01]](#n01-abiencodepacked-should-be-replaced-with-bytesconcat) | `abi.encodePacked()` should be replaced with `bytes.concat()` | 2 |
| [[N&#x2011;02]](#n02-consider-moving-msgsender-checks-to-modifiers) | Consider moving `msg.sender` checks to `modifier`s | 23 |
| [[N&#x2011;03]](#n03-import-declarations-should-import-specific-identifiers-rather-than-the-whole-file) | Import declarations should import specific identifiers, rather than the whole file | 96 |
| [[N&#x2011;04]](#n04-event-should-include-parameters) | Event should include parameters | 2 |
| [[N&#x2011;05]](#n05-visibility-of-state-variables-is-not-explicitly-defined) | Visibility of state variables is not explicitly defined | 6 |
| [[N&#x2011;06]](#n06-too-long-functions-should-be-refactored) | Too long functions should be refactored | 17 |
| [[N&#x2011;07]](#n07-natspec-documentation-for-contract-is-missing) | NatSpec documentation for contract is missing | 24 |
| [[N&#x2011;08]](#n08-names-of-constants-should-use-the-upper_case_with_underscores-style) | Names of constants should use the UPPER_CASE_WITH_UNDERSCORES style | 1 |
| [[N&#x2011;09]](#n09-names-of-privateinternal-functions-should-be-prefixed-with-an-underscore) | Names of `private`/`internal` functions should be prefixed with an underscore | 4 |
| [[N&#x2011;10]](#n10-names-of-privateinternal-state-variables-should-be-prefixed-with-an-underscore) | Names of `private`/`internal` state variables should be prefixed with an underscore | 21 |
| [[N&#x2011;11]](#n11-order-of-functions-does-not-follow-the-solidity-style-guide) | Order of functions does not follow the Solidity Style Guide | 138 |
| [[N&#x2011;12]](#n12-use-of-override-is-unnecessary) | Use of `override` is unnecessary | 100 |
| [[N&#x2011;13]](#n13-unused-events) | Unused events | 5 |
| [[N&#x2011;14]](#n14-unused-structs) | Unused `struct`s | 2 |
| [[N&#x2011;15]](#n15-use-uint256int256-instead-of-uintint) | Use `uint256`/`int256` instead of `uint`/`int` | 40 |
| [[N&#x2011;16]](#n16-large-numeric-literals-should-use-underscores-for-readability) | Large numeric literals should use underscores for readability | 9 |
| [[N&#x2011;17]](#n17-add-inline-comments-for-unnamed-parameters) | Add inline comments for unnamed parameters | 1 |
| [[N&#x2011;18]](#n18-assembly-blocks-should-have-extensive-comments) | Assembly blocks should have extensive comments | 4 |
| [[N&#x2011;19]](#n19-assertshould-be-replaced-with-require-or-revert) | `assert()`Â should be replaced with `require()` or `revert()` | 1 |
| [[N&#x2011;20]](#n20-simplify-complex-require-statements) | Simplify complex require statements | 1 |
| [[N&#x2011;21]](#n21-complex-math-should-be-split-into-multiple-steps) | Complex math should be split into multiple steps | 1 |
| [[N&#x2011;22]](#n22-consider-adding-a-blockdeny-list) | Consider adding a block/deny-list | 4 |
| [[N&#x2011;23]](#n23-constantsimmutables-redefined-elsewhere) | Constants/Immutables redefined elsewhere | 53 |
| [[N&#x2011;24]](#n24-convert-simple-if-statements-to-ternary-expressions) | Convert simple `if`-statements to ternary expressions | 3 |
| [[N&#x2011;25]](#n25-contracts-should-each-be-defined-in-separate-files) | Contracts should each be defined in separate files | 2 |
| [[N&#x2011;26]](#n26-upper_case-names-should-be-reserved-for-constantimmutable-variables) | UPPER_CASE names should be reserved for `constant`/`immutable` variables | 38 |
| [[N&#x2011;27]](#n27-do-not-use-literal-numbers-for-array-indexes) | Do not use literal numbers for array indexes | 2 |
| [[N&#x2011;28]](#n28-contract-timekeeping-will-break-earlier-than-the-ethereum-network-itself-will-stop-working) | Contract timekeeping will break earlier than the Ethereum network itself will stop working | 1 |
| [[N&#x2011;29]](#n29-events-should-be-emitted-before-external-calls) | Events should be emitted before external calls | 27 |
| [[N&#x2011;30]](#n30-events-are-emitted-without-the-sender-information) | Events are emitted without the sender information | 13 |
| [[N&#x2011;31]](#n31-function-state-mutability-can-be-restricted-to-pure) | Function state mutability can be restricted to pure | 9 |
| [[N&#x2011;32]](#n32-imports-could-be-organized-more-systematically) | Imports could be organized more systematically | 4 |
| [[N&#x2011;33]](#n33-invalid-natspec-comment-style) | Invalid NatSpec comment style | 6 |
| [[N&#x2011;34]](#n34-openzeppelincontracts-should-be-upgraded-to-a-newer-version) | @openzeppelin/contracts should be upgraded to a newer version | 1 |
| [[N&#x2011;35]](#n35-lib-openzeppelincontracts-upgradeable-should-be-upgraded-to-a-newer-version) | Lib @openzeppelin/contracts-upgradeable should be upgraded to a newer version | 1 |
| [[N&#x2011;36]](#n36-lines-are-too-long) | Lines are too long | 128 |
| [[N&#x2011;37]](#n37-magic-numbers-should-be-replaced-with-constants) | Magic numbers should be replaced with constants | 5 |
| [[N&#x2011;38]](#n38-expressions-for-constant-values-should-use-immutable-rather-than-constant) | Expressions for constant values should use `immutable` rather than `constant` | 5 |
| [[N&#x2011;39]](#n39-use-inheritdoc-for-overridden-functions) | Use `@inheritdoc` for overridden functions | 36 |
| [[N&#x2011;40]](#n40-contracts-should-have-natspec-author-tags) | Contracts should have NatSpec `@author` tags | 36 |
| [[N&#x2011;41]](#n41-contracts-should-have-notice-tags) | Contracts should have `@notice` tags | 24 |
| [[N&#x2011;42]](#n42-contracts-should-have-natspec-title-tags) | Contracts should have NatSpec `@title` tags | 30 |
| [[N&#x2011;43]](#n43-events-missing-natspec-param-tag) | Events missing NatSpec `@param` tag | 122 |
| [[N&#x2011;44]](#n44-event-declarations-should-have-natspec-descriptions) | Event declarations should have NatSpec descriptions | 56 |
| [[N&#x2011;45]](#n45-functions-missing-natspec-param-tag) | Functions missing NatSpec `@param` tag | 578 |
| [[N&#x2011;46]](#n46-natspec-documentation-for-function-is-missing) | NatSpec documentation for function is missing | 265 |
| [[N&#x2011;47]](#n47-functions-missing-natspec-return-tag) | Functions missing NatSpec `@return` tag | 168 |
| [[N&#x2011;48]](#n48-state-variables-should-have-natspec-descriptions) | State variables should have NatSpec descriptions | 53 |
| [[N&#x2011;49]](#n49-struct-names-should-use-capwords-style) | Struct names should use CapWords style | 3 |
| [[N&#x2011;50]](#n50-functions-should-be-named-in-mixedcase-style) | Functions should be named in mixedCase style | 47 |
| [[N&#x2011;51]](#n51-variable-names-for-immutables-should-use-upper_case_with_underscores) | Variable names for `immutable`s should use UPPER_CASE_WITH_UNDERSCORES | 44 |
| [[N&#x2011;52]](#n52-modifiers-should-be-named-in-mixedcase-style) | Modifiers should be named in mixedCase style | 2 |
| [[N&#x2011;53]](#n53-variables-should-be-named-in-mixedcase-style) | Variables should be named in mixedCase style | 88 |
| [[N&#x2011;54]](#n54-order-of-contract-layout-does-not-follow-the-solidity-style-guide) | Order of contract layout does not follow the Solidity Style Guide | 12 |
| [[N&#x2011;55]](#n55-missing-zero-address-check-in-functions-with-address-parameters) | Missing zero address check in functions with address parameters | 32 |
| [[N&#x2011;56]](#n56-named-imports-of-parent-contracts-are-missing) | Named imports of parent contracts are missing | 40 |
| [[N&#x2011;57]](#n57-constants-should-be-put-on-the-left-side-of-comparisons) | Constants should be put on the left side of comparisons | 119 |
| [[N&#x2011;58]](#n58-each-interfaces-should-be-defined-in-a-separate-file) | Each interfaces should be defined in a separate file | 2 |
| [[N&#x2011;59]](#n59-put-all-system-wide-constants-in-one-file) | Put all system-wide constants in one file | 31 |
| [[N&#x2011;60]](#n60-else-block-not-required) | `else`-block not required | 18 |
| [[N&#x2011;61]](#n61-redundant-return-statement-in-a-function-with-named-return-variables) | Redundant return statement in a function with named return variables | 3 |
| [[N&#x2011;62]](#n62-large-multiples-of-ten-should-use-scientific-notation) | Large multiples of ten should use scientific notation | 10 |
| [[N&#x2011;63]](#n63-todos-left-in-the-code) | `TODO`s left in the code | 1 |
| [[N&#x2011;64]](#n64-high-cyclomatic-complexity) | High cyclomatic complexity | 5 |
| [[N&#x2011;65]](#n65-typos) | Typos | 30 |
| [[N&#x2011;66]](#n66-consider-bounding-input-array-length) | Consider bounding input array length | 8 |
| [[N&#x2011;67]](#n67-unnecessary-casting) | Unnecessary casting | 2 |
| [[N&#x2011;68]](#n68-unused-contract-variables) | Unused contract variables | 2 |
| [[N&#x2011;69]](#n69-unused-function-parameters) | Unused function parameters | 2 |
| [[N&#x2011;70]](#n70-unused-local-variables) | Unused local variables | 6 |
| [[N&#x2011;71]](#n71-unused-named-return) | Unused named return | 8 |
| [[N&#x2011;72]](#n72-use-delete-instead-of-assigning-values-to-false) | Use delete instead of assigning values to `false` | 1 |
| [[N&#x2011;73]](#n73-consider-using-delete-rather-than-assigning-zero-to-clear-values) | Consider using `delete` rather than assigning zero to clear values | 11 |
| [[N&#x2011;74]](#n74-consider-using-eip-5267-to-securely-describe-eip-712-domains) | Consider using EIP-5267 to securely describe EIP-712 domains | 2 |
| [[N&#x2011;75]](#n75-use-the-latest-solidity-version) | Use the latest Solidity version | 39 |
| [[N&#x2011;76]](#n76-named-mappings-are-recommended) | Named mappings are recommended | 18 |
| [[N&#x2011;77]](#n77-whitespace-in-expressions) | Whitespace in Expressions | 32 |
| [[N&#x2011;78]](#n78-use-a-struct-to-encapsulate-multiple-function-parameters) | Use a struct to encapsulate multiple function parameters | 8 |
| [[N&#x2011;79]](#n79-returning-a-struct-instead-of-a-bunch-of-variables-is-better) | Returning a struct instead of a bunch of variables is better | 3 |
| [[N&#x2011;80]](#n80-events-that-mark-critical-parameter-changes-should-contain-both-the-old-and-the-new-value) | Events that mark critical parameter changes should contain both the old and the new value | 23 |
| [[N&#x2011;81]](#n81-contract-variables-should-have-comments) | Contract variables should have comments | 21 |
| [[N&#x2011;82]](#n82-file-is-missing-natspec) | File is missing NatSpec | 15 |
| [[N&#x2011;83]](#n83-modifier-declarations-should-have-natspec-descriptions) | Modifier declarations should have NatSpec descriptions | 3 |
| [[N&#x2011;84]](#n84-empty-bytes-check-is-missing) | Empty bytes check is missing | 3 |
| [[N&#x2011;85]](#n85-contract-functions-should-use-an-interface) | Contract functions should use an `interface` | 63 |
| [[N&#x2011;86]](#n86-dont-define-functions-with-the-same-name-in-a-contract) | Don't define functions with the same name in a contract | 2 |
| [[N&#x2011;87]](#n87-interface-files-should-not-use-fixed-compiler-versions) | Interface files should not use fixed compiler versions | 16 |
| [[N&#x2011;88]](#n88-multiple-mappings-with-same-keys-can-be-combined-into-a-single-struct-mapping-for-readability) | Multiple mappings with same keys can be combined into a single struct mapping for readability | 5 |
| [[N&#x2011;89]](#n89-control-structures-do-not-follow-the-solidity-style-guide) | Control structures do not follow the Solidity Style Guide | 32 |
| [[N&#x2011;90]](#n90-do-not-cache-constants) | Do not cache constants | 1 |
| [[N&#x2011;91]](#n91-function-state-mutability-can-be-restricted-to-view) | Function state mutability can be restricted to view | 2 |
| [[N&#x2011;92]](#n92-functions-contain-the-same-code) | Functions contain the same code | 10 |
| [[N&#x2011;93]](#n93-inconsistent-spacing-in-comments) | Inconsistent spacing in comments | 1 |
| [[N&#x2011;94]](#n94-missing-event-for-critical-changes) | Missing event for critical changes | 9 |
| [[N&#x2011;95]](#n95-non-assembly-method-available) | Non-assembly method available | 2 |
| [[N&#x2011;96]](#n96-duplicated-requirerevert-checks-should-be-refactored) | Duplicated `require()`/`revert()` checks should be refactored | 4 |
| [[N&#x2011;97]](#n97-consider-adding-emergency-stop-functionality) | Consider adding emergency-stop functionality | 11 |
| [[N&#x2011;98]](#n98-avoid-the-use-of-sensitive-terms) | Avoid the use of sensitive terms | 9 |
| [[N&#x2011;99]](#n99-enable-ir-based-code-generation) | Enable IR-based code generation | 1 |
| [[N&#x2011;100]](#n100-contracts-should-have-natspec-dev-tags) | Contracts should have NatSpec `@dev` tags | 30 |
| [[N&#x2011;101]](#n101-missing-natspec-dev-from-event-declaration) | Missing NatSpec `@dev` from event declaration | 56 |
| [[N&#x2011;102]](#n102-missing-natspec-notice-from-event-declaration) | Missing NatSpec `@notice` from event declaration | 56 |
| [[N&#x2011;103]](#n103-missing-natspec-dev-from-function-declaration) | Missing NatSpec `@dev` from function declaration | 369 |
| [[N&#x2011;104]](#n104-missing-natspec-notice-from-function-declaration) | Missing NatSpec `@notice` from function declaration | 327 |
| [[N&#x2011;105]](#n105-missing-natspec-dev-from-modifier-declaration) | Missing NatSpec `@dev` from modifier declaration | 3 |
| [[N&#x2011;106]](#n106-missing-natspec-notice-from-modifier-declaration) | Missing NatSpec `@notice` from modifier declaration | 3 |
| [[N&#x2011;107]](#n107-contracts-should-have-full-test-coverage) | Contracts should have full test coverage | 1 |
| [[N&#x2011;108]](#n108-large-or-complicated-code-bases-should-implement-invariant-tests) | Large or complicated code bases should implement invariant tests | 1 |
| [[N&#x2011;109]](#n109-top-level-declarations-should-be-separated-by-at-least-two-lines) | Top-level declarations should be separated by at least two lines | 138 |
| [[N&#x2011;110]](#n110-consider-adding-formal-verification-proofs) | Consider adding formal verification proofs | 39 |
| [[N&#x2011;111]](#n111-error-messages-should-be-descriptive-not-cryptic) | Error messages should be descriptive, not cryptic | 3 |
| [[N&#x2011;112]](#n112-numeric-values-having-to-do-with-time-should-use-time-units-for-readability) | Numeric values having to do with time should use time units for readability | 1 |

## Low Issues

### [L&#x2011;01] Variables shadowing other definitions

A variable declaration shadowing any other existing definition is error-prone. It can cause confusion for developers, potentially introduce bugs, and reduce the readability and maintainability.

There are 3 instances:

- *BorrowerOperations.sol* ( [680](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L680) ):

```solidity
/// @audit Shadows `function version()`
680:         bytes32 version
```

- *EBTCToken.sol* ( [237](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/EBTCToken.sol#L237), [238](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/EBTCToken.sol#L238) ):

```solidity
/// @audit Shadows `function name()`
237:         bytes32 name,

/// @audit Shadows `function version()`
238:         bytes32 version
```

### [L&#x2011;02] Missing zero address check in constructor

Constructors often take address parameters to initialize important components of a contract, such as owner or linked contracts. However, without a checking, there's a risk that an address parameter could be mistakenly set to the zero address (0x0). This could be due to an error or oversight during contract deployment. A zero address in a crucial role can cause serious issues, as it cannot perform actions like a normal address, and any funds sent to it will be irretrievable. It's therefore crucial to include a zero address check in constructors to prevent such potential problems. If a zero address is detected, the constructor should revert the transaction.

<details>
<summary>There are 50 instances (click to show):</summary>

- *ActivePool.sol* ( [46-52](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/ActivePool.sol#L46-L52) ):

```solidity
/// @audit `_borrowerOperationsAddress not checked`
/// @audit `_cdpManagerAddress not checked`
/// @audit `_collTokenAddress not checked`
/// @audit `_collSurplusAddress not checked`
/// @audit `_feeRecipientAddress not checked`
46:     constructor(
47:         address _borrowerOperationsAddress,
48:         address _cdpManagerAddress,
49:         address _collTokenAddress,
50:         address _collSurplusAddress,
51:         address _feeRecipientAddress
52:     ) {
```

- *BorrowerOperations.sol* ( [107-116](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L107-L116) ):

```solidity
/// @audit `_cdpManagerAddress not checked`
/// @audit `_collSurplusPoolAddress not checked`
/// @audit `_sortedCdpsAddress not checked`
/// @audit `_ebtcTokenAddress not checked`
/// @audit `_feeRecipientAddress not checked`
107:     constructor(
108:         address _cdpManagerAddress,
109:         address _activePoolAddress,
110:         address _collSurplusPoolAddress,
111:         address _priceFeedAddress,
112:         address _sortedCdpsAddress,
113:         address _ebtcTokenAddress,
114:         address _feeRecipientAddress,
115:         address _collTokenAddress
116:     ) EbtcBase(_activePoolAddress, _priceFeedAddress, _collTokenAddress) {
```

- *CdpManagerStorage.sol* ( [217-227](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L217-L227) ):

```solidity
/// @audit `_liquidationLibraryAddress not checked`
/// @audit `_authorityAddress not checked`
/// @audit `_borrowerOperationsAddress not checked`
/// @audit `_collSurplusPool not checked`
/// @audit `_ebtcToken not checked`
/// @audit `_sortedCdps not checked`
217:     constructor(
218:         address _liquidationLibraryAddress,
219:         address _authorityAddress,
220:         address _borrowerOperationsAddress,
221:         address _collSurplusPool,
222:         address _ebtcToken,
223:         address _sortedCdps,
224:         address _activePool,
225:         address _priceFeed,
226:         address _collateral
227:     ) EbtcBase(_activePool, _priceFeed, _collateral) {
```

- *CollSurplusPool.sol* ( [42-47](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CollSurplusPool.sol#L42-L47) ):

```solidity
/// @audit `_borrowerOperationsAddress not checked`
/// @audit `_cdpManagerAddress not checked`
/// @audit `_activePoolAddress not checked`
/// @audit `_collTokenAddress not checked`
42:     constructor(
43:         address _borrowerOperationsAddress,
44:         address _cdpManagerAddress,
45:         address _activePoolAddress,
46:         address _collTokenAddress
47:     ) {
```

- *Auth.sol* ( [18](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/Auth.sol#L18) ):

```solidity
/// @audit `_owner not checked`
/// @audit `_authority not checked`
18:     constructor(address _owner, Authority _authority) {
```

- *EbtcBase.sol* ( [52](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/EbtcBase.sol#L52) ):

```solidity
/// @audit `_activePoolAddress not checked`
/// @audit `_priceFeedAddress not checked`
/// @audit `_collateralAddress not checked`
52:     constructor(address _activePoolAddress, address _priceFeedAddress, address _collateralAddress) {
```

- *EBTCToken.sol* ( [61-65](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/EBTCToken.sol#L61-L65) ):

```solidity
/// @audit `_cdpManagerAddress not checked`
/// @audit `_borrowerOperationsAddress not checked`
/// @audit `_authorityAddress not checked`
61:     constructor(
62:         address _cdpManagerAddress,
63:         address _borrowerOperationsAddress,
64:         address _authorityAddress
65:     ) {
```

- *HintHelpers.sol* ( [27-33](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/HintHelpers.sol#L27-L33) ):

```solidity
/// @audit `_sortedCdpsAddress not checked`
/// @audit `_cdpManagerAddress not checked`
27:     constructor(
28:         address _sortedCdpsAddress,
29:         address _cdpManagerAddress,
30:         address _collateralAddress,
31:         address _activePoolAddress,
32:         address _priceFeedAddress
33:     ) EbtcBase(_activePoolAddress, _priceFeedAddress, _collateralAddress) {
```

- *LeverageMacroBase.sol* ( [51-59](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LeverageMacroBase.sol#L51-L59) ):

```solidity
/// @audit `_borrowerOperationsAddress not checked`
/// @audit `_activePool not checked`
/// @audit `_cdpManager not checked`
/// @audit `_ebtc not checked`
/// @audit `_coll not checked`
/// @audit `_sortedCdps not checked`
51:     constructor(
52:         address _borrowerOperationsAddress,
53:         address _activePool,
54:         address _cdpManager,
55:         address _ebtc,
56:         address _coll,
57:         address _sortedCdps,
58:         bool _sweepToCaller
59:     ) {
```

- *LeverageMacroFactory.sol* ( [21-28](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LeverageMacroFactory.sol#L21-L28) ):

```solidity
/// @audit `_borrowerOperationsAddress not checked`
/// @audit `_activePool not checked`
/// @audit `_cdpManager not checked`
/// @audit `_ebtc not checked`
/// @audit `_coll not checked`
/// @audit `_sortedCdps not checked`
21:     constructor(
22:         address _borrowerOperationsAddress,
23:         address _activePool,
24:         address _cdpManager,
25:         address _ebtc,
26:         address _coll,
27:         address _sortedCdps
28:     ) {
```

- *LeverageMacroReference.sol* ( [17-25](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LeverageMacroReference.sol#L17-L25) ):

```solidity
/// @audit `_owner not checked`
17:     constructor(
18:         address _borrowerOperationsAddress,
19:         address _activePool,
20:         address _cdpManager,
21:         address _ebtc,
22:         address _coll,
23:         address _sortedCdps,
24:         address _owner
25:     )
```

- *PriceFeed.sol* ( [57-62](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/PriceFeed.sol#L57-L62) ):

```solidity
/// @audit `_fallbackCallerAddress not checked`
/// @audit `_authorityAddress not checked`
/// @audit `_collEthCLFeed not checked`
/// @audit `_ethBtcCLFeed not checked`
57:     constructor(
58:         address _fallbackCallerAddress,
59:         address _authorityAddress,
60:         address _collEthCLFeed,
61:         address _ethBtcCLFeed
62:     ) {
```

- *SimplifiedDiamondLike.sol* ( [44](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SimplifiedDiamondLike.sol#L44) ):

```solidity
/// @audit `_owner not checked`
44:     constructor(address _owner) {
```

- *SortedCdps.sol* ( [88](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L88) ):

```solidity
/// @audit `_cdpManagerAddress not checked`
/// @audit `_borrowerOperationsAddress not checked`
88:     constructor(uint256 _size, address _cdpManagerAddress, address _borrowerOperationsAddress) {
```

</details>

### [L&#x2011;03] Function `receive()`/`payable fallback()` does not authorize sender

Users may send ETH by mistake to these contracts. As there is no access control on these functions, the funds will be permanently lost.

There are 2 instances:

- *SimplifiedDiamondLike.sol* ( [160](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SimplifiedDiamondLike.sol#L160), [164](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SimplifiedDiamondLike.sol#L164) ):

```solidity
160:     receive() external payable {

164:     fallback() external payable {
```

### [L&#x2011;04] Revert on transfer to the zero address

It's good practice to revert a token transfer transaction if the recipient's address is the zero address. This can prevent unintentional transfers to the zero address due to accidental operations or programming errors. Many token contracts implement such a safeguard, such as [OpenZeppelin - ERC20](https://github.com/OpenZeppelin/openzeppelin-contracts/blob/9e3f4d60c581010c4a3979480e07cc7752f124cc/contracts/token/ERC20/ERC20.sol#L232), [OpenZeppelin - ERC721](https://github.com/OpenZeppelin/openzeppelin-contracts/blob/9e3f4d60c581010c4a3979480e07cc7752f124cc/contracts/token/ERC721/ERC721.sol#L142).

There are 4 instances:

- *ActivePool.sol* ( [286](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/ActivePool.sol#L286), [381](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/ActivePool.sol#L381) ):

```solidity
286:         collateral.transfer(feeRecipientAddress, fee);

381:         IERC20(token).safeTransfer(cachedFeeRecipientAddress, amount);
```

- *BorrowerOperations.sol* ( [785](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L785) ):

```solidity
785:         collateral.transferFrom(msg.sender, address(activePool), _stEthBalance);
```

- *CollSurplusPool.sol* ( [148](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CollSurplusPool.sol#L148) ):

```solidity
148:         IERC20(token).safeTransfer(feeRecipientAddress, amount);
```

### [L&#x2011;05] Array is `push()`ed but not `pop()`ed

Array entries are added but are never removed. Consider whether this should be the case, or whether there should be a maximum, or whether old entries should be removed. Cases where there are specific potential problems will be flagged separately under a different issue.

There is 1 instance:

- *CdpManager.sol* ( [556](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L556) ):

```solidity
556:         CdpIds.push(_cdpId);
```

### [L&#x2011;06] State variables not limited to reasonable values

Consider adding appropriate minimum/maximum value checks to ensure that the following state variables can never be used to excessively harm users, including via griefing.

There are 2 instances:

- *CdpManagerStorage.sol* ( [581](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L581), [582](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L582) ):

```solidity
581:         systemStEthFeePerUnitIndex = _newPerUnit;

582:         systemStEthFeePerUnitIndexError = _newErrorPerUnit;
```

### [L&#x2011;07] Tokens may be minted to the zero address

The target address is not checked in the mint function.

There is 1 instance:

- *EBTCToken.sol* ( [85-88](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/EBTCToken.sol#L85-L88) ):

```solidity
85:     function mint(address _account, uint256 _amount) external override {
86:         _requireCallerIsBOorCdpMOrAuth();
87:         _mint(_account, _amount);
88:     }
```

### [L&#x2011;08] Consider implementing two-step procedure for updating protocol addresses

A copy-paste error or a typo may end up bricking protocol functionality, or sending tokens to an address with no known private key. Consider implementing a two-step procedure for updating protocol addresses, where the recipient is set as pending, and must 'accept' the assignment by making an affirmative call. A straight forward way of doing this would be to have the target contracts implement [EIP-165](https://eips.ethereum.org/EIPS/eip-165), and to have the 'set' functions ensure that the recipient is of the right interface type.

There is 1 instance:

- *BorrowerOperations.sol* ( [628-633](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L628-L633) ):

```solidity
628:     function setPositionManagerApproval(
629:         address _positionManager,
630:         PositionManagerApproval _approval
631:     ) external override {
632:         _setPositionManagerApproval(msg.sender, _positionManager, _approval);
633:     }
```

### [L&#x2011;09] Downcasting other types to an address can cause collisions

Downcasting other types to an address will truncates the upper bytes, which means that multiple values can be mapped to an address, i.e. address collisions can occur.

There is 1 instance:

- *SortedCdps.sol* ( [125](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L125) ):

```solidity
125:         return address(uint160(_tmp));
```

### [L&#x2011;10] Vulnerable versions of packages are being used

This project is using specific package versions which are vulnerable to the specific CVEs listed below. Consider switching to more recent versions of these packages that don't have these vulnerabilities.
- [CVE-2023-30541](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-30541) - **MEDIUM** - (`@openzeppelin/contracts >=3.2.0 <4.8.3`): OpenZeppelin Contracts is a library for secure smart contract development. A function in the implementation contract may be inaccessible if its selector clashes with one of the proxy's own selectors. Specifically, if the clashing function has a different signature with incompatible ABI encoding, the proxy could revert while attempting to decode the arguments from calldata. The probability of an accidental clash is negligible, but one could be caused deliberately and could cause a reduction in availability. The issue has been fixed in version 4.8.3. As a workaround if a function appears to be inaccessible for this reason, it may be possible to craft the calldata such that ABI decoding does not fail at the proxy and the function is properly proxied through.

- [CVE-2022-39384](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-39384) - **MEDIUM** - (`@openzeppelin/contracts >=3.2.0 <4.4.1`): OpenZeppelin Contracts is a library for secure smart contract development. Before version 4.4.1 but after 3.2.0, initializer functions that are invoked separate from contract creation (the most prominent example being minimal proxies) may be reentered if they make an untrusted non-view external call. Once an initializer has finished running it can never be re-executed. However, an exception put in place to support multiple inheritance made reentrancy possible in the scenario described above, breaking the expectation that there is a single execution. Note that upgradeable proxies are commonly initialized together with contract creation, where reentrancy is not feasible, so the impact of this issue is believed to be minor. This issue has been patched, please upgrade to version 4.4.1. As a workaround, avoid untrusted external calls during initialization.

- [CVE-2022-35915](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-35915) - **MEDIUM** - (`@openzeppelin/contracts >=2.0.0 <4.7.2`): OpenZeppelin Contracts is a library for secure smart contract development. The target contract of an EIP-165 `supportsInterface` query can cause unbounded gas consumption by returning a lot of data, while it is generally assumed that this operation has a bounded cost. The issue has been fixed in v4.7.2. Users are advised to upgrade. There are no known workarounds for this issue.

- [CVE-2021-39167](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-39167) - **HIGH** - (`@openzeppelin/contracts >=3.3.0 <=3.4.1`): OpenZepplin is a library for smart contract development. In affected versions a vulnerability in TimelockController allowed an actor with the executor role to escalate privileges. Further details about the vulnerability will be disclosed at a later date. As a workaround revoke the executor role from accounts not strictly under the team's control. We recommend revoking all executors that are not also proposers. When applying this mitigation, ensure there is at least one proposer and executor remaining.

There are 4 instances:

- Global finding

### [L&#x2011;11] Constructor / initialization function lacks parameter validation

Constructors and initialization functions play a critical role in contracts by setting important initial states when the contract is first deployed before the system starts. The parameters passed to the constructor and initialization functions directly affect the behavior of the contract / protocol. If incorrect parameters are provided, the system may fail to run, behave abnormally, be unstable, or lack security. Therefore, it's crucial to carefully check each parameter in the constructor and initialization functions. If an exception is found, the transaction should be rolled back.

There is 1 instance:

- *LeverageMacroBase.sol* ( [51-59](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LeverageMacroBase.sol#L51-L59) ):

```solidity
/// @audit `_sweepToCaller`
51:     constructor(
52:         address _borrowerOperationsAddress,
53:         address _activePool,
54:         address _cdpManager,
55:         address _ebtc,
56:         address _coll,
57:         address _sortedCdps,
58:         bool _sweepToCaller
59:     ) {
```

### [L&#x2011;12] Contracts are vulnerable to fee-on-transfer accounting-related issues

Some tokens take a transfer fee (e.g. STA, PAXG), some do not currently charge a fee but may do so in the future (e.g. USDT, USDC).
The functions below transfer funds from the caller to the receiver via `transferFrom()`, but do not ensure that the actual number of tokens received is the same as the input amount to the transfer. If the token is a fee-on-transfer token, the balance after the transfer will be smaller than expected, leading to accounting issues. Even if there are checks later, related to a secondary transfer, an attacker may be able to use latent funds (e.g. mistakenly sent by another user) in order to get a free credit.
One way to solve this problem is to measure the balance before and after the transfer, and use the difference as the amount, rather than the stated amount.

<details>
<summary>There are 8 instances (click to show):</summary>

- *ActivePool.sol* ( [274](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/ActivePool.sol#L274), [283](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/ActivePool.sol#L283), [286](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/ActivePool.sol#L286), [381](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/ActivePool.sol#L381) ):

```solidity
274:         collateral.transfer(address(receiver), amount);

283:         collateral.transferFrom(address(receiver), address(this), amountWithFee);

286:         collateral.transfer(feeRecipientAddress, fee);

381:         IERC20(token).safeTransfer(cachedFeeRecipientAddress, amount);
```

- *BorrowerOperations.sol* ( [785](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L785) ):

```solidity
785:         collateral.transferFrom(msg.sender, address(activePool), _stEthBalance);
```

- *CollSurplusPool.sol* ( [148](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CollSurplusPool.sol#L148) ):

```solidity
148:         IERC20(token).safeTransfer(feeRecipientAddress, amount);
```

- *LeverageMacroBase.sol* ( [129-133](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LeverageMacroBase.sol#L129-L133), [237](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LeverageMacroBase.sol#L237) ):

```solidity
129:             IERC20(operation.tokenToTransferIn).safeTransferFrom(
130:                 msg.sender,
131:                 address(this),
132:                 operation.amountToTransferIn
133:             );

237:         IERC20(token).safeTransfer(msg.sender, amount);
```

</details>

### [L&#x2011;13] Functions calling contracts/addresses with transfer hooks should be protected by reentrancy guard

Even if the function follows the best practice of check-effects-interaction, not using a reentrancy guard when there may be transfer hooks opens the users of this protocol up to [read-only reentrancy vulnerability](https://chainsecurity.com/curve-lp-oracle-manipulation-post-mortem/) with no way to protect them except by block-listing the entire protocol.

There are 6 instances:

- *ActivePool.sol* ( [274](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/ActivePool.sol#L274), [283](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/ActivePool.sol#L283), [286](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/ActivePool.sol#L286) ):

```solidity
274:         collateral.transfer(address(receiver), amount);

283:         collateral.transferFrom(address(receiver), address(this), amountWithFee);

286:         collateral.transfer(feeRecipientAddress, fee);
```

- *BorrowerOperations.sol* ( [785](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L785) ):

```solidity
785:         collateral.transferFrom(msg.sender, address(activePool), _stEthBalance);
```

- *LeverageMacroBase.sol* ( [129-133](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LeverageMacroBase.sol#L129-L133), [237](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LeverageMacroBase.sol#L237) ):

```solidity
129:             IERC20(operation.tokenToTransferIn).safeTransferFrom(
130:                 msg.sender,
131:                 address(this),
132:                 operation.amountToTransferIn
133:             );

237:         IERC20(token).safeTransfer(msg.sender, amount);
```

### [L&#x2011;14] Critical functions should be controlled by time locks

It is a good practice to give time for users to react and adjust to critical changes. A timelock provides more guarantees and reduces the level of trust required, thus decreasing risk for users. It also indicates that the project is legitimate (less risk of a malicious owner making a sandwich attack on a user).

<details>
<summary>There are 23 instances (click to show):</summary>

- *ActivePool.sol* ( [390](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/ActivePool.sol#L390) ):

```solidity
390:     function setFeeRecipientAddress(address _feeRecipientAddress) external requiresAuth {
```

- *BorrowerOperations.sol* ( [439-445](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L439-L445), [628-631](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L628-L631), [1140](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L1140) ):

```solidity
439:     function _openCdp(
440:         uint256 _debt,
441:         bytes32 _upperHint,
442:         bytes32 _lowerHint,
443:         uint256 _stEthBalance,
444:         address _borrower
445:     ) internal returns (bytes32) {

628:     function setPositionManagerApproval(
629:         address _positionManager,
630:         PositionManagerApproval _approval
631:     ) external override {

1140:     function setFeeRecipientAddress(address _feeRecipientAddress) external requiresAuth {
```

- *CdpManager.sol* ( [244-250](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L244-L250), [538-543](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L538-L543), [773](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L773), [788](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L788), [807](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L807), [830](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L830), [843](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L843), [946-953](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L946-L953) ):

```solidity
244:     function _closeCdpByRedemption(
245:         bytes32 _cdpId,
246:         uint256 _EBTC,
247:         uint256 _collSurplus,
248:         uint256 _liquidatorRewardShares,
249:         address _borrower
250:     ) internal {

538:     function closeCdp(
539:         bytes32 _cdpId,
540:         address _borrower,
541:         uint256 _debt,
542:         uint256 _coll
543:     ) external override {

773:     function setStakingRewardSplit(uint256 _stakingRewardSplit) external requiresAuth {

788:     function setRedemptionFeeFloor(uint256 _redemptionFeeFloor) external requiresAuth {

807:     function setMinuteDecayFactor(uint256 _minuteDecayFactor) external requiresAuth {

830:     function setBeta(uint256 _beta) external requiresAuth {

843:     function setRedemptionsPaused(bool _paused) external requiresAuth {

946:     function updateCdp(
947:         bytes32 _cdpId,
948:         address _borrower,
949:         uint256 _coll,
950:         uint256 _debt,
951:         uint256 _newColl,
952:         uint256 _newDebt
953:     ) external {
```

- *CdpManagerStorage.sol* ( [111](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L111) ):

```solidity
111:     function setGracePeriod(uint128 _gracePeriod) external requiresAuth {
```

- *Auth.sol* ( [42](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/Auth.sol#L42) ):

```solidity
42:     function setAuthority(Authority newAuthority) public virtual {
```

- *AuthNoOwner.sol* ( [38](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/AuthNoOwner.sol#L38) ):

```solidity
38:     function setAuthority(address newAuthority) public virtual {
```

- *RolesAuthority.sol* ( [85-89](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/RolesAuthority.sol#L85-L89), [106-111](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/RolesAuthority.sol#L106-L111), [147](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/RolesAuthority.sol#L147) ):

```solidity
85:     function setPublicCapability(
86:         address target,
87:         bytes4 functionSig,
88:         bool enabled
89:     ) public virtual requiresAuth {

106:     function setRoleCapability(
107:         uint8 role,
108:         address target,
109:         bytes4 functionSig,
110:         bool enabled
111:     ) public virtual requiresAuth {

147:     function setUserRole(address user, uint8 role, bool enabled) public virtual requiresAuth {
```

- *Governor.sol* ( [154](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Governor.sol#L154) ):

```solidity
154:     function setRoleName(uint8 role, string memory roleName) external requiresAuth {
```

- *PriceFeed.sol* ( [358](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/PriceFeed.sol#L358) ):

```solidity
358:     function setFallbackCaller(address _fallbackCaller) external requiresAuth {
```

- *SimplifiedDiamondLike.sol* ( [51](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SimplifiedDiamondLike.sol#L51) ):

```solidity
51:     function setFallbackHandler(bytes4 sig, address handler) external {
```

- *SortedCdps.sol* ( [410](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L410), [419](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L419) ):

```solidity
410:     function remove(bytes32 _id) external override {

419:     function batchRemove(bytes32[] memory _ids) external override {
```

</details>

### [L&#x2011;15] Division by zero not prevented

The divisions below take an input parameter that has no zero-value checks, which can cause the functions reverting if zero is passed.

<details>
<summary>There are 11 instances (click to show):</summary>

- *CdpManager.sol* ( [621-622](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L621-L622), [624](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L624) ):

```solidity
621:         uint256 redeemedEBTCFraction = (collateral.getPooledEthByShares(_ETHDrawn) * _price) /
622:             _totalEBTCSupply;

624:         uint256 newBaseRate = decayedBaseRate + (redeemedEBTCFraction / beta);
```

- *CdpManagerStorage.sol* ( [567](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L567) ):

```solidity
567:         uint256 _deltaFeePerUnit = _deltaFeeSplitShare / _cachedAllStakes;
```

- *EbtcBase.sol* ( [108](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/EbtcBase.sol#L108) ):

```solidity
108:         uint256 feePercentage = (_fee * DECIMAL_PRECISION) / _amount;
```

- *HintHelpers.sol* ( [145](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/HintHelpers.sol#L145) ):

```solidity
145:             (maxRedeemableEBTC * DECIMAL_PRECISION) / _price
```

- *LiquidationLibrary.sol* ( [278](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LiquidationLibrary.sol#L278), [435](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LiquidationLibrary.sol#L435), [555](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LiquidationLibrary.sol#L555), [558](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LiquidationLibrary.sol#L558), [579](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LiquidationLibrary.sol#L579), [882](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LiquidationLibrary.sol#L882) ):

```solidity
278:         uint _debtToColl = (_totalDebtToBurn * DECIMAL_PRECISION) / _liqState.price;

435:             uint _debtToColl = (_partialDebt * DECIMAL_PRECISION) / _partialState.price;

555:             _incentiveColl = (_totalDebtToBurn * (_ICR > MCR ? MCR : _ICR)) / _price;

558:             _incentiveColl = (_totalDebtToBurn * LICR) / _price;

579:             _incentiveColl = (_totalDebtToBurn * (_ICR > MCR ? MCR : _ICR)) / _price;

882:         uint256 EBTCDebtRewardPerUnitStaked = EBTCDebtNumerator / _totalStakes;
```

</details>

### [L&#x2011;16] External function calls within loops

Calling external functions within loops can easily result in insufficient gas. This greatly increases the likelihood of transaction failures, DOS attacks, and other unexpected actions. It is recommended to limit the number of loops within loops that call external functions, and to limit the gas line for each external call.

There are 3 instances:

- *CdpManager.sol* ( [403-405](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L403-L405) ):

```solidity
/// @audit Calling `_redeemCollateralFromCdp()` within `while` loop, it will trigger an external call - `reInsert()`
403:                 SingleRedemptionValues memory singleRedemption = _redeemCollateralFromCdp(
404:                     _redeemColFromCdp
405:                 );
```

- *LeverageMacroBase.sol* ( [386](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LeverageMacroBase.sol#L386) ):

```solidity
/// @audit Calling `_doSwap()` within `for` loop, it will trigger an external call - `safeApprove()`
386:             _doSwap(swapData[i]);
```

- *LiquidationLibrary.sol* ( [765-771](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LiquidationLibrary.sol#L765-L771) ):

```solidity
/// @audit Calling `_getLiquidationValuesRecoveryMode()` within `for` loop, it will trigger an external call - `increaseSurplusCollShares()`
765:                     _getLiquidationValuesRecoveryMode(
766:                         _price,
767:                         vars.entireSystemDebt,
768:                         vars.entireSystemColl,
769:                         vars,
770:                         singleLiquidation
771:                     );
```

### [L&#x2011;17] Some tokens may revert when zero value transfers are made

Despite the fact that [EIP-20 states](https://github.com/ethereum/EIPs/blob/7500ac4fc1bbdfaf684e7ef851f798f6b667b2fe/EIPS/eip-20.md?plain=1#L116) that zero-value transfers must be accepted, some tokens, such as LEND, will revert if this is attempted, which may cause transactions that involve other tokens (such as batch operations) to fully revert. Consider skipping the transfer if the amount is zero, which will also save gas.

There are 2 instances:

- *BorrowerOperations.sol* ( [785](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L785) ):

```solidity
785:         collateral.transferFrom(msg.sender, address(activePool), _stEthBalance);
```

- *LeverageMacroBase.sol* ( [237](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LeverageMacroBase.sol#L237) ):

```solidity
237:         IERC20(token).safeTransfer(msg.sender, amount);
```

### [L&#x2011;18] Use `SafeCast` to downcast safely

When a type is downcast to a smaller type, the higher order bits are truncated, effectively applying a modulo to the original value. The loss of data may cause incorrect calculations, unexpected state changes, or other unexpected behavior.
It is recommended to use the [SafeCast library](https://github.com/OpenZeppelin/openzeppelin-contracts/blob/master/contracts/utils/math/SafeCast.sol).

There are 2 instances:

- *CdpManager.sol* ( [559](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L559) ):

```solidity
/// @audit uint256 -> uint128
559:         index = uint128(CdpIds.length - 1);
```

- *CdpManagerStorage.sol* ( [53](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L53) ):

```solidity
/// @audit uint256 -> uint128
53:             lastGracePeriodStartTimestamp = uint128(block.timestamp);
```

### [L&#x2011;19] Use descriptive constant instead of 0 as a parameter

Passing `0` or `0x0` as a function argument can sometimes result in a security issue(e.g. passing zero as the slippage parameter). A historical example is the infamous `0x0` address bug where numerous tokens were lost. This happens because `0` can be interpreted as an uninitialized `address`, leading to transfers to the `0x0` `address`, effectively burning tokens. Moreover, `0` as a denominator in division operations would cause a runtime exception. It's also often indicative of a logical error in the caller's code.

Consider using a constant variable with a descriptive name, so it's clear that the argument is intentionally being used, and for the right reasons.

<details>
<summary>There are 19 instances (click to show):</summary>

- *BorrowerOperations.sol* ( [209](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L209), [225](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L225), [241](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L241), [256](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L256), [278-286](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L278-L286) ):

```solidity
209:         _adjustCdpInternal(_cdpId, 0, 0, false, _upperHint, _lowerHint, _stEthBalanceIncrease);

225:         _adjustCdpInternal(_cdpId, _stEthBalanceDecrease, 0, false, _upperHint, _lowerHint, 0);

241:         _adjustCdpInternal(_cdpId, 0, _debt, true, _upperHint, _lowerHint, 0);

256:         _adjustCdpInternal(_cdpId, 0, _debt, false, _upperHint, _lowerHint, 0);

278:         _adjustCdpInternal(
279:             _cdpId,
280:             _stEthBalanceDecrease,
281:             _debtChange,
282:             _isDebtIncrease,
283:             _upperHint,
284:             _lowerHint,
285:             0
286:         );
```

- *CdpManager.sol* ( [171-177](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L171-L177) ):

```solidity
171:                 _closeCdpByRedemption(
172:                     _redeemColFromCdp.cdpId,
173:                     0,
174:                     newColl,
175:                     _liquidatorRewardShares,
176:                     _borrower
177:                 );
```

- *CdpManagerStorage.sol* ( [519](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L519) ):

```solidity
519:             _updateSystemSnapshotsExcludeCollRemainder(0);
```

- *LeverageMacroBase.sol* ( [414-420](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LeverageMacroBase.sol#L414-L420), [427](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LeverageMacroBase.sol#L427) ):

```solidity
414:         (bool success, ) = excessivelySafeCall(
415:             swapData.addressForSwap,
416:             gasleft(),
417:             0,
418:             0,
419:             swapData.calldataForSwap
420:         );

427:         IERC20(swapData.tokenForSwap).safeApprove(swapData.addressForApprove, 0);
```

- *LiquidationLibrary.sol* ( [41](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LiquidationLibrary.sol#L41) ):

```solidity
41:         _liquidateIndividualCdpSetup(_cdpId, 0, _cdpId, _cdpId);
```

- *SortedCdps.sol* ( [144](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L144), [217](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L217), [273](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L273), [275](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L275) ):

```solidity
144:         (bytes32 _cdpId, ) = _cdpOfOwnerByIndex(owner, index, dummyId, 0);

217:         (uint256 _cnt, ) = _cdpCountOf(owner, dummyId, 0);

273:         (uint _ownedCount, ) = _cdpCountOf(owner, dummyId, 0);

275:             (bytes32[] memory _allCdps, , ) = _getCdpsOf(owner, dummyId, 0, _ownedCount);
```

</details>

### [L&#x2011;20] Large approvals may not work with some `ERC20` tokens

Some tokens such as [COMP](https://github.com/compound-finance/compound-protocol/blob/a3214f67b73310d547e00fc578e8355911c9d376/contracts/Governance/Comp.sol#L89-L91) downcast such approvals to `uint96` and use that as a raw value rather than interpreting it as an infinite approval. Eventually these approvals will reach zero, at which point the calling contract will no longer function properly.

There are 2 instances:

- *LeverageMacroBase.sol* ( [405-408](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LeverageMacroBase.sol#L405-L408), [427](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LeverageMacroBase.sol#L427) ):

```solidity
405:         IERC20(swapData.tokenForSwap).safeApprove(
406:             swapData.addressForApprove,
407:             swapData.exactApproveAmount
408:         );

427:         IERC20(swapData.tokenForSwap).safeApprove(swapData.addressForApprove, 0);
```

### [L&#x2011;21] Use `increaseAllowance()`/`decreaseAllowance()` instead of `approve()`/`safeApprove()`

Changing an allowance with `approve()` brings the risk that someone may use both the old and the new allowance by unfortunate transaction ordering. Refer to [ERC20 API: An Attack Vector on the Approve/TransferFrom Methods](https://docs.google.com/document/d/1YLPtQxZu1UAvO9cZ1O2RPXBbT0mooh4DYKjA_jp-RLM).
It is recommended to use the `increaseAllowance()`/`decreaseAllowance()` to avoid ths problem.

There are 2 instances:

- *LeverageMacroBase.sol* ( [405-408](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LeverageMacroBase.sol#L405-L408), [427](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LeverageMacroBase.sol#L427) ):

```solidity
405:         IERC20(swapData.tokenForSwap).safeApprove(
406:             swapData.addressForApprove,
407:             swapData.exactApproveAmount
408:         );

427:         IERC20(swapData.tokenForSwap).safeApprove(swapData.addressForApprove, 0);
```

### [L&#x2011;22] Code does not follow the best practice of check-effects-interaction

Code should follow the best-practice of [check-effects-interaction](https://blockchain-academy.hs-mittweida.de/courses/solidity-coding-beginners-to-intermediate/lessons/solidity-11-coding-patterns/topic/checks-effects-interactions/), where state variables are updated before any external calls are made. Doing so prevents a large class of reentrancy bugs.

<details>
<summary>There are 17 instances (click to show):</summary>

- *ActivePool.sol* ( [359](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/ActivePool.sol#L359), [398](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/ActivePool.sol#L398), [411](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/ActivePool.sol#L411), [420](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/ActivePool.sol#L420) ):

```solidity
/// @audit `syncGlobalAccountingAndGracePeriod()` is called on line 347
359:         feeRecipientCollShares = cachedFeeRecipientCollShares;

/// @audit `syncGlobalAccountingAndGracePeriod()` is called on line 391
398:         feeRecipientAddress = _feeRecipientAddress;

/// @audit `syncGlobalAccountingAndGracePeriod()` is called on line 405
411:         feeBps = uint16(_newFee);

/// @audit `syncGlobalAccountingAndGracePeriod()` is called on line 418
420:         flashLoansPaused = _paused;
```

- *BorrowerOperations.sol* ( [1148](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L1148), [1161](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L1161), [1170](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L1170) ):

```solidity
/// @audit `syncGlobalAccounting()` is called on line 1146
1148:         feeRecipientAddress = _feeRecipientAddress;

/// @audit `syncGlobalAccounting()` is called on line 1157
1161:         feeBps = uint16(_newFee);

/// @audit `syncGlobalAccounting()` is called on line 1168
1170:         flashLoansPaused = _paused;
```

- *CdpManager.sol* ( [216](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L216), [217](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L217), [781](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L781), [800](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L800), [823](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L823), [835](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L835), [847](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L847) ):

```solidity
/// @audit `reInsert()` is called on line 209
216:             Cdps[_redeemColFromCdp.cdpId].debt = newDebt;

/// @audit `reInsert()` is called on line 209
217:             Cdps[_redeemColFromCdp.cdpId].coll = newColl;

/// @audit `syncGlobalAccountingAndGracePeriod()` is called on line 779, triggering an external call - `fetchPrice()`
781:         stakingRewardSplit = _stakingRewardSplit;

/// @audit `syncGlobalAccountingAndGracePeriod()` is called on line 798, triggering an external call - `fetchPrice()`
800:         redemptionFeeFloor = _redemptionFeeFloor;

/// @audit `syncGlobalAccountingAndGracePeriod()` is called on line 817, triggering an external call - `fetchPrice()`
823:         minuteDecayFactor = _minuteDecayFactor;

/// @audit `syncGlobalAccountingAndGracePeriod()` is called on line 831, triggering an external call - `fetchPrice()`
835:         beta = _beta;

/// @audit `syncGlobalAccountingAndGracePeriod()` is called on line 844, triggering an external call - `fetchPrice()`
847:         redemptionsPaused = _paused;
```

- *CdpManagerStorage.sol* ( [118](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L118), [386](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L386), [405](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L405) ):

```solidity
/// @audit `syncGlobalAccountingAndGracePeriod()` is called on line 117, triggering an external call - `fetchPrice()`
118:         recoveryModeGracePeriodDuration = _gracePeriod;

/// @audit `_syncGlobalAccounting()` is called on line 348, triggering an external call - `allocateSystemCollSharesToFeeRecipient()`
386:                         _cdp.debt = _newDebt;

/// @audit `_syncGlobalAccounting()` is called on line 348, triggering an external call - `allocateSystemCollSharesToFeeRecipient()`
405:             cdpStEthFeePerUnitIndex[_cdpId] = _systemStEthFeePerUnitIndex;
```

</details>

### [L&#x2011;23] Some tokens may revert when large transfers are made

Tokens such as COMP or UNI will revert when an address' balance reaches [`type(uint96).max`](https://github.com/compound-finance/compound-protocol/blob/a3214f67b73310d547e00fc578e8355911c9d376/contracts/Governance/Comp.sol#L238). Ensure that the calls below can be broken up into smaller batches if necessary.

<details>
<summary>There are 8 instances (click to show):</summary>

- *ActivePool.sol* ( [274](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/ActivePool.sol#L274), [283](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/ActivePool.sol#L283), [286](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/ActivePool.sol#L286), [381](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/ActivePool.sol#L381) ):

```solidity
274:         collateral.transfer(address(receiver), amount);

283:         collateral.transferFrom(address(receiver), address(this), amountWithFee);

286:         collateral.transfer(feeRecipientAddress, fee);

381:         IERC20(token).safeTransfer(cachedFeeRecipientAddress, amount);
```

- *BorrowerOperations.sol* ( [785](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L785) ):

```solidity
785:         collateral.transferFrom(msg.sender, address(activePool), _stEthBalance);
```

- *CollSurplusPool.sol* ( [148](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CollSurplusPool.sol#L148) ):

```solidity
148:         IERC20(token).safeTransfer(feeRecipientAddress, amount);
```

- *LeverageMacroBase.sol* ( [129-133](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LeverageMacroBase.sol#L129-L133), [237](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LeverageMacroBase.sol#L237) ):

```solidity
129:             IERC20(operation.tokenToTransferIn).safeTransferFrom(
130:                 msg.sender,
131:                 address(this),
132:                 operation.amountToTransferIn
133:             );

237:         IERC20(token).safeTransfer(msg.sender, amount);
```

</details>

### [L&#x2011;24] Contracts are vulnerable to rebasing accounting-related issues

Rebasing tokens are tokens that have each holder's `balanceof()` increase over time. Aave aTokens are an example of such tokens. If rebasing tokens are used, rewards accrue to the contract holding the tokens, and cannot be withdrawn by the original depositor. To address the issue, track 'shares' deposited on a pro-rata basis, and let shares be redeemed for their proportion of the current balance at the time of the withdrawal.

There are 3 instances:

- *BorrowerOperations.sol* ( [783](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L783) ):

```solidity
783:     function _activePoolAddColl(uint256 _stEthBalance, uint256 _sharesToTrack) internal {
```

- *LeverageMacroBase.sol* ( [118-124](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LeverageMacroBase.sol#L118-L124), [234](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LeverageMacroBase.sol#L234) ):

```solidity
118:     function doOperation(
119:         FlashLoanType flType,
120:         uint256 borrowAmount,
121:         LeverageMacroOperation calldata operation,
122:         PostOperationCheck postCheckType,
123:         PostCheckParams calldata checkParams
124:     ) external {

234:     function sweepToken(address token, uint256 amount) public {
```

## Non Critical Issues

### [N&#x2011;01] `abi.encodePacked()` should be replaced with `bytes.concat()`

Solidity version 0.8.4 introduces `bytes.concat()`, which can be used to replace `abi.encodePacked()` on bytes/strings. It can make the intended operation clearer, leading to less reviewer confusion.

There are 2 instances:

- *BorrowerOperations.sol* ( [718-731](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L718-L731) ):

```solidity
718:             abi.encodePacked(
719:                 "\x19\x01",
720:                 domainSeparator(),
721:                 keccak256(
722:                     abi.encode(
723:                         _PERMIT_POSITION_MANAGER_TYPEHASH,
724:                         _borrower,
725:                         _positionManager,
726:                         _approval,
727:                         _nonces[_borrower]++,
728:                         _deadline
729:                     )
730:                 )
731:             )
```

- *EBTCToken.sol* ( [210-216](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/EBTCToken.sol#L210-L216) ):

```solidity
210:             abi.encodePacked(
211:                 "\x19\x01",
212:                 domainSeparator(),
213:                 keccak256(
214:                     abi.encode(_PERMIT_TYPEHASH, owner, spender, amount, _nonces[owner]++, deadline)
215:                 )
216:             )
```

### [N&#x2011;02] Consider moving `msg.sender` checks to `modifier`s

If some functions are only allowed to be called by some specific users, consider using a modifier instead of checking with a require statement, especially if this check is done in multiple functions.

<details>
<summary>There are 23 instances (click to show):</summary>

- *ActivePool.sol* ( [220-223](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/ActivePool.sol#L220-L223), [228-231](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/ActivePool.sol#L228-L231), [236](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/ActivePool.sol#L236), [277-280](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/ActivePool.sol#L277-L280) ):

```solidity
220:         require(
221:             msg.sender == borrowerOperationsAddress,
222:             "ActivePool: Caller is not BorrowerOperations"
223:         );

228:         require(
229:             msg.sender == borrowerOperationsAddress || msg.sender == cdpManagerAddress,
230:             "ActivePool: Caller is neither BorrowerOperations nor CdpManager"
231:         );

236:         require(msg.sender == cdpManagerAddress, "ActivePool: Caller is not CdpManager");

277:         require(
278:             receiver.onFlashLoan(msg.sender, token, amount, fee, data) == FLASH_SUCCESS_VALUE,
279:             "ActivePool: IERC3156: Callback failed"
280:         );
```

- *BorrowerOperations.sol* ( [1091-1094](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L1091-L1094) ):

```solidity
1091:         require(
1092:             receiver.onFlashLoan(msg.sender, token, amount, fee, data) == FLASH_SUCCESS_VALUE,
1093:             "IERC3156: Callback failed"
1094:         );
```

- *CdpManagerStorage.sol* ( [660-663](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L660-L663) ):

```solidity
660:         require(
661:             msg.sender == borrowerOperationsAddress,
662:             "CdpManager: Caller is not the BorrowerOperations contract"
663:         );
```

- *CollSurplusPool.sol* ( [113-116](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CollSurplusPool.sol#L113-L116), [120](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CollSurplusPool.sol#L120), [124](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CollSurplusPool.sol#L124) ):

```solidity
113:         require(
114:             msg.sender == borrowerOperationsAddress,
115:             "CollSurplusPool: Caller is not Borrower Operations"
116:         );

120:         require(msg.sender == cdpManagerAddress, "CollSurplusPool: Caller is not CdpManager");

124:         require(msg.sender == activePoolAddress, "CollSurplusPool: Caller is not Active Pool");
```

- *Auth.sol* ( [45](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/Auth.sol#L45) ):

```solidity
45:         require(msg.sender == owner || authority.canCall(msg.sender, address(this), msg.sig));
```

- *AuthNoOwner.sol* ( [41](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/AuthNoOwner.sol#L41) ):

```solidity
41:         require(_authority.canCall(msg.sender, address(this), msg.sig));
```

- *EBTCToken.sol* ( [307-310](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/EBTCToken.sol#L307-L310), [315-320](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/EBTCToken.sol#L315-L320), [324](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/EBTCToken.sol#L324) ):

```solidity
307:         require(
308:             msg.sender == borrowerOperationsAddress,
309:             "EBTCToken: Caller is not BorrowerOperations"
310:         );

315:         require(
316:             msg.sender == borrowerOperationsAddress ||
317:                 msg.sender == cdpManagerAddress ||
318:                 isAuthorized(msg.sender, msg.sig),
319:             "EBTC: Caller is neither BorrowerOperations nor CdpManager nor authorized"
320:         );

324:         require(msg.sender == cdpManagerAddress, "EBTC: Caller is not CdpManager");
```

- *LeverageMacroBase.sol* ( [45](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LeverageMacroBase.sol#L45), [356-359](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LeverageMacroBase.sol#L356-L359), [362-365](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LeverageMacroBase.sol#L362-L365) ):

```solidity
45:         require(owner() == msg.sender, "Must be owner");

356:             require(
357:                 msg.sender == address(borrowerOperations),
358:                 "LeverageMacroReference: wrong lender for eBTC flashloan"
359:             );

362:             require(
363:                 msg.sender == address(activePool),
364:                 "LeverageMacroReference: wrong lender for stETH flashloan"
365:             );
```

- *SimplifiedDiamondLike.sol* ( [52](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SimplifiedDiamondLike.sol#L52), [67](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SimplifiedDiamondLike.sol#L67), [77](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SimplifiedDiamondLike.sol#L77), [111](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SimplifiedDiamondLike.sol#L111) ):

```solidity
52:         require(msg.sender == owner);

67:         require(msg.sender == owner);

77:         require(msg.sender == address(this)); // Must call this via `execute` to explicitly set the flag

111:         require(msg.sender == owner, "Must be owner");
```

- *SortedCdps.sol* ( [715](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L715), [720-723](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L720-L723) ):

```solidity
715:         require(msg.sender == address(cdpManager), "SortedCdps: Caller is not the CdpManager");

720:         require(
721:             msg.sender == borrowerOperationsAddress || msg.sender == address(cdpManager),
722:             "SortedCdps: Caller is neither BO nor CdpM"
723:         );
```

</details>

### [N&#x2011;03] Import declarations should import specific identifiers, rather than the whole file

Using import declarations of the form `import {<identifier_name>} from "some/file.sol"` avoids polluting the symbol namespace making flattened files smaller, and speeds up compilation (but does not save any gas).

<details>
<summary>There are 96 instances (click to show):</summary>

- *ActivePool.sol* ( [5](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/ActivePool.sol#L5), [6](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/ActivePool.sol#L6), [7](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/ActivePool.sol#L7), [8](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/ActivePool.sol#L8), [9](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/ActivePool.sol#L9), [10](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/ActivePool.sol#L10), [11](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/ActivePool.sol#L11), [12](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/ActivePool.sol#L12), [13](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/ActivePool.sol#L13) ):

```solidity
5: import "./Interfaces/IActivePool.sol";

6: import "./Interfaces/ICollSurplusPool.sol";

7: import "./Dependencies/ICollateralToken.sol";

8: import "./Interfaces/ICdpManagerData.sol";

9: import "./Dependencies/ERC3156FlashLender.sol";

10: import "./Dependencies/SafeERC20.sol";

11: import "./Dependencies/ReentrancyGuard.sol";

12: import "./Dependencies/AuthNoOwner.sol";

13: import "./Dependencies/BaseMath.sol";
```

- *BorrowerOperations.sol* ( [5](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L5), [6](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L6), [7](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L7), [8](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L8), [9](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L9), [10](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L10), [11](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L11), [12](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L12), [13](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L13), [14](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L14), [15](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L15), [16](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L16) ):

```solidity
5: import "./Interfaces/IBorrowerOperations.sol";

6: import "./Interfaces/ICdpManager.sol";

7: import "./Interfaces/ICdpManagerData.sol";

8: import "./Interfaces/IEBTCToken.sol";

9: import "./Interfaces/ICollSurplusPool.sol";

10: import "./Interfaces/ISortedCdps.sol";

11: import "./Dependencies/EbtcBase.sol";

12: import "./Dependencies/ReentrancyGuard.sol";

13: import "./Dependencies/Ownable.sol";

14: import "./Dependencies/AuthNoOwner.sol";

15: import "./Dependencies/ERC3156FlashLender.sol";

16: import "./Dependencies/PermitNonce.sol";
```

- *CdpManager.sol* ( [5](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L5), [6](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L6), [7](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L7), [8](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L8), [9](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L9), [10](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L10), [11](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L11) ):

```solidity
5: import "./Interfaces/ICdpManager.sol";

6: import "./Interfaces/ICollSurplusPool.sol";

7: import "./Interfaces/IEBTCToken.sol";

8: import "./Interfaces/ISortedCdps.sol";

9: import "./Dependencies/ICollateralTokenOracle.sol";

10: import "./CdpManagerStorage.sol";

11: import "./Dependencies/Proxy.sol";
```

- *CdpManagerStorage.sol* ( [5](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L5), [6](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L6), [7](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L7), [8](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L8), [9](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L9), [10](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L10), [11](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L11), [12](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L12) ):

```solidity
5: import "./Interfaces/ICdpManager.sol";

6: import "./Interfaces/ICollSurplusPool.sol";

7: import "./Interfaces/IEBTCToken.sol";

8: import "./Interfaces/ISortedCdps.sol";

9: import "./Dependencies/EbtcBase.sol";

10: import "./Dependencies/ReentrancyGuard.sol";

11: import "./Dependencies/ICollateralTokenOracle.sol";

12: import "./Dependencies/AuthNoOwner.sol";
```

- *CollSurplusPool.sol* ( [5](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CollSurplusPool.sol#L5), [6](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CollSurplusPool.sol#L6), [7](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CollSurplusPool.sol#L7), [8](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CollSurplusPool.sol#L8), [9](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CollSurplusPool.sol#L9), [10](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CollSurplusPool.sol#L10) ):

```solidity
5: import "./Interfaces/ICollSurplusPool.sol";

6: import "./Dependencies/ICollateralToken.sol";

7: import "./Dependencies/SafeERC20.sol";

8: import "./Dependencies/ReentrancyGuard.sol";

9: import "./Dependencies/AuthNoOwner.sol";

10: import "./Interfaces/IActivePool.sol";
```

- *ERC3156FlashLender.sol* ( [5](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/ERC3156FlashLender.sol#L5), [6](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/ERC3156FlashLender.sol#L6) ):

```solidity
5: import "../Interfaces/IERC3156FlashLender.sol";

6: import "../Interfaces/IWETH.sol";
```

- *EbtcBase.sol* ( [5](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/EbtcBase.sol#L5), [6](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/EbtcBase.sol#L6), [7](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/EbtcBase.sol#L7), [8](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/EbtcBase.sol#L8), [9](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/EbtcBase.sol#L9), [10](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/EbtcBase.sol#L10) ):

```solidity
5: import "./BaseMath.sol";

6: import "./EbtcMath.sol";

7: import "../Interfaces/IActivePool.sol";

8: import "../Interfaces/IPriceFeed.sol";

9: import "../Interfaces/IEbtcBase.sol";

10: import "../Dependencies/ICollateralToken.sol";
```

- *RolesAuthority.sol* ( [6](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/RolesAuthority.sol#L6) ):

```solidity
6: import "./EnumerableSet.sol";
```

- *EBTCToken.sol* ( [5](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/EBTCToken.sol#L5), [7](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/EBTCToken.sol#L7), [8](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/EBTCToken.sol#L8) ):

```solidity
5: import "./Interfaces/IEBTCToken.sol";

7: import "./Dependencies/AuthNoOwner.sol";

8: import "./Dependencies/PermitNonce.sol";
```

- *HintHelpers.sol* ( [5](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/HintHelpers.sol#L5), [6](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/HintHelpers.sol#L6), [7](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/HintHelpers.sol#L7) ):

```solidity
5: import "./Interfaces/ICdpManager.sol";

6: import "./Interfaces/ISortedCdps.sol";

7: import "./Dependencies/EbtcBase.sol";
```

- *IActivePool.sol* ( [5](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IActivePool.sol#L5) ):

```solidity
5: import "./IPool.sol";
```

- *IBorrowerOperations.sol* ( [4](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IBorrowerOperations.sol#L4) ):

```solidity
4: import "./IPositionManagers.sol";
```

- *ICdpManager.sol* ( [5](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManager.sol#L5), [6](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManager.sol#L6) ):

```solidity
5: import "./IEbtcBase.sol";

6: import "./ICdpManagerData.sol";
```

- *ICdpManagerData.sol* ( [5](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManagerData.sol#L5), [6](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManagerData.sol#L6), [7](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManagerData.sol#L7), [8](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManagerData.sol#L8), [9](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManagerData.sol#L9), [10](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManagerData.sol#L10) ):

```solidity
5: import "./ICollSurplusPool.sol";

6: import "./IEBTCToken.sol";

7: import "./ISortedCdps.sol";

8: import "./IActivePool.sol";

9: import "./IRecoveryModeGracePeriod.sol";

10: import "../Dependencies/ICollateralTokenOracle.sol";
```

- *IEBTCToken.sol* ( [5](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IEBTCToken.sol#L5), [6](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IEBTCToken.sol#L6) ):

```solidity
5: import "../Dependencies/IERC20.sol";

6: import "../Dependencies/IERC2612.sol";
```

- *IERC3156FlashLender.sol* ( [5](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IERC3156FlashLender.sol#L5) ):

```solidity
5: import "./IERC3156FlashBorrower.sol";
```

- *IEbtcBase.sol* ( [5](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IEbtcBase.sol#L5) ):

```solidity
5: import "./IPriceFeed.sol";
```

- *LeverageMacroBase.sol* ( [4](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LeverageMacroBase.sol#L4), [5](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LeverageMacroBase.sol#L5), [6](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LeverageMacroBase.sol#L6), [7](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LeverageMacroBase.sol#L7), [8](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LeverageMacroBase.sol#L8), [9](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LeverageMacroBase.sol#L9), [10](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LeverageMacroBase.sol#L10), [12](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LeverageMacroBase.sol#L12) ):

```solidity
4: import "./Interfaces/IBorrowerOperations.sol";

5: import "./Interfaces/IERC3156FlashLender.sol";

6: import "./Interfaces/IEBTCToken.sol";

7: import "./Interfaces/ICdpManager.sol";

8: import "./Interfaces/ISortedCdps.sol";

9: import "./Interfaces/IPriceFeed.sol";

10: import "./Dependencies/ICollateralToken.sol";

12: import "./Dependencies/SafeERC20.sol";
```

- *LeverageMacroFactory.sol* ( [5](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LeverageMacroFactory.sol#L5), [6](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LeverageMacroFactory.sol#L6) ):

```solidity
5: import "./Dependencies/ICollateralToken.sol";

6: import "./Interfaces/IEBTCToken.sol";
```

- *LiquidationLibrary.sol* ( [4](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LiquidationLibrary.sol#L4), [5](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LiquidationLibrary.sol#L5), [6](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LiquidationLibrary.sol#L6), [7](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LiquidationLibrary.sol#L7), [8](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LiquidationLibrary.sol#L8), [9](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LiquidationLibrary.sol#L9) ):

```solidity
4: import "./Interfaces/ICdpManagerData.sol";

5: import "./Interfaces/ICollSurplusPool.sol";

6: import "./Interfaces/IEBTCToken.sol";

7: import "./Interfaces/ISortedCdps.sol";

8: import "./Dependencies/ICollateralTokenOracle.sol";

9: import "./CdpManagerStorage.sol";
```

- *PriceFeed.sol* ( [5](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/PriceFeed.sol#L5), [6](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/PriceFeed.sol#L6), [7](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/PriceFeed.sol#L7), [8](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/PriceFeed.sol#L8), [9](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/PriceFeed.sol#L9), [10](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/PriceFeed.sol#L10) ):

```solidity
5: import "./Interfaces/IPriceFeed.sol";

6: import "./Interfaces/IFallbackCaller.sol";

7: import "./Dependencies/AggregatorV3Interface.sol";

8: import "./Dependencies/BaseMath.sol";

9: import "./Dependencies/EbtcMath.sol";

10: import "./Dependencies/AuthNoOwner.sol";
```

- *SortedCdps.sol* ( [5](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L5), [6](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L6), [7](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L7) ):

```solidity
5: import "./Interfaces/ISortedCdps.sol";

6: import "./Interfaces/ICdpManager.sol";

7: import "./Interfaces/IBorrowerOperations.sol";
```

</details>

### [N&#x2011;04] Event should include parameters

It is beneficial for events to include parameters. Including parameters in events allows you to provide additional information and context when emitting the event. This can be valuable for logging important state changes, or recording related accounts, or capturing relevant data.

There are 2 instances:

- *IRecoveryModeGracePeriod.sol* ( [9](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IRecoveryModeGracePeriod.sol#L9), [10](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IRecoveryModeGracePeriod.sol#L10) ):

```solidity
9:     event GracePeriodStart();

10:     event GracePeriodEnd();
```

### [N&#x2011;05] Visibility of state variables is not explicitly defined

To avoid misunderstandings and unexpected state accesses, it is recommended to explicitly define the visibility of each state variable.

<details>
<summary>There are 6 instances (click to show):</summary>

- *CdpManagerStorage.sol* ( [128](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L128) ):

```solidity
128:     ICollSurplusPool immutable collSurplusPool;
```

- *Governor.sol* ( [17](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Governor.sol#L17) ):

```solidity
17:     bytes32 NO_ROLES = bytes32(0);
```

- *LeverageMacroBase.sol* ( [37](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LeverageMacroBase.sol#L37) ):

```solidity
37:     bytes32 constant FLASH_LOAN_SUCCESS = keccak256("ERC3156FlashBorrower.onFlashLoan");
```

- *SimplifiedDiamondLike.sol* ( [39](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SimplifiedDiamondLike.sol#L39) ):

```solidity
39:     bytes32 constant DIAMOND_STORAGE_POSITION = keccak256("diamond.standard.diamond.storage");
```

- *SortedCdps.sol* ( [60](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L60), [61](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L61) ):

```solidity
60:     uint256 constant ADDRESS_SHIFT = 96; // 8 * 12; Puts the address at leftmost bytes32 position

61:     uint256 constant BLOCK_SHIFT = 64; // 8 * 8; Puts the block value after the address
```

</details>

### [N&#x2011;06] Too long functions should be refactored

Functions with too many lines are difficult to understand. It is recommended to refactor complex functions into multiple shorter and easier to understand functions.

<details>
<summary>There are 17 instances (click to show):</summary>

- *ActivePool.sol* ( [261](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/ActivePool.sol#L261) ):

```solidity
/// @audit 50 lines
261:     function flashLoan(
```

- *BorrowerOperations.sol* ( [328](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L328), [439](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L439), [852](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L852) ):

```solidity
/// @audit 110 lines
328:     function _adjustCdpInternal(

/// @audit 109 lines
439:     function _openCdp(

/// @audit 57 lines
852:     function _requireValidAdjustmentInCurrentMode(
```

- *CdpManager.sol* ( [135](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L135), [320](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L320) ):

```solidity
/// @audit 100 lines
135:     function _redeemCollateralFromCdp(

/// @audit 166 lines
320:     function redeemCollateral(
```

- *CdpManagerStorage.sol* ( [344](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L344) ):

```solidity
/// @audit 64 lines
344:     function _syncAccounting(bytes32 _cdpId) internal {
```

- *HintHelpers.sol* ( [48](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/HintHelpers.sol#L48) ):

```solidity
/// @audit 75 lines
48:     function getRedemptionHints(
```

- *LeverageMacroBase.sol* ( [118](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LeverageMacroBase.sol#L118) ):

```solidity
/// @audit 94 lines
118:     function doOperation(
```

- *LiquidationLibrary.sol* ( [61](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LiquidationLibrary.sol#L61), [223](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LiquidationLibrary.sol#L223), [295](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LiquidationLibrary.sol#L295), [397](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LiquidationLibrary.sol#L397), [733](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LiquidationLibrary.sol#L733) ):

```solidity
/// @audit 71 lines
61:     function _liquidateIndividualCdpSetup(

/// @audit 71 lines
223:     function _liquidateIndividualCdpSetupCDPInNormalMode(

/// @audit 85 lines
295:     function _liquidateIndividualCdpSetupCDPInRecoveryMode(

/// @audit 52 lines
397:     function _liquidateCDPPartially(

/// @audit 73 lines
733:     function _getTotalFromBatchLiquidate_RecoveryMode(
```

- *PriceFeed.sol* ( [98](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/PriceFeed.sol#L98), [606](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/PriceFeed.sol#L606), [687](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/PriceFeed.sol#L687) ):

```solidity
/// @audit 255 lines
98:     function fetchPrice() external override returns (uint256) {

/// @audit 76 lines
606:     function _getCurrentChainlinkResponse()

/// @audit 83 lines
687:     function _getPrevChainlinkResponse(
```

</details>

### [N&#x2011;07] NatSpec documentation for contract is missing

e.g. `@dev` or `@notice`, and it must appear above the contract definition braces in order to be identified by the compiler as NatSpec.

<details>
<summary>There are 24 instances (click to show):</summary>

- *ERC3156FlashLender.sol* ( [8](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/ERC3156FlashLender.sol#L8) ):

```solidity
8: abstract contract ERC3156FlashLender is IERC3156FlashLender {
```

- *EbtcBase.sol* ( [16](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/EbtcBase.sol#L16) ):

```solidity
16: contract EbtcBase is BaseMath, IEbtcBase {
```

- *EbtcMath.sol* ( [5](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/EbtcMath.sol#L5) ):

```solidity
5: library EbtcMath {
```

- *EBTCToken.sol* ( [26](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/EBTCToken.sol#L26) ):

```solidity
26: contract EBTCToken is IEBTCToken, AuthNoOwner, PermitNonce {
```

- *IActivePool.sol* ( [7](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IActivePool.sol#L7) ):

```solidity
7: interface IActivePool is IPool {
```

- *IBorrowerOperations.sol* ( [7](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IBorrowerOperations.sol#L7) ):

```solidity
7: interface IBorrowerOperations is IPositionManagers {
```

- *ICdpManager.sol* ( [9](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManager.sol#L9) ):

```solidity
9: interface ICdpManager is IEbtcBase, ICdpManagerData {
```

- *ICdpManagerData.sol* ( [13](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManagerData.sol#L13) ):

```solidity
13: interface ICdpManagerData is IRecoveryModeGracePeriod {
```

- *ICollSurplusPool.sol* ( [5](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICollSurplusPool.sol#L5) ):

```solidity
5: interface ICollSurplusPool {
```

- *IEBTCToken.sol* ( [8](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IEBTCToken.sol#L8) ):

```solidity
8: interface IEBTCToken is IERC20, IERC2612 {
```

- *IERC3156FlashBorrower.sol* ( [5](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IERC3156FlashBorrower.sol#L5) ):

```solidity
5: interface IERC3156FlashBorrower {
```

- *IERC3156FlashLender.sol* ( [7](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IERC3156FlashLender.sol#L7) ):

```solidity
7: interface IERC3156FlashLender {
```

- *IEbtcBase.sol* ( [7](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IEbtcBase.sol#L7) ):

```solidity
7: interface IEbtcBase {
```

- *IFallbackCaller.sol* ( [5](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IFallbackCaller.sol#L5) ):

```solidity
5: interface IFallbackCaller {
```

- *IPermitNonce.sol* ( [5](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IPermitNonce.sol#L5) ):

```solidity
5: interface IPermitNonce {
```

- *IPool.sol* ( [6](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IPool.sol#L6) ):

```solidity
6: interface IPool {
```

- *IPositionManagers.sol* ( [5](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IPositionManagers.sol#L5) ):

```solidity
5: interface IPositionManagers {
```

- *IPriceFeed.sol* ( [5](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IPriceFeed.sol#L5) ):

```solidity
5: interface IPriceFeed {
```

- *IRecoveryModeGracePeriod.sol* ( [5](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IRecoveryModeGracePeriod.sol#L5) ):

```solidity
5: interface IRecoveryModeGracePeriod {
```

- *ISortedCdps.sol* ( [6](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ISortedCdps.sol#L6) ):

```solidity
6: interface ISortedCdps {
```

- *LeverageMacroBase.sol* ( [14](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LeverageMacroBase.sol#L14) ):

```solidity
14: interface ICdpCdps {
```

- *LeverageMacroDelegateTarget.sol* ( [6](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LeverageMacroDelegateTarget.sol#L6) ):

```solidity
6: interface IOwnerLike {
```

- *PriceFeed.sol* ( [21](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/PriceFeed.sol#L21) ):

```solidity
21: contract PriceFeed is BaseMath, IPriceFeed, AuthNoOwner {
```

- *SortedCdps.sol* ( [51](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L51) ):

```solidity
51: contract SortedCdps is ISortedCdps {
```

</details>

### [N&#x2011;08] Names of constants should use the UPPER_CASE_WITH_UNDERSCORES style

It is recommended by the [Solidity Style Guide](https://docs.soliditylang.org/en/latest/style-guide.html)

There is 1 instance:

- *SortedCdps.sol* ( [80-81](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L80-L81) ):

```solidity
80:     bytes32 public constant dummyId =
81:         0x0000000000000000000000000000000000000000000000000000000000000000;
```

### [N&#x2011;09] Names of `private`/`internal` functions should be prefixed with an underscore

It is recommended by the [Solidity Style Guide](https://docs.soliditylang.org/en/v0.8.20/style-guide.html#underscore-prefix-for-non-external-functions-and-variables).

There are 4 instances:

- *Auth.sol* ( [32](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/Auth.sol#L32) ):

```solidity
32:     function isAuthorized(address user, bytes4 functionSig) internal view virtual returns (bool) {
```

- *AuthNoOwner.sol* ( [30](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/AuthNoOwner.sol#L30) ):

```solidity
30:     function isAuthorized(address user, bytes4 functionSig) internal view virtual returns (bool) {
```

- *EbtcMath.sol* ( [35](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/EbtcMath.sol#L35) ):

```solidity
35:     function decMul(uint256 x, uint256 y) internal pure returns (uint256 decProd) {
```

- *LeverageMacroBase.sol* ( [498-504](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LeverageMacroBase.sol#L498-L504) ):

```solidity
498:     function excessivelySafeCall(
499:         address _target,
500:         uint256 _gas,
501:         uint256 _value,
502:         uint16 _maxCopy,
503:         bytes memory _calldata
504:     ) internal returns (bool, bytes memory) {
```

### [N&#x2011;10] Names of `private`/`internal` state variables should be prefixed with an underscore

It is recommended by the [Solidity Style Guide](https://docs.soliditylang.org/en/v0.8.20/style-guide.html#underscore-prefix-for-non-external-functions-and-variables).

<details>
<summary>There are 21 instances (click to show):</summary>

- *ActivePool.sol* ( [31](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/ActivePool.sol#L31), [32](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/ActivePool.sol#L32), [33](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/ActivePool.sol#L33) ):

```solidity
31:     uint256 internal systemCollShares; // deposited collateral tracker

32:     uint256 internal systemDebt;

33:     uint256 internal feeRecipientCollShares; // coll shares claimable by fee recipient
```

- *CdpManagerStorage.sol* ( [128](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L128), [152](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L152) ):

```solidity
128:     ICollSurplusPool immutable collSurplusPool;

152:     uint256 internal immutable deploymentStartTime;
```

- *CollSurplusPool.sol* ( [28](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CollSurplusPool.sol#L28), [30](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CollSurplusPool.sol#L30) ):

```solidity
28:     uint256 internal totalSurplusCollShares;

30:     mapping(address => uint256) internal balances;
```

- *ReentrancyGuard.sol* ( [8](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/ReentrancyGuard.sol#L8), [9](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/ReentrancyGuard.sol#L9) ):

```solidity
8:     uint256 internal constant OPEN = 1;

9:     uint256 internal constant LOCKED = 2;
```

- *RolesAuthority.sol* ( [26](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/RolesAuthority.sol#L26), [27](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/RolesAuthority.sol#L27), [28](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/RolesAuthority.sol#L28), [30](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/RolesAuthority.sol#L30) ):

```solidity
26:     EnumerableSet.AddressSet internal users;

27:     EnumerableSet.AddressSet internal targets;

28:     mapping(address => EnumerableSet.Bytes32Set) internal enabledFunctionSigsByTarget;

30:     EnumerableSet.Bytes32Set internal enabledFunctionSigsPublic;
```

- *Governor.sol* ( [17](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Governor.sol#L17), [30](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Governor.sol#L30) ):

```solidity
17:     bytes32 NO_ROLES = bytes32(0);

30:     mapping(uint8 => string) internal roleNames;
```

- *LeverageMacroBase.sol* ( [35](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LeverageMacroBase.sol#L35), [37](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LeverageMacroBase.sol#L37) ):

```solidity
35:     bool internal immutable willSweep;

37:     bytes32 constant FLASH_LOAN_SUCCESS = keccak256("ERC3156FlashBorrower.onFlashLoan");
```

- *LeverageMacroReference.sol* ( [12](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LeverageMacroReference.sol#L12) ):

```solidity
12:     address internal immutable theOwner;
```

- *SimplifiedDiamondLike.sol* ( [39](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SimplifiedDiamondLike.sol#L39) ):

```solidity
39:     bytes32 constant DIAMOND_STORAGE_POSITION = keccak256("diamond.standard.diamond.storage");
```

- *SortedCdps.sol* ( [60](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L60), [61](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L61) ):

```solidity
60:     uint256 constant ADDRESS_SHIFT = 96; // 8 * 12; Puts the address at leftmost bytes32 position

61:     uint256 constant BLOCK_SHIFT = 64; // 8 * 8; Puts the block value after the address
```

</details>

### [N&#x2011;11] Order of functions does not follow the Solidity Style Guide

According to the [Solidity Style Guide](https://docs.soliditylang.org/en/v0.8.20/style-guide.html#order-of-functions), functions should be grouped according to their visibility and ordered: `constructor`, `receive`, `fallback`, `external`, `public`, `internal`, `private`. Within a grouping, place the view and pure functions last.

<details>
<summary>There are 138 instances (click to show):</summary>

- *ActivePool.sol* ( [100](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/ActivePool.sol#L100), [129-133](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/ActivePool.sol#L129-L133), [157](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/ActivePool.sol#L157), [181](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/ActivePool.sol#L181), [194](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/ActivePool.sol#L194), [207](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/ActivePool.sol#L207), [235](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/ActivePool.sol#L235), [242](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/ActivePool.sol#L242), [261-266](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/ActivePool.sol#L261-L266), [328](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/ActivePool.sol#L328), [346](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/ActivePool.sol#L346), [371](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/ActivePool.sol#L371), [390](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/ActivePool.sol#L390), [404](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/ActivePool.sol#L404), [417](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/ActivePool.sol#L417) ):

```solidity
/// @audit ââ Out of order with `transferSystemCollSharesAndLiquidatorReward()`
100:     function transferSystemCollShares(address _account, uint256 _shares) public override {

/// @audit ââ Out of order with `transferSystemCollShares()`
129:     function transferSystemCollSharesAndLiquidatorReward(
130:         address _account,
131:         uint256 _shares,
132:         uint256 _liquidatorRewardShares
133:     ) external override {

/// @audit ââ Out of order with `transferSystemCollSharesAndLiquidatorReward()`
157:     function allocateSystemCollSharesToFeeRecipient(uint256 _shares) external override {

/// @audit ââ Out of order with `increaseSystemDebt()`
181:     function _transferCollSharesWithContractHooks(address _account, uint256 _shares) internal {

/// @audit ââ Out of order with `_transferCollSharesWithContractHooks()`
194:     function increaseSystemDebt(uint256 _amount) external override {

/// @audit ââ Out of order with `increaseSystemDebt()`
207:     function decreaseSystemDebt(uint256 _amount) external override {

/// @audit ââ Out of order with `increaseSystemCollShares()`
235:     function _requireCallerIsCdpManager() internal view {

/// @audit ââ Out of order with `_requireCallerIsCdpManager()`
242:     function increaseSystemCollShares(uint256 _value) external override {

/// @audit ââ Out of order with `increaseSystemCollShares()`
261:     function flashLoan(
262:         IERC3156FlashBorrower receiver,
263:         address token,
264:         uint256 amount,
265:         bytes calldata data
266:     ) external override returns (bool) {

/// @audit ââ Out of order with `claimFeeRecipientCollShares()`
328:     function maxFlashLoan(address token) public view override returns (uint256) {

/// @audit ââ Out of order with `maxFlashLoan()`
346:     function claimFeeRecipientCollShares(uint256 _shares) external override requiresAuth {

/// @audit ââ Out of order with `setFeeRecipientAddress()`
371:     function sweepToken(address token, uint256 amount) public nonReentrant requiresAuth {

/// @audit ââ Out of order with `sweepToken()`
390:     function setFeeRecipientAddress(address _feeRecipientAddress) external requiresAuth {

/// @audit ââ Out of order with `setFeeRecipientAddress()`
404:     function setFeeBps(uint256 _newFee) external requiresAuth {

/// @audit ââ Out of order with `setFeeBps()`
417:     function setFlashLoansPaused(bool _paused) external requiresAuth {
```

- *BorrowerOperations.sol* ( [439-445](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L439-L445), [553](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L553), [615-618](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L615-L618), [628-631](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L628-L631), [635-639](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L635-L639), [647](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L647), [653](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L653), [677-681](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L677-L681), [687](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L687), [693](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L693), [706-714](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L706-L714), [744-747](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L744-L747), [760](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L760), [783](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L783), [790](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L790), [796](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L796), [845](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L845), [852-857](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L852-L857), [953-956](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L953-L956), [963](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L963), [1049-1055](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L1049-L1055), [1077-1082](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L1077-L1082), [1124](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L1124), [1140](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L1140), [1154](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L1154), [1167](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L1167) ):

```solidity
/// @audit ââ Out of order with `closeCdp()`
439:     function _openCdp(
440:         uint256 _debt,
441:         bytes32 _upperHint,
442:         bytes32 _lowerHint,
443:         uint256 _stEthBalance,
444:         address _borrower
445:     ) internal returns (bytes32) {

/// @audit ââ Out of order with `_openCdp()`
553:     function closeCdp(bytes32 _cdpId) external override {

/// @audit ââ Out of order with `setPositionManagerApproval()`
615:     function _getPositionManagerApproval(
616:         address _borrower,
617:         address _positionManager
618:     ) internal view returns (PositionManagerApproval) {

/// @audit ââ Out of order with `_getPositionManagerApproval()`
628:     function setPositionManagerApproval(
629:         address _positionManager,
630:         PositionManagerApproval _approval
631:     ) external override {

/// @audit ââ Out of order with `revokePositionManagerApproval()`
635:     function _setPositionManagerApproval(
636:         address _borrower,
637:         address _positionManager,
638:         PositionManagerApproval _approval
639:     ) internal {

/// @audit ââ Out of order with `_setPositionManagerApproval()`
647:     function revokePositionManagerApproval(address _positionManager) external override {

/// @audit ââ Out of order with `revokePositionManagerApproval()`
653:     function renouncePositionManagerApproval(address _borrower) external override {

/// @audit ââ Out of order with `version()`
677:     function _buildDomainSeparator(
678:         bytes32 typeHash,
679:         bytes32 name,
680:         bytes32 version
681:     ) private view returns (bytes32) {

/// @audit ââ Out of order with `_buildDomainSeparator()`
687:     function version() external pure override returns (string memory) {

/// @audit ââ Out of order with `permitPositionManagerApproval()`
693:     function permitTypeHash() external pure override returns (bytes32) {

/// @audit ââ Out of order with `permitTypeHash()`
706:     function permitPositionManagerApproval(
707:         address _borrower,
708:         address _positionManager,
709:         PositionManagerApproval _approval,
710:         uint256 _deadline,
711:         uint8 v,
712:         bytes32 r,
713:         bytes32 s
714:     ) external override {

/// @audit ââ Out of order with `_processTokenMovesFromAdjustment()`
744:     function _getCollSharesChangeFromStEthChange(
745:         uint256 _collReceived,
746:         uint256 _requestedCollWithdrawal
747:     ) internal view returns (uint256 collSharesChange, bool isCollIncrease) {

/// @audit ââ Out of order with `_getCollSharesChangeFromStEthChange()`
760:     function _processTokenMovesFromAdjustment(MoveTokensParams memory _varMvTokens) internal {

/// @audit ââ Out of order with `_processTokenMovesFromAdjustment()`
783:     function _activePoolAddColl(uint256 _stEthBalance, uint256 _sharesToTrack) internal {

/// @audit ââ Out of order with `_activePoolAddColl()`
790:     function _withdrawDebt(address _account, uint256 _debt) internal {

/// @audit ââ Out of order with `_withdrawDebt()`
796:     function _repayDebt(address _account, uint256 _debt) internal {

/// @audit ââ Out of order with `_requireValidAdjustmentInCurrentMode()`
845:     function _requireNoStEthBalanceDecrease(uint256 _stEthBalanceDecrease) internal pure {

/// @audit ââ Out of order with `_requireNoStEthBalanceDecrease()`
852:     function _requireValidAdjustmentInCurrentMode(
853:         bool _isRecoveryMode,
854:         uint256 _stEthBalanceDecrease,
855:         bool _isDebtIncrease,
856:         AdjustCdpLocals memory _vars
857:     ) internal {

/// @audit ââ Out of order with `_requireBorrowerOrPositionManagerAndUpdateManagerApproval()`
953:     function _requireSufficientEbtcTokenBalance(
954:         address _account,
955:         uint256 _debtRepayment
956:     ) internal view {

/// @audit ââ Out of order with `_requireSufficientEbtcTokenBalance()`
963:     function _requireBorrowerOrPositionManagerAndUpdateManagerApproval(address _borrower) internal {

/// @audit ââ Out of order with `flashLoan()`
1049:     function _getNewTCRFromCdpChange(
1050:         uint256 _stEthBalanceChange,
1051:         bool _isCollIncrease,
1052:         uint256 _debtChange,
1053:         bool _isDebtIncrease,
1054:         uint256 _price
1055:     ) internal view returns (uint256) {

/// @audit ââ Out of order with `_getNewTCRFromCdpChange()`
1077:     function flashLoan(
1078:         IERC3156FlashBorrower receiver,
1079:         address token,
1080:         uint256 amount,
1081:         bytes calldata data
1082:     ) external override returns (bool) {

/// @audit ââ Out of order with `setFeeRecipientAddress()`
1124:     function maxFlashLoan(address token) public view override returns (uint256) {

/// @audit ââ Out of order with `maxFlashLoan()`
1140:     function setFeeRecipientAddress(address _feeRecipientAddress) external requiresAuth {

/// @audit ââ Out of order with `setFeeRecipientAddress()`
1154:     function setFeeBps(uint256 _newFee) external requiresAuth {

/// @audit ââ Out of order with `setFeeBps()`
1167:     function setFlashLoansPaused(bool _paused) external requiresAuth {
```

- *CdpManager.sol* ( [73](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L73), [99](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L99), [109-114](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L109-L114), [126](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L126), [135-137](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L135-L137), [244-250](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L244-L250), [272-275](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L272-L275), [320-328](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L320-L328), [489-493](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L489-L493), [514](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L514), [523](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L523), [538-543](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L538-L543), [550](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L550), [570](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L570), [580](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L580), [595-599](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L595-L599), [612-616](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L612-L616), [638](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L638), [655](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L655), [661-663](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L661-L663), [667-670](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L667-L670), [676](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L676), [689](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L689), [709](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L709), [717](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L717), [727-731](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L727-L731), [761](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L761), [773](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L773), [788](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L788), [807](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L807), [830](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L830), [843](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L843), [891](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L891), [905-911](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L905-L911), [946-953](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L946-L953), [977](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L977), [984](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L984) ):

```solidity
/// @audit ââ Out of order with `liquidate()`
73:     function getIdFromCdpIdsArray(uint256 _index) external view override returns (bytes32) {

/// @audit ââ Out of order with `getIdFromCdpIdsArray()`
99:     function liquidate(bytes32 _cdpId) external override {

/// @audit ââ Out of order with `liquidate()`
109:     function partiallyLiquidate(
110:         bytes32 _cdpId,
111:         uint256 _partialAmount,
112:         bytes32 _upperPartialHint,
113:         bytes32 _lowerPartialHint
114:     ) external override {

/// @audit ââ Out of order with `partiallyLiquidate()`
126:     function batchLiquidateCdps(bytes32[] memory _cdpArray) external override {

/// @audit ââ Out of order with `_closeCdpByRedemption()`
135:     function _redeemCollateralFromCdp(
136:         SingleRedemptionInputs memory _redeemColFromCdp
137:     ) internal returns (SingleRedemptionValues memory singleRedemption) {

/// @audit ââ Out of order with `_redeemCollateralFromCdp()`
244:     function _closeCdpByRedemption(
245:         bytes32 _cdpId,
246:         uint256 _EBTC,
247:         uint256 _collSurplus,
248:         uint256 _liquidatorRewardShares,
249:         address _borrower
250:     ) internal {

/// @audit ââ Out of order with `redeemCollateral()`
272:     function _isValidFirstRedemptionHint(
273:         bytes32 _firstRedemptionHint,
274:         uint256 _price
275:     ) internal view returns (bool) {

/// @audit ââ Out of order with `_isValidFirstRedemptionHint()`
320:     function redeemCollateral(
321:         uint256 _debt,
322:         bytes32 _firstRedemptionHint,
323:         bytes32 _upperPartialRedemptionHint,
324:         bytes32 _lowerPartialRedemptionHint,
325:         uint256 _partialRedemptionHintNICR,
326:         uint256 _maxIterations,
327:         uint256 _maxFeePercentage
328:     ) external override nonReentrantSelfAndBOps {

/// @audit ââ Out of order with `syncAccounting()`
489:     function _getCdpIdsToRemove(
490:         bytes32 _start,
491:         uint256 _total,
492:         bytes32 _end
493:     ) internal view returns (bytes32[] memory) {

/// @audit ââ Out of order with `_getCdpIdsToRemove()`
514:     function syncAccounting(bytes32 _cdpId) external virtual override {

/// @audit ââ Out of order with `syncAccounting()`
523:     function updateStakeAndTotalStakes(bytes32 _cdpId) external override returns (uint256) {

/// @audit ââ Out of order with `updateStakeAndTotalStakes()`
538:     function closeCdp(
539:         bytes32 _cdpId,
540:         address _borrower,
541:         uint256 _debt,
542:         uint256 _coll
543:     ) external override {

/// @audit ââ Out of order with `getSystemDebt()`
550:     function _addCdpIdToArray(bytes32 _cdpId) internal returns (uint128 index) {

/// @audit ââ Out of order with `_addCdpIdToArray()`
570:     function getSystemDebt() public view returns (uint256 entireSystemDebt) {

/// @audit ââ Out of order with `getSystemDebt()`
580:     function getCachedTCR(uint256 _price) external view override returns (uint256) {

/// @audit ââ Out of order with `_updateBaseRateFromRedemption()`
595:     function _checkPotentialRecoveryMode(
596:         uint256 _systemCollShares,
597:         uint256 _systemDebt,
598:         uint256 _price
599:     ) internal view returns (bool) {

/// @audit ââ Out of order with `_checkPotentialRecoveryMode()`
612:     function _updateBaseRateFromRedemption(
613:         uint256 _ETHDrawn,
614:         uint256 _price,
615:         uint256 _totalEBTCSupply
616:     ) internal returns (uint256) {

/// @audit ââ Out of order with `_updateBaseRateFromRedemption()`
638:     function getRedemptionRate() public view override returns (uint256) {

/// @audit ââ Out of order with `getRedemptionFeeWithDecay()`
655:     function _getRedemptionFee(uint256 _ETHDrawn) internal view returns (uint256) {

/// @audit ââ Out of order with `_getRedemptionFee()`
661:     function getRedemptionFeeWithDecay(
662:         uint256 _stETHToRedeem
663:     ) external view override returns (uint256) {

/// @audit ââ Out of order with `_decayBaseRate()`
667:     function _calcRedemptionFee(
668:         uint256 _redemptionRate,
669:         uint256 _ETHDrawn
670:     ) internal pure returns (uint256) {

/// @audit ââ Out of order with `_calcRedemptionFee()`
676:     function _decayBaseRate() internal {

/// @audit ââ Out of order with `_decayBaseRate()`
689:     function _updateLastRedemptionTimestamp() internal {

/// @audit ââ Out of order with `getDeploymentStartTime()`
709:     function _minutesPassedSinceLastRedemption() internal view returns (uint256) {

/// @audit ââ Out of order with `_minutesPassedSinceLastRedemption()`
717:     function getDeploymentStartTime() public view returns (uint256) {

/// @audit ââ Out of order with `getDeploymentStartTime()`
727:     function checkPotentialRecoveryMode(
728:         uint256 _systemCollShares,
729:         uint256 _systemDebt,
730:         uint256 _price
731:     ) external view returns (bool) {

/// @audit ââ Out of order with `setStakingRewardSplit()`
761:     function _requireValidMaxFeePercentage(uint256 _maxFeePercentage) internal view {

/// @audit ââ Out of order with `_requireValidMaxFeePercentage()`
773:     function setStakingRewardSplit(uint256 _stakingRewardSplit) external requiresAuth {

/// @audit ââ Out of order with `setStakingRewardSplit()`
788:     function setRedemptionFeeFloor(uint256 _redemptionFeeFloor) external requiresAuth {

/// @audit ââ Out of order with `setRedemptionFeeFloor()`
807:     function setMinuteDecayFactor(uint256 _minuteDecayFactor) external requiresAuth {

/// @audit ââ Out of order with `setMinuteDecayFactor()`
830:     function setBeta(uint256 _beta) external requiresAuth {

/// @audit ââ Out of order with `setBeta()`
843:     function setRedemptionsPaused(bool _paused) external requiresAuth {

/// @audit ââ Out of order with `initializeCdp()`
891:     function getCdpLiquidatorRewardShares(bytes32 _cdpId) external view override returns (uint256) {

/// @audit ââ Out of order with `getCdpLiquidatorRewardShares()`
905:     function initializeCdp(
906:         bytes32 _cdpId,
907:         uint256 _debt,
908:         uint256 _coll,
909:         uint256 _liquidatorRewardShares,
910:         address _borrower
911:     ) external {

/// @audit ââ Out of order with `initializeCdp()`
946:     function updateCdp(
947:         bytes32 _cdpId,
948:         address _borrower,
949:         uint256 _coll,
950:         uint256 _debt,
951:         uint256 _newColl,
952:         uint256 _newDebt
953:     ) external {

/// @audit ââ Out of order with `_setCdpDebt()`
977:     function _setCdpCollShares(bytes32 _cdpId, uint256 _newColl) internal {

/// @audit ââ Out of order with `_setCdpCollShares()`
984:     function _setCdpDebt(bytes32 _cdpId, uint256 _newDebt) internal {
```

- *CdpManagerStorage.sol* ( [87-91](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L87-L91), [111](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L111), [217-227](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L217-L227), [327](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L327), [336](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L336), [344](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L344), [410](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L410), [419](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L419), [431](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L431), [441](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L441), [463](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L463), [489-493](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L489-L493), [504](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L504), [509](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L509), [527](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L527), [534](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L534), [539](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L539), [552-555](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L552-L555), [574-578](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L574-L578), [592-598](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L592-L598), [616-619](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L616-L619), [659](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L659), [673](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L673), [707-711](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L707-L711), [719-721](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L719-L721), [733-735](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L733-L735), [745-747](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L745-L747), [822-824](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L822-L824), [839](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L839) ):

```solidity
/// @audit ââ Out of order with `setGracePeriod()`
87:     function _syncGracePeriodForGivenValues(
88:         uint256 systemCollShares,
89:         uint256 systemDebt,
90:         uint256 price
91:     ) internal {

/// @audit ââ Out of order with `_syncGracePeriodForGivenValues()`
111:     function setGracePeriod(uint128 _gracePeriod) external requiresAuth {

/// @audit ââ Out of order with `setGracePeriod()`
217:     constructor(
218:         address _liquidationLibraryAddress,
219:         address _authorityAddress,
220:         address _borrowerOperationsAddress,
221:         address _collSurplusPool,
222:         address _ebtcToken,
223:         address _sortedCdps,
224:         address _activePool,
225:         address _priceFeed,
226:         address _collateral
227:     ) EbtcBase(_activePool, _priceFeed, _collateral) {

/// @audit ââ Out of order with `_updateRedistributedDebtIndex()`
327:     function _hasRedistributedDebt(bytes32 _cdpId) internal view returns (bool) {

/// @audit ââ Out of order with `_hasRedistributedDebt()`
336:     function _updateRedistributedDebtIndex(bytes32 _cdpId) internal {

/// @audit ââ Out of order with `_updateRedistributedDebtIndex()`
344:     function _syncAccounting(bytes32 _cdpId) internal {

/// @audit ââ Out of order with `_syncAccounting()`
410:     function _removeStake(bytes32 _cdpId) internal {

/// @audit ââ Out of order with `_removeStake()`
419:     function _updateStakeAndTotalStakes(bytes32 _cdpId) internal returns (uint256) {

/// @audit ââ Out of order with `_updateStakeAndTotalStakes()`
431:     function _updateStakeForCdp(bytes32 _cdpId) internal returns (uint256, uint256) {

/// @audit ââ Out of order with `_removeCdp()`
441:     function _computeNewStake(uint256 _coll) internal view returns (uint256) {

/// @audit ââ Out of order with `_computeNewStake()`
463:     function _removeCdp(bytes32 _cdpId, uint256 cdpIdsArrayLength) internal {

/// @audit ââ Out of order with `syncGlobalAccounting()`
489:     function _computeTCRWithGivenSystemValues(
490:         uint256 _systemCollShares,
491:         uint256 _systemDebt,
492:         uint256 _price
493:     ) internal view returns (uint256) {

/// @audit ââ Out of order with `_computeTCRWithGivenSystemValues()`
504:     function syncGlobalAccounting() external {

/// @audit ââ Out of order with `syncGlobalAccountingAndGracePeriod()`
509:     function _syncGlobalAccounting() internal {

/// @audit ââ Out of order with `_syncGlobalAccounting()`
527:     function syncGlobalAccountingAndGracePeriod() public {

/// @audit ââ Out of order with `_syncStEthIndex()`
534:     function _readStEthIndex() internal view returns (uint256, uint256) {

/// @audit ââ Out of order with `_readStEthIndex()`
539:     function _syncStEthIndex(uint256 _oldIndex, uint256 _newIndex) internal {

/// @audit ââ Out of order with `_syncStEthIndex()`
552:     function calcFeeUponStakingReward(
553:         uint256 _newIndex,
554:         uint256 _prevIndex
555:     ) public view returns (uint256, uint256, uint256) {

/// @audit ââ Out of order with `_applyAccumulatedFeeSplit()`
574:     function _takeSplitAndUpdateFeePerUnit(
575:         uint256 _feeTaken,
576:         uint256 _newPerUnit,
577:         uint256 _newErrorPerUnit
578:     ) internal {

/// @audit ââ Out of order with `_takeSplitAndUpdateFeePerUnit()`
592:     function _applyAccumulatedFeeSplit(
593:         bytes32 _cdpId,
594:         uint256 _newColl,
595:         uint256 _feeSplitDistributed,
596:         uint256 _oldPerUnitCdp,
597:         uint256 _systemStEthFeePerUnitIndex
598:     ) internal {

/// @audit ââ Out of order with `_applyAccumulatedFeeSplit()`
616:     function getAccumulatedFeeSplitApplied(
617:         bytes32 _cdpId,
618:         uint256 _systemStEthFeePerUnitIndex
619:     ) public view returns (uint256, uint256) {

/// @audit ââ Out of order with `getCachedNominalICR()`
659:     function _requireCallerIsBorrowerOperations() internal view {

/// @audit ââ Out of order with `_requireCallerIsBorrowerOperations()`
673:     function getCachedNominalICR(bytes32 _cdpId) external view returns (uint256) {

/// @audit ââ Out of order with `getPendingRedistributedDebt()`
707:     function _calculateCR(
708:         uint256 currentCollShare,
709:         uint256 currentDebt,
710:         uint256 _price
711:     ) internal view returns (uint256) {

/// @audit ââ Out of order with `_calculateCR()`
719:     function getPendingRedistributedDebt(
720:         bytes32 _cdpId
721:     ) public view returns (uint256 pendingEBTCDebtReward) {

/// @audit ââ Out of order with `getSyncedDebtAndCollShares()`
733:     function _getSyncedDebtAndCollShares(
734:         bytes32 _cdpId
735:     ) internal view returns (CdpDebtAndCollShares memory) {

/// @audit ââ Out of order with `_getSyncedDebtAndCollShares()`
745:     function getSyncedDebtAndCollShares(
746:         bytes32 _cdpId
747:     ) public view returns (uint256 debt, uint256 coll) {

/// @audit ââ Out of order with `getSyncedCdpDebt()`
822:     function _getSyncedCdpDebtAndRedistribution(
823:         bytes32 _cdpId
824:     ) internal view returns (uint256, uint256, uint256) {

/// @audit ââ Out of order with `_getSyncedCdpDebtAndRedistribution()`
839:     function getSyncedCdpDebt(bytes32 _cdpId) public view returns (uint256) {
```

- *CollSurplusPool.sol* ( [67](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CollSurplusPool.sol#L67), [77](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CollSurplusPool.sol#L77), [89](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CollSurplusPool.sol#L89), [123](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CollSurplusPool.sol#L123), [130](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CollSurplusPool.sol#L130) ):

```solidity
/// @audit ââ Out of order with `increaseSurplusCollShares()`
67:     function getSurplusCollShares(address _account) external view override returns (uint256) {

/// @audit ââ Out of order with `getSurplusCollShares()`
77:     function increaseSurplusCollShares(address _account, uint256 _amount) external override {

/// @audit ââ Out of order with `increaseSurplusCollShares()`
89:     function claimSurplusCollShares(address _account) external override {

/// @audit ââ Out of order with `increaseTotalSurplusCollShares()`
123:     function _requireCallerIsActivePool() internal view {

/// @audit ââ Out of order with `_requireCallerIsActivePool()`
130:     function increaseTotalSurplusCollShares(uint256 _value) external override {
```

- *Auth.sol* ( [32](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/Auth.sol#L32), [42](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/Auth.sol#L42) ):

```solidity
/// @audit ââ Out of order with `setAuthority()`
32:     function isAuthorized(address user, bytes4 functionSig) internal view virtual returns (bool) {

/// @audit ââ Out of order with `isAuthorized()`
42:     function setAuthority(Authority newAuthority) public virtual {
```

- *AuthNoOwner.sol* ( [30](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/AuthNoOwner.sol#L30), [38](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/AuthNoOwner.sol#L38) ):

```solidity
/// @audit ââ Out of order with `setAuthority()`
30:     function isAuthorized(address user, bytes4 functionSig) internal view virtual returns (bool) {

/// @audit ââ Out of order with `isAuthorized()`
38:     function setAuthority(address newAuthority) public virtual {
```

- *EbtcBase.sol* ( [60](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/EbtcBase.sol#L60), [67](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/EbtcBase.sol#L67) ):

```solidity
/// @audit ââ Out of order with `getSystemCollShares()`
60:     function _calcNetStEthBalance(uint256 _stEthBalance) internal pure returns (uint256) {

/// @audit ââ Out of order with `_calcNetStEthBalance()`
67:     function getSystemCollShares() public view returns (uint256 entireSystemColl) {
```

- *RolesAuthority.sol* ( [63-67](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/RolesAuthority.sol#L63-L67), [85-89](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/RolesAuthority.sol#L85-L89), [106-111](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/RolesAuthority.sol#L106-L111), [133](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/RolesAuthority.sol#L133), [147](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/RolesAuthority.sol#L147) ):

```solidity
/// @audit ââ Out of order with `setPublicCapability()`
63:     function canCall(
64:         address user,
65:         address target,
66:         bytes4 functionSig
67:     ) public view virtual override returns (bool) {

/// @audit ââ Out of order with `canCall()`
85:     function setPublicCapability(
86:         address target,
87:         bytes4 functionSig,
88:         bool enabled
89:     ) public virtual requiresAuth {

/// @audit ââ Out of order with `setPublicCapability()`
106:     function setRoleCapability(
107:         uint8 role,
108:         address target,
109:         bytes4 functionSig,
110:         bool enabled
111:     ) public virtual requiresAuth {

/// @audit ââ Out of order with `setRoleCapability()`
133:     function burnCapability(address target, bytes4 functionSig) public virtual requiresAuth {

/// @audit ââ Out of order with `burnCapability()`
147:     function setUserRole(address user, uint8 role, bool enabled) public virtual requiresAuth {
```

- *EBTCToken.sol* ( [115](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/EBTCToken.sol#L115), [119](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/EBTCToken.sol#L119), [125](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/EBTCToken.sol#L125), [129](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/EBTCToken.sol#L129), [134-138](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/EBTCToken.sol#L134-L138), [152-155](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/EBTCToken.sol#L152-L155), [160-163](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/EBTCToken.sol#L160-L163), [182](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/EBTCToken.sol#L182), [199-207](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/EBTCToken.sol#L199-L207), [235-239](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/EBTCToken.sol#L235-L239), [246](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/EBTCToken.sol#L246), [262](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/EBTCToken.sol#L262), [270](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/EBTCToken.sol#L270), [285](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/EBTCToken.sol#L285), [323](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/EBTCToken.sol#L323), [331](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/EBTCToken.sol#L331) ):

```solidity
/// @audit ââ Out of order with `transfer()`
115:     function balanceOf(address account) external view override returns (uint256) {

/// @audit ââ Out of order with `balanceOf()`
119:     function transfer(address recipient, uint256 amount) external override returns (bool) {

/// @audit ââ Out of order with `approve()`
125:     function allowance(address owner, address spender) external view override returns (uint256) {

/// @audit ââ Out of order with `allowance()`
129:     function approve(address spender, uint256 amount) external override returns (bool) {

/// @audit ââ Out of order with `approve()`
134:     function transferFrom(
135:         address sender,
136:         address recipient,
137:         uint256 amount
138:     ) external override returns (bool) {

/// @audit ââ Out of order with `transferFrom()`
152:     function increaseAllowance(
153:         address spender,
154:         uint256 addedValue
155:     ) external override returns (bool) {

/// @audit ââ Out of order with `increaseAllowance()`
160:     function decreaseAllowance(
161:         address spender,
162:         uint256 subtractedValue
163:     ) external override returns (bool) {

/// @audit ââ Out of order with `permit()`
182:     function domainSeparator() public view override returns (bytes32) {

/// @audit ââ Out of order with `domainSeparator()`
199:     function permit(
200:         address owner,
201:         address spender,
202:         uint256 amount,
203:         uint256 deadline,
204:         uint8 v,
205:         bytes32 r,
206:         bytes32 s
207:     ) external override {

/// @audit ââ Out of order with `_transfer()`
235:     function _buildDomainSeparator(
236:         bytes32 typeHash,
237:         bytes32 name,
238:         bytes32 version
239:     ) private view returns (bytes32) {

/// @audit ââ Out of order with `_buildDomainSeparator()`
246:     function _transfer(address sender, address recipient, uint256 amount) internal {

/// @audit ââ Out of order with `_transfer()`
262:     function _mint(address account, uint256 amount) internal {

/// @audit ââ Out of order with `_mint()`
270:     function _burn(address account, uint256 amount) internal {

/// @audit ââ Out of order with `_burn()`
285:     function _approve(address owner, address spender, uint256 amount) internal {

/// @audit ââ Out of order with `name()`
323:     function _requireCallerIsCdpM() internal view {

/// @audit ââ Out of order with `_requireCallerIsCdpM()`
331:     function name() external pure override returns (string memory) {
```

- *Governor.sol* ( [131-133](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Governor.sol#L131-L133), [146](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Governor.sol#L146), [154](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Governor.sol#L154) ):

```solidity
/// @audit ââ Out of order with `getRoleName()`
131:     function getEnabledFunctionsInTarget(
132:         address _target
133:     ) public view returns (bytes4[] memory _funcs) {

/// @audit ââ Out of order with `getEnabledFunctionsInTarget()`
146:     function getRoleName(uint8 role) external view returns (string memory roleName) {

/// @audit ââ Out of order with `getRoleName()`
154:     function setRoleName(uint8 role, string memory roleName) external requiresAuth {
```

- *HintHelpers.sol* ( [133-137](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/HintHelpers.sol#L133-L137), [164-168](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/HintHelpers.sol#L164-L168) ):

```solidity
/// @audit ââ Out of order with `getApproxHint()`
133:     function _calculateCdpStateAfterPartialRedemption(
134:         LocalVariables_getRedemptionHints memory vars,
135:         uint256 currentCdpDebt,
136:         uint256 _price
137:     ) internal view returns (uint256, uint256) {

/// @audit ââ Out of order with `_calculateCdpStateAfterPartialRedemption()`
164:     function getApproxHint(
165:         uint256 _CR,
166:         uint256 _numTrials,
167:         uint256 _inputRandomSeed
168:     ) external view returns (bytes32 hint, uint256 diff, uint256 latestRandomSeed) {
```

- *IActivePool.sol* ( [39](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IActivePool.sol#L39), [41](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IActivePool.sol#L41) ):

```solidity
/// @audit ââ Out of order with `setFeeRecipientAddress()`
39:     function getFeeRecipientClaimableCollShares() external view returns (uint256);

/// @audit ââ Out of order with `getFeeRecipientClaimableCollShares()`
41:     function setFeeRecipientAddress(address _feeRecipientAddress) external;
```

- *ICdpManager.sol* ( [13](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManager.sol#L13), [15](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManager.sol#L15), [17-22](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManager.sol#L17-L22), [24](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManager.sol#L24), [26-34](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManager.sol#L26-L34), [36](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManager.sol#L36), [38](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManager.sol#L38), [40](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManager.sol#L40), [56](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManager.sol#L56), [58-64](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManager.sol#L58-L64), [66-73](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManager.sol#L66-L73) ):

```solidity
/// @audit ââ Out of order with `liquidate()`
13:     function getIdFromCdpIdsArray(uint256 _index) external view returns (bytes32);

/// @audit ââ Out of order with `getIdFromCdpIdsArray()`
15:     function liquidate(bytes32 _cdpId) external;

/// @audit ââ Out of order with `liquidate()`
17:     function partiallyLiquidate(
18:         bytes32 _cdpId,
19:         uint256 _partialAmount,
20:         bytes32 _upperPartialHint,
21:         bytes32 _lowerPartialHint
22:     ) external;

/// @audit ââ Out of order with `partiallyLiquidate()`
24:     function batchLiquidateCdps(bytes32[] calldata _cdpArray) external;

/// @audit ââ Out of order with `batchLiquidateCdps()`
26:     function redeemCollateral(
27:         uint256 _EBTCAmount,
28:         bytes32 _firstRedemptionHint,
29:         bytes32 _upperPartialRedemptionHint,
30:         bytes32 _lowerPartialRedemptionHint,
31:         uint256 _partialRedemptionHintNICR,
32:         uint256 _maxIterations,
33:         uint256 _maxFee
34:     ) external;

/// @audit ââ Out of order with `redeemCollateral()`
36:     function updateStakeAndTotalStakes(bytes32 _cdpId) external returns (uint256);

/// @audit ââ Out of order with `updateStakeAndTotalStakes()`
38:     function syncAccounting(bytes32 _cdpId) external;

/// @audit ââ Out of order with `syncAccounting()`
40:     function closeCdp(bytes32 _cdpId, address _borrower, uint256 _debt, uint256 _coll) external;

/// @audit ââ Out of order with `initializeCdp()`
56:     function getCdpLiquidatorRewardShares(bytes32 _cdpId) external view returns (uint);

/// @audit ââ Out of order with `getCdpLiquidatorRewardShares()`
58:     function initializeCdp(
59:         bytes32 _cdpId,
60:         uint256 _debt,
61:         uint256 _coll,
62:         uint256 _liquidatorRewardShares,
63:         address _borrower
64:     ) external;

/// @audit ââ Out of order with `initializeCdp()`
66:     function updateCdp(
67:         bytes32 _cdpId,
68:         address _borrower,
69:         uint256 _coll,
70:         uint256 _debt,
71:         uint256 _newColl,
72:         uint256 _newDebt
73:     ) external;
```

- *ICdpManagerData.sol* ( [227-230](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManagerData.sol#L227-L230), [232](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManagerData.sol#L232), [234](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManagerData.sol#L234) ):

```solidity
/// @audit ââ Out of order with `syncGlobalAccounting()`
227:     function calcFeeUponStakingReward(
228:         uint256 _newIndex,
229:         uint256 _prevIndex
230:     ) external view returns (uint256, uint256, uint256);

/// @audit ââ Out of order with `calcFeeUponStakingReward()`
232:     function syncGlobalAccounting() external; // Accrues StEthFeeSplit without influencing Grace Period

/// @audit ââ Out of order with `syncGlobalAccounting()`
234:     function syncGlobalAccountingAndGracePeriod() external; // Accrues StEthFeeSplit and influences Grace Period
```

- *ICollSurplusPool.sol* ( [17](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICollSurplusPool.sol#L17), [19](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICollSurplusPool.sol#L19), [21](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICollSurplusPool.sol#L21), [23](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICollSurplusPool.sol#L23) ):

```solidity
/// @audit ââ Out of order with `increaseSurplusCollShares()`
17:     function getSurplusCollShares(address _account) external view returns (uint256);

/// @audit ââ Out of order with `getSurplusCollShares()`
19:     function increaseSurplusCollShares(address _account, uint256 _amount) external;

/// @audit ââ Out of order with `increaseSurplusCollShares()`
21:     function claimSurplusCollShares(address _account) external;

/// @audit ââ Out of order with `claimSurplusCollShares()`
23:     function increaseTotalSurplusCollShares(uint256 _value) external;
```

- *IERC3156FlashLender.sol* ( [21](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IERC3156FlashLender.sol#L21), [28-33](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IERC3156FlashLender.sol#L28-L33) ):

```solidity
/// @audit ââ Out of order with `flashLoan()`
21:     function flashFee(address token, uint256 amount) external view returns (uint256);

/// @audit ââ Out of order with `flashFee()`
28:     function flashLoan(
29:         IERC3156FlashBorrower receiver,
30:         address token,
31:         uint256 amount,
32:         bytes calldata data
33:     ) external returns (bool);
```

- *IFallbackCaller.sol* ( [17](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IFallbackCaller.sol#L17), [21](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IFallbackCaller.sol#L21) ):

```solidity
/// @audit ââ Out of order with `setFallbackTimeout()`
17:     function fallbackTimeout() external view returns (uint256);

/// @audit ââ Out of order with `fallbackTimeout()`
21:     function setFallbackTimeout(uint256 newFallbackTimeout) external;
```

- *IPool.sol* ( [17](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IPool.sol#L17), [19](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IPool.sol#L19), [21](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IPool.sol#L21) ):

```solidity
/// @audit ââ Out of order with `increaseSystemDebt()`
17:     function getSystemDebt() external view returns (uint256);

/// @audit ââ Out of order with `getSystemDebt()`
19:     function increaseSystemDebt(uint256 _amount) external;

/// @audit ââ Out of order with `increaseSystemDebt()`
21:     function decreaseSystemDebt(uint256 _amount) external;
```

- *ISortedCdps.sol* ( [44-48](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ISortedCdps.sol#L44-L48), [50-55](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ISortedCdps.sol#L50-L55) ):

```solidity
/// @audit ââ Out of order with `insert()`
44:     function findInsertPosition(
45:         uint256 _ICR,
46:         bytes32 _prevId,
47:         bytes32 _nextId
48:     ) external view returns (bytes32, bytes32);

/// @audit ââ Out of order with `findInsertPosition()`
50:     function insert(
51:         address owner,
52:         uint256 _ICR,
53:         bytes32 _prevId,
54:         bytes32 _nextId
55:     ) external returns (bytes32);
```

- *LeverageMacroBase.sol* ( [43](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LeverageMacroBase.sol#L43), [51-59](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LeverageMacroBase.sol#L51-L59), [291](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LeverageMacroBase.sol#L291), [338](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LeverageMacroBase.sol#L338), [344-350](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LeverageMacroBase.sol#L344-L350) ):

```solidity
/// @audit ââ Out of order with `constructor()`
43:     function _assertOwner() internal {

/// @audit ââ Out of order with `_assertOwner()`
51:     constructor(
52:         address _borrowerOperationsAddress,
53:         address _activePool,
54:         address _cdpManager,
55:         address _ebtc,
56:         address _coll,
57:         address _sortedCdps,
58:         bool _sweepToCaller
59:     ) {

/// @audit ââ Out of order with `decodeFLData()`
291:     function _handleOperation(LeverageMacroOperation memory operation) internal {

/// @audit ââ Out of order with `_handleOperation()`
338:     function decodeFLData(bytes calldata data) public view returns (LeverageMacroOperation memory) {

/// @audit ââ Out of order with `decodeFLData()`
344:     function onFlashLoan(
345:         address initiator,
346:         address token,
347:         uint256 amount,
348:         uint256 fee,
349:         bytes calldata data
350:     ) external returns (bytes32) {
```

- *LeverageMacroReference.sol* ( [44](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LeverageMacroReference.sol#L44), [50](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LeverageMacroReference.sol#L50) ):

```solidity
/// @audit ââ Out of order with `resetApprovals()`
44:     function owner() public override returns (address) {

/// @audit ââ Out of order with `owner()`
50:     function resetApprovals() external {
```

- *LiquidationLibrary.sol* ( [397-399](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LiquidationLibrary.sol#L397-L399), [450-454](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LiquidationLibrary.sol#L450-L454), [570-575](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LiquidationLibrary.sol#L570-L575), [608-613](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LiquidationLibrary.sol#L608-L613), [642-648](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LiquidationLibrary.sol#L642-L648), [679](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LiquidationLibrary.sol#L679), [733-738](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LiquidationLibrary.sol#L733-L738), [807-811](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LiquidationLibrary.sol#L807-L811), [839-842](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LiquidationLibrary.sol#L839-L842), [862](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LiquidationLibrary.sol#L862) ):

```solidity
/// @audit ââ Out of order with `_partiallyReduceCdpDebt()`
397:     function _liquidateCDPPartially(
398:         LiquidationLocals memory _partialState
399:     ) private returns (uint256, uint256) {

/// @audit ââ Out of order with `_liquidateCDPPartially()`
450:     function _partiallyReduceCdpDebt(
451:         bytes32 _cdpId,
452:         uint256 _partialDebt,
453:         uint256 _partialColl
454:     ) internal {

/// @audit ââ Out of order with `_getLiquidationValuesNormalMode()`
570:     function _calculateFullLiquidationSurplusAndCap(
571:         uint256 _ICR,
572:         uint256 _price,
573:         uint256 _totalDebtToBurn,
574:         uint256 _totalColToSend
575:     ) private view returns (uint256 toLiquidator, uint256 collSurplus, uint256 debtToRedistribute) {

/// @audit ââ Out of order with `_calculateFullLiquidationSurplusAndCap()`
608:     function _getLiquidationValuesNormalMode(
609:         uint256 _price,
610:         uint256 _TCR,
611:         LocalVariables_LiquidationSequence memory vars,
612:         LiquidationValues memory singleLiquidation
613:     ) internal {

/// @audit ââ Out of order with `_getLiquidationValuesNormalMode()`
642:     function _getLiquidationValuesRecoveryMode(
643:         uint256 _price,
644:         uint256 _systemDebt,
645:         uint256 _systemCollShares,
646:         LocalVariables_LiquidationSequence memory vars,
647:         LiquidationValues memory singleLiquidation
648:     ) internal {

/// @audit ââ Out of order with `_getLiquidationValuesRecoveryMode()`
679:     function batchLiquidateCdps(bytes32[] memory _cdpArray) external nonReentrantSelfAndBOps {

/// @audit ââ Out of order with `_getTotalsFromBatchLiquidate_NormalMode()`
733:     function _getTotalFromBatchLiquidate_RecoveryMode(
734:         uint256 _price,
735:         uint256 _systemCollShares,
736:         uint256 _systemDebt,
737:         bytes32[] memory _cdpArray
738:     ) internal returns (LiquidationTotals memory totals) {

/// @audit ââ Out of order with `_getTotalFromBatchLiquidate_RecoveryMode()`
807:     function _getTotalsFromBatchLiquidate_NormalMode(
808:         uint256 _price,
809:         uint256 _TCR,
810:         bytes32[] memory _cdpArray
811:     ) internal returns (LiquidationTotals memory totals) {

/// @audit ââ Out of order with `_redistributeDebt()`
839:     function _addLiquidationValuesToTotals(
840:         LiquidationTotals memory oldTotals,
841:         LiquidationValues memory singleLiquidation
842:     ) internal pure returns (LiquidationTotals memory newTotals) {

/// @audit ââ Out of order with `_addLiquidationValuesToTotals()`
862:     function _redistributeDebt(uint256 _debt) internal {
```

- *PriceFeed.sol* ( [526-529](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/PriceFeed.sol#L526-L529), [546](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/PriceFeed.sol#L546), [553](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/PriceFeed.sol#L553), [561-563](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/PriceFeed.sol#L561-L563), [571](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/PriceFeed.sol#L571) ):

```solidity
/// @audit ââ Out of order with `_changeStatus()`
526:     function _bothOraclesSimilarPrice(
527:         ChainlinkResponse memory _chainlinkResponse,
528:         FallbackResponse memory _fallbackResponse
529:     ) internal pure returns (bool) {

/// @audit ââ Out of order with `_bothOraclesSimilarPrice()`
546:     function _changeStatus(Status _status) internal {

/// @audit ââ Out of order with `_changeStatus()`
553:     function _storePrice(uint256 _currentPrice) internal {

/// @audit ââ Out of order with `_storePrice()`
561:     function _storeFallbackPrice(
562:         FallbackResponse memory _fallbackResponse
563:     ) internal returns (uint256) {

/// @audit ââ Out of order with `_storeFallbackPrice()`
571:     function _storeChainlinkPrice(uint256 _answer) internal returns (uint256) {
```

- *SimplifiedDiamondLike.sol* ( [83](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SimplifiedDiamondLike.sol#L83), [110](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SimplifiedDiamondLike.sol#L110), [134](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SimplifiedDiamondLike.sol#L134), [160](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SimplifiedDiamondLike.sol#L160) ):

```solidity
/// @audit ââ Out of order with `execute()`
83:     function _getStorage() internal pure returns (DiamondLikeStorage storage ds) {

/// @audit ââ Out of order with `_getStorage()`
110:     function execute(Operation[] calldata ops) external payable {

/// @audit ââ Out of order with `receive()`
134:     function _executeOne(Operation calldata op) internal {

/// @audit ââ Out of order with `_executeOne()`
160:     receive() external payable {
```

- *SortedCdps.sol* ( [130](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L130), [140-143](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L140-L143), [173-178](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L173-L178), [216](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L216), [237-241](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L237-L241), [270](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L270), [299-304](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L299-L304), [344-349](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L344-L349), [363](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L363), [410](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L410), [419](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L419), [456](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L456), [498-503](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L498-L503), [536](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L536), [542](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L542), [642](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L642), [666-670](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L666-L670) ):

```solidity
/// @audit ââ Out of order with `cdpOfOwnerByIndex()`
130:     function nonExistId() public pure override returns (bytes32) {

/// @audit ââ Out of order with `nonExistId()`
140:     function cdpOfOwnerByIndex(
141:         address owner,
142:         uint256 index
143:     ) external view override returns (bytes32) {

/// @audit ââ Out of order with `cdpCountOf()`
173:     function _cdpOfOwnerByIndex(
174:         address owner,
175:         uint256 index,
176:         bytes32 startNodeId,
177:         uint maxNodes
178:     ) internal view returns (bytes32, bool) {

/// @audit ââ Out of order with `_cdpOfOwnerByIndex()`
216:     function cdpCountOf(address owner) external view override returns (uint256) {

/// @audit ââ Out of order with `getCdpsOf()`
237:     function _cdpCountOf(
238:         address owner,
239:         bytes32 startNodeId,
240:         uint maxNodes
241:     ) internal view returns (uint256, bytes32) {

/// @audit ââ Out of order with `_cdpCountOf()`
270:     function getCdpsOf(address owner) external view override returns (bytes32[] memory cdps) {

/// @audit ââ Out of order with `insert()`
299:     function _getCdpsOf(
300:         address owner,
301:         bytes32 startNodeId,
302:         uint maxNodes,
303:         uint maxArraySize
304:     ) internal view returns (bytes32[] memory, uint256, bytes32) {

/// @audit ââ Out of order with `_getCdpsOf()`
344:     function insert(
345:         address owner,
346:         uint256 _NICR,
347:         bytes32 _prevId,
348:         bytes32 _nextId
349:     ) external override returns (bytes32) {

/// @audit ââ Out of order with `remove()`
363:     function _insert(bytes32 _id, uint256 _NICR, bytes32 _prevId, bytes32 _nextId) internal {

/// @audit ââ Out of order with `_insert()`
410:     function remove(bytes32 _id) external override {

/// @audit ââ Out of order with `remove()`
419:     function batchRemove(bytes32[] memory _ids) external override {

/// @audit ââ Out of order with `reInsert()`
456:     function _remove(bytes32 _id) internal {

/// @audit ââ Out of order with `_remove()`
498:     function reInsert(
499:         bytes32 _id,
500:         uint256 _newNICR,
501:         bytes32 _prevId,
502:         bytes32 _nextId
503:     ) external override {

/// @audit ââ Out of order with `getSize()`
536:     function isEmpty() public view override returns (bool) {

/// @audit ââ Out of order with `isEmpty()`
542:     function getSize() external view override returns (uint256) {

/// @audit ââ Out of order with `findInsertPosition()`
642:     function _ascendList(uint256 _NICR, bytes32 _startId) internal view returns (bytes32, bytes32) {

/// @audit ââ Out of order with `_ascendList()`
666:     function findInsertPosition(
667:         uint256 _NICR,
668:         bytes32 _prevId,
669:         bytes32 _nextId
670:     ) external view override returns (bytes32, bytes32) {
```

</details>

### [N&#x2011;12] Use of `override` is unnecessary

[Starting from Solidity 0.8.8](https://docs.soliditylang.org/en/v0.8.20/contracts.html#function-overriding), the override keyword is not required when overriding an interface function, except for the case where the function is defined in multiple bases.

<details>
<summary>There are 100 instances (click to show):</summary>

- *ActivePool.sol* ( [74](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/ActivePool.sol#L74), [82](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/ActivePool.sol#L82), [89](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/ActivePool.sol#L89), [100](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/ActivePool.sol#L100), [129-133](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/ActivePool.sol#L129-L133), [157](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/ActivePool.sol#L157), [194](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/ActivePool.sol#L194), [207](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/ActivePool.sol#L207), [242](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/ActivePool.sol#L242), [261-266](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/ActivePool.sol#L261-L266), [317](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/ActivePool.sol#L317), [328](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/ActivePool.sol#L328), [346](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/ActivePool.sol#L346) ):

```solidity
74:     function getSystemCollShares() external view override returns (uint256) {

82:     function getSystemDebt() external view override returns (uint256) {

89:     function getFeeRecipientClaimableCollShares() external view override returns (uint256) {

100:     function transferSystemCollShares(address _account, uint256 _shares) public override {

129:     function transferSystemCollSharesAndLiquidatorReward(
130:         address _account,
131:         uint256 _shares,
132:         uint256 _liquidatorRewardShares
133:     ) external override {

157:     function allocateSystemCollSharesToFeeRecipient(uint256 _shares) external override {

194:     function increaseSystemDebt(uint256 _amount) external override {

207:     function decreaseSystemDebt(uint256 _amount) external override {

242:     function increaseSystemCollShares(uint256 _value) external override {

261:     function flashLoan(
262:         IERC3156FlashBorrower receiver,
263:         address token,
264:         uint256 amount,
265:         bytes calldata data
266:     ) external override returns (bool) {

317:     function flashFee(address token, uint256 amount) public view override returns (uint256) {

328:     function maxFlashLoan(address token) public view override returns (uint256) {

346:     function claimFeeRecipientCollShares(uint256 _shares) external override requiresAuth {
```

- *BorrowerOperations.sol* ( [168-173](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L168-L173), [187-193](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L187-L193), [203-208](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L203-L208), [219-224](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L219-L224), [235-240](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L235-L240), [250-255](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L250-L255), [270-277](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L270-L277), [300-308](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L300-L308), [553](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L553), [599](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L599), [608-611](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L608-L611), [628-631](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L628-L631), [647](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L647), [653](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L653), [665](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L665), [687](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L687), [693](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L693), [706-714](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L706-L714), [1077-1082](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L1077-L1082), [1114](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L1114), [1124](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L1124) ):

```solidity
168:     function openCdp(
169:         uint256 _debt,
170:         bytes32 _upperHint,
171:         bytes32 _lowerHint,
172:         uint256 _stEthBalance
173:     ) external override nonReentrantSelfAndCdpM returns (bytes32) {

187:     function openCdpFor(
188:         uint256 _debt,
189:         bytes32 _upperHint,
190:         bytes32 _lowerHint,
191:         uint256 _stEthBalance,
192:         address _borrower
193:     ) external override nonReentrantSelfAndCdpM returns (bytes32) {

203:     function addColl(
204:         bytes32 _cdpId,
205:         bytes32 _upperHint,
206:         bytes32 _lowerHint,
207:         uint256 _stEthBalanceIncrease
208:     ) external override nonReentrantSelfAndCdpM {

219:     function withdrawColl(
220:         bytes32 _cdpId,
221:         uint256 _stEthBalanceDecrease,
222:         bytes32 _upperHint,
223:         bytes32 _lowerHint
224:     ) external override nonReentrantSelfAndCdpM {

235:     function withdrawDebt(
236:         bytes32 _cdpId,
237:         uint256 _debt,
238:         bytes32 _upperHint,
239:         bytes32 _lowerHint
240:     ) external override nonReentrantSelfAndCdpM {

250:     function repayDebt(
251:         bytes32 _cdpId,
252:         uint256 _debt,
253:         bytes32 _upperHint,
254:         bytes32 _lowerHint
255:     ) external override nonReentrantSelfAndCdpM {

270:     function adjustCdp(
271:         bytes32 _cdpId,
272:         uint256 _stEthBalanceDecrease,
273:         uint256 _debtChange,
274:         bool _isDebtIncrease,
275:         bytes32 _upperHint,
276:         bytes32 _lowerHint
277:     ) external override nonReentrantSelfAndCdpM {

300:     function adjustCdpWithColl(
301:         bytes32 _cdpId,
302:         uint256 _stEthBalanceDecrease,
303:         uint256 _debtChange,
304:         bool _isDebtIncrease,
305:         bytes32 _upperHint,
306:         bytes32 _lowerHint,
307:         uint256 _stEthBalanceIncrease
308:     ) external override nonReentrantSelfAndCdpM {

553:     function closeCdp(bytes32 _cdpId) external override {

599:     function claimSurplusCollShares() external override {

608:     function getPositionManagerApproval(
609:         address _borrower,
610:         address _positionManager
611:     ) external view override returns (PositionManagerApproval) {

628:     function setPositionManagerApproval(
629:         address _positionManager,
630:         PositionManagerApproval _approval
631:     ) external override {

647:     function revokePositionManagerApproval(address _positionManager) external override {

653:     function renouncePositionManagerApproval(address _borrower) external override {

665:     function domainSeparator() public view override returns (bytes32) {

687:     function version() external pure override returns (string memory) {

693:     function permitTypeHash() external pure override returns (bytes32) {

706:     function permitPositionManagerApproval(
707:         address _borrower,
708:         address _positionManager,
709:         PositionManagerApproval _approval,
710:         uint256 _deadline,
711:         uint8 v,
712:         bytes32 r,
713:         bytes32 s
714:     ) external override {

1077:     function flashLoan(
1078:         IERC3156FlashBorrower receiver,
1079:         address token,
1080:         uint256 amount,
1081:         bytes calldata data
1082:     ) external override returns (bool) {

1114:     function flashFee(address token, uint256 amount) public view override returns (uint256) {

1124:     function maxFlashLoan(address token) public view override returns (uint256) {
```

- *CdpManager.sol* ( [66](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L66), [73](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L73), [99](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L99), [109-114](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L109-L114), [126](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L126), [320-328](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L320-L328), [514](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L514), [523](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L523), [538-543](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L538-L543), [580](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L580), [589](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L589), [638](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L638), [643](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L643), [661-663](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L661-L663), [856](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L856), [863](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L863), [871](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L871), [879](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L879), [891](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L891) ):

```solidity
66:     function getActiveCdpsCount() external view override returns (uint256) {

73:     function getIdFromCdpIdsArray(uint256 _index) external view override returns (bytes32) {

99:     function liquidate(bytes32 _cdpId) external override {

109:     function partiallyLiquidate(
110:         bytes32 _cdpId,
111:         uint256 _partialAmount,
112:         bytes32 _upperPartialHint,
113:         bytes32 _lowerPartialHint
114:     ) external override {

126:     function batchLiquidateCdps(bytes32[] memory _cdpArray) external override {

320:     function redeemCollateral(
321:         uint256 _debt,
322:         bytes32 _firstRedemptionHint,
323:         bytes32 _upperPartialRedemptionHint,
324:         bytes32 _lowerPartialRedemptionHint,
325:         uint256 _partialRedemptionHintNICR,
326:         uint256 _maxIterations,
327:         uint256 _maxFeePercentage
328:     ) external override nonReentrantSelfAndBOps {

514:     function syncAccounting(bytes32 _cdpId) external virtual override {

523:     function updateStakeAndTotalStakes(bytes32 _cdpId) external override returns (uint256) {

538:     function closeCdp(
539:         bytes32 _cdpId,
540:         address _borrower,
541:         uint256 _debt,
542:         uint256 _coll
543:     ) external override {

580:     function getCachedTCR(uint256 _price) external view override returns (uint256) {

589:     function checkRecoveryMode(uint256 _price) external view override returns (bool) {

638:     function getRedemptionRate() public view override returns (uint256) {

643:     function getRedemptionRateWithDecay() public view override returns (uint256) {

661:     function getRedemptionFeeWithDecay(
662:         uint256 _stETHToRedeem
663:     ) external view override returns (uint256) {

856:     function getCdpStatus(bytes32 _cdpId) external view override returns (uint256) {

863:     function getCdpStake(bytes32 _cdpId) external view override returns (uint256) {

871:     function getCdpDebt(bytes32 _cdpId) external view override returns (uint256) {

879:     function getCdpCollShares(bytes32 _cdpId) external view override returns (uint256) {

891:     function getCdpLiquidatorRewardShares(bytes32 _cdpId) external view override returns (uint256) {
```

- *CollSurplusPool.sol* ( [61](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CollSurplusPool.sol#L61), [67](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CollSurplusPool.sol#L67), [77](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CollSurplusPool.sol#L77), [89](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CollSurplusPool.sol#L89), [130](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CollSurplusPool.sol#L130) ):

```solidity
61:     function getTotalSurplusCollShares() external view override returns (uint256) {

67:     function getSurplusCollShares(address _account) external view override returns (uint256) {

77:     function increaseSurplusCollShares(address _account, uint256 _amount) external override {

89:     function claimSurplusCollShares(address _account) external override {

130:     function increaseTotalSurplusCollShares(uint256 _value) external override {
```

- *RolesAuthority.sol* ( [63-67](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/RolesAuthority.sol#L63-L67) ):

```solidity
63:     function canCall(
64:         address user,
65:         address target,
66:         bytes4 functionSig
67:     ) public view virtual override returns (bool) {
```

- *EBTCToken.sol* ( [85](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/EBTCToken.sol#L85), [95](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/EBTCToken.sol#L95), [111](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/EBTCToken.sol#L111), [115](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/EBTCToken.sol#L115), [119](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/EBTCToken.sol#L119), [125](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/EBTCToken.sol#L125), [129](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/EBTCToken.sol#L129), [134-138](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/EBTCToken.sol#L134-L138), [152-155](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/EBTCToken.sol#L152-L155), [160-163](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/EBTCToken.sol#L160-L163), [182](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/EBTCToken.sol#L182), [199-207](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/EBTCToken.sol#L199-L207), [331](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/EBTCToken.sol#L331), [337](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/EBTCToken.sol#L337), [343](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/EBTCToken.sol#L343), [349](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/EBTCToken.sol#L349), [355](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/EBTCToken.sol#L355) ):

```solidity
85:     function mint(address _account, uint256 _amount) external override {

95:     function burn(address _account, uint256 _amount) external override {

111:     function totalSupply() external view override returns (uint256) {

115:     function balanceOf(address account) external view override returns (uint256) {

119:     function transfer(address recipient, uint256 amount) external override returns (bool) {

125:     function allowance(address owner, address spender) external view override returns (uint256) {

129:     function approve(address spender, uint256 amount) external override returns (bool) {

134:     function transferFrom(
135:         address sender,
136:         address recipient,
137:         uint256 amount
138:     ) external override returns (bool) {

152:     function increaseAllowance(
153:         address spender,
154:         uint256 addedValue
155:     ) external override returns (bool) {

160:     function decreaseAllowance(
161:         address spender,
162:         uint256 subtractedValue
163:     ) external override returns (bool) {

182:     function domainSeparator() public view override returns (bytes32) {

199:     function permit(
200:         address owner,
201:         address spender,
202:         uint256 amount,
203:         uint256 deadline,
204:         uint8 v,
205:         bytes32 r,
206:         bytes32 s
207:     ) external override {

331:     function name() external pure override returns (string memory) {

337:     function symbol() external pure override returns (string memory) {

343:     function decimals() external pure override returns (uint8) {

349:     function version() external pure override returns (string memory) {

355:     function permitTypeHash() external pure override returns (bytes32) {
```

- *PriceFeed.sol* ( [98](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/PriceFeed.sol#L98) ):

```solidity
98:     function fetchPrice() external override returns (uint256) {
```

- *SortedCdps.sol* ( [123](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L123), [130](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L130), [140-143](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L140-L143), [155-160](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L155-L160), [216](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L216), [227-231](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L227-L231), [270](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L270), [286-290](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L286-L290), [344-349](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L344-L349), [410](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L410), [419](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L419), [498-503](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L498-L503), [519](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L519), [530](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L530), [536](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L536), [542](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L542), [548](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L548), [554](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L554), [560](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L560), [567](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L567), [574](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L574), [583-587](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L583-L587), [666-670](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L666-L670) ):

```solidity
123:     function getOwnerAddress(bytes32 cdpId) public pure override returns (address) {

130:     function nonExistId() public pure override returns (bytes32) {

140:     function cdpOfOwnerByIndex(
141:         address owner,
142:         uint256 index
143:     ) external view override returns (bytes32) {

155:     function cdpOfOwnerByIdx(
156:         address owner,
157:         uint256 index,
158:         bytes32 startNodeId,
159:         uint maxNodes
160:     ) external view override returns (bytes32, bool) {

216:     function cdpCountOf(address owner) external view override returns (uint256) {

227:     function getCdpCountOf(
228:         address owner,
229:         bytes32 startNodeId,
230:         uint maxNodes
231:     ) external view override returns (uint256, bytes32) {

270:     function getCdpsOf(address owner) external view override returns (bytes32[] memory cdps) {

286:     function getAllCdpsOf(
287:         address owner,
288:         bytes32 startNodeId,
289:         uint maxNodes
290:     ) external view override returns (bytes32[] memory, uint256, bytes32) {

344:     function insert(
345:         address owner,
346:         uint256 _NICR,
347:         bytes32 _prevId,
348:         bytes32 _nextId
349:     ) external override returns (bytes32) {

410:     function remove(bytes32 _id) external override {

419:     function batchRemove(bytes32[] memory _ids) external override {

498:     function reInsert(
499:         bytes32 _id,
500:         uint256 _newNICR,
501:         bytes32 _prevId,
502:         bytes32 _nextId
503:     ) external override {

519:     function contains(bytes32 _id) public view override returns (bool) {

530:     function isFull() public view override returns (bool) {

536:     function isEmpty() public view override returns (bool) {

542:     function getSize() external view override returns (uint256) {

548:     function getMaxSize() external view override returns (uint256) {

554:     function getFirst() external view override returns (bytes32) {

560:     function getLast() external view override returns (bytes32) {

567:     function getNext(bytes32 _id) external view override returns (bytes32) {

574:     function getPrev(bytes32 _id) external view override returns (bytes32) {

583:     function validInsertPosition(
584:         uint256 _NICR,
585:         bytes32 _prevId,
586:         bytes32 _nextId
587:     ) external view override returns (bool) {

666:     function findInsertPosition(
667:         uint256 _NICR,
668:         bytes32 _prevId,
669:         bytes32 _nextId
670:     ) external view override returns (bytes32, bytes32) {
```

</details>

### [N&#x2011;13] Unused events

The following `event`s are defined but not used. It is recommended to check the code for logical omissions that cause them not to be used. If it's determined that they are not needed anywhere, it's best to remove them from the codebase to improve code clarity and minimize confusion.
Note that there may be cases where an event appears to be used because it has multiple definitions in different files. In such cases, the definitions should be moved to a separate file.

There are 5 instances:

- *ICdpManagerData.sol* ( [16](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManagerData.sol#L16) ):

```solidity
16:     event FeeRecipientAddressChanged(address indexed _feeRecipientAddress);
```

- *IERC3156FlashLender.sol* ( [9](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IERC3156FlashLender.sol#L9) ):

```solidity
9:     event MaxFlashFeeSet(address indexed _setter, uint256 _oldMaxFee, uint256 _newMaxFee);
```

- *IFallbackCaller.sol* ( [7](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IFallbackCaller.sol#L7) ):

```solidity
7:     event FallbackTimeOutChanged(uint256 _oldTimeOut, uint256 _newTimeOut);
```

- *IPool.sol* ( [9](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IPool.sol#L9), [10](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IPool.sol#L10) ):

```solidity
9:     event ETHBalanceUpdated(uint256 _newBalance);

10:     event EBTCBalanceUpdated(uint256 _newBalance);
```

### [N&#x2011;14] Unused `struct`s

Note that there may be cases where a struct superficially appears to be used, but this is only because there are multiple definitions of the struct in different files. In such cases, the struct definition should be moved into a separate file. The instances below are the unused definitions.

There are 2 instances:

- *Governor.sol* ( [19](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Governor.sol#L19), [24](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Governor.sol#L24) ):

```solidity
19:     struct Role {

24:     struct Capability {
```

### [N&#x2011;15] Use `uint256`/`int256` instead of `uint`/`int`

It is recommended to use `uint256`/`int256` instead of `uint`/`int` in function parameters, since they are used for function signatures.

<details>
<summary>There are 40 instances (click to show):</summary>

- *BorrowerOperations.sol* ( [830](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L830), [834](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L834) ):

```solidity
/// @audit uint status
830:         uint status = cdpManager.getCdpStatus(_cdpId);

/// @audit uint _debtChange
834:     function _requireNonZeroDebtChange(uint _debtChange) internal pure {
```

- *CdpManagerStorage.sol* ( [357](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L357), [365](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L365) ):

```solidity
/// @audit uint _pendingDebt
357:             uint _pendingDebt,

/// @audit uint prevCollShares
365:             uint prevCollShares = _cdp.coll;
```

- *EbtcBase.sol* ( [124](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/EbtcBase.sol#L124), [140](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/EbtcBase.sol#L140) ):

```solidity
/// @audit uint _tcr
124:     function _checkICRAgainstLiqThreshold(uint256 _icr, uint _tcr) internal view returns (bool) {

/// @audit uint _tcr
140:     function _checkICRAgainstTCR(uint256 _icr, uint _tcr) internal view returns (bool) {
```

- *IBorrowerOperations.sol* ( [28](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IBorrowerOperations.sol#L28), [31](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IBorrowerOperations.sol#L31) ):

```solidity
/// @audit uint _EBTCAmount
28:         uint _EBTCAmount,

/// @audit uint _collAmount
31:         uint _collAmount,
```

- *ICdpManager.sol* ( [56](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManager.sol#L56) ):

```solidity
/// @audit uint
56:     function getCdpLiquidatorRewardShares(bytes32 _cdpId) external view returns (uint);
```

- *ICdpManagerData.sol* ( [45](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManagerData.sol#L45), [46](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManagerData.sol#L46), [49](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManagerData.sol#L49), [58](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManagerData.sol#L58) ):

```solidity
/// @audit uint _debt
45:         uint _debt,

/// @audit uint _collShares
46:         uint _collShares,

/// @audit uint _premiumToLiquidator
49:         uint _premiumToLiquidator

/// @audit uint _premiumToLiquidator
58:         uint _premiumToLiquidator
```

- *IPositionManagers.sol* ( [36](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IPositionManagers.sol#L36) ):

```solidity
/// @audit uint _deadline
36:         uint _deadline,
```

- *ISortedCdps.sol* ( [9](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ISortedCdps.sol#L9), [66](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ISortedCdps.sol#L66), [74](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ISortedCdps.sol#L74), [83](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ISortedCdps.sol#L83) ):

```solidity
/// @audit uint _NICR
9:     event NodeAdded(bytes32 _id, uint _NICR);

/// @audit uint maxNodes
66:         uint maxNodes

/// @audit uint maxNodes
74:         uint maxNodes

/// @audit uint maxNodes
83:         uint maxNodes
```

- *LiquidationLibrary.sol* ( [278](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LiquidationLibrary.sol#L278), [279](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LiquidationLibrary.sol#L279), [365](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LiquidationLibrary.sol#L365), [366](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LiquidationLibrary.sol#L366), [435](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LiquidationLibrary.sol#L435), [436](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LiquidationLibrary.sol#L436) ):

```solidity
/// @audit uint _debtToColl
278:         uint _debtToColl = (_totalDebtToBurn * DECIMAL_PRECISION) / _liqState.price;

/// @audit uint _cappedColl
279:         uint _cappedColl = collateral.getPooledEthByShares(_cappedColPortion + _liquidatorReward);

/// @audit uint _debtToColl
365:         uint _debtToColl = (_totalDebtToBurn * DECIMAL_PRECISION) / _recoveryState.price;

/// @audit uint _cappedColl
366:         uint _cappedColl = collateral.getPooledEthByShares(_cappedColPortion + _liquidatorReward);

/// @audit uint _debtToColl
435:             uint _debtToColl = (_partialDebt * DECIMAL_PRECISION) / _partialState.price;

/// @audit uint _cappedColl
436:             uint _cappedColl = collateral.getPooledEthByShares(_partialColl);
```

- *SortedCdps.sol* ( [159](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L159), [177](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L177), [182](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L182), [183](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L183), [230](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L230), [240](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L240), [245](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L245), [246](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L246), [273](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L273), [289](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L289), [293](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L293), [302](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L302), [303](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L303), [311](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L311), [312](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L312), [449](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L449) ):

```solidity
/// @audit uint maxNodes
159:         uint maxNodes

/// @audit uint maxNodes
177:         uint maxNodes

/// @audit uint _currentIndex
182:         uint _currentIndex = 0;

/// @audit uint i
183:         uint i;

/// @audit uint maxNodes
230:         uint maxNodes

/// @audit uint maxNodes
240:         uint maxNodes

/// @audit uint _ownedCount
245:         uint _ownedCount = 0;

/// @audit uint i
246:         uint i = 0;

/// @audit uint _ownedCount
273:         (uint _ownedCount, ) = _cdpCountOf(owner, dummyId, 0);

/// @audit uint maxNodes
289:         uint maxNodes

/// @audit uint _ownedCount
293:         (uint _ownedCount, ) = _cdpCountOf(owner, startNodeId, maxNodes);

/// @audit uint maxNodes
302:         uint maxNodes,

/// @audit uint maxArraySize
303:         uint maxArraySize

/// @audit uint i
311:         uint i = 0;

/// @audit uint _cdpRetrieved
312:         uint _cdpRetrieved;

/// @audit uint i
449:         for (uint i = 0; i < _len; ++i) {
```

</details>

### [N&#x2011;16] Large numeric literals should use underscores for readability

Large hardcoded numbers in code can be difficult to read. Consider using underscores for number literals to improve readability (e.g `1234567` -> `1_234_567`). Consider using an underscore for every third digit from the right.

<details>
<summary>There are 9 instances (click to show):</summary>

- *CdpManagerStorage.sol* ( [148](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L148), [150](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L150) ):

```solidity
148:     uint256 public minuteDecayFactor = 999037758833783000;

150:     uint256 public constant MAX_MINUTE_DECAY_FACTOR = 999999999999999999; // Corresponds to a very fast decay rate, but not too extreme
```

- *EbtcBase.sol* ( [19](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/EbtcBase.sol#L19), [22](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/EbtcBase.sol#L22), [25](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/EbtcBase.sol#L25) ):

```solidity
19:     uint256 public constant LICR = 1030000000000000000; // 103%

22:     uint256 public constant MCR = 1100000000000000000; // 110%

25:     uint256 public constant CCR = 1250000000000000000; // 125%
```

- *EbtcMath.sol* ( [60](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/EbtcMath.sol#L60), [61](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/EbtcMath.sol#L61) ):

```solidity
60:         if (_minutes > 525600000) {

61:             _minutes = 525600000;
```

- *PriceFeed.sol* ( [32](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/PriceFeed.sol#L32), [33](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/PriceFeed.sol#L33) ):

```solidity
32:     uint256 public constant TIMEOUT_ETH_BTC_FEED = 4800; // 1 hours & 20min: 60 * 80

33:     uint256 public constant TIMEOUT_STETH_ETH_FEED = 90000; // 25 hours: 60 * 60 * 25
```

</details>

### [N&#x2011;17] Add inline comments for unnamed parameters

`function func(address a, address)` -> `function func(address a, address /* b */)`

There is 1 instance:

- *LeverageMacroBase.sol* ( [15](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LeverageMacroBase.sol#L15) ):

```solidity
15:     function Cdps(bytes32) external view returns (ICdpManagerData.Cdp memory);
```

### [N&#x2011;18] Assembly blocks should have extensive comments

Assembly blocks take a lot more time to audit than normal Solidity code, and often have gotchas and side-effects that the Solidity versions of the same code do not. Consider adding more comments explaining what is being done in every step of the assembly code, and describe why assembly is being used instead of Solidity.

There are 4 instances:

- *SimplifiedDiamondLike.sol* ( [85-87](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SimplifiedDiamondLike.sol#L85-L87), [143-145](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SimplifiedDiamondLike.sol#L143-L145), [148-150](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SimplifiedDiamondLike.sol#L148-L150), [189](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SimplifiedDiamondLike.sol#L189) ):

```solidity
85:         assembly {
86:             ds.slot := position
87:         }

143:             assembly {
144:                 success := delegatecall(txGas, to, add(data, 0x20), mload(data), 0, 0)
145:             }

148:             assembly {
149:                 success := call(txGas, to, value, add(data, 0x20), mload(data), 0, 0)
150:             }

189:         assembly {
```

### [N&#x2011;19] `assert()`Â should be replaced with `require()` or `revert()`

In versions of Solidity prior to 0.8.0, when encountering an assert all the remaining gas will be consumed.
Even after solidity 0.8.0, the assert function is still not recommended, as described in the [documentation](https://docs.soliditylang.org/en/v0.8.20/control-structures.html#panic-via-assert-and-error-via-require):
> Assert should only be used to test for internal errors, and to check invariants. Properly functioning code should never create a Panic, not even on invalid external input. If this happens, then there is a bug in your contract which you should fix.

There is 1 instance:

- *LiquidationLibrary.sol* ( [564](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LiquidationLibrary.sol#L564) ):

```solidity
564:         assert(toLiquidator < _totalColToSend); // Assert is correct here for Echidna
```

### [N&#x2011;20] Simplify complex require statements

Simplifying complex `require` statements with local variables and `if`(or `revert`) statements can improve readability, make debugging easier, and promote modularity and reusability in the code.

There is 1 instance:

- *BorrowerOperations.sol* ( [818-821](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L818-L821) ):

```solidity
818:         require(
819:             _stEthBalanceIncrease != 0 || _stEthBalanceDecrease != 0 || _debtChange != 0,
820:             "BorrowerOperations: There must be either a collateral change or a debt change"
821:         );
```

### [N&#x2011;21] Complex math should be split into multiple steps

Consider splitting long arithmetic calculations into multiple steps to improve the code readability.

There is 1 instance:

- *PriceFeed.sol* ( [797-799](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/PriceFeed.sol#L797-L799) ):

```solidity
797:         uint256 _scaledDecimal = _stEthEthDecimals > _ethBtcDecimals
798:             ? 10 ** (_stEthEthDecimals - _ethBtcDecimals)
799:             : 10 ** (_ethBtcDecimals - _stEthEthDecimals);
```

### [N&#x2011;22] Consider adding a block/deny-list

Doing so will significantly increase centralization, but will help to prevent hackers from using stolen tokens

There are 4 instances:

- *ActivePool.sol* ( [22](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/ActivePool.sol#L22) ):

```solidity
22: contract ActivePool is IActivePool, ERC3156FlashLender, ReentrancyGuard, BaseMath, AuthNoOwner {
```

- *BorrowerOperations.sol* ( [21](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L21) ):

```solidity
21: contract BorrowerOperations is
```

- *CollSurplusPool.sol* ( [16](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CollSurplusPool.sol#L16) ):

```solidity
16: contract CollSurplusPool is ICollSurplusPool, ReentrancyGuard, AuthNoOwner {
```

- *LeverageMacroBase.sol* ( [26](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LeverageMacroBase.sol#L26) ):

```solidity
26: contract LeverageMacroBase {
```

### [N&#x2011;23] Constants/Immutables redefined elsewhere

Consider defining in only one contract so that values cannot become out of sync when only one location is updated. A [cheap way](https://medium.com/coinmonks/gas-cost-of-solidity-library-functions-dbe0cedd4678) to store constants/immutables in a single location is to create an `internal constant` in a `library`. If the variable is a local cache of another contract's value, consider making the cache variable internal or private, which will require external users to query the contract with the source of truth, so that callers don't get out of sync.

<details>
<summary>There are 53 instances (click to show):</summary>

- *ActivePool.sol* ( [24](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/ActivePool.sol#L24), [26](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/ActivePool.sol#L26), [27](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/ActivePool.sol#L27), [34](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/ActivePool.sol#L34) ):

```solidity
/// @audit Seen in contracts/BorrowerOperations.sol#29
24:     string public constant NAME = "ActivePool";

/// @audit Seen in contracts/CdpManagerStorage.sol#126
26:     address public immutable borrowerOperationsAddress;

/// @audit Seen in contracts/CollSurplusPool.sol#22
27:     address public immutable cdpManagerAddress;

/// @audit Seen in contracts/CollSurplusPool.sol#25
34:     ICollateralToken public immutable collateral;
```

- *BorrowerOperations.sol* ( [29](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L29), [38-39](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L38-L39), [41](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L41), [45](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L45), [46](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L46), [48](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L48), [49](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L49), [53](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L53), [55](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L55), [59](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L59), [62](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L62) ):

```solidity
/// @audit Seen in contracts/ActivePool.sol#24
29:     string public constant NAME = "BorrowerOperations";

/// @audit Seen in contracts/EBTCToken.sol#39
38:     bytes32 private constant _TYPE_HASH =
39:         0x8b73c3c69bb8fe3d512ecc4cf759cc79239f7b179b0ffacaa9a75d522b39400f;

/// @audit Seen in contracts/EBTCToken.sol#30
41:     string internal constant _VERSION = "1";

/// @audit Seen in contracts/EBTCToken.sol#44
45:     bytes32 private immutable _CACHED_DOMAIN_SEPARATOR;

/// @audit Seen in contracts/EBTCToken.sol#45
46:     uint256 private immutable _CACHED_CHAIN_ID;

/// @audit Seen in contracts/EBTCToken.sol#47
48:     bytes32 private immutable _HASHED_NAME;

/// @audit Seen in contracts/EBTCToken.sol#48
49:     bytes32 private immutable _HASHED_VERSION;

/// @audit Seen in contracts/SortedCdps.sol#56
53:     ICdpManager public immutable cdpManager;

/// @audit Seen in contracts/CdpManagerStorage.sol#128
55:     ICollSurplusPool public immutable collSurplusPool;

/// @audit Seen in contracts/CdpManagerStorage.sol#130
59:     IEBTCToken public immutable ebtcToken;

/// @audit Seen in contracts/CdpManagerStorage.sol#135
62:     ISortedCdps public immutable sortedCdps;
```

- *CdpManagerStorage.sol* ( [122](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L122), [126](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L126), [128](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L128), [130](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L130), [135](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L135) ):

```solidity
/// @audit Seen in contracts/BorrowerOperations.sol#29
122:     string public constant NAME = "CdpManager";

/// @audit Seen in contracts/ActivePool.sol#26
126:     address public immutable borrowerOperationsAddress;

/// @audit Seen in contracts/BorrowerOperations.sol#55
128:     ICollSurplusPool immutable collSurplusPool;

/// @audit Seen in contracts/BorrowerOperations.sol#59
130:     IEBTCToken public immutable override ebtcToken;

/// @audit Seen in contracts/BorrowerOperations.sol#62
135:     ISortedCdps public immutable sortedCdps;
```

- *CollSurplusPool.sol* ( [19](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CollSurplusPool.sol#L19), [21](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CollSurplusPool.sol#L21), [22](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CollSurplusPool.sol#L22), [25](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CollSurplusPool.sol#L25) ):

```solidity
/// @audit Seen in contracts/CdpManagerStorage.sol#122
19:     string public constant NAME = "CollSurplusPool";

/// @audit Seen in contracts/CdpManagerStorage.sol#126
21:     address public immutable borrowerOperationsAddress;

/// @audit Seen in contracts/ActivePool.sol#27
22:     address public immutable cdpManagerAddress;

/// @audit Seen in contracts/ActivePool.sol#34
25:     ICollateralToken public immutable collateral;
```

- *EbtcBase.sol* ( [41](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/EbtcBase.sol#L41), [46](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/EbtcBase.sol#L46) ):

```solidity
/// @audit Seen in contracts/LeverageMacroFactory.sol#13
41:     IActivePool public immutable activePool;

/// @audit Seen in contracts/CollSurplusPool.sol#25
46:     ICollateralToken public immutable collateral;
```

- *EBTCToken.sol* ( [30](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/EBTCToken.sol#L30), [39-40](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/EBTCToken.sol#L39-L40), [44](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/EBTCToken.sol#L44), [45](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/EBTCToken.sol#L45), [47](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/EBTCToken.sol#L47), [48](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/EBTCToken.sol#L48), [55](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/EBTCToken.sol#L55), [56](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/EBTCToken.sol#L56) ):

```solidity
/// @audit Seen in contracts/BorrowerOperations.sol#41
30:     string internal constant _VERSION = "1";

/// @audit Seen in contracts/BorrowerOperations.sol#38
39:     bytes32 private constant _TYPE_HASH =
40:         0x8b73c3c69bb8fe3d512ecc4cf759cc79239f7b179b0ffacaa9a75d522b39400f;

/// @audit Seen in contracts/BorrowerOperations.sol#45
44:     bytes32 private immutable _CACHED_DOMAIN_SEPARATOR;

/// @audit Seen in contracts/BorrowerOperations.sol#46
45:     uint256 private immutable _CACHED_CHAIN_ID;

/// @audit Seen in contracts/BorrowerOperations.sol#48
47:     bytes32 private immutable _HASHED_NAME;

/// @audit Seen in contracts/BorrowerOperations.sol#49
48:     bytes32 private immutable _HASHED_VERSION;

/// @audit Seen in contracts/CollSurplusPool.sol#22
55:     address public immutable cdpManagerAddress;

/// @audit Seen in contracts/CollSurplusPool.sol#21
56:     address public immutable borrowerOperationsAddress;
```

- *HintHelpers.sol* ( [12](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/HintHelpers.sol#L12), [14](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/HintHelpers.sol#L14), [15](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/HintHelpers.sol#L15) ):

```solidity
/// @audit Seen in contracts/SortedCdps.sol#52
12:     string public constant NAME = "HintHelpers";

/// @audit Seen in contracts/CdpManagerStorage.sol#135
14:     ISortedCdps public immutable sortedCdps;

/// @audit Seen in contracts/SortedCdps.sol#56
15:     ICdpManager public immutable cdpManager;
```

- *LeverageMacroBase.sol* ( [29](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LeverageMacroBase.sol#L29), [30](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LeverageMacroBase.sol#L30), [31](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LeverageMacroBase.sol#L31), [32](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LeverageMacroBase.sol#L32), [33](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LeverageMacroBase.sol#L33), [34](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LeverageMacroBase.sol#L34) ):

```solidity
/// @audit Seen in contracts/LeverageMacroFactory.sol#12
29:     IBorrowerOperations public immutable borrowerOperations;

/// @audit Seen in contracts/LeverageMacroFactory.sol#13
30:     IActivePool public immutable activePool;

/// @audit Seen in contracts/HintHelpers.sol#15
31:     ICdpCdps public immutable cdpManager;

/// @audit Seen in contracts/CdpManagerStorage.sol#130
32:     IEBTCToken public immutable ebtcToken;

/// @audit Seen in contracts/HintHelpers.sol#14
33:     ISortedCdps public immutable sortedCdps;

/// @audit Seen in contracts/LeverageMacroFactory.sol#16
34:     ICollateralToken public immutable stETH;
```

- *LeverageMacroFactory.sol* ( [12](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LeverageMacroFactory.sol#L12), [13](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LeverageMacroFactory.sol#L13), [14](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LeverageMacroFactory.sol#L14), [15](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LeverageMacroFactory.sol#L15), [16](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LeverageMacroFactory.sol#L16), [17](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LeverageMacroFactory.sol#L17) ):

```solidity
/// @audit Seen in contracts/LeverageMacroBase.sol#29
12:     address public immutable borrowerOperations;

/// @audit Seen in contracts/LeverageMacroBase.sol#30
13:     address public immutable activePool;

/// @audit Seen in contracts/LeverageMacroBase.sol#31
14:     address public immutable cdpManager;

/// @audit Seen in contracts/LeverageMacroBase.sol#32
15:     address public immutable ebtcToken;

/// @audit Seen in contracts/LeverageMacroBase.sol#34
16:     address public immutable stETH;

/// @audit Seen in contracts/LeverageMacroBase.sol#33
17:     address public immutable sortedCdps;
```

- *PriceFeed.sol* ( [22](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/PriceFeed.sol#L22) ):

```solidity
/// @audit Seen in contracts/CollSurplusPool.sol#19
22:     string public constant NAME = "PriceFeed";
```

- *SortedCdps.sol* ( [52](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L52), [54](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L54), [56](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L56) ):

```solidity
/// @audit Seen in contracts/PriceFeed.sol#22
52:     string public constant NAME = "SortedCdps";

/// @audit Seen in contracts/EBTCToken.sol#56
54:     address public immutable borrowerOperationsAddress;

/// @audit Seen in contracts/BorrowerOperations.sol#53
56:     ICdpManager public immutable cdpManager;
```

</details>

### [N&#x2011;24] Convert simple `if`-statements to ternary expressions

Converting some if statements to ternaries (such as `z = (a < b) ? x : y`) can make the code more concise and easier to read.

<details>
<summary>There are 3 instances (click to show):</summary>

- *RolesAuthority.sol* ( [95-99](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/RolesAuthority.sol#L95-L99) ):

```solidity
95:         if (enabled) {
96:             capabilityFlag[target][functionSig] = CapabilityFlag.Public;
97:         } else {
98:             capabilityFlag[target][functionSig] = CapabilityFlag.None;
99:         }
```

- *LiquidationLibrary.sol* ( [553-559](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LiquidationLibrary.sol#L553-L559), [698-708](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LiquidationLibrary.sol#L698-L708) ):

```solidity
553:         if (_ICR > LICR) {
554:             // Cap at 10%
555:             _incentiveColl = (_totalDebtToBurn * (_ICR > MCR ? MCR : _ICR)) / _price;
556:         } else {
557:             // Min 103%
558:             _incentiveColl = (_totalDebtToBurn * LICR) / _price;
559:         }

698:         if (vars.recoveryModeAtStart) {
699:             totals = _getTotalFromBatchLiquidate_RecoveryMode(
700:                 vars.price,
701:                 systemColl,
702:                 systemDebt,
703:                 _cdpArray
704:             );
705:         } else {
706:             //  if !vars.recoveryModeAtStart
707:             totals = _getTotalsFromBatchLiquidate_NormalMode(vars.price, _TCR, _cdpArray);
708:         }
```

</details>

### [N&#x2011;25] Contracts should each be defined in separate files

Keeping each contract in a separate file makes it easier to work with multiple people, makes the code easier to maintain, and is a common practice on most projects. The following files each contains more than one contract/library/interface.

There are 2 instances:

- [*LeverageMacroBase.sol*](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LeverageMacroBase.sol)

- [*LeverageMacroDelegateTarget.sol*](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LeverageMacroDelegateTarget.sol)

### [N&#x2011;26] UPPER_CASE names should be reserved for `constant`/`immutable` variables

If the variable needs to be different based on which class it comes from, a `view`/`pure` _function_ should be used instead (e.g. like [this](https://github.com/OpenZeppelin/openzeppelin-contracts/blob/76eee35971c2541585e05cbf258510dda7b2fbc6/contracts/token/ERC20/extensions/draft-IERC20Permit.sol#L59)).

<details>
<summary>There are 38 instances (click to show):</summary>

- *BorrowerOperations.sol* ( [91](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L91), [92](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L92) ):

```solidity
91:         uint256 ICR;

92:         uint256 NICR;
```

- *CdpManager.sol* ( [246](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L246), [600](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L600), [757](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L757) ):

```solidity
246:         uint256 _EBTC,

600:         uint256 TCR = _computeTCRWithGivenSystemValues(_systemCollShares, _systemDebt, _price);

757:     function _requireTCRisNotBelowMCR(uint256 _price, uint256 _TCR) internal view {
```

- *CdpManagerStorage.sol* ( [676](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L676), [693](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L693), [703](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L703) ):

```solidity
676:         uint256 NICR = EbtcMath._computeNominalCR(currentCollShares, currentEBTCDebt);

693:         uint256 NICR = EbtcMath._computeNominalCR(_newColl, _newDebt);

703:         uint256 ICR = _calculateCR(currentCollShares, currentEBTCDebt, _price);
```

- *EbtcBase.sol* ( [79](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/EbtcBase.sol#L79), [85](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/EbtcBase.sol#L85) ):

```solidity
79:     function _getCachedTCR(uint256 _price) internal view returns (uint256 TCR) {

85:     ) internal view returns (uint256 TCR, uint256 _coll, uint256 _debt) {
```

- *Governor.sol* ( [17](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Governor.sol#L17) ):

```solidity
17:     bytes32 NO_ROLES = bytes32(0);
```

- *HintHelpers.sol* ( [165](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/HintHelpers.sol#L165) ):

```solidity
165:         uint256 _CR,
```

- *ICdpManagerData.sol* ( [122](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManagerData.sol#L122), [126](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManagerData.sol#L126), [142](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManagerData.sol#L142), [156](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManagerData.sol#L156), [162](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManagerData.sol#L162) ):

```solidity
122:         uint256 ICR;

126:         uint256 TCR;

142:         uint256 ICR;

156:         uint256 ICR;

162:         uint256 TCR;
```

- *IRecoveryModeGracePeriod.sol* ( [6](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IRecoveryModeGracePeriod.sol#L6) ):

```solidity
6:     event TCRNotified(uint256 TCR); /// NOTE: Mostly for debugging to ensure synch
```

- *ISortedCdps.sol* ( [9](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ISortedCdps.sol#L9), [39](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ISortedCdps.sol#L39), [45](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ISortedCdps.sol#L45), [52](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ISortedCdps.sol#L52) ):

```solidity
9:     event NodeAdded(bytes32 _id, uint _NICR);

39:         uint256 _ICR,

45:         uint256 _ICR,

52:         uint256 _ICR,
```

- *LiquidationLibrary.sol* ( [74](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LiquidationLibrary.sol#L74), [75](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LiquidationLibrary.sol#L75), [545](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LiquidationLibrary.sol#L545), [571](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LiquidationLibrary.sol#L571), [610](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LiquidationLibrary.sol#L610), [692](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LiquidationLibrary.sol#L692), [745](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LiquidationLibrary.sol#L745), [809](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LiquidationLibrary.sol#L809) ):

```solidity
74:         uint256 _ICR = getCachedICR(_cdpId, _price); // @audit syncAccounting already called, guarenteed to be synced

75:         (uint256 _TCR, uint256 systemColl, uint256 systemDebt) = _getTCRWithSystemDebtAndCollShares(

545:         uint256 _ICR,

571:         uint256 _ICR,

610:         uint256 _TCR,

692:         (uint256 _TCR, uint256 systemColl, uint256 systemDebt) = _getTCRWithSystemDebtAndCollShares(

745:         uint256 _TCR = _computeTCRWithGivenSystemValues(

809:         uint256 _TCR,
```

- *SortedCdps.sol* ( [346](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L346), [363](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L363), [584](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L584), [592](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L592), [619](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L619), [642](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L642), [667](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L667), [675](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L675) ):

```solidity
346:         uint256 _NICR,

363:     function _insert(bytes32 _id, uint256 _NICR, bytes32 _prevId, bytes32 _nextId) internal {

584:         uint256 _NICR,

592:         uint256 _NICR,

619:     function _descendList(uint256 _NICR, bytes32 _startId) internal view returns (bytes32, bytes32) {

642:     function _ascendList(uint256 _NICR, bytes32 _startId) internal view returns (bytes32, bytes32) {

667:         uint256 _NICR,

675:         uint256 _NICR,
```

</details>

### [N&#x2011;27] Do not use literal numbers for array indexes

Indexing arrays using enums or meaningfully named constants instead of literals can make code easier to read and maintain.

There are 2 instances:

- *CdpManager.sol* ( [502](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L502) ):

```solidity
502:         require(_toRemoveIds[0] == _start, "CdpManager: batchRemoveSortedCdpIds check start error");
```

- *SortedCdps.sol* ( [424](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L424) ):

```solidity
424:         bytes32 _firstPrev = data.nodes[_ids[0]].prevId;
```

### [N&#x2011;28] Contract timekeeping will break earlier than the Ethereum network itself will stop working

When a timestamp is downcast from `uint256` to `uint32`, the value will wrap in the year 2106, and the contracts will break. Other downcasts will have different endpoints. Consider whether your contract is intended to live past the size of the type being used.

There is 1 instance:

- *CdpManagerStorage.sol* ( [53](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L53) ):

```solidity
53:             lastGracePeriodStartTimestamp = uint128(block.timestamp);
```

### [N&#x2011;29] Events should be emitted before external calls

Ensure that events follow the best practice of check-effects-interaction, and are emitted before external calls.

<details>
<summary>There are 27 instances (click to show):</summary>

- *ActivePool.sol* ( [307](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/ActivePool.sol#L307), [360](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/ActivePool.sol#L360), [383](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/ActivePool.sol#L383), [399](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/ActivePool.sol#L399), [412](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/ActivePool.sol#L412), [421](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/ActivePool.sol#L421) ):

```solidity
/// @audit `transfer()` is called on line 274
307:         emit FlashLoanSuccess(address(receiver), token, amount, fee);

/// @audit `syncGlobalAccountingAndGracePeriod()` is called on line 347
360:         emit FeeRecipientClaimableCollSharesDecreased(cachedFeeRecipientCollShares, _shares);

/// @audit `syncGlobalAccountingAndGracePeriod()` is called on line 372
383:         emit SweepTokenSuccess(token, amount, cachedFeeRecipientAddress);

/// @audit `syncGlobalAccountingAndGracePeriod()` is called on line 391
399:         emit FeeRecipientAddressChanged(_feeRecipientAddress);

/// @audit `syncGlobalAccountingAndGracePeriod()` is called on line 405
412:         emit FlashFeeSet(msg.sender, _oldFee, _newFee);

/// @audit `syncGlobalAccountingAndGracePeriod()` is called on line 418
421:         emit FlashLoansPaused(msg.sender, _paused);
```

- *BorrowerOperations.sol* ( [1105](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L1105), [1149](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L1149), [1162](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L1162), [1171](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L1171) ):

```solidity
/// @audit `mint()` is called on line 1088
1105:         emit FlashLoanSuccess(address(receiver), token, amount, fee);

/// @audit `syncGlobalAccounting()` is called on line 1146
1149:         emit FeeRecipientAddressChanged(_feeRecipientAddress);

/// @audit `syncGlobalAccounting()` is called on line 1157
1162:         emit FlashFeeSet(msg.sender, _oldFee, _newFee);

/// @audit `syncGlobalAccounting()` is called on line 1168
1171:         emit FlashLoansPaused(msg.sender, _paused);
```

- *CdpManager.sol* ( [220-230](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L220-L230), [466-472](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L466-L472), [782](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L782), [801](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L801), [824](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L824), [836](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L836), [848](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L848) ):

```solidity
/// @audit `reInsert()` is called on line 209
220:             emit CdpUpdated(
221:                 _redeemColFromCdp.cdpId,
222:                 ISortedCdps(sortedCdps).getOwnerAddress(_redeemColFromCdp.cdpId),
223:                 msg.sender,
224:                 _oldDebtAndColl.debt,
225:                 _oldDebtAndColl.collShares,
226:                 newDebt,
227:                 newColl,
228:                 Cdps[_redeemColFromCdp.cdpId].stake,
229:                 CdpOperation.redeemCollateral
230:             );

/// @audit `_syncGlobalAccounting()` is called on line 336, triggering an external call - `allocateSystemCollSharesToFeeRecipient()`
466:         emit Redemption(
467:             _debt,
468:             totals.debtToRedeem,
469:             totals.collSharesDrawn,
470:             totals.feeCollShares,
471:             msg.sender
472:         );

/// @audit `syncGlobalAccountingAndGracePeriod()` is called on line 779, triggering an external call - `fetchPrice()`
782:         emit StakingRewardSplitSet(_stakingRewardSplit);

/// @audit `syncGlobalAccountingAndGracePeriod()` is called on line 798, triggering an external call - `fetchPrice()`
801:         emit RedemptionFeeFloorSet(_redemptionFeeFloor);

/// @audit `syncGlobalAccountingAndGracePeriod()` is called on line 817, triggering an external call - `fetchPrice()`
824:         emit MinuteDecayFactorSet(_minuteDecayFactor);

/// @audit `syncGlobalAccountingAndGracePeriod()` is called on line 831, triggering an external call - `fetchPrice()`
836:         emit BetaSet(_beta);

/// @audit `syncGlobalAccountingAndGracePeriod()` is called on line 844, triggering an external call - `fetchPrice()`
848:         emit RedemptionsPaused(_paused);
```

- *CdpManagerStorage.sol* ( [119](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L119), [390-400](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L390-L400), [587](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L587) ):

```solidity
/// @audit `syncGlobalAccountingAndGracePeriod()` is called on line 117, triggering an external call - `fetchPrice()`
119:         emit GracePeriodDurationSet(_gracePeriod);

/// @audit `_syncGlobalAccounting()` is called on line 348, triggering an external call - `allocateSystemCollSharesToFeeRecipient()`
390:             emit CdpUpdated(
391:                 _cdpId,
392:                 ISortedCdps(sortedCdps).getOwnerAddress(_cdpId),
393:                 msg.sender,
394:                 prevDebt,
395:                 prevCollShares,
396:                 _newDebt,
397:                 _newColl,
398:                 _cdp.stake,
399:                 CdpOperation.syncAccounting
400:             );

/// @audit `allocateSystemCollSharesToFeeRecipient()` is called on line 585
587:         emit CollateralFeePerUnitUpdated(_oldPerUnit, _newPerUnit, _feeTaken);
```

- *CollSurplusPool.sol* ( [150](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CollSurplusPool.sol#L150) ):

```solidity
/// @audit `safeTransfer()` is called on line 148
150:         emit SweepTokenSuccess(token, amount, feeRecipientAddress);
```

- *LiquidationLibrary.sol* ( [238-248](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LiquidationLibrary.sol#L238-L248), [281-290](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LiquidationLibrary.sol#L281-L290), [312-322](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LiquidationLibrary.sol#L312-L322), [367-376](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LiquidationLibrary.sol#L367-L376), [437-445](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LiquidationLibrary.sol#L437-L445), [490-500](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LiquidationLibrary.sol#L490-L500) ):

```solidity
/// @audit `_closeCdpByLiquidation()` is called on line 231, triggering an external call - `remove()`
238:         emit CdpUpdated(
239:             _liqState.cdpId,
240:             _borrower,
241:             msg.sender,
242:             _totalDebtToBurn,
243:             _totalColToSend,
244:             0,
245:             0,
246:             0,
247:             CdpOperation.liquidateInNormalMode
248:         );

/// @audit `_closeCdpByLiquidation()` is called on line 231, triggering an external call - `remove()`
281:         emit CdpLiquidated(
282:             _liqState.cdpId,
283:             _borrower,
284:             _totalDebtToBurn,
285:             // please note this is the collateral share of the liquidated CDP
286:             _cappedColPortion,
287:             CdpOperation.liquidateInNormalMode,
288:             msg.sender,
289:             _cappedColl > _debtToColl ? (_cappedColl - _debtToColl) : 0
290:         );

/// @audit `_closeCdpByLiquidation()` is called on line 303, triggering an external call - `remove()`
312:         emit CdpUpdated(
313:             _recoveryState.cdpId,
314:             _borrower,
315:             msg.sender,
316:             _totalDebtToBurn,
317:             _totalColToSend,
318:             0,
319:             0,
320:             0,
321:             CdpOperation.liquidateInRecoveryMode
322:         );

/// @audit `_closeCdpByLiquidation()` is called on line 303, triggering an external call - `remove()`
367:         emit CdpLiquidated(
368:             _recoveryState.cdpId,
369:             _borrower,
370:             _totalDebtToBurn,
371:             // please note this is the collateral share of the liquidated CDP
372:             _cappedColPortion,
373:             CdpOperation.liquidateInRecoveryMode,
374:             msg.sender,
375:             _cappedColl > _debtToColl ? (_cappedColl - _debtToColl) : 0
376:         );

/// @audit `_reInsertPartialLiquidation()` is called on line 429, triggering an external call - `reInsert()`
437:             emit CdpPartiallyLiquidated(
438:                 _cdpId,
439:                 sortedCdps.getOwnerAddress(_cdpId),
440:                 _partialDebt,
441:                 _partialColl,
442:                 CdpOperation.partiallyLiquidate,
443:                 msg.sender,
444:                 _cappedColl > _debtToColl ? (_cappedColl - _debtToColl) : 0
445:             );

/// @audit `reInsert()` is called on line 484
490:         emit CdpUpdated(
491:             _cdpId,
492:             sortedCdps.getOwnerAddress(_cdpId),
493:             msg.sender,
494:             _oldDebt,
495:             _oldColl,
496:             Cdps[_cdpId].debt,
497:             Cdps[_cdpId].coll,
498:             Cdps[_cdpId].stake,
499:             CdpOperation.partiallyLiquidate
500:         );
```

</details>

### [N&#x2011;30] Events are emitted without the sender information

When an action is triggered based on a user's action, not being able to filter based on who triggered the action makes event processing a lot more cumbersome. Including the `msg.sender` the events of these types of action will make events much more useful to end users, especially when `msg.sender` is not `tx.origin`.

<details>
<summary>There are 13 instances (click to show):</summary>

- *ActivePool.sol* ( [112](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/ActivePool.sol#L112), [113](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/ActivePool.sol#L113), [145](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/ActivePool.sol#L145), [146](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/ActivePool.sol#L146), [200](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/ActivePool.sol#L200), [213](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/ActivePool.sol#L213), [247](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/ActivePool.sol#L247), [307](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/ActivePool.sol#L307) ):

```solidity
112:         emit SystemCollSharesUpdated(cachedSystemCollShares);

113:         emit CollSharesTransferred(_account, _shares);

145:         emit SystemCollSharesUpdated(cachedSystemCollShares);

146:         emit CollSharesTransferred(_account, totalShares);

200:         emit ActivePoolEBTCDebtUpdated(cachedSystemDebt);

213:         emit ActivePoolEBTCDebtUpdated(cachedSystemDebt);

247:         emit SystemCollSharesUpdated(cachedSystemCollShares);

307:         emit FlashLoanSuccess(address(receiver), token, amount, fee);
```

- *BorrowerOperations.sol* ( [1105](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L1105) ):

```solidity
1105:         emit FlashLoanSuccess(address(receiver), token, amount, fee);
```

- *CollSurplusPool.sol* ( [95](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CollSurplusPool.sol#L95), [104](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CollSurplusPool.sol#L104) ):

```solidity
95:         emit SurplusCollSharesUpdated(_account, 0);

104:         emit CollSharesTransferred(_account, claimableColl);
```

- *LeverageMacroFactory.sol* ( [56](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LeverageMacroFactory.sol#L56) ):

```solidity
56:         emit DeployNewMacro(_owner, addy);
```

- *LiquidationLibrary.sol* ( [516](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LiquidationLibrary.sol#L516) ):

```solidity
516:         emit Liquidation(totalDebtToBurn, totalCollSharesToSend, totalLiquidatorRewardCollShares);
```

</details>

### [N&#x2011;31] Function state mutability can be restricted to pure

Function state mutability can be restricted to pure

<details>
<summary>There are 9 instances (click to show):</summary>

- *CdpManager.sol* ( [757](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L757) ):

```solidity
757:     function _requireTCRisNotBelowMCR(uint256 _price, uint256 _TCR) internal view {
```

- *EbtcBase.sol* ( [99](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/EbtcBase.sol#L99), [134](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/EbtcBase.sol#L134), [140](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/EbtcBase.sol#L140) ):

```solidity
99:     function _checkRecoveryModeForTCR(uint256 _tcr) internal view returns (bool) {

134:     function _checkICRAgainstMCR(uint256 _icr) internal view returns (bool) {

140:     function _checkICRAgainstTCR(uint256 _icr, uint _tcr) internal view returns (bool) {
```

- *LeverageMacroBase.sol* ( [39](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LeverageMacroBase.sol#L39), [244](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LeverageMacroBase.sol#L244), [338](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LeverageMacroBase.sol#L338) ):

```solidity
39:     function owner() public virtual returns (address) {

244:     function _doCheckValueType(CheckValueAndType memory check, uint256 valueToCheck) internal {

338:     function decodeFLData(bytes calldata data) public view returns (LeverageMacroOperation memory) {
```

- *LiquidationLibrary.sol* ( [896-900](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LiquidationLibrary.sol#L896-L900) ):

```solidity
896:     function _requirePartialLiqDebtSize(
897:         uint256 _partialDebt,
898:         uint256 _entireDebt,
899:         uint256 _price
900:     ) internal view {
```

- *PriceFeed.sol* ( [775](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/PriceFeed.sol#L775) ):

```solidity
775:     function _checkHealthyCLResponse(uint80 _roundId, int256 _answer) internal view returns (bool) {
```

</details>

### [N&#x2011;32] Imports could be organized more systematically

The contract's interface should be imported first, followed by each of the interfaces it uses, followed by all other files. The examples below do not follow this layout.

There are 4 instances:

- *CdpManagerStorage.sol* ( [11](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L11) ):

```solidity
/// @audit Out of order with the prev importï¸ â¬
11: import "./Dependencies/ICollateralTokenOracle.sol";
```

- *CollSurplusPool.sol* ( [10](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CollSurplusPool.sol#L10) ):

```solidity
/// @audit Out of order with the prev importï¸ â¬
10: import "./Interfaces/IActivePool.sol";
```

- *EbtcBase.sol* ( [7](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/EbtcBase.sol#L7) ):

```solidity
/// @audit Out of order with the prev importï¸ â¬
7: import "../Interfaces/IActivePool.sol";
```

- *LeverageMacroFactory.sol* ( [5](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LeverageMacroFactory.sol#L5) ):

```solidity
/// @audit Out of order with the prev importï¸ â¬
5: import "./Dependencies/ICollateralToken.sol";
```

### [N&#x2011;33] Invalid NatSpec comment style

NatSpec comment in solidity should use `///` or `/* ... */` syntax.

There are 6 instances:

- *PriceFeed.sol* ( [781-782](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/PriceFeed.sol#L781-L782), [783](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/PriceFeed.sol#L783), [784](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/PriceFeed.sol#L784), [785](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/PriceFeed.sol#L785), [786](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/PriceFeed.sol#L786), [787](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/PriceFeed.sol#L787) ):

```solidity
781: 
782:     // @notice Returns the price of stETH:BTC in 18 decimals denomination

783:     // @param _ethBtcAnswer CL price retrieve from ETH:BTC feed

784:     // @param _stEthEthAnswer CL price retrieve from stETH:BTC feed

785:     // @param _ethBtcDecimals ETH:BTC feed decimals

786:     // @param _stEthEthDecimals stETH:BTC feed decimalss

787:     // @return The aggregated calculated price for stETH:BTC
```

### [N&#x2011;34] @openzeppelin/contracts should be upgraded to a newer version

These contracts import contracts from `@openzeppelin/contracts`, but they are not using [the latest version](https://github.com/OpenZeppelin/openzeppelin-contracts/releases).

The imported version is `^3.3.0`.

There is 1 instance:

- Global finding

### [N&#x2011;35] Lib @openzeppelin/contracts-upgradeable should be upgraded to a newer version

These contracts import contracts from `@openzeppelin/contracts-upgradeable`, but they are not using [the latest version](https://github.com/OpenZeppelin/openzeppelin-contracts-upgradeable/releases).

The imported version is `4.9.3`.

There is 1 instance:

- Global finding

### [N&#x2011;36] Lines are too long

The [solidity style guide](https://docs.soliditylang.org/en/v0.8.17/style-guide.html#maximum-line-length) recommends a maximum line length of 120 characters. Lines of code that are longer than 120 should be wrapped.

<details>
<summary>There are 128 instances (click to show):</summary>

- *ActivePool.sol* ( [39](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/ActivePool.sol#L39), [71](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/ActivePool.sol#L71), [79](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/ActivePool.sol#L79), [119](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/ActivePool.sol#L119), [121](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/ActivePool.sol#L121), [123](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/ActivePool.sol#L123), [154](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/ActivePool.sol#L154), [177](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/ActivePool.sol#L177), [268](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/ActivePool.sol#L268), [293](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/ActivePool.sol#L293), [347](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/ActivePool.sol#L347) ):

```solidity
39:     /// @dev Initializes the contract with the borrowerOperationsAddress, cdpManagerAddress, collateral token address, collSurplusAddress, and feeRecipientAddress

71:     /// @dev Not necessarily equal to the the contract's raw systemCollShares balance - tokens can be forcibly sent to contracts

79:     /// @dev The amount of EBTC debt in the pool. Like systemCollShares, this is not necessarily equal to the contract's EBTC token balance - tokens can be forcibly sent to contracts

119:     /// @notice Liquidator reward shares are not tracked via internal accounting in the active pool and are assumed to be present in expected amount as part of the intended behavior of BorowerOperations and CdpManager

121:     /// @dev closeCdp() or liqudations result in the actor (borrower or liquidator respectively) receiving the liquidator reward shares

123:     /// @dev Note that funds in the coll surplus pool, just like liquidator reward shares, are not tracked as part of the system CR or coll of a CDP.

154:     /// @dev If the fee recipient address is changed while outstanding claimable coll is available, only the new fee recipient will be able to claim the outstanding coll

177:     /// @notice Helper function to transfer stETH shares to another address, ensuring to call hooks into other system pools if they are the recipient

268:         uint256 fee = flashFee(token, amount); // NOTE: Check for `token` is implicit in the requires above // also checks for paused

293:         //  You technically could, but you'd be having to repay any amount below systemCollShares to get Fl2 to not revert

347:         ICdpManagerData(cdpManagerAddress).syncGlobalAccountingAndGracePeriod(); // Calling this increases shares so do it first
```

- *BorrowerOperations.sol* ( [31](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L31), [34](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L34), [64](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L64), [140](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L140), [141](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L141), [160](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L160), [161](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L161), [177](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L177), [179](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L179), [214](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L214), [228](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L228), [230](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L230), [267](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L267), [296](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L296), [392](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L392), [451](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L451), [533](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L533), [537](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L537), [597](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L597), [624](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L624), [625](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L625), [627](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L627), [645](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L645), [782](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L782), [977](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L977), [1084](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L1084), [1122](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L1122) ):

```solidity
31:     // keccak256("permitPositionManagerApproval(address borrower,address positionManager,uint8 status,uint256 nonce,uint256 deadline)");

34:             "PermitPositionManagerApproval(address borrower,address positionManager,uint8 status,uint256 nonce,uint256 deadline)"

64:     // Mapping of borrowers to approved position managers, by approval status: cdpOwner(borrower) -> positionManager -> PositionManagerApproval (None, OneTime, Persistent)

140:         @notice BorrowerOperations and CdpManager share reentrancy status by confirming the other's locked flag before beginning operation

141:         @dev This is an alternative to the more heavyweight solution of both being able to set the reentrancy flag on a 3rd contract.

160:     /// @notice Function that creates a Cdp for the caller with the requested debt, and the stETH received as collateral.

161:     /// @notice Successful execution is conditional mainly on the resulting collateralization ratio which must exceed minimum requirement, e.g., MCR.

177:     /// @notice Function that creates a Cdp for the specified _borrower by caller with the requested debt, and the stETH received as collateral.

179:     /// @notice Successful execution is conditional mainly on the resulting collateralization ratio which must exceed minimum requirement, e.g., MCR.

214:     /// @notice Successful execution is conditional on whether the withdrawal would bring down the ICR or TCR to the minimum requirement, e.g., MCR or CCR

228:     /// @notice Function that withdraws `_debt` amount of eBTC token from the specified Cdp, thus increasing its debt accounting

230:     /// @notice Successful execution is conditional on whether the withdrawal would bring down the ICR or TCR to the minimum requirement, e.g., MCR or CCR

267:     /// @param _isDebtIncrease The flag (true or false) to indicate whether this is a eBTC token withdrawal (debt increase) or a repayment (debt reduce)

296:     /// @param _isDebtIncrease The flag (true or false) to indicate whether this is a eBTC token withdrawal (debt increase) or a repayment (debt reduce)

392:         // When the adjustment is a debt repayment, check it's a valid amount, that the caller has enough EBTC, and that the resulting debt is >0

451:         // ICR is based on the net stEth balance, i.e. the specified stEth balance amount - fixed liquidator incentive gas comp.

533:             The static liqudiation incentive is stored in the gas pool and can be considered a deposit / voucher to be returned upon Cdp close, to the closer.

537:         // CEI: Move the collateral and liquidator gas compensation to the Active Pool. Track only net collateral for TCR purposes.

597:     /// @notice when a Cdp has been fully redeemed from and closed, or liquidated in Recovery Mode with a collateralization ratio higher enough (like over MCR)

624:     /// @notice Position managers with 'OneTIme' status will be able to take a single action on one Cdp. Approval will be automatically revoked after one Cdp-related action.

625:     /// @notice Similar to approving tokens, approving a position manager allows _stealing of all positions_ if given to a malicious account.

627:     /// @param _approval PositionManagerApproval (None/OneTime/Persistent) status set to the specified _positionManager for caller's Cdp

645:     /// @notice Similar to approving tokens, approving a position manager allows _stealing of all positions_ if given to a malicious account.

782:     /// @dev These number of liquidator shares associated with each Cdp are stored in the Cdp, while the actual tokens float in the active pool

977:         /// @dev If the PositionManagerApproval was none, we should have failed with the check in _requireBorrowerOrPositionManagerAndUpdateManagerApproval

1084:         uint256 fee = flashFee(token, amount); // NOTE: Check for `eBTCToken` is implicit here // NOTE: Pause check is here

1122:     /// @param token The address of the token to get the maximum flash loan amount for, exclusively used here for eBTC token
```

- *CdpManager.sol* ( [13](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L13), [96](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L96), [122](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L122), [271](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L271), [291](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L291), [292](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L292), [294](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L294), [295](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L295), [296](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L296), [299](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L299), [301](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L301), [304](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L304), [305](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L305), [311](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L311), [314](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L314), [315](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L315), [316](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L316), [317](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L317), [515](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L515), [579](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L579), [919](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L919) ):

```solidity
13: /// @title CdpManager is mainly in charge of all Cdp related core processing like collateral & debt accounting, split fee calculation, redemption, etc

96:     /// @notice callable by anyone, attempts to liquidate the CdpId. Executes successfully if Cdp meets the conditions for liquidation (e.g. in Normal Mode, it liquidates if the Cdp's ICR < the system MCR).

122:     /// @notice Steps through the provided list and attempts to liquidate every Cdp, until it reaches the end or it runs out of gas.

271:     /// @dev Returns true if the specified CdpId is not blank, exists in the list, has an ICR > MCR, and the next lower Cdp in the list is either blank or has an ICR < MCR.

291:     /// @notice Note that if _debt is very large, this function can run out of gas, specially if traversed cdps are small (meaning many small Cdps are redeemed against).

292:     /// @notice This can be easily avoided by splitting the total _debt in appropriate chunks and calling the function multiple times.

294:     /// @notice There is a optional parameter `_maxIterations` which can also be provided, so the loop through Cdps is capped (if itâs zero, it will be ignored).

295:     /// @notice This makes it easier to avoid OOG for the frontend, as only knowing approximately the average cost of an iteration is enough,

296:     /// @notice without needing to know the "topology" of the cdp list. It also avoids the need to set the cap in stone in the contract,

299:     /// @notice All Cdps that are redeemed from -- with the likely exception of the last one -- will end up with no debt left,

301:     /// @notice If the last Cdp does have some remaining debt & collateral (it has a valid meaningful ICR) then reinsertion of the CDP

304:     /// @notice A frontend should use HintHelper.getRedemptionHints() to calculate what the ICR of this Cdp will be after redemption,

305:     /// @notice and pass a hint for its position in the SortedCdps list along with the ICR value that the hint was found for.

311:     /// @notice In this case, the redemption will stop after the last completely redeemed Cdp and the sender will keep the

314:     /// @param _firstRedemptionHint The first CdpId to be considered for redemption, could get from HintHelper.getRedemptionHints()

315:     /// @param _upperPartialRedemptionHint The first CdpId to be considered for redemption, could get from HintHelper.getApproxHint(_partialRedemptionHintNICR) then SortedCdps.findInsertPosition(_partialRedemptionHintNICR)

316:     /// @param _lowerPartialRedemptionHint The first CdpId to be considered for redemption, could get from HintHelper.getApproxHint(_partialRedemptionHintNICR) then SortedCdps.findInsertPosition(_partialRedemptionHintNICR)

317:     /// @param _partialRedemptionHintNICR The new Nominal Collateral Ratio (NICR) of the last redeemed CDP after partial redemption, could get from HintHelper.getRedemptionHints()

515:         /// @audit Opening can cause invalid reordering of Cdps due to changing values without reInserting into sortedCdps

579:     /// @return TCR The cached total collateralization ratio (TCR) of the system (does not take into account pending global state)

919:         cdpStEthFeePerUnitIndex[_cdpId] = systemStEthFeePerUnitIndex; /// @audit We critically assume global accounting is synced here
```

- *CdpManagerStorage.sol* ( [27](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L27), [150](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L150), [175](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L175), [197](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L197), [239](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L239), [240](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L240), [303](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L303), [613](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L613), [683](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L683), [716](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L716), [726](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L726), [740](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L740), [781](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L781) ):

```solidity
27:     /// @notice Start the recovery mode grace period, if the system is in RM and the grace period timestamp has not already been set

150:     uint256 public constant MAX_MINUTE_DECAY_FACTOR = 999999999999999999; // Corresponds to a very fast decay rate, but not too extreme

175:     // Snapshot of the total collateral across the ActivePool, immediately after the latest liquidation and split fee claim

197:     /* Global Fee accumulator (never decreasing) per stake unit in CDPManager, similar to systemDebtRedistributionIndex */

239:     /// @notice BorrowerOperations and CdpManager share reentrancy status by confirming the other's locked flag before beginning operation

240:     /// @dev This is an alternative to the more heavyweight solution of both being able to set the reentrancy flag on a 3rd contract.

303:     /// @dev get the pending Cdp debt "reward" (i.e. the amount of extra debt assigned to the Cdp) from liquidation redistribution events, earned by their stake

613:     /// @param _systemStEthFeePerUnitIndex The fee-per-stake-unit value to be used in fee split calculation, could be result of calcFeeUponStakingReward()

683:     /// @return The Nominal Collateral Ratio (NICR) of the specified Cdp with fee split and debt redistribution considered.

716:     /// @notice Return the pending extra debt assigned to the Cdp from liquidation redistribution, calcualted by Cdp's stake

726:     /// @return Whether the debt redistribution tracking index of the specified Cdp is less than the global tracking one (meaning it might get pending debt redistribution)

740:     /// @notice Calculate the Cdps entire debt and coll, including pending debt redistributions and collateral reduction from split fee.

781:     /// @dev calculate pending state change to be applied for given CDP and global split index(typically already synced):
```

- *CollSurplusPool.sol* ( [14](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CollSurplusPool.sol#L14), [36](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CollSurplusPool.sol#L36) ):

```solidity
14: /// @dev While an owner could have multiple different sized Cdps, the remaining surplus colateral from all of its closed Cdp

36:      * @dev One-time initialization function. Can only be called by the owner as a security measure. Ownership is renounced after the function is called.
```

- *EbtcBase.sol* ( [24](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/EbtcBase.sol#L24), [66](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/EbtcBase.sol#L66) ):

```solidity
24:     // Critical system collateral ratio. If the system's total collateral ratio (TCR) falls below the CCR, Recovery Mode is triggered.

66:     /// @dev Collateral tokens stored in ActivePool for liquidator rewards, fees, or coll in CollSurplusPool, are not included
```

- *ReentrancyGuard.sol* ( [6](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/ReentrancyGuard.sol#L6) ):

```solidity
6: /// @author Modified from OpenZeppelin (https://github.com/OpenZeppelin/openzeppelin-contracts/blob/master/contracts/security/ReentrancyGuard.sol)
```

- *RolesAuthority.sol* ( [10](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/RolesAuthority.sol#L10), [61](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/RolesAuthority.sol#L61) ):

```solidity
10: /// @author Modified from Solmate (https://github.com/transmissions11/solmate/blob/main/src/auth/authorities/RolesAuthority.sol)

61:             - That capability is public, or the user has a role that has been granted the capability to call the function
```

- *EBTCToken.sol* ( [16](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/EBTCToken.sol#L16), [21](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/EBTCToken.sol#L21) ):

```solidity
16:  * https://github.com/OpenZeppelin/openzeppelin-contracts/blob/53516bc555a454862470e7860a9b5254db4d00f5/contracts/token/ERC20/ERC20Permit.sol

21:  * 1) Transfer protection: blocklist of addresses that are invalid recipients (i.e. core Ebtc contracts) in external transfer() and transferFrom() calls.
```

- *Governor.sol* ( [9](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Governor.sol#L9), [11](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Governor.sol#L11) ):

```solidity
9: /// @notice We have taken the tradeoff of additional storage usage for easier readabiliy without using off-chain / indexing services.

11: /// @author Modified from Solmate (https://github.com/transmissions11/solmate/blob/main/src/auth/authorities/RolesAuthority.sol)
```

- *HintHelpers.sol* ( [9](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/HintHelpers.sol#L9), [100](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/HintHelpers.sol#L100) ):

```solidity
9: /// @title HintHelpers mainly serves to provide handy information to facilitate offchain integration like redemption bots.

100:                     // If the partial redemption would leave the CDP with less than the minimum allowed coll, bail out of partial redemption and return only the fully redeemable
```

- *LeverageMacroBase.sol* ( [24](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LeverageMacroBase.sol#L24), [233](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LeverageMacroBase.sol#L233), [413](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LeverageMacroBase.sol#L413), [426](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LeverageMacroBase.sol#L426), [496](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LeverageMacroBase.sol#L496) ):

```solidity
24: /// @custom:known-issue Due to slippage some dust amounts for all intermediary tokens can be left, since there's no way to ask to sell all available

233:     /// @dev If you delegatecall into this, this will transfer the tokens to the caller of the DiamondLike (and not the contract)

413:         // But technically you could approve w/e you want here, this is fine because the contract is a router and will not hold user funds

426:         // val -> 0 -> 0 -> val means this is safe to repeat since even if full approve is unused, we always go back to 0 after

496:     /// @dev excessivelySafeCall to perform generic calls without getting gas bombed | useful if you don't care about return value
```

- *LiquidationLibrary.sol* ( [12](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LiquidationLibrary.sol#L12), [37](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LiquidationLibrary.sol#L37), [134](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LiquidationLibrary.sol#L134), [311](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LiquidationLibrary.sol#L311), [675](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LiquidationLibrary.sol#L675) ):

```solidity
12: /// @dev This contract shares same base and storage layout with CdpManager and is the delegatecall destination from CdpManager

37:     /// @notice callable by anyone, attempts to liquidate the CdpId. Executes successfully if Cdp meets the conditions for liquidation (e.g. in Normal Mode, it liquidates if the Cdp's ICR < the system MCR).

134:     // For partial liquidation, caller should use HintHelper smart contract to get correct hints for reinsertion into sorted CDP list

311:         // I don't see an issue emitting the CdpUpdated() event up here and avoiding an extra cache of the values, any objections?

675:     /// @notice Steps through the provided list and attempts to liquidate every Cdp, until it reaches the end or it runs out of gas.
```

- *PriceFeed.sol* ( [31](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/PriceFeed.sol#L31), [96](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/PriceFeed.sol#L96), [97](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/PriceFeed.sol#L97), [166](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/PriceFeed.sol#L166), [173](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/PriceFeed.sol#L173), [296](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/PriceFeed.sol#L296), [308](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/PriceFeed.sol#L308), [326](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/PriceFeed.sol#L326), [345](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/PriceFeed.sol#L345), [394](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/PriceFeed.sol#L394), [396](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/PriceFeed.sol#L396), [408](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/PriceFeed.sol#L408), [432](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/PriceFeed.sol#L432), [444](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/PriceFeed.sol#L444), [521](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/PriceFeed.sol#L521), [530](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/PriceFeed.sol#L530), [538](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/PriceFeed.sol#L538), [579](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/PriceFeed.sol#L579), [605](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/PriceFeed.sol#L605), [686](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/PriceFeed.sol#L686), [771](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/PriceFeed.sol#L771) ):

```solidity
31:     // Maximum time period allowed since Chainlink's latest round data timestamp, beyond which Chainlink is considered frozen.

96:     /// @dev Uses a main oracle (Chainlink) and a fallback oracle in case Chainlink fails. If both fail, it uses the last good price seen by eBTC.

97:     /// @dev The fallback oracle address can be swapped by the Authority. The fallback oracle must conform to the IFallbackCaller interface.

166:                  * If Fallback is live and both oracles have a similar price, conclude that Chainlink's large price deviation between

173:                 // If Fallback is live but the oracles differ too much in price, conclude that Chainlink's initial price deviation was

296:             // If Chainlink is live and Fallback is frozen, just use last good price (no status change) since we have no basis for comparison

308:             // Otherwise if Chainlink is live but price not within 5% of Fallback, distrust Chainlink, and return Fallback price

326:             // If Chainlink and Fallback are both live, unbroken and similar price, switch back to chainlinkWorking and return Chainlink price

345:             // Otherwise if Chainlink is live and deviated <50% from it's previous price and Fallback is still untrusted,

394:     /// @dev Chainlink is considered broken if its current or previous round data is in any way bad. We check the previous round for two reasons.

396:     /// @dev 2. Chainlink is the PriceFeed's preferred primary oracle - having two consecutive valid round responses adds peace of mind when using or returning to Chainlink.

408:     /// @dev A response is considered bad if the success value reports failure, or if the timestamp is invalid (0 or in the future)

432:     /// @dev The oracle is considered frozen if either of the feed timestamps are older than the threshold specified by the static timeout thresholds

444:     /// @return A boolean indicating whether the price change from Chainlink oracle is above the maximum threshold allowed

521:     /// @notice Checks if the prices reported by the Chainlink and fallback oracles are similar, within the maximum deviation specified by MAX_PRICE_DIFFERENCE_BETWEEN_ORACLES.

530:         // Get the relative price difference between the oracles. Use the lower price as the denominator, i.e. the reference for the calculation.

538:          * Return true if the relative price difference is <= MAX_PRICE_DIFFERENCE_BETWEEN_ORACLES: if so, we assume both oracles are probably reporting

579:     /// @notice Retrieves the latest response from the fallback oracle. If the fallback oracle address is set to the zero address, it returns a failing struct.

605:     /// @return chainlinkResponse A struct containing data retrieved from the price feeds, including the round IDs, timestamps, aggregated price, and a success flag.

686:     /// @return prevChainlinkResponse A struct containing data retrieved from the price feeds, including the round IDs, timestamps, aggregated price, and a success flag.

771:     /// @notice Returns if the CL feed is healthy or not, based on: negative value and null round id. For price aggregation
```

- *SimplifiedDiamondLike.sol* ( [16](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SimplifiedDiamondLike.sol#L16) ):

```solidity
16:  *  Per solidity, hardcoded functions are switched into, meaning they cannot be overriden (although you could set a callbackHandler that cannot be reached)
```

- *SortedCdps.sol* ( [21](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L21), [37](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L37), [40](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L40), [100](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L100), [134](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L134), [148](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L148), [171](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L171), [280](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L280), [283](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L283), [309](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L309), [606](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L606) ):

```solidity
21:  * The list relies on the fact that liquidation events preserve ordering: a liquidation decreases the NICRs of all active Cdps,

37:  * - Ordering checks for insertion are performed by comparing an NICR argument to the current NICR, calculated at runtime.

40:  * - Public functions with parameters have been made internal to save gas, and given an external wrapper function for external access

100:     /// @dev Inspired https://github.com/balancer-labs/balancer-v2-monorepo/blob/18bd5fb5d87b451cc27fbd30b276d1fb2987b529/pkg/vault/contracts/PoolRegistry.sol

134:     /// @notice Find a specific CDP for a given owner, indexed by it's place in the linked list relative to other Cdps owned by the same address

148:     /// @dev a pagination-flavor search (from least ICR to biggest ICR) for CDP owned by given owner and specified index (starting at given CDP)

171:     /// @return cdpId The CDP Id if found, otherwise return current lastly-visited CDP as the startNode for next pagination

280:     /// @dev a pagination-flavor search retrieval of (from least ICR to biggest ICR) Cdps owned by given owner (starting at given CDP)

283:     /// @return all CdpIds of the specified owner found by search starting at the specified startNodeId for the specified maximum iteration count

309:         // Two-pass strategy, halving the amount of Cdps we can process before relying on pagination or off-chain methods

606:             // `(_prevId, _nextId)` is a valid insert position if they are adjacent nodes and `_NICR` falls between the two nodes' NICRs
```

</details>

### [N&#x2011;37] Magic numbers should be replaced with constants

Magic numbers are hard-coded values in code that can make it difficult for developers and maintainers to understand the code, and can also cause confusion or errors. To improve the readability and maintainability of code, it is recommended to replace magic numbers with constants that have good readability.

There are 5 instances:

- *CdpManagerStorage.sol* ( [148](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L148) ):

```solidity
/// @audit 999037758833783000
148:     uint256 public minuteDecayFactor = 999037758833783000;
```

- *ERC3156FlashLender.sol* ( [14](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/ERC3156FlashLender.sol#L14) ):

```solidity
/// @audit 3
14:     uint16 public feeBps = 3; // may be subject to future adjustments through protocol governance
```

- *EbtcMath.sol* ( [60](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/EbtcMath.sol#L60), [61](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/EbtcMath.sol#L61) ):

```solidity
/// @audit 525600000
60:         if (_minutes > 525600000) {

/// @audit 525600000
61:             _minutes = 525600000;
```

- *SimplifiedDiamondLike.sol* ( [56](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SimplifiedDiamondLike.sol#L56) ):

```solidity
/// @audit 0x94b24d09
56:         require(sig != 0x94b24d09);
```

### [N&#x2011;38] Expressions for constant values should use `immutable` rather than `constant`

While it doesn't save any gas because the compiler knows that developers often make this mistake, it's still best to use the right tool for the task at hand. There is a difference between `constant` variables and `immutable` variables, and they should each be used in their appropriate contexts. `constants` should be used for literal values written into the code, and `immutable` variables should be used for expressions, or values calculated in, or passed into the constructor.

<details>
<summary>There are 5 instances (click to show):</summary>

- *BorrowerOperations.sol* ( [32-35](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L32-L35) ):

```solidity
32:     bytes32 private constant _PERMIT_POSITION_MANAGER_TYPEHASH =
33:         keccak256(
34:             "PermitPositionManagerApproval(address borrower,address positionManager,uint8 status,uint256 nonce,uint256 deadline)"
35:         );
```

- *CdpManagerStorage.sol* ( [141](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L141) ):

```solidity
141:     uint256 public constant MIN_REDEMPTION_FEE_FLOOR = (DECIMAL_PRECISION * 5) / 1000; // 0.5%
```

- *ERC3156FlashLender.sol* ( [11](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/ERC3156FlashLender.sol#L11) ):

```solidity
11:     bytes32 public constant FLASH_SUCCESS_VALUE = keccak256("ERC3156FlashBorrower.onFlashLoan");
```

- *LeverageMacroBase.sol* ( [37](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LeverageMacroBase.sol#L37) ):

```solidity
37:     bytes32 constant FLASH_LOAN_SUCCESS = keccak256("ERC3156FlashBorrower.onFlashLoan");
```

- *SimplifiedDiamondLike.sol* ( [39](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SimplifiedDiamondLike.sol#L39) ):

```solidity
39:     bytes32 constant DIAMOND_STORAGE_POSITION = keccak256("diamond.standard.diamond.storage");
```

</details>

### [N&#x2011;39] Use `@inheritdoc` for overridden functions

It is recommended to use `@inheritdoc` for overridden functions.

<details>
<summary>There are 36 instances (click to show):</summary>

- *ActivePool.sol* ( [70-74](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/ActivePool.sol#L70-L74), [78-82](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/ActivePool.sol#L78-L82), [86-89](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/ActivePool.sol#L86-L89) ):

```solidity
70:     /// @notice Amount of stETH collateral shares in the contract
71:     /// @dev Not necessarily equal to the the contract's raw systemCollShares balance - tokens can be forcibly sent to contracts
72:     /// @return uint256 The amount of systemCollShares allocated to the pool
73: 
74:     function getSystemCollShares() external view override returns (uint256) {

78:     /// @notice Returns the systemDebt state variable
79:     /// @dev The amount of EBTC debt in the pool. Like systemCollShares, this is not necessarily equal to the contract's EBTC token balance - tokens can be forcibly sent to contracts
80:     /// @return uint256 The amount of EBTC debt in the pool
81: 
82:     function getSystemDebt() external view override returns (uint256) {

86:     /// @notice The amount of stETH collateral shares claimable by the fee recipient
87:     /// @return uint256 The amount of collateral shares claimable by the fee recipient
88: 
89:     function getFeeRecipientClaimableCollShares() external view override returns (uint256) {
```

- *BorrowerOperations.sol* ( [596-599](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L596-L599), [663-665](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L663-L665), [685-687](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L685-L687), [691-693](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L691-L693) ):

```solidity
596:     /// @notice Claim remaining collateral from a redemption or from a liquidation with ICR > MCR in Recovery Mode
597:     /// @notice when a Cdp has been fully redeemed from and closed, or liquidated in Recovery Mode with a collateralization ratio higher enough (like over MCR)
598:     /// @notice the borrower is allowed to claim their stETH collateral surplus that remains in the system if any
599:     function claimSurplusCollShares() external override {

663:     /// @notice This function returns the domain separator for current chain
664:     /// @return EIP712 compatible Domain definition
665:     function domainSeparator() public view override returns (bytes32) {

685:     /// @notice This function returns the version parameter for the EIP712 domain
686:     /// @return EIP712 compatible version parameter
687:     function version() external pure override returns (string memory) {

691:     /// @notice This function returns hash of the fully encoded EIP712 message for the permitPositionManagerApproval.
692:     /// @return EIP712 compatible hash of Positon Manager permit
693:     function permitTypeHash() external pure override returns (bytes32) {
```

- *CdpManager.sol* ( [64-66](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L64-L66), [637-638](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L637-L638), [642-643](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L642-L643) ):

```solidity
64:     /// @notice Get the count of active Cdps in the system
65:     /// @return The number of current active Cdps (not closed) in the system.
66:     function getActiveCdpsCount() external view override returns (uint256) {

637:     /// @return current fee rate for redemption with base rate
638:     function getRedemptionRate() public view override returns (uint256) {

642:     /// @return current fee rate for redemption with decayed base rate
643:     function getRedemptionRateWithDecay() public view override returns (uint256) {
```

- *CollSurplusPool.sol* ( [60-61](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CollSurplusPool.sol#L60-L61) ):

```solidity
60:     /// @return The current total collateral surplus available in this pool
61:     function getTotalSurplusCollShares() external view override returns (uint256) {
```

- *RolesAuthority.sol* ( [58-67](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/RolesAuthority.sol#L58-L67) ):

```solidity
58:     /**
59:         @notice A user can call a given function signature on a given target address if:
60:             - The capability has not been burned
61:             - That capability is public, or the user has a role that has been granted the capability to call the function
62:      */
63:     function canCall(
64:         address user,
65:         address target,
66:         bytes4 functionSig
67:     ) public view virtual override returns (bool) {
```

- *EBTCToken.sol* ( [111](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/EBTCToken.sol#L111), [115](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/EBTCToken.sol#L115), [119](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/EBTCToken.sol#L119), [125](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/EBTCToken.sol#L125), [129](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/EBTCToken.sol#L129), [134-138](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/EBTCToken.sol#L134-L138), [152-155](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/EBTCToken.sol#L152-L155), [160-163](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/EBTCToken.sol#L160-L163), [180-182](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/EBTCToken.sol#L180-L182), [329-331](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/EBTCToken.sol#L329-L331), [335-337](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/EBTCToken.sol#L335-L337), [341-343](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/EBTCToken.sol#L341-L343), [347-349](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/EBTCToken.sol#L347-L349), [353-355](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/EBTCToken.sol#L353-L355) ):

```solidity
111:     function totalSupply() external view override returns (uint256) {

115:     function balanceOf(address account) external view override returns (uint256) {

119:     function transfer(address recipient, uint256 amount) external override returns (bool) {

125:     function allowance(address owner, address spender) external view override returns (uint256) {

129:     function approve(address spender, uint256 amount) external override returns (bool) {

134:     function transferFrom(
135:         address sender,
136:         address recipient,
137:         uint256 amount
138:     ) external override returns (bool) {

152:     function increaseAllowance(
153:         address spender,
154:         uint256 addedValue
155:     ) external override returns (bool) {

160:     function decreaseAllowance(
161:         address spender,
162:         uint256 subtractedValue
163:     ) external override returns (bool) {

180:     /// @notice This function returns the domain separator for current chain
181:     /// @return EIP712 compatible Domain definition
182:     function domainSeparator() public view override returns (bytes32) {

329:     /// @notice Returns the name of the token
330:     /// @return Name of the token
331:     function name() external pure override returns (string memory) {

335:     /// @notice Returns the symbol of the token
336:     /// @return Symbol of the token
337:     function symbol() external pure override returns (string memory) {

341:     /// @notice Returns the number of decimals used to represent token amounts
342:     /// @return Number of decimals used by the token
343:     function decimals() external pure override returns (uint8) {

347:     /// @notice Returns the version of the token
348:     /// @return Version of the token
349:     function version() external pure override returns (string memory) {

353:     /// @notice Returns the type hash used for permit() function as per EIP-2612
354:     /// @return EIP-2612 permit type hash
355:     function permitTypeHash() external pure override returns (bytes32) {
```

- *LeverageMacroDelegateTarget.sol* ( [62-63](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LeverageMacroDelegateTarget.sol#L62-L63) ):

```solidity
62:     /// @dev Call self, since this is called via delegate call, and get owner
63:     function owner() public override returns (address) {
```

- *LeverageMacroReference.sol* ( [44](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LeverageMacroReference.sol#L44) ):

```solidity
44:     function owner() public override returns (address) {
```

- *PriceFeed.sol* ( [93-98](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/PriceFeed.sol#L93-L98) ):

```solidity
93:     /// @notice Returns the latest price obtained from the Oracle
94:     /// @dev Called by eBTC functions that require a current price. Also callable permissionlessly.
95:     /// @dev Non-view function - it updates and stores the last good price seen by eBTC.
96:     /// @dev Uses a main oracle (Chainlink) and a fallback oracle in case Chainlink fails. If both fail, it uses the last good price seen by eBTC.
97:     /// @dev The fallback oracle address can be swapped by the Authority. The fallback oracle must conform to the IFallbackCaller interface.
98:     function fetchPrice() external override returns (uint256) {
```

- *SortedCdps.sol* ( [128-130](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L128-L130), [528-530](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L528-L530), [534-536](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L534-L536), [540-542](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L540-L542), [546-548](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L546-L548), [552-554](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L552-L554), [558-560](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L558-L560) ):

```solidity
128:     /// @notice Get dummy non-existent CDP Id
129:     /// @return Dummy non-existent CDP Id
130:     function nonExistId() public pure override returns (bytes32) {

528:     /// @dev Checks if the list is full
529:     /// @return true if the list is full, false otherwise
530:     function isFull() public view override returns (bool) {

534:     /// @dev Checks if the list is empty
535:     /// @return true if the list is empty, false otherwise
536:     function isEmpty() public view override returns (bool) {

540:     /// @dev Returns the current size of the list
541:     /// @return The current size of the list
542:     function getSize() external view override returns (uint256) {

546:     /// @dev Returns the maximum size of the list
547:     /// @return The maximum size of the list
548:     function getMaxSize() external view override returns (uint256) {

552:     /// @dev Returns the first node in the list (node with the largest NICR)
553:     /// @return The Id of the first node
554:     function getFirst() external view override returns (bytes32) {

558:     /// @dev Returns the last node in the list (node with the smallest NICR)
559:     /// @return The Id of the last node
560:     function getLast() external view override returns (bytes32) {
```

</details>

### [N&#x2011;40] Contracts should have NatSpec `@author` tags

Contracts should have NatSpec `@author` tags

<details>
<summary>There are 36 instances (click to show):</summary>

- *ActivePool.sol* ( [22](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/ActivePool.sol#L22) ):

```solidity
22: contract ActivePool is IActivePool, ERC3156FlashLender, ReentrancyGuard, BaseMath, AuthNoOwner {
```

- *BorrowerOperations.sol* ( [21](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L21) ):

```solidity
21: contract BorrowerOperations is
```

- *CdpManager.sol* ( [16](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L16) ):

```solidity
16: contract CdpManager is CdpManagerStorage, ICdpManager, Proxy {
```

- *CdpManagerStorage.sol* ( [19](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L19) ):

```solidity
19: contract CdpManagerStorage is EbtcBase, ReentrancyGuard, ICdpManagerData, AuthNoOwner {
```

- *CollSurplusPool.sol* ( [16](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CollSurplusPool.sol#L16) ):

```solidity
16: contract CollSurplusPool is ICollSurplusPool, ReentrancyGuard, AuthNoOwner {
```

- *ERC3156FlashLender.sol* ( [8](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/ERC3156FlashLender.sol#L8) ):

```solidity
8: abstract contract ERC3156FlashLender is IERC3156FlashLender {
```

- *EbtcBase.sol* ( [16](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/EbtcBase.sol#L16) ):

```solidity
16: contract EbtcBase is BaseMath, IEbtcBase {
```

- *EbtcMath.sol* ( [5](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/EbtcMath.sol#L5) ):

```solidity
5: library EbtcMath {
```

- *EBTCToken.sol* ( [26](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/EBTCToken.sol#L26) ):

```solidity
26: contract EBTCToken is IEBTCToken, AuthNoOwner, PermitNonce {
```

- *HintHelpers.sol* ( [11](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/HintHelpers.sol#L11) ):

```solidity
11: contract HintHelpers is EbtcBase {
```

- *IActivePool.sol* ( [7](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IActivePool.sol#L7) ):

```solidity
7: interface IActivePool is IPool {
```

- *IBorrowerOperations.sol* ( [7](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IBorrowerOperations.sol#L7) ):

```solidity
7: interface IBorrowerOperations is IPositionManagers {
```

- *ICdpManager.sol* ( [9](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManager.sol#L9) ):

```solidity
9: interface ICdpManager is IEbtcBase, ICdpManagerData {
```

- *ICdpManagerData.sol* ( [13](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManagerData.sol#L13) ):

```solidity
13: interface ICdpManagerData is IRecoveryModeGracePeriod {
```

- *ICollSurplusPool.sol* ( [5](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICollSurplusPool.sol#L5) ):

```solidity
5: interface ICollSurplusPool {
```

- *IEBTCToken.sol* ( [8](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IEBTCToken.sol#L8) ):

```solidity
8: interface IEBTCToken is IERC20, IERC2612 {
```

- *IERC3156FlashBorrower.sol* ( [5](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IERC3156FlashBorrower.sol#L5) ):

```solidity
5: interface IERC3156FlashBorrower {
```

- *IERC3156FlashLender.sol* ( [7](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IERC3156FlashLender.sol#L7) ):

```solidity
7: interface IERC3156FlashLender {
```

- *IEbtcBase.sol* ( [7](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IEbtcBase.sol#L7) ):

```solidity
7: interface IEbtcBase {
```

- *IFallbackCaller.sol* ( [5](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IFallbackCaller.sol#L5) ):

```solidity
5: interface IFallbackCaller {
```

- *IPermitNonce.sol* ( [5](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IPermitNonce.sol#L5) ):

```solidity
5: interface IPermitNonce {
```

- *IPool.sol* ( [6](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IPool.sol#L6) ):

```solidity
6: interface IPool {
```

- *IPositionManagers.sol* ( [5](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IPositionManagers.sol#L5) ):

```solidity
5: interface IPositionManagers {
```

- *IPriceFeed.sol* ( [5](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IPriceFeed.sol#L5) ):

```solidity
5: interface IPriceFeed {
```

- *IRecoveryModeGracePeriod.sol* ( [5](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IRecoveryModeGracePeriod.sol#L5) ):

```solidity
5: interface IRecoveryModeGracePeriod {
```

- *ISortedCdps.sol* ( [6](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ISortedCdps.sol#L6) ):

```solidity
6: interface ISortedCdps {
```

- *LeverageMacroBase.sol* ( [14](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LeverageMacroBase.sol#L14), [26](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LeverageMacroBase.sol#L26) ):

```solidity
14: interface ICdpCdps {

26: contract LeverageMacroBase {
```

- *LeverageMacroDelegateTarget.sol* ( [6](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LeverageMacroDelegateTarget.sol#L6), [40](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LeverageMacroDelegateTarget.sol#L40) ):

```solidity
6: interface IOwnerLike {

40: contract LeverageMacroDelegateTarget is LeverageMacroBase {
```

- *LeverageMacroFactory.sol* ( [11](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LeverageMacroFactory.sol#L11) ):

```solidity
11: contract LeverageMacroFactory {
```

- *LeverageMacroReference.sol* ( [11](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LeverageMacroReference.sol#L11) ):

```solidity
11: contract LeverageMacroReference is LeverageMacroBase {
```

- *LiquidationLibrary.sol* ( [13](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LiquidationLibrary.sol#L13) ):

```solidity
13: contract LiquidationLibrary is CdpManagerStorage {
```

- *PriceFeed.sol* ( [21](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/PriceFeed.sol#L21) ):

```solidity
21: contract PriceFeed is BaseMath, IPriceFeed, AuthNoOwner {
```

- *SimplifiedDiamondLike.sol* ( [25](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SimplifiedDiamondLike.sol#L25) ):

```solidity
25: contract SimplifiedDiamondLike {
```

- *SortedCdps.sol* ( [51](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L51) ):

```solidity
51: contract SortedCdps is ISortedCdps {
```

</details>

### [N&#x2011;41] Contracts should have `@notice` tags

The `@notice` is used to explain to users what the contract does. The compiler interprets `///` or `/**` comments [as this tag](https://docs.soliditylang.org/en/latest/natspec-format.html#tags) if one wasn't explicitly provided.

<details>
<summary>There are 24 instances (click to show):</summary>

- *ERC3156FlashLender.sol* ( [8](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/ERC3156FlashLender.sol#L8) ):

```solidity
8: abstract contract ERC3156FlashLender is IERC3156FlashLender {
```

- *EbtcBase.sol* ( [16](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/EbtcBase.sol#L16) ):

```solidity
16: contract EbtcBase is BaseMath, IEbtcBase {
```

- *EbtcMath.sol* ( [5](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/EbtcMath.sol#L5) ):

```solidity
5: library EbtcMath {
```

- *EBTCToken.sol* ( [26](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/EBTCToken.sol#L26) ):

```solidity
26: contract EBTCToken is IEBTCToken, AuthNoOwner, PermitNonce {
```

- *IActivePool.sol* ( [7](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IActivePool.sol#L7) ):

```solidity
7: interface IActivePool is IPool {
```

- *IBorrowerOperations.sol* ( [7](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IBorrowerOperations.sol#L7) ):

```solidity
7: interface IBorrowerOperations is IPositionManagers {
```

- *ICdpManager.sol* ( [9](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManager.sol#L9) ):

```solidity
9: interface ICdpManager is IEbtcBase, ICdpManagerData {
```

- *ICdpManagerData.sol* ( [13](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManagerData.sol#L13) ):

```solidity
13: interface ICdpManagerData is IRecoveryModeGracePeriod {
```

- *ICollSurplusPool.sol* ( [5](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICollSurplusPool.sol#L5) ):

```solidity
5: interface ICollSurplusPool {
```

- *IEBTCToken.sol* ( [8](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IEBTCToken.sol#L8) ):

```solidity
8: interface IEBTCToken is IERC20, IERC2612 {
```

- *IERC3156FlashBorrower.sol* ( [5](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IERC3156FlashBorrower.sol#L5) ):

```solidity
5: interface IERC3156FlashBorrower {
```

- *IERC3156FlashLender.sol* ( [7](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IERC3156FlashLender.sol#L7) ):

```solidity
7: interface IERC3156FlashLender {
```

- *IEbtcBase.sol* ( [7](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IEbtcBase.sol#L7) ):

```solidity
7: interface IEbtcBase {
```

- *IFallbackCaller.sol* ( [5](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IFallbackCaller.sol#L5) ):

```solidity
5: interface IFallbackCaller {
```

- *IPermitNonce.sol* ( [5](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IPermitNonce.sol#L5) ):

```solidity
5: interface IPermitNonce {
```

- *IPool.sol* ( [6](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IPool.sol#L6) ):

```solidity
6: interface IPool {
```

- *IPositionManagers.sol* ( [5](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IPositionManagers.sol#L5) ):

```solidity
5: interface IPositionManagers {
```

- *IPriceFeed.sol* ( [5](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IPriceFeed.sol#L5) ):

```solidity
5: interface IPriceFeed {
```

- *IRecoveryModeGracePeriod.sol* ( [5](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IRecoveryModeGracePeriod.sol#L5) ):

```solidity
5: interface IRecoveryModeGracePeriod {
```

- *ISortedCdps.sol* ( [6](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ISortedCdps.sol#L6) ):

```solidity
6: interface ISortedCdps {
```

- *LeverageMacroBase.sol* ( [14](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LeverageMacroBase.sol#L14) ):

```solidity
14: interface ICdpCdps {
```

- *LeverageMacroDelegateTarget.sol* ( [6](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LeverageMacroDelegateTarget.sol#L6) ):

```solidity
6: interface IOwnerLike {
```

- *PriceFeed.sol* ( [21](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/PriceFeed.sol#L21) ):

```solidity
21: contract PriceFeed is BaseMath, IPriceFeed, AuthNoOwner {
```

- *SortedCdps.sol* ( [51](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L51) ):

```solidity
51: contract SortedCdps is ISortedCdps {
```

</details>

### [N&#x2011;42] Contracts should have NatSpec `@title` tags

Some contract definitions have an incomplete NatSpec: add a `@title` notation to describe the contract to improve the code documentation.

<details>
<summary>There are 30 instances (click to show):</summary>

- *CollSurplusPool.sol* ( [16](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CollSurplusPool.sol#L16) ):

```solidity
16: contract CollSurplusPool is ICollSurplusPool, ReentrancyGuard, AuthNoOwner {
```

- *Auth.sol* ( [9](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/Auth.sol#L9) ):

```solidity
9: abstract contract Auth {
```

- *AuthNoOwner.sol* ( [10](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/AuthNoOwner.sol#L10) ):

```solidity
10: contract AuthNoOwner {
```

- *ERC3156FlashLender.sol* ( [8](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/ERC3156FlashLender.sol#L8) ):

```solidity
8: abstract contract ERC3156FlashLender is IERC3156FlashLender {
```

- *EbtcBase.sol* ( [16](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/EbtcBase.sol#L16) ):

```solidity
16: contract EbtcBase is BaseMath, IEbtcBase {
```

- *EbtcMath.sol* ( [5](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/EbtcMath.sol#L5) ):

```solidity
5: library EbtcMath {
```

- *ReentrancyGuard.sol* ( [7](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/ReentrancyGuard.sol#L7) ):

```solidity
7: abstract contract ReentrancyGuard {
```

- *RolesAuthority.sol* ( [12](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/RolesAuthority.sol#L12) ):

```solidity
12: contract RolesAuthority is IRolesAuthority, Auth, Authority {
```

- *EBTCToken.sol* ( [26](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/EBTCToken.sol#L26) ):

```solidity
26: contract EBTCToken is IEBTCToken, AuthNoOwner, PermitNonce {
```

- *Governor.sol* ( [13](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Governor.sol#L13) ):

```solidity
13: contract Governor is RolesAuthority {
```

- *IActivePool.sol* ( [7](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IActivePool.sol#L7) ):

```solidity
7: interface IActivePool is IPool {
```

- *IBorrowerOperations.sol* ( [7](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IBorrowerOperations.sol#L7) ):

```solidity
7: interface IBorrowerOperations is IPositionManagers {
```

- *ICdpManager.sol* ( [9](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManager.sol#L9) ):

```solidity
9: interface ICdpManager is IEbtcBase, ICdpManagerData {
```

- *ICdpManagerData.sol* ( [13](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManagerData.sol#L13) ):

```solidity
13: interface ICdpManagerData is IRecoveryModeGracePeriod {
```

- *ICollSurplusPool.sol* ( [5](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICollSurplusPool.sol#L5) ):

```solidity
5: interface ICollSurplusPool {
```

- *IEBTCToken.sol* ( [8](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IEBTCToken.sol#L8) ):

```solidity
8: interface IEBTCToken is IERC20, IERC2612 {
```

- *IERC3156FlashBorrower.sol* ( [5](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IERC3156FlashBorrower.sol#L5) ):

```solidity
5: interface IERC3156FlashBorrower {
```

- *IERC3156FlashLender.sol* ( [7](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IERC3156FlashLender.sol#L7) ):

```solidity
7: interface IERC3156FlashLender {
```

- *IEbtcBase.sol* ( [7](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IEbtcBase.sol#L7) ):

```solidity
7: interface IEbtcBase {
```

- *IFallbackCaller.sol* ( [5](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IFallbackCaller.sol#L5) ):

```solidity
5: interface IFallbackCaller {
```

- *IPermitNonce.sol* ( [5](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IPermitNonce.sol#L5) ):

```solidity
5: interface IPermitNonce {
```

- *IPool.sol* ( [6](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IPool.sol#L6) ):

```solidity
6: interface IPool {
```

- *IPositionManagers.sol* ( [5](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IPositionManagers.sol#L5) ):

```solidity
5: interface IPositionManagers {
```

- *IPriceFeed.sol* ( [5](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IPriceFeed.sol#L5) ):

```solidity
5: interface IPriceFeed {
```

- *IRecoveryModeGracePeriod.sol* ( [5](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IRecoveryModeGracePeriod.sol#L5) ):

```solidity
5: interface IRecoveryModeGracePeriod {
```

- *ISortedCdps.sol* ( [6](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ISortedCdps.sol#L6) ):

```solidity
6: interface ISortedCdps {
```

- *LeverageMacroBase.sol* ( [14](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LeverageMacroBase.sol#L14) ):

```solidity
14: interface ICdpCdps {
```

- *LeverageMacroDelegateTarget.sol* ( [6](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LeverageMacroDelegateTarget.sol#L6) ):

```solidity
6: interface IOwnerLike {
```

- *PriceFeed.sol* ( [21](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/PriceFeed.sol#L21) ):

```solidity
21: contract PriceFeed is BaseMath, IPriceFeed, AuthNoOwner {
```

- *SortedCdps.sol* ( [51](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L51) ):

```solidity
51: contract SortedCdps is ISortedCdps {
```

</details>

### [N&#x2011;43] Events missing NatSpec `@param` tag

Each modifier parameter should have a `@param` notation to improve the code documentation.

<details>
<summary>There are 122 instances (click to show):</summary>

- *Auth.sol* ( [10](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/Auth.sol#L10), [12](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/Auth.sol#L12) ):

```solidity
/// @audit Missing @param for `user`, `newOwner`
10:     event OwnershipTransferred(address indexed user, address indexed newOwner);

/// @audit Missing @param for `user`, `newAuthority`
12:     event AuthorityUpdated(address indexed user, Authority indexed newAuthority);
```

- *AuthNoOwner.sol* ( [11](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/AuthNoOwner.sol#L11) ):

```solidity
/// @audit Missing @param for `user`, `newAuthority`
11:     event AuthorityUpdated(address indexed user, Authority indexed newAuthority);
```

- *Governor.sol* ( [32](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Governor.sol#L32) ):

```solidity
/// @audit Missing @param for `role`, `name`
32:     event RoleNameSet(uint8 indexed role, string indexed name);
```

- *IActivePool.sol* ( [9](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IActivePool.sol#L9), [10](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IActivePool.sol#L10), [11](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IActivePool.sol#L11), [12](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IActivePool.sol#L12), [13](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IActivePool.sol#L13), [14-19](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IActivePool.sol#L14-L19), [20](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IActivePool.sol#L20) ):

```solidity
/// @audit Missing @param for `_EBTCDebt`
9:     event ActivePoolEBTCDebtUpdated(uint256 _EBTCDebt);

/// @audit Missing @param for `_coll`
10:     event SystemCollSharesUpdated(uint256 _coll);

/// @audit Missing @param for `_feeRecipientAddress`
11:     event FeeRecipientAddressChanged(address indexed _feeRecipientAddress);

/// @audit Missing @param for `_coll`, `_fee`
12:     event FeeRecipientClaimableCollSharesIncreased(uint256 _coll, uint256 _fee);

/// @audit Missing @param for `_coll`, `_fee`
13:     event FeeRecipientClaimableCollSharesDecreased(uint256 _coll, uint256 _fee);

/// @audit Missing @param for `_receiver`, `_token`, `_amount`, `_fee`
14:     event FlashLoanSuccess(
15:         address indexed _receiver,
16:         address indexed _token,
17:         uint256 _amount,
18:         uint256 _fee
19:     );

/// @audit Missing @param for `_token`, `_amount`, `_recipient`
20:     event SweepTokenSuccess(address indexed _token, uint256 _amount, address indexed _recipient);
```

- *IBorrowerOperations.sol* ( [10](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IBorrowerOperations.sol#L10), [11-16](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IBorrowerOperations.sol#L11-L16) ):

```solidity
/// @audit Missing @param for `_feeRecipientAddress`
10:     event FeeRecipientAddressChanged(address indexed _feeRecipientAddress);

/// @audit Missing @param for `_receiver`, `_token`, `_amount`, `_fee`
11:     event FlashLoanSuccess(
12:         address indexed _receiver,
13:         address indexed _token,
14:         uint256 _amount,
15:         uint256 _fee
16:     );
```

- *ICdpManagerData.sol* ( [16](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManagerData.sol#L16), [17](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManagerData.sol#L17), [18](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManagerData.sol#L18), [19](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManagerData.sol#L19), [20](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManagerData.sol#L20), [21](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManagerData.sol#L21), [23](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManagerData.sol#L23), [24-30](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManagerData.sol#L24-L30), [31-41](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManagerData.sol#L31-L41), [42-50](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManagerData.sol#L42-L50), [51-59](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManagerData.sol#L51-L59), [60](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManagerData.sol#L60), [61](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManagerData.sol#L61), [62](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManagerData.sol#L62), [63](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManagerData.sol#L63), [64](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManagerData.sol#L64), [65](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManagerData.sol#L65), [66](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManagerData.sol#L66), [67](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManagerData.sol#L67), [68](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManagerData.sol#L68), [69-75](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManagerData.sol#L69-L75) ):

```solidity
/// @audit Missing @param for `_feeRecipientAddress`
16:     event FeeRecipientAddressChanged(address indexed _feeRecipientAddress);

/// @audit Missing @param for `_stakingRewardSplit`
17:     event StakingRewardSplitSet(uint256 _stakingRewardSplit);

/// @audit Missing @param for `_redemptionFeeFloor`
18:     event RedemptionFeeFloorSet(uint256 _redemptionFeeFloor);

/// @audit Missing @param for `_minuteDecayFactor`
19:     event MinuteDecayFactorSet(uint256 _minuteDecayFactor);

/// @audit Missing @param for `_beta`
20:     event BetaSet(uint256 _beta);

/// @audit Missing @param for `_paused`
21:     event RedemptionsPaused(bool _paused);

/// @audit Missing @param for `_liquidatedDebt`, `_liquidatedColl`, `_liqReward`
23:     event Liquidation(uint256 _liquidatedDebt, uint256 _liquidatedColl, uint256 _liqReward);

/// @audit Missing @param for `_debtToRedeemExpected`, `_debtToRedeemActual`, `_collSharesSent`, `_feeCollShares`, `_redeemer`
24:     event Redemption(
25:         uint256 _debtToRedeemExpected,
26:         uint256 _debtToRedeemActual,
27:         uint256 _collSharesSent,
28:         uint256 _feeCollShares,
29:         address indexed _redeemer
30:     );

/// @audit Missing @param for `_cdpId`, `_borrower`, `_executor`, `_oldDebt`, `_oldCollShares`, `_debt`, `_collShares`, `_stake`, `_operation`
31:     event CdpUpdated(
32:         bytes32 indexed _cdpId,
33:         address indexed _borrower,
34:         address indexed _executor,
35:         uint256 _oldDebt,
36:         uint256 _oldCollShares,
37:         uint256 _debt,
38:         uint256 _collShares,
39:         uint256 _stake,
40:         CdpOperation _operation
41:     );

/// @audit Missing @param for `_cdpId`, `_borrower`, `_debt`, `_collShares`, `_operation`, `_liquidator`, `_premiumToLiquidator`
42:     event CdpLiquidated(
43:         bytes32 indexed _cdpId,
44:         address indexed _borrower,
45:         uint _debt,
46:         uint _collShares,
47:         CdpOperation _operation,
48:         address indexed _liquidator,
49:         uint _premiumToLiquidator
50:     );

/// @audit Missing @param for `_cdpId`, `_borrower`, `_debt`, `_collShares`, `operation`, `_liquidator`, `_premiumToLiquidator`
51:     event CdpPartiallyLiquidated(
52:         bytes32 indexed _cdpId,
53:         address indexed _borrower,
54:         uint256 _debt,
55:         uint256 _collShares,
56:         CdpOperation operation,
57:         address indexed _liquidator,
58:         uint _premiumToLiquidator
59:     );

/// @audit Missing @param for `_baseRate`
60:     event BaseRateUpdated(uint256 _baseRate);

/// @audit Missing @param for `_lastFeeOpTime`
61:     event LastRedemptionTimestampUpdated(uint256 _lastFeeOpTime);

/// @audit Missing @param for `_newTotalStakes`
62:     event TotalStakesUpdated(uint256 _newTotalStakes);

/// @audit Missing @param for `_totalStakesSnapshot`, `_totalCollateralSnapshot`
63:     event SystemSnapshotsUpdated(uint256 _totalStakesSnapshot, uint256 _totalCollateralSnapshot);

/// @audit Missing @param for `_systemDebtRedistributionIndex`
64:     event SystemDebtRedistributionIndexUpdated(uint256 _systemDebtRedistributionIndex);

/// @audit Missing @param for `_cdpId`, `_cdpDebtRedistributionIndex`
65:     event CdpDebtRedistributionIndexUpdated(bytes32 _cdpId, uint256 _cdpDebtRedistributionIndex);

/// @audit Missing @param for `_cdpId`, `_newIndex`
66:     event CdpArrayIndexUpdated(bytes32 _cdpId, uint256 _newIndex);

/// @audit Missing @param for `_oldIndex`, `_newIndex`, `_updTimestamp`
67:     event StEthIndexUpdated(uint256 _oldIndex, uint256 _newIndex, uint256 _updTimestamp);

/// @audit Missing @param for `_oldPerUnit`, `_newPerUnit`, `_feeTaken`
68:     event CollateralFeePerUnitUpdated(uint256 _oldPerUnit, uint256 _newPerUnit, uint256 _feeTaken);

/// @audit Missing @param for `_cdpId`, `_oldPerUnitCdp`, `_newPerUnitCdp`, `_collReduced`, `_collLeft`
69:     event CdpFeeSplitApplied(
70:         bytes32 _cdpId,
71:         uint256 _oldPerUnitCdp,
72:         uint256 _newPerUnitCdp,
73:         uint256 _collReduced,
74:         uint256 _collLeft
75:     );
```

- *ICollSurplusPool.sol* ( [8](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICollSurplusPool.sol#L8), [9](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICollSurplusPool.sol#L9), [11](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICollSurplusPool.sol#L11) ):

```solidity
/// @audit Missing @param for `_account`, `_newBalance`
8:     event SurplusCollSharesUpdated(address indexed _account, uint256 _newBalance);

/// @audit Missing @param for `_to`, `_amount`
9:     event CollSharesTransferred(address indexed _to, uint256 _amount);

/// @audit Missing @param for `_token`, `_amount`, `_recipient`
11:     event SweepTokenSuccess(address indexed _token, uint256 _amount, address indexed _recipient);
```

- *IERC3156FlashLender.sol* ( [8](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IERC3156FlashLender.sol#L8), [9](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IERC3156FlashLender.sol#L9), [10](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IERC3156FlashLender.sol#L10) ):

```solidity
/// @audit Missing @param for `_setter`, `_oldFee`, `_newFee`
8:     event FlashFeeSet(address indexed _setter, uint256 _oldFee, uint256 _newFee);

/// @audit Missing @param for `_setter`, `_oldMaxFee`, `_newMaxFee`
9:     event MaxFlashFeeSet(address indexed _setter, uint256 _oldMaxFee, uint256 _newMaxFee);

/// @audit Missing @param for `_setter`, `_paused`
10:     event FlashLoansPaused(address indexed _setter, bool _paused);
```

- *IFallbackCaller.sol* ( [7](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IFallbackCaller.sol#L7) ):

```solidity
/// @audit Missing @param for `_oldTimeOut`, `_newTimeOut`
7:     event FallbackTimeOutChanged(uint256 _oldTimeOut, uint256 _newTimeOut);
```

- *IPool.sol* ( [9](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IPool.sol#L9), [10](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IPool.sol#L10), [11](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IPool.sol#L11) ):

```solidity
/// @audit Missing @param for `_newBalance`
9:     event ETHBalanceUpdated(uint256 _newBalance);

/// @audit Missing @param for `_newBalance`
10:     event EBTCBalanceUpdated(uint256 _newBalance);

/// @audit Missing @param for `_to`, `_amount`
11:     event CollSharesTransferred(address indexed _to, uint256 _amount);
```

- *IPositionManagers.sol* ( [12-16](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IPositionManagers.sol#L12-L16) ):

```solidity
/// @audit Missing @param for `_borrower`, `_positionManager`, `_approval`
12:     event PositionManagerApprovalSet(
13:         address indexed _borrower,
14:         address indexed _positionManager,
15:         PositionManagerApproval _approval
16:     );
```

- *IPriceFeed.sol* ( [7](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IPriceFeed.sol#L7), [8](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IPriceFeed.sol#L8), [9-12](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IPriceFeed.sol#L9-L12), [13](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IPriceFeed.sol#L13) ):

```solidity
/// @audit Missing @param for `_lastGoodPrice`
7:     event LastGoodPriceUpdated(uint256 _lastGoodPrice);

/// @audit Missing @param for `newStatus`
8:     event PriceFeedStatusChanged(Status newStatus);

/// @audit Missing @param for `_oldFallbackCaller`, `_newFallbackCaller`
9:     event FallbackCallerChanged(
10:         address indexed _oldFallbackCaller,
11:         address indexed _newFallbackCaller
12:     );

/// @audit Missing @param for `_fallbackCaller`, `timestamp`
13:     event UnhealthyFallbackCaller(address indexed _fallbackCaller, uint256 timestamp);
```

- *IRecoveryModeGracePeriod.sol* ( [6](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IRecoveryModeGracePeriod.sol#L6), [11](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IRecoveryModeGracePeriod.sol#L11) ):

```solidity
/// @audit Missing @param for `TCR`
6:     event TCRNotified(uint256 TCR); /// NOTE: Mostly for debugging to ensure synch

/// @audit Missing @param for `_recoveryModeGracePeriodDuration`
11:     event GracePeriodDurationSet(uint256 _recoveryModeGracePeriodDuration);
```

- *ISortedCdps.sol* ( [9](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ISortedCdps.sol#L9), [10](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ISortedCdps.sol#L10) ):

```solidity
/// @audit Missing @param for `_id`, `_NICR`
9:     event NodeAdded(bytes32 _id, uint _NICR);

/// @audit Missing @param for `_id`
10:     event NodeRemoved(bytes32 _id);
```

- *LeverageMacroFactory.sol* ( [19](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LeverageMacroFactory.sol#L19) ):

```solidity
/// @audit Missing @param for `sender`, `newContractAddress`
19:     event DeployNewMacro(address indexed sender, address indexed newContractAddress);
```

</details>

### [N&#x2011;44] Event declarations should have NatSpec descriptions

Event declarations should have NatSpec descriptions

<details>
<summary>There are 56 instances (click to show):</summary>

- *Auth.sol* ( [10](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/Auth.sol#L10), [12](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/Auth.sol#L12) ):

```solidity
10:     event OwnershipTransferred(address indexed user, address indexed newOwner);

12:     event AuthorityUpdated(address indexed user, Authority indexed newAuthority);
```

- *AuthNoOwner.sol* ( [11](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/AuthNoOwner.sol#L11) ):

```solidity
11:     event AuthorityUpdated(address indexed user, Authority indexed newAuthority);
```

- *Governor.sol* ( [32](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Governor.sol#L32) ):

```solidity
32:     event RoleNameSet(uint8 indexed role, string indexed name);
```

- *IActivePool.sol* ( [9](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IActivePool.sol#L9), [10](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IActivePool.sol#L10), [11](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IActivePool.sol#L11), [12](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IActivePool.sol#L12), [13](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IActivePool.sol#L13), [14-19](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IActivePool.sol#L14-L19), [20](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IActivePool.sol#L20) ):

```solidity
9:     event ActivePoolEBTCDebtUpdated(uint256 _EBTCDebt);

10:     event SystemCollSharesUpdated(uint256 _coll);

11:     event FeeRecipientAddressChanged(address indexed _feeRecipientAddress);

12:     event FeeRecipientClaimableCollSharesIncreased(uint256 _coll, uint256 _fee);

13:     event FeeRecipientClaimableCollSharesDecreased(uint256 _coll, uint256 _fee);

14:     event FlashLoanSuccess(
15:         address indexed _receiver,
16:         address indexed _token,
17:         uint256 _amount,
18:         uint256 _fee
19:     );

20:     event SweepTokenSuccess(address indexed _token, uint256 _amount, address indexed _recipient);
```

- *IBorrowerOperations.sol* ( [10](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IBorrowerOperations.sol#L10), [11-16](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IBorrowerOperations.sol#L11-L16) ):

```solidity
10:     event FeeRecipientAddressChanged(address indexed _feeRecipientAddress);

11:     event FlashLoanSuccess(
12:         address indexed _receiver,
13:         address indexed _token,
14:         uint256 _amount,
15:         uint256 _fee
16:     );
```

- *ICdpManagerData.sol* ( [16](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManagerData.sol#L16), [17](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManagerData.sol#L17), [18](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManagerData.sol#L18), [19](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManagerData.sol#L19), [20](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManagerData.sol#L20), [21](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManagerData.sol#L21), [23](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManagerData.sol#L23), [24-30](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManagerData.sol#L24-L30), [31-41](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManagerData.sol#L31-L41), [42-50](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManagerData.sol#L42-L50), [51-59](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManagerData.sol#L51-L59), [60](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManagerData.sol#L60), [61](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManagerData.sol#L61), [62](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManagerData.sol#L62), [63](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManagerData.sol#L63), [64](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManagerData.sol#L64), [65](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManagerData.sol#L65), [66](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManagerData.sol#L66), [67](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManagerData.sol#L67), [68](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManagerData.sol#L68), [69-75](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManagerData.sol#L69-L75) ):

```solidity
16:     event FeeRecipientAddressChanged(address indexed _feeRecipientAddress);

17:     event StakingRewardSplitSet(uint256 _stakingRewardSplit);

18:     event RedemptionFeeFloorSet(uint256 _redemptionFeeFloor);

19:     event MinuteDecayFactorSet(uint256 _minuteDecayFactor);

20:     event BetaSet(uint256 _beta);

21:     event RedemptionsPaused(bool _paused);

23:     event Liquidation(uint256 _liquidatedDebt, uint256 _liquidatedColl, uint256 _liqReward);

24:     event Redemption(
25:         uint256 _debtToRedeemExpected,
26:         uint256 _debtToRedeemActual,
27:         uint256 _collSharesSent,
28:         uint256 _feeCollShares,
29:         address indexed _redeemer
30:     );

31:     event CdpUpdated(
32:         bytes32 indexed _cdpId,
33:         address indexed _borrower,
34:         address indexed _executor,
35:         uint256 _oldDebt,
36:         uint256 _oldCollShares,
37:         uint256 _debt,
38:         uint256 _collShares,
39:         uint256 _stake,
40:         CdpOperation _operation
41:     );

42:     event CdpLiquidated(
43:         bytes32 indexed _cdpId,
44:         address indexed _borrower,
45:         uint _debt,
46:         uint _collShares,
47:         CdpOperation _operation,
48:         address indexed _liquidator,
49:         uint _premiumToLiquidator
50:     );

51:     event CdpPartiallyLiquidated(
52:         bytes32 indexed _cdpId,
53:         address indexed _borrower,
54:         uint256 _debt,
55:         uint256 _collShares,
56:         CdpOperation operation,
57:         address indexed _liquidator,
58:         uint _premiumToLiquidator
59:     );

60:     event BaseRateUpdated(uint256 _baseRate);

61:     event LastRedemptionTimestampUpdated(uint256 _lastFeeOpTime);

62:     event TotalStakesUpdated(uint256 _newTotalStakes);

63:     event SystemSnapshotsUpdated(uint256 _totalStakesSnapshot, uint256 _totalCollateralSnapshot);

64:     event SystemDebtRedistributionIndexUpdated(uint256 _systemDebtRedistributionIndex);

65:     event CdpDebtRedistributionIndexUpdated(bytes32 _cdpId, uint256 _cdpDebtRedistributionIndex);

66:     event CdpArrayIndexUpdated(bytes32 _cdpId, uint256 _newIndex);

67:     event StEthIndexUpdated(uint256 _oldIndex, uint256 _newIndex, uint256 _updTimestamp);

68:     event CollateralFeePerUnitUpdated(uint256 _oldPerUnit, uint256 _newPerUnit, uint256 _feeTaken);

69:     event CdpFeeSplitApplied(
70:         bytes32 _cdpId,
71:         uint256 _oldPerUnitCdp,
72:         uint256 _newPerUnitCdp,
73:         uint256 _collReduced,
74:         uint256 _collLeft
75:     );
```

- *ICollSurplusPool.sol* ( [8](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICollSurplusPool.sol#L8), [9](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICollSurplusPool.sol#L9), [11](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICollSurplusPool.sol#L11) ):

```solidity
8:     event SurplusCollSharesUpdated(address indexed _account, uint256 _newBalance);

9:     event CollSharesTransferred(address indexed _to, uint256 _amount);

11:     event SweepTokenSuccess(address indexed _token, uint256 _amount, address indexed _recipient);
```

- *IERC3156FlashLender.sol* ( [8](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IERC3156FlashLender.sol#L8), [9](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IERC3156FlashLender.sol#L9), [10](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IERC3156FlashLender.sol#L10) ):

```solidity
8:     event FlashFeeSet(address indexed _setter, uint256 _oldFee, uint256 _newFee);

9:     event MaxFlashFeeSet(address indexed _setter, uint256 _oldMaxFee, uint256 _newMaxFee);

10:     event FlashLoansPaused(address indexed _setter, bool _paused);
```

- *IFallbackCaller.sol* ( [7](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IFallbackCaller.sol#L7) ):

```solidity
7:     event FallbackTimeOutChanged(uint256 _oldTimeOut, uint256 _newTimeOut);
```

- *IPool.sol* ( [9](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IPool.sol#L9), [10](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IPool.sol#L10), [11](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IPool.sol#L11) ):

```solidity
9:     event ETHBalanceUpdated(uint256 _newBalance);

10:     event EBTCBalanceUpdated(uint256 _newBalance);

11:     event CollSharesTransferred(address indexed _to, uint256 _amount);
```

- *IPositionManagers.sol* ( [12-16](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IPositionManagers.sol#L12-L16) ):

```solidity
12:     event PositionManagerApprovalSet(
13:         address indexed _borrower,
14:         address indexed _positionManager,
15:         PositionManagerApproval _approval
16:     );
```

- *IPriceFeed.sol* ( [7](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IPriceFeed.sol#L7), [8](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IPriceFeed.sol#L8), [9-12](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IPriceFeed.sol#L9-L12), [13](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IPriceFeed.sol#L13) ):

```solidity
7:     event LastGoodPriceUpdated(uint256 _lastGoodPrice);

8:     event PriceFeedStatusChanged(Status newStatus);

9:     event FallbackCallerChanged(
10:         address indexed _oldFallbackCaller,
11:         address indexed _newFallbackCaller
12:     );

13:     event UnhealthyFallbackCaller(address indexed _fallbackCaller, uint256 timestamp);
```

- *IRecoveryModeGracePeriod.sol* ( [6](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IRecoveryModeGracePeriod.sol#L6), [9](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IRecoveryModeGracePeriod.sol#L9), [10](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IRecoveryModeGracePeriod.sol#L10), [11](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IRecoveryModeGracePeriod.sol#L11) ):

```solidity
6:     event TCRNotified(uint256 TCR); /// NOTE: Mostly for debugging to ensure synch

9:     event GracePeriodStart();

10:     event GracePeriodEnd();

11:     event GracePeriodDurationSet(uint256 _recoveryModeGracePeriodDuration);
```

- *ISortedCdps.sol* ( [9](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ISortedCdps.sol#L9), [10](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ISortedCdps.sol#L10) ):

```solidity
9:     event NodeAdded(bytes32 _id, uint _NICR);

10:     event NodeRemoved(bytes32 _id);
```

- *LeverageMacroFactory.sol* ( [19](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LeverageMacroFactory.sol#L19) ):

```solidity
19:     event DeployNewMacro(address indexed sender, address indexed newContractAddress);
```

</details>

### [N&#x2011;45] Functions missing NatSpec `@param` tag

Each function parameter should have a `@param` notation to improve the code documentation.

<details>
<summary>There are 578 instances (click to show):</summary>

- *BorrowerOperations.sol* ( [107-116](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L107-L116), [328-336](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L328-L336), [439-445](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L439-L445), [615-618](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L615-L618), [635-639](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L635-L639), [677-681](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L677-L681), [744-747](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L744-L747), [760](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L760), [790](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L790), [796](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L796), [803-806](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L803-L806), [813-817](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L813-L817), [824](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L824), [829](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L829), [834](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L834), [838](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L838), [845](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L845), [852-857](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L852-L857), [910](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L910), [917](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L917), [921](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L921), [928](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L928), [935](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L935), [939](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L939), [946](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L946), [953-956](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L953-L956), [963](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L963), [986-989](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L986-L989), [1004-1012](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L1004-L1012), [1030-1037](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L1030-L1037), [1049-1055](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L1049-L1055) ):

```solidity
/// @audit Missing @param for `_cdpManagerAddress`, `_activePoolAddress`, `_collSurplusPoolAddress`, `_priceFeedAddress`, `_sortedCdpsAddress`, `_ebtcTokenAddress`, `_feeRecipientAddress`, `_collTokenAddress`
107:     constructor(
108:         address _cdpManagerAddress,
109:         address _activePoolAddress,
110:         address _collSurplusPoolAddress,
111:         address _priceFeedAddress,
112:         address _sortedCdpsAddress,
113:         address _ebtcTokenAddress,
114:         address _feeRecipientAddress,
115:         address _collTokenAddress
116:     ) EbtcBase(_activePoolAddress, _priceFeedAddress, _collTokenAddress) {

/// @audit Missing @param for `_cdpId`, `_stEthBalanceDecrease`, `_debtChange`, `_isDebtIncrease`, `_upperHint`, `_lowerHint`, `_stEthBalanceIncrease`
328:     function _adjustCdpInternal(
329:         bytes32 _cdpId,
330:         uint256 _stEthBalanceDecrease,
331:         uint256 _debtChange,
332:         bool _isDebtIncrease,
333:         bytes32 _upperHint,
334:         bytes32 _lowerHint,
335:         uint256 _stEthBalanceIncrease
336:     ) internal {

/// @audit Missing @param for `_debt`, `_upperHint`, `_lowerHint`, `_stEthBalance`, `_borrower`
439:     function _openCdp(
440:         uint256 _debt,
441:         bytes32 _upperHint,
442:         bytes32 _lowerHint,
443:         uint256 _stEthBalance,
444:         address _borrower
445:     ) internal returns (bytes32) {

/// @audit Missing @param for `_borrower`, `_positionManager`
615:     function _getPositionManagerApproval(
616:         address _borrower,
617:         address _positionManager
618:     ) internal view returns (PositionManagerApproval) {

/// @audit Missing @param for `_borrower`, `_positionManager`, `_approval`
635:     function _setPositionManagerApproval(
636:         address _borrower,
637:         address _positionManager,
638:         PositionManagerApproval _approval
639:     ) internal {

/// @audit Missing @param for `typeHash`, `name`, `version`
677:     function _buildDomainSeparator(
678:         bytes32 typeHash,
679:         bytes32 name,
680:         bytes32 version
681:     ) private view returns (bytes32) {

/// @audit Missing @param for `_collReceived`, `_requestedCollWithdrawal`
744:     function _getCollSharesChangeFromStEthChange(
745:         uint256 _collReceived,
746:         uint256 _requestedCollWithdrawal
747:     ) internal view returns (uint256 collSharesChange, bool isCollIncrease) {

/// @audit Missing @param for `_varMvTokens`
760:     function _processTokenMovesFromAdjustment(MoveTokensParams memory _varMvTokens) internal {

/// @audit Missing @param for `_account`, `_debt`
790:     function _withdrawDebt(address _account, uint256 _debt) internal {

/// @audit Missing @param for `_account`, `_debt`
796:     function _repayDebt(address _account, uint256 _debt) internal {

/// @audit Missing @param for `_stEthBalanceIncrease`, `_stEthBalanceDecrease`
803:     function _requireSingularCollChange(
804:         uint256 _stEthBalanceIncrease,
805:         uint256 _stEthBalanceDecrease
806:     ) internal pure {

/// @audit Missing @param for `_stEthBalanceIncrease`, `_debtChange`, `_stEthBalanceDecrease`
813:     function _requireNonZeroAdjustment(
814:         uint256 _stEthBalanceIncrease,
815:         uint256 _debtChange,
816:         uint256 _stEthBalanceDecrease
817:     ) internal pure {

/// @audit Missing @param for `_cdpManager`, `_cdpId`
824:     function _requireCdpisActive(ICdpManager _cdpManager, bytes32 _cdpId) internal view {

/// @audit Missing @param for `_cdpId`
829:     function _requireCdpIsNonExistent(bytes32 _cdpId) internal view {

/// @audit Missing @param for `_debtChange`
834:     function _requireNonZeroDebtChange(uint _debtChange) internal pure {

/// @audit Missing @param for `_tcr`
838:     function _requireNotInRecoveryMode(uint256 _tcr) internal view {

/// @audit Missing @param for `_stEthBalanceDecrease`
845:     function _requireNoStEthBalanceDecrease(uint256 _stEthBalanceDecrease) internal pure {

/// @audit Missing @param for `_isRecoveryMode`, `_stEthBalanceDecrease`, `_isDebtIncrease`, `_vars`
852:     function _requireValidAdjustmentInCurrentMode(
853:         bool _isRecoveryMode,
854:         uint256 _stEthBalanceDecrease,
855:         bool _isDebtIncrease,
856:         AdjustCdpLocals memory _vars
857:     ) internal {

/// @audit Missing @param for `_newICR`
910:     function _requireICRisNotBelowMCR(uint256 _newICR) internal pure {

/// @audit Missing @param for `_newICR`
917:     function _requireICRisNotBelowCCR(uint256 _newICR) internal pure {

/// @audit Missing @param for `_newICR`, `_oldICR`
921:     function _requireNoDecreaseOfICR(uint256 _newICR, uint256 _oldICR) internal pure {

/// @audit Missing @param for `_newTCR`
928:     function _requireNewTCRisNotBelowCCR(uint256 _newTCR) internal pure {

/// @audit Missing @param for `_debt`
935:     function _requireNonZeroDebt(uint256 _debt) internal pure {

/// @audit Missing @param for `_stEthBalance`
939:     function _requireAtLeastMinNetStEthBalance(uint256 _stEthBalance) internal pure {

/// @audit Missing @param for `_currentDebt`, `_debtRepayment`
946:     function _requireValidDebtRepayment(uint256 _currentDebt, uint256 _debtRepayment) internal pure {

/// @audit Missing @param for `_account`, `_debtRepayment`
953:     function _requireSufficientEbtcTokenBalance(
954:         address _account,
955:         uint256 _debtRepayment
956:     ) internal view {

/// @audit Missing @param for `_borrower`
963:     function _requireBorrowerOrPositionManagerAndUpdateManagerApproval(address _borrower) internal {

/// @audit Missing @param for `vars`, `_isDebtIncrease`
986:     function _getNewNominalICRFromCdpChange(
987:         AdjustCdpLocals memory vars,
988:         bool _isDebtIncrease
989:     ) internal pure returns (uint256) {

/// @audit Missing @param for `_collShares`, `_debt`, `_collSharesChange`, `_isCollIncrease`, `_debtChange`, `_isDebtIncrease`, `_price`
1004:     function _getNewICRFromCdpChange(
1005:         uint256 _collShares,
1006:         uint256 _debt,
1007:         uint256 _collSharesChange,
1008:         bool _isCollIncrease,
1009:         uint256 _debtChange,
1010:         bool _isDebtIncrease,
1011:         uint256 _price
1012:     ) internal view returns (uint256) {

/// @audit Missing @param for `_collShares`, `_debt`, `_collSharesChange`, `_isCollIncrease`, `_debtChange`, `_isDebtIncrease`
1030:     function _getNewCdpAmounts(
1031:         uint256 _collShares,
1032:         uint256 _debt,
1033:         uint256 _collSharesChange,
1034:         bool _isCollIncrease,
1035:         uint256 _debtChange,
1036:         bool _isDebtIncrease
1037:     ) internal pure returns (uint256, uint256) {

/// @audit Missing @param for `_stEthBalanceChange`, `_isCollIncrease`, `_debtChange`, `_isDebtIncrease`, `_price`
1049:     function _getNewTCRFromCdpChange(
1050:         uint256 _stEthBalanceChange,
1051:         bool _isCollIncrease,
1052:         uint256 _debtChange,
1053:         bool _isDebtIncrease,
1054:         uint256 _price
1055:     ) internal view returns (uint256) {
```

- *CdpManager.sol* ( [244-250](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L244-L250), [272-275](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L272-L275), [489-493](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L489-L493), [550](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L550), [595-599](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L595-L599), [612-616](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L612-L616), [647](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L647), [655](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L655), [667-670](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L667-L670), [737-741](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L737-L741), [753](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L753), [757](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L757), [761](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L761) ):

```solidity
/// @audit Missing @param for `_cdpId`, `_EBTC`, `_collSurplus`, `_liquidatorRewardShares`, `_borrower`
244:     function _closeCdpByRedemption(
245:         bytes32 _cdpId,
246:         uint256 _EBTC,
247:         uint256 _collSurplus,
248:         uint256 _liquidatorRewardShares,
249:         address _borrower
250:     ) internal {

/// @audit Missing @param for `_firstRedemptionHint`, `_price`
272:     function _isValidFirstRedemptionHint(
273:         bytes32 _firstRedemptionHint,
274:         uint256 _price
275:     ) internal view returns (bool) {

/// @audit Missing @param for `_start`, `_total`, `_end`
489:     function _getCdpIdsToRemove(
490:         bytes32 _start,
491:         uint256 _total,
492:         bytes32 _end
493:     ) internal view returns (bytes32[] memory) {

/// @audit Missing @param for `_cdpId`
550:     function _addCdpIdToArray(bytes32 _cdpId) internal returns (uint128 index) {

/// @audit Missing @param for `_systemCollShares`, `_systemDebt`, `_price`
595:     function _checkPotentialRecoveryMode(
596:         uint256 _systemCollShares,
597:         uint256 _systemDebt,
598:         uint256 _price
599:     ) internal view returns (bool) {

/// @audit Missing @param for `_ETHDrawn`, `_price`, `_totalEBTCSupply`
612:     function _updateBaseRateFromRedemption(
613:         uint256 _ETHDrawn,
614:         uint256 _price,
615:         uint256 _totalEBTCSupply
616:     ) internal returns (uint256) {

/// @audit Missing @param for `_baseRate`
647:     function _calcRedemptionRate(uint256 _baseRate) internal view returns (uint256) {

/// @audit Missing @param for `_ETHDrawn`
655:     function _getRedemptionFee(uint256 _ETHDrawn) internal view returns (uint256) {

/// @audit Missing @param for `_redemptionRate`, `_ETHDrawn`
667:     function _calcRedemptionFee(
668:         uint256 _redemptionRate,
669:         uint256 _ETHDrawn
670:     ) internal pure returns (uint256) {

/// @audit Missing @param for `_redeemer`, `_amount`, `_totalSupply`
737:     function _requireEbtcBalanceCoversRedemptionAndWithinSupply(
738:         address _redeemer,
739:         uint256 _amount,
740:         uint256 _totalSupply
741:     ) internal view {

/// @audit Missing @param for `_amount`
753:     function _requireAmountGreaterThanZero(uint256 _amount) internal pure {

/// @audit Missing @param for `_price`, `_TCR`
757:     function _requireTCRisNotBelowMCR(uint256 _price, uint256 _TCR) internal view {

/// @audit Missing @param for `_maxFeePercentage`
761:     function _requireValidMaxFeePercentage(uint256 _maxFeePercentage) internal view {
```

- *CdpManagerStorage.sol* ( [49](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L49), [63](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L63), [87-91](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L87-L91), [255](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L255), [260](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L260), [293](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L293), [304-306](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L304-L306), [327](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L327), [336](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L336), [344](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L344), [410](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L410), [419](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L419), [431](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L431), [441](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L441), [463](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L463), [489-493](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L489-L493), [539](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L539), [574-578](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L574-L578), [592-598](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L592-L598), [648](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L648), [652](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L652), [701](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L701), [707-711](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L707-L711), [733-735](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L733-L735), [761-764](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L761-L764), [787-791](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L787-L791), [822-824](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L822-L824) ):

```solidity
/// @audit Missing @param for `_tcr`
49:     function _startGracePeriod(uint256 _tcr) internal {

/// @audit Missing @param for `_tcr`
63:     function _endGracePeriod(uint256 _tcr) internal {

/// @audit Missing @param for `systemCollShares`, `systemDebt`, `price`
87:     function _syncGracePeriodForGivenValues(
88:         uint256 systemCollShares,
89:         uint256 systemDebt,
90:         uint256 price
91:     ) internal {

/// @audit Missing @param for `_cdpId`, `closedStatus`
255:     function _closeCdp(bytes32 _cdpId, Status closedStatus) internal {

/// @audit Missing @param for `_cdpId`, `closedStatus`
260:     function _closeCdpWithoutRemovingSortedCdps(bytes32 _cdpId, Status closedStatus) internal {

/// @audit Missing @param for `_collRemainder`
293:     function _updateSystemSnapshotsExcludeCollRemainder(uint256 _collRemainder) internal {

/// @audit Missing @param for `_cdpId`
304:     function _getPendingRedistributedDebt(
305:         bytes32 _cdpId
306:     ) internal view returns (uint256 pendingEBTCDebtReward, uint256 _debtIndexDiff) {

/// @audit Missing @param for `_cdpId`
327:     function _hasRedistributedDebt(bytes32 _cdpId) internal view returns (bool) {

/// @audit Missing @param for `_cdpId`
336:     function _updateRedistributedDebtIndex(bytes32 _cdpId) internal {

/// @audit Missing @param for `_cdpId`
344:     function _syncAccounting(bytes32 _cdpId) internal {

/// @audit Missing @param for `_cdpId`
410:     function _removeStake(bytes32 _cdpId) internal {

/// @audit Missing @param for `_cdpId`
419:     function _updateStakeAndTotalStakes(bytes32 _cdpId) internal returns (uint256) {

/// @audit Missing @param for `_cdpId`
431:     function _updateStakeForCdp(bytes32 _cdpId) internal returns (uint256, uint256) {

/// @audit Missing @param for `_coll`
441:     function _computeNewStake(uint256 _coll) internal view returns (uint256) {

/// @audit Missing @param for `_cdpId`, `cdpIdsArrayLength`
463:     function _removeCdp(bytes32 _cdpId, uint256 cdpIdsArrayLength) internal {

/// @audit Missing @param for `_systemCollShares`, `_systemDebt`, `_price`
489:     function _computeTCRWithGivenSystemValues(
490:         uint256 _systemCollShares,
491:         uint256 _systemDebt,
492:         uint256 _price
493:     ) internal view returns (uint256) {

/// @audit Missing @param for `_oldIndex`, `_newIndex`
539:     function _syncStEthIndex(uint256 _oldIndex, uint256 _newIndex) internal {

/// @audit Missing @param for `_feeTaken`, `_newPerUnit`, `_newErrorPerUnit`
574:     function _takeSplitAndUpdateFeePerUnit(
575:         uint256 _feeTaken,
576:         uint256 _newPerUnit,
577:         uint256 _newErrorPerUnit
578:     ) internal {

/// @audit Missing @param for `_cdpId`, `_newColl`, `_feeSplitDistributed`, `_oldPerUnitCdp`, `_systemStEthFeePerUnitIndex`
592:     function _applyAccumulatedFeeSplit(
593:         bytes32 _cdpId,
594:         uint256 _newColl,
595:         uint256 _feeSplitDistributed,
596:         uint256 _oldPerUnitCdp,
597:         uint256 _systemStEthFeePerUnitIndex
598:     ) internal {

/// @audit Missing @param for `_cdpId`
648:     function _requireCdpIsActive(bytes32 _cdpId) internal view {

/// @audit Missing @param for `CdpOwnersArrayLength`
652:     function _requireMoreThanOneCdpInSystem(uint256 CdpOwnersArrayLength) internal view {

/// @audit Missing @param for `_price`
701:     function getCachedICR(bytes32 _cdpId, uint256 _price) public view returns (uint256) {

/// @audit Missing @param for `currentCollShare`, `currentDebt`, `_price`
707:     function _calculateCR(
708:         uint256 currentCollShare,
709:         uint256 currentDebt,
710:         uint256 _price
711:     ) internal view returns (uint256) {

/// @audit Missing @param for `_cdpId`
733:     function _getSyncedDebtAndCollShares(
734:         bytes32 _cdpId
735:     ) internal view returns (CdpDebtAndCollShares memory) {

/// @audit Missing @param for `_newIndex`, `_oldIndex`
761:     function _calcSyncedGlobalAccounting(
762:         uint256 _newIndex,
763:         uint256 _oldIndex
764:     ) internal view returns (uint256, uint256, uint256) {

/// @audit Missing @param for `_cdpId`, `_cdpPerUnitIdx`, `_systemStEthFeePerUnitIndex`
787:     function _calcSyncedAccounting(
788:         bytes32 _cdpId,
789:         uint256 _cdpPerUnitIdx,
790:         uint256 _systemStEthFeePerUnitIndex
791:     ) internal view returns (uint256, uint256, uint256, uint256, uint256) {

/// @audit Missing @param for `_cdpId`
822:     function _getSyncedCdpDebtAndRedistribution(
823:         bytes32 _cdpId
824:     ) internal view returns (uint256, uint256, uint256) {
```

- *Auth.sol* ( [18](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/Auth.sol#L18), [32](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/Auth.sol#L32), [42](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/Auth.sol#L42), [52](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/Auth.sol#L52) ):

```solidity
/// @audit Missing @param for `_owner`, `_authority`
18:     constructor(address _owner, Authority _authority) {

/// @audit Missing @param for `user`, `functionSig`
32:     function isAuthorized(address user, bytes4 functionSig) internal view virtual returns (bool) {

/// @audit Missing @param for `newAuthority`
42:     function setAuthority(Authority newAuthority) public virtual {

/// @audit Missing @param for `newOwner`
52:     function transferOwnership(address newOwner) public virtual requiresAuth {
```

- *AuthNoOwner.sol* ( [30](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/AuthNoOwner.sol#L30), [38](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/AuthNoOwner.sol#L38), [55](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/AuthNoOwner.sol#L55) ):

```solidity
/// @audit Missing @param for `user`, `functionSig`
30:     function isAuthorized(address user, bytes4 functionSig) internal view virtual returns (bool) {

/// @audit Missing @param for `newAuthority`
38:     function setAuthority(address newAuthority) public virtual {

/// @audit Missing @param for `newAuthority`
55:     function _initializeAuthority(address newAuthority) internal {
```

- *EbtcBase.sol* ( [60](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/EbtcBase.sol#L60), [79](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/EbtcBase.sol#L79), [83-85](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/EbtcBase.sol#L83-L85), [95](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/EbtcBase.sol#L95), [99](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/EbtcBase.sol#L99), [103-107](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/EbtcBase.sol#L103-L107), [115-118](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/EbtcBase.sol#L115-L118), [124](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/EbtcBase.sol#L124), [134](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/EbtcBase.sol#L134), [140](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/EbtcBase.sol#L140) ):

```solidity
/// @audit Missing @param for `_stEthBalance`
60:     function _calcNetStEthBalance(uint256 _stEthBalance) internal pure returns (uint256) {

/// @audit Missing @param for `_price`
79:     function _getCachedTCR(uint256 _price) internal view returns (uint256 TCR) {

/// @audit Missing @param for `_price`
83:     function _getTCRWithSystemDebtAndCollShares(
84:         uint256 _price
85:     ) internal view returns (uint256 TCR, uint256 _coll, uint256 _debt) {

/// @audit Missing @param for `_price`
95:     function _checkRecoveryMode(uint256 _price) internal view returns (bool) {

/// @audit Missing @param for `_tcr`
99:     function _checkRecoveryModeForTCR(uint256 _tcr) internal view returns (bool) {

/// @audit Missing @param for `_fee`, `_amount`, `_maxFeePercentage`
103:     function _requireUserAcceptsFee(
104:         uint256 _fee,
105:         uint256 _amount,
106:         uint256 _maxFeePercentage
107:     ) internal pure {

/// @audit Missing @param for `_debt`, `_price`
115:     function _convertDebtDenominationToBtc(
116:         uint256 _debt,
117:         uint256 _price
118:     ) internal pure returns (uint256) {

/// @audit Missing @param for `_icr`, `_tcr`
124:     function _checkICRAgainstLiqThreshold(uint256 _icr, uint _tcr) internal view returns (bool) {

/// @audit Missing @param for `_icr`
134:     function _checkICRAgainstMCR(uint256 _icr) internal view returns (bool) {

/// @audit Missing @param for `_icr`, `_tcr`
140:     function _checkICRAgainstTCR(uint256 _icr, uint _tcr) internal view returns (bool) {
```

- *EbtcMath.sol* ( [20](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/EbtcMath.sol#L20), [24](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/EbtcMath.sol#L24), [35](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/EbtcMath.sol#L35), [59](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/EbtcMath.sol#L59), [88](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/EbtcMath.sol#L88), [92](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/EbtcMath.sol#L92), [104-108](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/EbtcMath.sol#L104-L108) ):

```solidity
/// @audit Missing @param for `_a`, `_b`
20:     function _min(uint256 _a, uint256 _b) internal pure returns (uint256) {

/// @audit Missing @param for `_a`, `_b`
24:     function _max(uint256 _a, uint256 _b) internal pure returns (uint256) {

/// @audit Missing @param for `x`, `y`
35:     function decMul(uint256 x, uint256 y) internal pure returns (uint256 decProd) {

/// @audit Missing @param for `_base`, `_minutes`
59:     function _decPow(uint256 _base, uint256 _minutes) internal pure returns (uint256) {

/// @audit Missing @param for `_a`, `_b`
88:     function _getAbsoluteDifference(uint256 _a, uint256 _b) internal pure returns (uint256) {

/// @audit Missing @param for `_collShares`, `_debt`
92:     function _computeNominalCR(uint256 _collShares, uint256 _debt) internal pure returns (uint256) {

/// @audit Missing @param for `_stEthBalance`, `_debt`, `_price`
104:     function _computeCR(
105:         uint256 _stEthBalance,
106:         uint256 _debt,
107:         uint256 _price
108:     ) internal pure returns (uint256) {
```

- *RolesAuthority.sol* ( [20](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/RolesAuthority.sol#L20), [38](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/RolesAuthority.sol#L38), [42-46](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/RolesAuthority.sol#L42-L46), [50](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/RolesAuthority.sol#L50), [63-67](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/RolesAuthority.sol#L63-L67), [85-89](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/RolesAuthority.sol#L85-L89), [106-111](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/RolesAuthority.sol#L106-L111), [133](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/RolesAuthority.sol#L133), [147](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/RolesAuthority.sol#L147) ):

```solidity
/// @audit Missing @param for `_owner`, `_authority`
20:     constructor(address _owner, Authority _authority) Auth(_owner, _authority) {}

/// @audit Missing @param for `user`, `role`
38:     function doesUserHaveRole(address user, uint8 role) public view virtual returns (bool) {

/// @audit Missing @param for `role`, `target`, `functionSig`
42:     function doesRoleHaveCapability(
43:         uint8 role,
44:         address target,
45:         bytes4 functionSig
46:     ) public view virtual returns (bool) {

/// @audit Missing @param for `target`, `functionSig`
50:     function isPublicCapability(address target, bytes4 functionSig) public view returns (bool) {

/// @audit Missing @param for `user`, `target`, `functionSig`
63:     function canCall(
64:         address user,
65:         address target,
66:         bytes4 functionSig
67:     ) public view virtual override returns (bool) {

/// @audit Missing @param for `target`, `functionSig`, `enabled`
85:     function setPublicCapability(
86:         address target,
87:         bytes4 functionSig,
88:         bool enabled
89:     ) public virtual requiresAuth {

/// @audit Missing @param for `role`, `target`, `functionSig`, `enabled`
106:     function setRoleCapability(
107:         uint8 role,
108:         address target,
109:         bytes4 functionSig,
110:         bool enabled
111:     ) public virtual requiresAuth {

/// @audit Missing @param for `target`, `functionSig`
133:     function burnCapability(address target, bytes4 functionSig) public virtual requiresAuth {

/// @audit Missing @param for `user`, `role`, `enabled`
147:     function setUserRole(address user, uint8 role, bool enabled) public virtual requiresAuth {
```

- *EBTCToken.sol* ( [115](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/EBTCToken.sol#L115), [119](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/EBTCToken.sol#L119), [125](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/EBTCToken.sol#L125), [129](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/EBTCToken.sol#L129), [134-138](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/EBTCToken.sol#L134-L138), [152-155](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/EBTCToken.sol#L152-L155), [160-163](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/EBTCToken.sol#L160-L163), [235-239](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/EBTCToken.sol#L235-L239), [246](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/EBTCToken.sol#L246), [262](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/EBTCToken.sol#L262), [270](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/EBTCToken.sol#L270), [285](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/EBTCToken.sol#L285), [295](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/EBTCToken.sol#L295) ):

```solidity
/// @audit Missing @param for `account`
115:     function balanceOf(address account) external view override returns (uint256) {

/// @audit Missing @param for `recipient`, `amount`
119:     function transfer(address recipient, uint256 amount) external override returns (bool) {

/// @audit Missing @param for `owner`, `spender`
125:     function allowance(address owner, address spender) external view override returns (uint256) {

/// @audit Missing @param for `spender`, `amount`
129:     function approve(address spender, uint256 amount) external override returns (bool) {

/// @audit Missing @param for `sender`, `recipient`, `amount`
134:     function transferFrom(
135:         address sender,
136:         address recipient,
137:         uint256 amount
138:     ) external override returns (bool) {

/// @audit Missing @param for `spender`, `addedValue`
152:     function increaseAllowance(
153:         address spender,
154:         uint256 addedValue
155:     ) external override returns (bool) {

/// @audit Missing @param for `spender`, `subtractedValue`
160:     function decreaseAllowance(
161:         address spender,
162:         uint256 subtractedValue
163:     ) external override returns (bool) {

/// @audit Missing @param for `typeHash`, `name`, `version`
235:     function _buildDomainSeparator(
236:         bytes32 typeHash,
237:         bytes32 name,
238:         bytes32 version
239:     ) private view returns (bytes32) {

/// @audit Missing @param for `sender`, `recipient`, `amount`
246:     function _transfer(address sender, address recipient, uint256 amount) internal {

/// @audit Missing @param for `account`, `amount`
262:     function _mint(address account, uint256 amount) internal {

/// @audit Missing @param for `account`, `amount`
270:     function _burn(address account, uint256 amount) internal {

/// @audit Missing @param for `owner`, `spender`, `amount`
285:     function _approve(address owner, address spender, uint256 amount) internal {

/// @audit Missing @param for `_recipient`
295:     function _requireValidRecipient(address _recipient) internal view {
```

- *HintHelpers.sol* ( [27-33](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/HintHelpers.sol#L27-L33), [164-168](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/HintHelpers.sol#L164-L168) ):

```solidity
/// @audit Missing @param for `_sortedCdpsAddress`, `_cdpManagerAddress`, `_collateralAddress`, `_activePoolAddress`, `_priceFeedAddress`
27:     constructor(
28:         address _sortedCdpsAddress,
29:         address _cdpManagerAddress,
30:         address _collateralAddress,
31:         address _activePoolAddress,
32:         address _priceFeedAddress
33:     ) EbtcBase(_activePoolAddress, _priceFeedAddress, _collateralAddress) {

/// @audit Missing @param for `_CR`, `_numTrials`, `_inputRandomSeed`
164:     function getApproxHint(
165:         uint256 _CR,
166:         uint256 _numTrials,
167:         uint256 _inputRandomSeed
168:     ) external view returns (bytes32 hint, uint256 diff, uint256 latestRandomSeed) {
```

- *IActivePool.sol* ( [23](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IActivePool.sol#L23), [25](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IActivePool.sol#L25), [27-31](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IActivePool.sol#L27-L31), [33](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IActivePool.sol#L33), [35](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IActivePool.sol#L35), [41](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IActivePool.sol#L41) ):

```solidity
/// @audit Missing @param for `_account`, `_amount`
23:     function transferSystemCollShares(address _account, uint256 _amount) external;

/// @audit Missing @param for `_value`
25:     function increaseSystemCollShares(uint256 _value) external;

/// @audit Missing @param for `_account`, `_shares`, `_liquidatorRewardShares`
27:     function transferSystemCollSharesAndLiquidatorReward(
28:         address _account,
29:         uint256 _shares,
30:         uint256 _liquidatorRewardShares
31:     ) external;

/// @audit Missing @param for `_shares`
33:     function allocateSystemCollSharesToFeeRecipient(uint256 _shares) external;

/// @audit Missing @param for `_shares`
35:     function claimFeeRecipientCollShares(uint256 _shares) external;

/// @audit Missing @param for `_feeRecipientAddress`
41:     function setFeeRecipientAddress(address _feeRecipientAddress) external;
```

- *IBorrowerOperations.sol* ( [20-25](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IBorrowerOperations.sol#L20-L25), [27-33](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IBorrowerOperations.sol#L27-L33), [35-40](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IBorrowerOperations.sol#L35-L40), [42-47](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IBorrowerOperations.sol#L42-L47), [49-54](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IBorrowerOperations.sol#L49-L54), [56-61](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IBorrowerOperations.sol#L56-L61), [63](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IBorrowerOperations.sol#L63), [65-72](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IBorrowerOperations.sol#L65-L72), [74-82](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IBorrowerOperations.sol#L74-L82) ):

```solidity
/// @audit Missing @param for `_EBTCAmount`, `_upperHint`, `_lowerHint`, `_stEthBalance`
20:     function openCdp(
21:         uint256 _EBTCAmount,
22:         bytes32 _upperHint,
23:         bytes32 _lowerHint,
24:         uint256 _stEthBalance
25:     ) external returns (bytes32);

/// @audit Missing @param for `_EBTCAmount`, `_upperHint`, `_lowerHint`, `_collAmount`, `_borrower`
27:     function openCdpFor(
28:         uint _EBTCAmount,
29:         bytes32 _upperHint,
30:         bytes32 _lowerHint,
31:         uint _collAmount,
32:         address _borrower
33:     ) external returns (bytes32);

/// @audit Missing @param for `_cdpId`, `_upperHint`, `_lowerHint`, `_stEthBalanceIncrease`
35:     function addColl(
36:         bytes32 _cdpId,
37:         bytes32 _upperHint,
38:         bytes32 _lowerHint,
39:         uint256 _stEthBalanceIncrease
40:     ) external;

/// @audit Missing @param for `_cdpId`, `_stEthBalanceDecrease`, `_upperHint`, `_lowerHint`
42:     function withdrawColl(
43:         bytes32 _cdpId,
44:         uint256 _stEthBalanceDecrease,
45:         bytes32 _upperHint,
46:         bytes32 _lowerHint
47:     ) external;

/// @audit Missing @param for `_cdpId`, `_amount`, `_upperHint`, `_lowerHint`
49:     function withdrawDebt(
50:         bytes32 _cdpId,
51:         uint256 _amount,
52:         bytes32 _upperHint,
53:         bytes32 _lowerHint
54:     ) external;

/// @audit Missing @param for `_cdpId`, `_amount`, `_upperHint`, `_lowerHint`
56:     function repayDebt(
57:         bytes32 _cdpId,
58:         uint256 _amount,
59:         bytes32 _upperHint,
60:         bytes32 _lowerHint
61:     ) external;

/// @audit Missing @param for `_cdpId`
63:     function closeCdp(bytes32 _cdpId) external;

/// @audit Missing @param for `_cdpId`, `_stEthBalanceDecrease`, `_debtChange`, `isDebtIncrease`, `_upperHint`, `_lowerHint`
65:     function adjustCdp(
66:         bytes32 _cdpId,
67:         uint256 _stEthBalanceDecrease,
68:         uint256 _debtChange,
69:         bool isDebtIncrease,
70:         bytes32 _upperHint,
71:         bytes32 _lowerHint
72:     ) external;

/// @audit Missing @param for `_cdpId`, `_stEthBalanceDecrease`, `_debtChange`, `isDebtIncrease`, `_upperHint`, `_lowerHint`, `_stEthBalanceIncrease`
74:     function adjustCdpWithColl(
75:         bytes32 _cdpId,
76:         uint256 _stEthBalanceDecrease,
77:         uint256 _debtChange,
78:         bool isDebtIncrease,
79:         bytes32 _upperHint,
80:         bytes32 _lowerHint,
81:         uint256 _stEthBalanceIncrease
82:     ) external;
```

- *ICdpManager.sol* ( [13](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManager.sol#L13), [15](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManager.sol#L15), [17-22](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManager.sol#L17-L22), [24](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManager.sol#L24), [26-34](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManager.sol#L26-L34), [36](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManager.sol#L36), [38](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManager.sol#L38), [40](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManager.sol#L40), [46](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManager.sol#L46), [48](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManager.sol#L48), [50](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManager.sol#L50), [52](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManager.sol#L52), [54](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManager.sol#L54), [56](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManager.sol#L56), [58-64](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManager.sol#L58-L64), [66-73](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManager.sol#L66-L73), [75](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManager.sol#L75), [77](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManager.sol#L77) ):

```solidity
/// @audit Missing @param for `_index`
13:     function getIdFromCdpIdsArray(uint256 _index) external view returns (bytes32);

/// @audit Missing @param for `_cdpId`
15:     function liquidate(bytes32 _cdpId) external;

/// @audit Missing @param for `_cdpId`, `_partialAmount`, `_upperPartialHint`, `_lowerPartialHint`
17:     function partiallyLiquidate(
18:         bytes32 _cdpId,
19:         uint256 _partialAmount,
20:         bytes32 _upperPartialHint,
21:         bytes32 _lowerPartialHint
22:     ) external;

/// @audit Missing @param for `_cdpArray`
24:     function batchLiquidateCdps(bytes32[] calldata _cdpArray) external;

/// @audit Missing @param for `_EBTCAmount`, `_firstRedemptionHint`, `_upperPartialRedemptionHint`, `_lowerPartialRedemptionHint`, `_partialRedemptionHintNICR`, `_maxIterations`, `_maxFee`
26:     function redeemCollateral(
27:         uint256 _EBTCAmount,
28:         bytes32 _firstRedemptionHint,
29:         bytes32 _upperPartialRedemptionHint,
30:         bytes32 _lowerPartialRedemptionHint,
31:         uint256 _partialRedemptionHintNICR,
32:         uint256 _maxIterations,
33:         uint256 _maxFee
34:     ) external;

/// @audit Missing @param for `_cdpId`
36:     function updateStakeAndTotalStakes(bytes32 _cdpId) external returns (uint256);

/// @audit Missing @param for `_cdpId`
38:     function syncAccounting(bytes32 _cdpId) external;

/// @audit Missing @param for `_cdpId`, `_borrower`, `_debt`, `_coll`
40:     function closeCdp(bytes32 _cdpId, address _borrower, uint256 _debt, uint256 _coll) external;

/// @audit Missing @param for `_stETHToRedeem`
46:     function getRedemptionFeeWithDecay(uint256 _stETHToRedeem) external view returns (uint256);

/// @audit Missing @param for `_cdpId`
48:     function getCdpStatus(bytes32 _cdpId) external view returns (uint256);

/// @audit Missing @param for `_cdpId`
50:     function getCdpStake(bytes32 _cdpId) external view returns (uint256);

/// @audit Missing @param for `_cdpId`
52:     function getCdpDebt(bytes32 _cdpId) external view returns (uint256);

/// @audit Missing @param for `_cdpId`
54:     function getCdpCollShares(bytes32 _cdpId) external view returns (uint256);

/// @audit Missing @param for `_cdpId`
56:     function getCdpLiquidatorRewardShares(bytes32 _cdpId) external view returns (uint);

/// @audit Missing @param for `_cdpId`, `_debt`, `_coll`, `_liquidatorRewardShares`, `_borrower`
58:     function initializeCdp(
59:         bytes32 _cdpId,
60:         uint256 _debt,
61:         uint256 _coll,
62:         uint256 _liquidatorRewardShares,
63:         address _borrower
64:     ) external;

/// @audit Missing @param for `_cdpId`, `_borrower`, `_coll`, `_debt`, `_newColl`, `_newDebt`
66:     function updateCdp(
67:         bytes32 _cdpId,
68:         address _borrower,
69:         uint256 _coll,
70:         uint256 _debt,
71:         uint256 _newColl,
72:         uint256 _newDebt
73:     ) external;

/// @audit Missing @param for `_price`
75:     function getCachedTCR(uint256 _price) external view returns (uint256);

/// @audit Missing @param for `_price`
77:     function checkRecoveryMode(uint256 _price) external view returns (bool);
```

- *ICdpManagerData.sol* ( [227-230](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManagerData.sol#L227-L230), [236-239](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManagerData.sol#L236-L239), [241](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManagerData.sol#L241), [243](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManagerData.sol#L243), [245](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManagerData.sol#L245), [247](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManagerData.sol#L247), [249](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManagerData.sol#L249), [251](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManagerData.sol#L251), [253](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManagerData.sol#L253), [255](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManagerData.sol#L255), [257](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManagerData.sol#L257), [259-261](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManagerData.sol#L259-L261), [263](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManagerData.sol#L263) ):

```solidity
/// @audit Missing @param for `_newIndex`, `_prevIndex`
227:     function calcFeeUponStakingReward(
228:         uint256 _newIndex,
229:         uint256 _prevIndex
230:     ) external view returns (uint256, uint256, uint256);

/// @audit Missing @param for `_cdpId`, `_systemStEthFeePerUnitIndex`
236:     function getAccumulatedFeeSplitApplied(
237:         bytes32 _cdpId,
238:         uint256 _systemStEthFeePerUnitIndex
239:     ) external view returns (uint256, uint256);

/// @audit Missing @param for `_cdpId`
241:     function getCachedNominalICR(bytes32 _cdpId) external view returns (uint256);

/// @audit Missing @param for `_cdpId`, `_price`
243:     function getCachedICR(bytes32 _cdpId, uint256 _price) external view returns (uint256);

/// @audit Missing @param for `_cdpId`
245:     function getSyncedCdpDebt(bytes32 _cdpId) external view returns (uint256);

/// @audit Missing @param for `_cdpId`
247:     function getSyncedCdpCollShares(bytes32 _cdpId) external view returns (uint256);

/// @audit Missing @param for `_cdpId`, `_price`
249:     function getSyncedICR(bytes32 _cdpId, uint256 _price) external view returns (uint256);

/// @audit Missing @param for `_price`
251:     function getSyncedTCR(uint256 _price) external view returns (uint256);

/// @audit Missing @param for `_cdpId`
253:     function getSyncedNominalICR(bytes32 _cdpId) external view returns (uint256);

/// @audit Missing @param for `_cdpId`
255:     function getPendingRedistributedDebt(bytes32 _cdpId) external view returns (uint256);

/// @audit Missing @param for `_cdpId`
257:     function hasPendingRedistributedDebt(bytes32 _cdpId) external view returns (bool);

/// @audit Missing @param for `_cdpId`
259:     function getSyncedDebtAndCollShares(
260:         bytes32 _cdpId
261:     ) external view returns (uint256 debt, uint256 collShares);

/// @audit Missing @param for `icr`, `tcr`
263:     function canLiquidateRecoveryMode(uint256 icr, uint256 tcr) external view returns (bool);
```

- *ICollSurplusPool.sol* ( [17](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICollSurplusPool.sol#L17), [19](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICollSurplusPool.sol#L19), [21](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICollSurplusPool.sol#L21), [23](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICollSurplusPool.sol#L23) ):

```solidity
/// @audit Missing @param for `_account`
17:     function getSurplusCollShares(address _account) external view returns (uint256);

/// @audit Missing @param for `_account`, `_amount`
19:     function increaseSurplusCollShares(address _account, uint256 _amount) external;

/// @audit Missing @param for `_account`
21:     function claimSurplusCollShares(address _account) external;

/// @audit Missing @param for `_value`
23:     function increaseTotalSurplusCollShares(uint256 _value) external;
```

- *IEBTCToken.sol* ( [11](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IEBTCToken.sol#L11), [13](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IEBTCToken.sol#L13) ):

```solidity
/// @audit Missing @param for `_account`, `_amount`
11:     function mint(address _account, uint256 _amount) external;

/// @audit Missing @param for `_account`, `_amount`
13:     function burn(address _account, uint256 _amount) external;
```

- *IFallbackCaller.sol* ( [21](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IFallbackCaller.sol#L21) ):

```solidity
/// @audit Missing @param for `newFallbackTimeout`
21:     function setFallbackTimeout(uint256 newFallbackTimeout) external;
```

- *IPermitNonce.sol* ( [9](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IPermitNonce.sol#L9) ):

```solidity
/// @audit Missing @param for `owner`
9:     function nonces(address owner) external view returns (uint256);
```

- *IPool.sol* ( [19](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IPool.sol#L19), [21](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IPool.sol#L21) ):

```solidity
/// @audit Missing @param for `_amount`
19:     function increaseSystemDebt(uint256 _amount) external;

/// @audit Missing @param for `_amount`
21:     function decreaseSystemDebt(uint256 _amount) external;
```

- *IPositionManagers.sol* ( [18-21](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IPositionManagers.sol#L18-L21), [23-26](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IPositionManagers.sol#L23-L26), [28](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IPositionManagers.sol#L28), [30](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IPositionManagers.sol#L30), [32-40](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IPositionManagers.sol#L32-L40) ):

```solidity
/// @audit Missing @param for `_borrower`, `_positionManager`
18:     function getPositionManagerApproval(
19:         address _borrower,
20:         address _positionManager
21:     ) external view returns (PositionManagerApproval);

/// @audit Missing @param for `_positionManager`, `_approval`
23:     function setPositionManagerApproval(
24:         address _positionManager,
25:         PositionManagerApproval _approval
26:     ) external;

/// @audit Missing @param for `_positionManager`
28:     function revokePositionManagerApproval(address _positionManager) external;

/// @audit Missing @param for `_borrower`
30:     function renouncePositionManagerApproval(address _borrower) external;

/// @audit Missing @param for `_borrower`, `_positionManager`, `_approval`, `_deadline`, `v`, `r`, `s`
32:     function permitPositionManagerApproval(
33:         address _borrower,
34:         address _positionManager,
35:         PositionManagerApproval _approval,
36:         uint _deadline,
37:         uint8 v,
38:         bytes32 r,
39:         bytes32 s
40:     ) external;
```

- *IRecoveryModeGracePeriod.sol* ( [13](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IRecoveryModeGracePeriod.sol#L13), [15](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IRecoveryModeGracePeriod.sol#L15) ):

```solidity
/// @audit Missing @param for `tcr`
13:     function notifyStartGracePeriod(uint256 tcr) external;

/// @audit Missing @param for `tcr`
15:     function notifyEndGracePeriod(uint256 tcr) external;
```

- *ISortedCdps.sol* ( [14](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ISortedCdps.sol#L14), [16](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ISortedCdps.sol#L16), [18](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ISortedCdps.sol#L18), [20](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ISortedCdps.sol#L20), [34](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ISortedCdps.sol#L34), [36](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ISortedCdps.sol#L36), [38-42](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ISortedCdps.sol#L38-L42), [44-48](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ISortedCdps.sol#L44-L48), [50-55](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ISortedCdps.sol#L50-L55), [57](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ISortedCdps.sol#L57), [61](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ISortedCdps.sol#L61), [63-67](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ISortedCdps.sol#L63-L67), [69](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ISortedCdps.sol#L69), [71-75](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ISortedCdps.sol#L71-L75), [77](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ISortedCdps.sol#L77), [79-84](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ISortedCdps.sol#L79-L84) ):

```solidity
/// @audit Missing @param for `_id`
14:     function remove(bytes32 _id) external;

/// @audit Missing @param for `_ids`
16:     function batchRemove(bytes32[] memory _ids) external;

/// @audit Missing @param for `_id`, `_newICR`, `_prevId`, `_nextId`
18:     function reInsert(bytes32 _id, uint256 _newICR, bytes32 _prevId, bytes32 _nextId) external;

/// @audit Missing @param for `_id`
20:     function contains(bytes32 _id) external view returns (bool);

/// @audit Missing @param for `_id`
34:     function getNext(bytes32 _id) external view returns (bytes32);

/// @audit Missing @param for `_id`
36:     function getPrev(bytes32 _id) external view returns (bytes32);

/// @audit Missing @param for `_ICR`, `_prevId`, `_nextId`
38:     function validInsertPosition(
39:         uint256 _ICR,
40:         bytes32 _prevId,
41:         bytes32 _nextId
42:     ) external view returns (bool);

/// @audit Missing @param for `_ICR`, `_prevId`, `_nextId`
44:     function findInsertPosition(
45:         uint256 _ICR,
46:         bytes32 _prevId,
47:         bytes32 _nextId
48:     ) external view returns (bytes32, bytes32);

/// @audit Missing @param for `owner`, `_ICR`, `_prevId`, `_nextId`
50:     function insert(
51:         address owner,
52:         uint256 _ICR,
53:         bytes32 _prevId,
54:         bytes32 _nextId
55:     ) external returns (bytes32);

/// @audit Missing @param for `_id`
57:     function getOwnerAddress(bytes32 _id) external pure returns (address);

/// @audit Missing @param for `owner`
61:     function cdpCountOf(address owner) external view returns (uint256);

/// @audit Missing @param for `owner`, `startNodeId`, `maxNodes`
63:     function getCdpCountOf(
64:         address owner,
65:         bytes32 startNodeId,
66:         uint maxNodes
67:     ) external view returns (uint256, bytes32);

/// @audit Missing @param for `owner`
69:     function getCdpsOf(address owner) external view returns (bytes32[] memory);

/// @audit Missing @param for `owner`, `startNodeId`, `maxNodes`
71:     function getAllCdpsOf(
72:         address owner,
73:         bytes32 startNodeId,
74:         uint maxNodes
75:     ) external view returns (bytes32[] memory, uint256, bytes32);

/// @audit Missing @param for `owner`, `index`
77:     function cdpOfOwnerByIndex(address owner, uint256 index) external view returns (bytes32);

/// @audit Missing @param for `owner`, `index`, `startNodeId`, `maxNodes`
79:     function cdpOfOwnerByIdx(
80:         address owner,
81:         uint256 index,
82:         bytes32 startNodeId,
83:         uint maxNodes
84:     ) external view returns (bytes32, bool);
```

- *LeverageMacroBase.sol* ( [51-59](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LeverageMacroBase.sol#L51-L59), [118-124](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LeverageMacroBase.sol#L118-L124), [234](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LeverageMacroBase.sol#L234), [244](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LeverageMacroBase.sol#L244), [291](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LeverageMacroBase.sol#L291), [338](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LeverageMacroBase.sol#L338), [344-350](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LeverageMacroBase.sol#L344-L350), [382](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LeverageMacroBase.sol#L382), [398](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LeverageMacroBase.sol#L398), [435](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LeverageMacroBase.sol#L435), [450](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LeverageMacroBase.sol#L450), [460](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LeverageMacroBase.sol#L460), [474](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LeverageMacroBase.sol#L474), [482](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LeverageMacroBase.sol#L482), [498-504](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LeverageMacroBase.sol#L498-L504) ):

```solidity
/// @audit Missing @param for `_borrowerOperationsAddress`, `_activePool`, `_cdpManager`, `_ebtc`, `_coll`, `_sortedCdps`, `_sweepToCaller`
51:     constructor(
52:         address _borrowerOperationsAddress,
53:         address _activePool,
54:         address _cdpManager,
55:         address _ebtc,
56:         address _coll,
57:         address _sortedCdps,
58:         bool _sweepToCaller
59:     ) {

/// @audit Missing @param for `flType`, `borrowAmount`, `operation`, `postCheckType`, `checkParams`
118:     function doOperation(
119:         FlashLoanType flType,
120:         uint256 borrowAmount,
121:         LeverageMacroOperation calldata operation,
122:         PostOperationCheck postCheckType,
123:         PostCheckParams calldata checkParams
124:     ) external {

/// @audit Missing @param for `token`, `amount`
234:     function sweepToken(address token, uint256 amount) public {

/// @audit Missing @param for `check`, `valueToCheck`
244:     function _doCheckValueType(CheckValueAndType memory check, uint256 valueToCheck) internal {

/// @audit Missing @param for `operation`
291:     function _handleOperation(LeverageMacroOperation memory operation) internal {

/// @audit Missing @param for `data`
338:     function decodeFLData(bytes calldata data) public view returns (LeverageMacroOperation memory) {

/// @audit Missing @param for `initiator`, `token`, `amount`, `fee`, `data`
344:     function onFlashLoan(
345:         address initiator,
346:         address token,
347:         uint256 amount,
348:         uint256 fee,
349:         bytes calldata data
350:     ) external returns (bytes32) {

/// @audit Missing @param for `swapData`
382:     function _doSwaps(SwapOperation[] memory swapData) internal {

/// @audit Missing @param for `swapData`
398:     function _doSwap(SwapOperation memory swapData) internal {

/// @audit Missing @param for `swapChecks`
435:     function _doSwapChecks(SwapCheck[] memory swapChecks) internal {

/// @audit Missing @param for `addy`
450:     function _ensureNotSystem(address addy) internal {

/// @audit Missing @param for `data`
460:     function _openCdpCallback(bytes memory data) internal {

/// @audit Missing @param for `data`
474:     function _closeCdpCallback(bytes memory data) internal {

/// @audit Missing @param for `data`
482:     function _adjustCdpCallback(bytes memory data) internal {

/// @audit Missing @param for `_target`, `_gas`, `_value`, `_maxCopy`, `_calldata`
498:     function excessivelySafeCall(
499:         address _target,
500:         uint256 _gas,
501:         uint256 _value,
502:         uint16 _maxCopy,
503:         bytes memory _calldata
504:     ) internal returns (bool, bytes memory) {
```

- *LeverageMacroDelegateTarget.sol* ( [41-48](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LeverageMacroDelegateTarget.sol#L41-L48) ):

```solidity
/// @audit Missing @param for `_borrowerOperationsAddress`, `_activePool`, `_cdpManager`, `_ebtc`, `_coll`, `_sortedCdps`
41:     constructor(
42:         address _borrowerOperationsAddress,
43:         address _activePool,
44:         address _cdpManager,
45:         address _ebtc,
46:         address _coll,
47:         address _sortedCdps
48:     )
```

- *LeverageMacroFactory.sol* ( [21-28](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LeverageMacroFactory.sol#L21-L28), [43](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LeverageMacroFactory.sol#L43) ):

```solidity
/// @audit Missing @param for `_borrowerOperationsAddress`, `_activePool`, `_cdpManager`, `_ebtc`, `_coll`, `_sortedCdps`
21:     constructor(
22:         address _borrowerOperationsAddress,
23:         address _activePool,
24:         address _cdpManager,
25:         address _ebtc,
26:         address _coll,
27:         address _sortedCdps
28:     ) {

/// @audit Missing @param for `_owner`
43:     function deployNewMacro(address _owner) public returns (address) {
```

- *LeverageMacroReference.sol* ( [17-25](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LeverageMacroReference.sol#L17-L25) ):

```solidity
/// @audit Missing @param for `_borrowerOperationsAddress`, `_activePool`, `_cdpManager`, `_ebtc`, `_coll`, `_sortedCdps`, `_owner`
17:     constructor(
18:         address _borrowerOperationsAddress,
19:         address _activePool,
20:         address _cdpManager,
21:         address _ebtc,
22:         address _coll,
23:         address _sortedCdps,
24:         address _owner
25:     )
```

- *LiquidationLibrary.sol* ( [14-22](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LiquidationLibrary.sol#L14-L22), [61-66](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LiquidationLibrary.sol#L61-L66), [135-138](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LiquidationLibrary.sol#L135-L138), [186-189](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LiquidationLibrary.sol#L186-L189), [223-225](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LiquidationLibrary.sol#L223-L225), [295-297](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LiquidationLibrary.sol#L295-L297), [384](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LiquidationLibrary.sol#L384), [397-399](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LiquidationLibrary.sol#L397-L399), [450-454](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LiquidationLibrary.sol#L450-L454), [466-471](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LiquidationLibrary.sol#L466-L471), [503-512](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LiquidationLibrary.sol#L503-L512), [544-549](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LiquidationLibrary.sol#L544-L549), [570-575](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LiquidationLibrary.sol#L570-L575), [608-613](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LiquidationLibrary.sol#L608-L613), [642-648](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LiquidationLibrary.sol#L642-L648), [733-738](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LiquidationLibrary.sol#L733-L738), [807-811](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LiquidationLibrary.sol#L807-L811), [839-842](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LiquidationLibrary.sol#L839-L842), [862](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LiquidationLibrary.sol#L862), [896-900](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LiquidationLibrary.sol#L896-L900), [908](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LiquidationLibrary.sol#L908) ):

```solidity
/// @audit Missing @param for `_borrowerOperationsAddress`, `_collSurplusPool`, `_ebtcToken`, `_sortedCdps`, `_activePool`, `_priceFeed`, `_collateral`
14:     constructor(
15:         address _borrowerOperationsAddress,
16:         address _collSurplusPool,
17:         address _ebtcToken,
18:         address _sortedCdps,
19:         address _activePool,
20:         address _priceFeed,
21:         address _collateral
22:     )

/// @audit Missing @param for `_cdpId`, `_partialAmount`, `_upperPartialHint`, `_lowerPartialHint`
61:     function _liquidateIndividualCdpSetup(
62:         bytes32 _cdpId,
63:         uint256 _partialAmount,
64:         bytes32 _upperPartialHint,
65:         bytes32 _lowerPartialHint
66:     ) internal {

/// @audit Missing @param for `_liqState`, `_recoveryState`
135:     function _liquidateIndividualCdpSetupCDP(
136:         LiquidationLocals memory _liqState,
137:         LiquidationRecoveryModeLocals memory _recoveryState
138:     ) internal {

/// @audit Missing @param for `_liqState`, `_recoveryState`
186:     function _liquidateCdpInGivenMode(
187:         LiquidationLocals memory _liqState,
188:         LiquidationRecoveryModeLocals memory _recoveryState
189:     ) private returns (uint256, uint256, uint256, uint256, uint256) {

/// @audit Missing @param for `_liqState`
223:     function _liquidateIndividualCdpSetupCDPInNormalMode(
224:         LiquidationLocals memory _liqState
225:     ) private returns (LiquidationLocals memory) {

/// @audit Missing @param for `_recoveryState`
295:     function _liquidateIndividualCdpSetupCDPInRecoveryMode(
296:         LiquidationRecoveryModeLocals memory _recoveryState
297:     ) private returns (LiquidationRecoveryModeLocals memory) {

/// @audit Missing @param for `_cdpId`
384:     function _closeCdpByLiquidation(bytes32 _cdpId) private returns (uint256, uint256, uint256) {

/// @audit Missing @param for `_partialState`
397:     function _liquidateCDPPartially(
398:         LiquidationLocals memory _partialState
399:     ) private returns (uint256, uint256) {

/// @audit Missing @param for `_cdpId`, `_partialDebt`, `_partialColl`
450:     function _partiallyReduceCdpDebt(
451:         bytes32 _cdpId,
452:         uint256 _partialDebt,
453:         uint256 _partialColl
454:     ) internal {

/// @audit Missing @param for `_partialState`, `_newNICR`, `_oldDebt`, `_oldColl`
466:     function _reInsertPartialLiquidation(
467:         LiquidationLocals memory _partialState,
468:         uint256 _newNICR,
469:         uint256 _oldDebt,
470:         uint256 _oldColl
471:     ) internal {

/// @audit Missing @param for `totalDebtToBurn`, `totalCollSharesToSend`, `totalDebtToRedistribute`, `totalLiquidatorRewardCollShares`, `totalSurplusCollShares`, `systemInitialCollShares`, `systemInitialDebt`, `price`
503:     function _finalizeLiquidation(
504:         uint256 totalDebtToBurn,
505:         uint256 totalCollSharesToSend,
506:         uint256 totalDebtToRedistribute,
507:         uint256 totalLiquidatorRewardCollShares,
508:         uint256 totalSurplusCollShares,
509:         uint256 systemInitialCollShares,
510:         uint256 systemInitialDebt,
511:         uint256 price
512:     ) internal {

/// @audit Missing @param for `_ICR`, `_price`, `_totalDebtToBurn`, `_totalColToSend`
544:     function _calculatePartialLiquidationSurplusAndCap(
545:         uint256 _ICR,
546:         uint256 _price,
547:         uint256 _totalDebtToBurn,
548:         uint256 _totalColToSend
549:     ) private view returns (uint256 toLiquidator, uint256 collSurplus, uint256 debtToRedistribute) {

/// @audit Missing @param for `_ICR`, `_price`, `_totalDebtToBurn`, `_totalColToSend`
570:     function _calculateFullLiquidationSurplusAndCap(
571:         uint256 _ICR,
572:         uint256 _price,
573:         uint256 _totalDebtToBurn,
574:         uint256 _totalColToSend
575:     ) private view returns (uint256 toLiquidator, uint256 collSurplus, uint256 debtToRedistribute) {

/// @audit Missing @param for `_price`, `_TCR`, `vars`, `singleLiquidation`
608:     function _getLiquidationValuesNormalMode(
609:         uint256 _price,
610:         uint256 _TCR,
611:         LocalVariables_LiquidationSequence memory vars,
612:         LiquidationValues memory singleLiquidation
613:     ) internal {

/// @audit Missing @param for `_price`, `_systemDebt`, `_systemCollShares`, `vars`, `singleLiquidation`
642:     function _getLiquidationValuesRecoveryMode(
643:         uint256 _price,
644:         uint256 _systemDebt,
645:         uint256 _systemCollShares,
646:         LocalVariables_LiquidationSequence memory vars,
647:         LiquidationValues memory singleLiquidation
648:     ) internal {

/// @audit Missing @param for `_price`, `_systemCollShares`, `_systemDebt`, `_cdpArray`
733:     function _getTotalFromBatchLiquidate_RecoveryMode(
734:         uint256 _price,
735:         uint256 _systemCollShares,
736:         uint256 _systemDebt,
737:         bytes32[] memory _cdpArray
738:     ) internal returns (LiquidationTotals memory totals) {

/// @audit Missing @param for `_price`, `_TCR`, `_cdpArray`
807:     function _getTotalsFromBatchLiquidate_NormalMode(
808:         uint256 _price,
809:         uint256 _TCR,
810:         bytes32[] memory _cdpArray
811:     ) internal returns (LiquidationTotals memory totals) {

/// @audit Missing @param for `oldTotals`, `singleLiquidation`
839:     function _addLiquidationValuesToTotals(
840:         LiquidationTotals memory oldTotals,
841:         LiquidationValues memory singleLiquidation
842:     ) internal pure returns (LiquidationTotals memory newTotals) {

/// @audit Missing @param for `_debt`
862:     function _redistributeDebt(uint256 _debt) internal {

/// @audit Missing @param for `_partialDebt`, `_entireDebt`, `_price`
896:     function _requirePartialLiqDebtSize(
897:         uint256 _partialDebt,
898:         uint256 _entireDebt,
899:         uint256 _price
900:     ) internal view {

/// @audit Missing @param for `_entireColl`
908:     function _requirePartialLiqCollSize(uint256 _entireColl) internal pure {
```

- *PriceFeed.sol* ( [465](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/PriceFeed.sol#L465), [493](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/PriceFeed.sol#L493), [788-793](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/PriceFeed.sol#L788-L793) ):

```solidity
/// @audit Missing @param for `_response`
465:     function _fallbackIsBroken(FallbackResponse memory _response) internal view returns (bool) {

/// @audit Missing @param for `_timestamp`, `_timeout`
493:     function _responseTimeout(uint256 _timestamp, uint256 _timeout) internal view returns (bool) {

/// @audit Missing @param for `_ethBtcAnswer`, `_stEthEthAnswer`, `_ethBtcDecimals`, `_stEthEthDecimals`
788:     function _formatClAggregateAnswer(
789:         int256 _ethBtcAnswer,
790:         int256 _stEthEthAnswer,
791:         uint8 _ethBtcDecimals,
792:         uint8 _stEthEthDecimals
793:     ) internal view returns (uint256) {
```

- *SimplifiedDiamondLike.sol* ( [44](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SimplifiedDiamondLike.sol#L44), [51](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SimplifiedDiamondLike.sol#L51), [66](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SimplifiedDiamondLike.sol#L66), [110](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SimplifiedDiamondLike.sol#L110), [129](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SimplifiedDiamondLike.sol#L129), [134](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SimplifiedDiamondLike.sol#L134) ):

```solidity
/// @audit Missing @param for `_owner`
44:     constructor(address _owner) {

/// @audit Missing @param for `sig`, `handler`
51:     function setFallbackHandler(bytes4 sig, address handler) external {

/// @audit Missing @param for `allowNonCallbacks`
66:     function setAllowAnyCall(bool allowNonCallbacks) external {

/// @audit Missing @param for `ops`
110:     function execute(Operation[] calldata ops) external payable {

/// @audit Missing @param for `ds`, `_enabled`
129:     function _setCallbackEnabledForCall(DiamondLikeStorage storage ds, bool _enabled) internal {

/// @audit Missing @param for `op`
134:     function _executeOne(Operation calldata op) internal {
```

- *SortedCdps.sol* ( [227-231](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L227-L231), [237-241](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L237-L241), [286-290](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L286-L290), [299-304](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L299-L304), [363](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L363), [456](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L456), [591-595](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L591-L595), [674-678](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L674-L678) ):

```solidity
/// @audit Missing @param for `owner`
227:     function getCdpCountOf(
228:         address owner,
229:         bytes32 startNodeId,
230:         uint maxNodes
231:     ) external view override returns (uint256, bytes32) {

/// @audit Missing @param for `owner`, `startNodeId`, `maxNodes`
237:     function _cdpCountOf(
238:         address owner,
239:         bytes32 startNodeId,
240:         uint maxNodes
241:     ) internal view returns (uint256, bytes32) {

/// @audit Missing @param for `owner`
286:     function getAllCdpsOf(
287:         address owner,
288:         bytes32 startNodeId,
289:         uint maxNodes
290:     ) external view override returns (bytes32[] memory, uint256, bytes32) {

/// @audit Missing @param for `owner`, `startNodeId`, `maxNodes`, `maxArraySize`
299:     function _getCdpsOf(
300:         address owner,
301:         bytes32 startNodeId,
302:         uint maxNodes,
303:         uint maxArraySize
304:     ) internal view returns (bytes32[] memory, uint256, bytes32) {

/// @audit Missing @param for `_id`, `_NICR`, `_prevId`, `_nextId`
363:     function _insert(bytes32 _id, uint256 _NICR, bytes32 _prevId, bytes32 _nextId) internal {

/// @audit Missing @param for `_id`
456:     function _remove(bytes32 _id) internal {

/// @audit Missing @param for `_NICR`, `_prevId`, `_nextId`
591:     function _validInsertPosition(
592:         uint256 _NICR,
593:         bytes32 _prevId,
594:         bytes32 _nextId
595:     ) internal view returns (bool) {

/// @audit Missing @param for `_NICR`, `_prevId`, `_nextId`
674:     function _findInsertPosition(
675:         uint256 _NICR,
676:         bytes32 _prevId,
677:         bytes32 _nextId
678:     ) internal view returns (bytes32, bytes32) {
```

</details>

### [N&#x2011;46] NatSpec documentation for function is missing

It is recommended that Solidity contracts are fully annotated using NatSpec for all public interfaces (everything in the ABI). It is clearly stated in the Solidity official documentation.
In complex projects such as DeFi, the interpretation of all functions and their arguments and returns is important for code readability and auditability.

<details>
<summary>There are 265 instances (click to show):</summary>

- *BorrowerOperations.sol* ( [107](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L107), [328](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L328), [439](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L439), [615](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L615), [635](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L635), [673](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L673), [677](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L677), [744](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L744), [796](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L796), [803](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L803), [813](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L813), [824](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L824), [829](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L829), [834](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L834), [838](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L838), [845](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L845), [852](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L852), [910](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L910), [917](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L917), [921](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L921), [928](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L928), [935](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L935), [939](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L939), [946](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L946), [953](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L953), [963](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L963), [986](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L986), [1004](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L1004), [1030](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L1030), [1049](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L1049) ):

```solidity
107:     constructor(

328:     function _adjustCdpInternal(

439:     function _openCdp(

615:     function _getPositionManagerApproval(

635:     function _setPositionManagerApproval(

673:     function _chainID() private view returns (uint256) {

677:     function _buildDomainSeparator(

744:     function _getCollSharesChangeFromStEthChange(

796:     function _repayDebt(address _account, uint256 _debt) internal {

803:     function _requireSingularCollChange(

813:     function _requireNonZeroAdjustment(

824:     function _requireCdpisActive(ICdpManager _cdpManager, bytes32 _cdpId) internal view {

829:     function _requireCdpIsNonExistent(bytes32 _cdpId) internal view {

834:     function _requireNonZeroDebtChange(uint _debtChange) internal pure {

838:     function _requireNotInRecoveryMode(uint256 _tcr) internal view {

845:     function _requireNoStEthBalanceDecrease(uint256 _stEthBalanceDecrease) internal pure {

852:     function _requireValidAdjustmentInCurrentMode(

910:     function _requireICRisNotBelowMCR(uint256 _newICR) internal pure {

917:     function _requireICRisNotBelowCCR(uint256 _newICR) internal pure {

921:     function _requireNoDecreaseOfICR(uint256 _newICR, uint256 _oldICR) internal pure {

928:     function _requireNewTCRisNotBelowCCR(uint256 _newTCR) internal pure {

935:     function _requireNonZeroDebt(uint256 _debt) internal pure {

939:     function _requireAtLeastMinNetStEthBalance(uint256 _stEthBalance) internal pure {

946:     function _requireValidDebtRepayment(uint256 _currentDebt, uint256 _debtRepayment) internal pure {

953:     function _requireSufficientEbtcTokenBalance(

963:     function _requireBorrowerOrPositionManagerAndUpdateManagerApproval(address _borrower) internal {

986:     function _getNewNominalICRFromCdpChange(

1004:     function _getNewICRFromCdpChange(

1030:     function _getNewCdpAmounts(

1049:     function _getNewTCRFromCdpChange(
```

- *CdpManager.sol* ( [244](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L244), [489](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L489), [550](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L550), [595](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L595), [612](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L612), [647](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L647), [655](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L655), [667](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L667), [676](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L676), [689](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L689), [702](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L702), [709](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L709), [737](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L737), [753](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L753), [757](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L757), [761](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L761) ):

```solidity
244:     function _closeCdpByRedemption(

489:     function _getCdpIdsToRemove(

550:     function _addCdpIdToArray(bytes32 _cdpId) internal returns (uint128 index) {

595:     function _checkPotentialRecoveryMode(

612:     function _updateBaseRateFromRedemption(

647:     function _calcRedemptionRate(uint256 _baseRate) internal view returns (uint256) {

655:     function _getRedemptionFee(uint256 _ETHDrawn) internal view returns (uint256) {

667:     function _calcRedemptionFee(

676:     function _decayBaseRate() internal {

689:     function _updateLastRedemptionTimestamp() internal {

702:     function _calcDecayedBaseRate() internal view returns (uint256) {

709:     function _minutesPassedSinceLastRedemption() internal view returns (uint256) {

737:     function _requireEbtcBalanceCoversRedemptionAndWithinSupply(

753:     function _requireAmountGreaterThanZero(uint256 _amount) internal pure {

757:     function _requireTCRisNotBelowMCR(uint256 _price, uint256 _TCR) internal view {

761:     function _requireValidMaxFeePercentage(uint256 _maxFeePercentage) internal view {
```

- *CdpManagerStorage.sol* ( [73](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L73), [255](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L255), [260](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L260), [293](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L293), [327](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L327), [410](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L410), [419](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L419), [431](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L431), [441](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L441), [463](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L463), [489](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L489), [509](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L509), [539](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L539), [574](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L574), [592](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L592), [648](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L648), [652](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L652), [659](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L659), [707](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L707), [733](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L733) ):

```solidity
73:     function _syncGracePeriod() internal {

255:     function _closeCdp(bytes32 _cdpId, Status closedStatus) internal {

260:     function _closeCdpWithoutRemovingSortedCdps(bytes32 _cdpId, Status closedStatus) internal {

293:     function _updateSystemSnapshotsExcludeCollRemainder(uint256 _collRemainder) internal {

327:     function _hasRedistributedDebt(bytes32 _cdpId) internal view returns (bool) {

410:     function _removeStake(bytes32 _cdpId) internal {

419:     function _updateStakeAndTotalStakes(bytes32 _cdpId) internal returns (uint256) {

431:     function _updateStakeForCdp(bytes32 _cdpId) internal returns (uint256, uint256) {

441:     function _computeNewStake(uint256 _coll) internal view returns (uint256) {

463:     function _removeCdp(bytes32 _cdpId, uint256 cdpIdsArrayLength) internal {

489:     function _computeTCRWithGivenSystemValues(

509:     function _syncGlobalAccounting() internal {

539:     function _syncStEthIndex(uint256 _oldIndex, uint256 _newIndex) internal {

574:     function _takeSplitAndUpdateFeePerUnit(

592:     function _applyAccumulatedFeeSplit(

648:     function _requireCdpIsActive(bytes32 _cdpId) internal view {

652:     function _requireMoreThanOneCdpInSystem(uint256 CdpOwnersArrayLength) internal view {

659:     function _requireCallerIsBorrowerOperations() internal view {

707:     function _calculateCR(

733:     function _getSyncedDebtAndCollShares(
```

- *CollSurplusPool.sol* ( [112](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CollSurplusPool.sol#L112), [119](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CollSurplusPool.sol#L119), [123](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CollSurplusPool.sol#L123) ):

```solidity
112:     function _requireCallerIsBorrowerOperations() internal view {

119:     function _requireCallerIsCdpManager() internal view {

123:     function _requireCallerIsActivePool() internal view {
```

- *Auth.sol* ( [18](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/Auth.sol#L18), [32](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/Auth.sol#L32), [42](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/Auth.sol#L42), [52](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/Auth.sol#L52) ):

```solidity
18:     constructor(address _owner, Authority _authority) {

32:     function isAuthorized(address user, bytes4 functionSig) internal view virtual returns (bool) {

42:     function setAuthority(Authority newAuthority) public virtual {

52:     function transferOwnership(address newOwner) public virtual requiresAuth {
```

- *AuthNoOwner.sol* ( [22](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/AuthNoOwner.sol#L22), [26](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/AuthNoOwner.sol#L26), [30](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/AuthNoOwner.sol#L30), [38](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/AuthNoOwner.sol#L38) ):

```solidity
22:     function authority() public view returns (Authority) {

26:     function authorityInitialized() public view returns (bool) {

30:     function isAuthorized(address user, bytes4 functionSig) internal view virtual returns (bool) {

38:     function setAuthority(address newAuthority) public virtual {
```

- *EbtcBase.sol* ( [60](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/EbtcBase.sol#L60), [79](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/EbtcBase.sol#L79), [83](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/EbtcBase.sol#L83), [95](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/EbtcBase.sol#L95), [99](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/EbtcBase.sol#L99), [103](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/EbtcBase.sol#L103), [115](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/EbtcBase.sol#L115) ):

```solidity
60:     function _calcNetStEthBalance(uint256 _stEthBalance) internal pure returns (uint256) {

79:     function _getCachedTCR(uint256 _price) internal view returns (uint256 TCR) {

83:     function _getTCRWithSystemDebtAndCollShares(

95:     function _checkRecoveryMode(uint256 _price) internal view returns (bool) {

99:     function _checkRecoveryModeForTCR(uint256 _tcr) internal view returns (bool) {

103:     function _requireUserAcceptsFee(

115:     function _convertDebtDenominationToBtc(
```

- *EbtcMath.sol* ( [20](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/EbtcMath.sol#L20), [24](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/EbtcMath.sol#L24), [35](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/EbtcMath.sol#L35), [59](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/EbtcMath.sol#L59), [88](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/EbtcMath.sol#L88), [92](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/EbtcMath.sol#L92) ):

```solidity
20:     function _min(uint256 _a, uint256 _b) internal pure returns (uint256) {

24:     function _max(uint256 _a, uint256 _b) internal pure returns (uint256) {

35:     function decMul(uint256 x, uint256 y) internal pure returns (uint256 decProd) {

59:     function _decPow(uint256 _base, uint256 _minutes) internal pure returns (uint256) {

88:     function _getAbsoluteDifference(uint256 _a, uint256 _b) internal pure returns (uint256) {

92:     function _computeNominalCR(uint256 _collShares, uint256 _debt) internal pure returns (uint256) {
```

- *RolesAuthority.sol* ( [20](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/RolesAuthority.sol#L20), [38](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/RolesAuthority.sol#L38), [42](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/RolesAuthority.sol#L42), [50](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/RolesAuthority.sol#L50), [147](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/RolesAuthority.sol#L147) ):

```solidity
20:     constructor(address _owner, Authority _authority) Auth(_owner, _authority) {}

38:     function doesUserHaveRole(address user, uint8 role) public view virtual returns (bool) {

42:     function doesRoleHaveCapability(

50:     function isPublicCapability(address target, bytes4 functionSig) public view returns (bool) {

147:     function setUserRole(address user, uint8 role, bool enabled) public virtual requiresAuth {
```

- *EBTCToken.sol* ( [111](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/EBTCToken.sol#L111), [115](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/EBTCToken.sol#L115), [119](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/EBTCToken.sol#L119), [125](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/EBTCToken.sol#L125), [129](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/EBTCToken.sol#L129), [134](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/EBTCToken.sol#L134), [152](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/EBTCToken.sol#L152), [160](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/EBTCToken.sol#L160), [231](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/EBTCToken.sol#L231), [235](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/EBTCToken.sol#L235), [246](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/EBTCToken.sol#L246), [262](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/EBTCToken.sol#L262), [270](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/EBTCToken.sol#L270), [285](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/EBTCToken.sol#L285), [295](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/EBTCToken.sol#L295), [306](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/EBTCToken.sol#L306), [323](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/EBTCToken.sol#L323) ):

```solidity
111:     function totalSupply() external view override returns (uint256) {

115:     function balanceOf(address account) external view override returns (uint256) {

119:     function transfer(address recipient, uint256 amount) external override returns (bool) {

125:     function allowance(address owner, address spender) external view override returns (uint256) {

129:     function approve(address spender, uint256 amount) external override returns (bool) {

134:     function transferFrom(

152:     function increaseAllowance(

160:     function decreaseAllowance(

231:     function _chainID() private view returns (uint256) {

235:     function _buildDomainSeparator(

246:     function _transfer(address sender, address recipient, uint256 amount) internal {

262:     function _mint(address account, uint256 amount) internal {

270:     function _burn(address account, uint256 amount) internal {

285:     function _approve(address owner, address spender, uint256 amount) internal {

295:     function _requireValidRecipient(address _recipient) internal view {

306:     function _requireCallerIsBorrowerOperations() internal view {

323:     function _requireCallerIsCdpM() internal view {
```

- *HintHelpers.sol* ( [27](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/HintHelpers.sol#L27), [164](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/HintHelpers.sol#L164) ):

```solidity
27:     constructor(

164:     function getApproxHint(
```

- *IActivePool.sol* ( [23](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IActivePool.sol#L23), [25](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IActivePool.sol#L25), [27](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IActivePool.sol#L27), [33](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IActivePool.sol#L33), [35](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IActivePool.sol#L35), [37](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IActivePool.sol#L37), [39](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IActivePool.sol#L39), [41](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IActivePool.sol#L41) ):

```solidity
23:     function transferSystemCollShares(address _account, uint256 _amount) external;

25:     function increaseSystemCollShares(uint256 _value) external;

27:     function transferSystemCollSharesAndLiquidatorReward(

33:     function allocateSystemCollSharesToFeeRecipient(uint256 _shares) external;

35:     function claimFeeRecipientCollShares(uint256 _shares) external;

37:     function feeRecipientAddress() external view returns (address);

39:     function getFeeRecipientClaimableCollShares() external view returns (uint256);

41:     function setFeeRecipientAddress(address _feeRecipientAddress) external;
```

- *IBorrowerOperations.sol* ( [20](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IBorrowerOperations.sol#L20), [27](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IBorrowerOperations.sol#L27), [35](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IBorrowerOperations.sol#L35), [42](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IBorrowerOperations.sol#L42), [49](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IBorrowerOperations.sol#L49), [56](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IBorrowerOperations.sol#L56), [63](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IBorrowerOperations.sol#L63), [65](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IBorrowerOperations.sol#L65), [74](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IBorrowerOperations.sol#L74), [84](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IBorrowerOperations.sol#L84), [86](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IBorrowerOperations.sol#L86) ):

```solidity
20:     function openCdp(

27:     function openCdpFor(

35:     function addColl(

42:     function withdrawColl(

49:     function withdrawDebt(

56:     function repayDebt(

63:     function closeCdp(bytes32 _cdpId) external;

65:     function adjustCdp(

74:     function adjustCdpWithColl(

84:     function claimSurplusCollShares() external;

86:     function feeRecipientAddress() external view returns (address);
```

- *ICdpManager.sol* ( [11](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManager.sol#L11), [13](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManager.sol#L13), [15](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManager.sol#L15), [17](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManager.sol#L17), [24](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManager.sol#L24), [26](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManager.sol#L26), [36](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManager.sol#L36), [38](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManager.sol#L38), [40](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManager.sol#L40), [42](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManager.sol#L42), [44](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManager.sol#L44), [46](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManager.sol#L46), [48](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManager.sol#L48), [50](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManager.sol#L50), [52](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManager.sol#L52), [54](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManager.sol#L54), [56](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManager.sol#L56), [58](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManager.sol#L58), [66](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManager.sol#L66), [75](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManager.sol#L75), [77](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManager.sol#L77) ):

```solidity
11:     function getActiveCdpsCount() external view returns (uint256);

13:     function getIdFromCdpIdsArray(uint256 _index) external view returns (bytes32);

15:     function liquidate(bytes32 _cdpId) external;

17:     function partiallyLiquidate(

24:     function batchLiquidateCdps(bytes32[] calldata _cdpArray) external;

26:     function redeemCollateral(

36:     function updateStakeAndTotalStakes(bytes32 _cdpId) external returns (uint256);

38:     function syncAccounting(bytes32 _cdpId) external;

40:     function closeCdp(bytes32 _cdpId, address _borrower, uint256 _debt, uint256 _coll) external;

42:     function getRedemptionRate() external view returns (uint256);

44:     function getRedemptionRateWithDecay() external view returns (uint256);

46:     function getRedemptionFeeWithDecay(uint256 _stETHToRedeem) external view returns (uint256);

48:     function getCdpStatus(bytes32 _cdpId) external view returns (uint256);

50:     function getCdpStake(bytes32 _cdpId) external view returns (uint256);

52:     function getCdpDebt(bytes32 _cdpId) external view returns (uint256);

54:     function getCdpCollShares(bytes32 _cdpId) external view returns (uint256);

56:     function getCdpLiquidatorRewardShares(bytes32 _cdpId) external view returns (uint);

58:     function initializeCdp(

66:     function updateCdp(

75:     function getCachedTCR(uint256 _price) external view returns (uint256);

77:     function checkRecoveryMode(uint256 _price) external view returns (bool);
```

- *ICdpManagerData.sol* ( [217](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManagerData.sol#L217), [219](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManagerData.sol#L219), [221](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManagerData.sol#L221), [223](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManagerData.sol#L223), [225](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManagerData.sol#L225), [227](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManagerData.sol#L227), [232](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManagerData.sol#L232), [234](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManagerData.sol#L234), [236](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManagerData.sol#L236), [241](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManagerData.sol#L241), [243](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManagerData.sol#L243), [245](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManagerData.sol#L245), [247](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManagerData.sol#L247), [249](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManagerData.sol#L249), [251](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManagerData.sol#L251), [253](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManagerData.sol#L253), [255](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManagerData.sol#L255), [257](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManagerData.sol#L257), [259](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManagerData.sol#L259), [263](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManagerData.sol#L263) ):

```solidity
217:     function totalStakes() external view returns (uint256);

219:     function ebtcToken() external view returns (IEBTCToken);

221:     function systemStEthFeePerUnitIndex() external view returns (uint256);

223:     function systemStEthFeePerUnitIndexError() external view returns (uint256);

225:     function stEthIndex() external view returns (uint256);

227:     function calcFeeUponStakingReward(

232:     function syncGlobalAccounting() external; // Accrues StEthFeeSplit without influencing Grace Period

234:     function syncGlobalAccountingAndGracePeriod() external; // Accrues StEthFeeSplit and influences Grace Period

236:     function getAccumulatedFeeSplitApplied(

241:     function getCachedNominalICR(bytes32 _cdpId) external view returns (uint256);

243:     function getCachedICR(bytes32 _cdpId, uint256 _price) external view returns (uint256);

245:     function getSyncedCdpDebt(bytes32 _cdpId) external view returns (uint256);

247:     function getSyncedCdpCollShares(bytes32 _cdpId) external view returns (uint256);

249:     function getSyncedICR(bytes32 _cdpId, uint256 _price) external view returns (uint256);

251:     function getSyncedTCR(uint256 _price) external view returns (uint256);

253:     function getSyncedNominalICR(bytes32 _cdpId) external view returns (uint256);

255:     function getPendingRedistributedDebt(bytes32 _cdpId) external view returns (uint256);

257:     function hasPendingRedistributedDebt(bytes32 _cdpId) external view returns (bool);

259:     function getSyncedDebtAndCollShares(

263:     function canLiquidateRecoveryMode(uint256 icr, uint256 tcr) external view returns (bool);
```

- *ICollSurplusPool.sol* ( [15](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICollSurplusPool.sol#L15), [17](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICollSurplusPool.sol#L17), [19](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICollSurplusPool.sol#L19), [21](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICollSurplusPool.sol#L21), [23](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICollSurplusPool.sol#L23) ):

```solidity
15:     function getTotalSurplusCollShares() external view returns (uint256);

17:     function getSurplusCollShares(address _account) external view returns (uint256);

19:     function increaseSurplusCollShares(address _account, uint256 _amount) external;

21:     function claimSurplusCollShares(address _account) external;

23:     function increaseTotalSurplusCollShares(uint256 _value) external;
```

- *IEBTCToken.sol* ( [11](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IEBTCToken.sol#L11), [13](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IEBTCToken.sol#L13) ):

```solidity
11:     function mint(address _account, uint256 _amount) external;

13:     function burn(address _account, uint256 _amount) external;
```

- *IEbtcBase.sol* ( [8](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IEbtcBase.sol#L8) ):

```solidity
8:     function priceFeed() external view returns (IPriceFeed);
```

- *IFallbackCaller.sol* ( [13](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IFallbackCaller.sol#L13), [17](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IFallbackCaller.sol#L17), [21](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IFallbackCaller.sol#L21) ):

```solidity
13:     function getFallbackResponse() external view returns (uint256, uint256, bool);

17:     function fallbackTimeout() external view returns (uint256);

21:     function setFallbackTimeout(uint256 newFallbackTimeout) external;
```

- *IPermitNonce.sol* ( [7](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IPermitNonce.sol#L7), [9](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IPermitNonce.sol#L9) ):

```solidity
7:     function increasePermitNonce() external returns (uint256);

9:     function nonces(address owner) external view returns (uint256);
```

- *IPool.sol* ( [15](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IPool.sol#L15), [17](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IPool.sol#L17), [19](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IPool.sol#L19), [21](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IPool.sol#L21) ):

```solidity
15:     function getSystemCollShares() external view returns (uint256);

17:     function getSystemDebt() external view returns (uint256);

19:     function increaseSystemDebt(uint256 _amount) external;

21:     function decreaseSystemDebt(uint256 _amount) external;
```

- *IPositionManagers.sol* ( [18](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IPositionManagers.sol#L18), [23](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IPositionManagers.sol#L23), [28](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IPositionManagers.sol#L28), [30](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IPositionManagers.sol#L30), [32](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IPositionManagers.sol#L32), [42](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IPositionManagers.sol#L42), [44](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IPositionManagers.sol#L44), [46](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IPositionManagers.sol#L46) ):

```solidity
18:     function getPositionManagerApproval(

23:     function setPositionManagerApproval(

28:     function revokePositionManagerApproval(address _positionManager) external;

30:     function renouncePositionManagerApproval(address _borrower) external;

32:     function permitPositionManagerApproval(

42:     function version() external view returns (string memory);

44:     function permitTypeHash() external view returns (bytes32);

46:     function domainSeparator() external view returns (bytes32);
```

- *IPriceFeed.sol* ( [43](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IPriceFeed.sol#L43) ):

```solidity
43:     function fetchPrice() external returns (uint256);
```

- *IRecoveryModeGracePeriod.sol* ( [13](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IRecoveryModeGracePeriod.sol#L13), [15](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IRecoveryModeGracePeriod.sol#L15) ):

```solidity
13:     function notifyStartGracePeriod(uint256 tcr) external;

15:     function notifyEndGracePeriod(uint256 tcr) external;
```

- *ISortedCdps.sol* ( [14](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ISortedCdps.sol#L14), [16](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ISortedCdps.sol#L16), [18](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ISortedCdps.sol#L18), [20](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ISortedCdps.sol#L20), [22](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ISortedCdps.sol#L22), [24](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ISortedCdps.sol#L24), [26](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ISortedCdps.sol#L26), [28](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ISortedCdps.sol#L28), [30](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ISortedCdps.sol#L30), [32](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ISortedCdps.sol#L32), [34](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ISortedCdps.sol#L34), [36](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ISortedCdps.sol#L36), [38](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ISortedCdps.sol#L38), [44](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ISortedCdps.sol#L44), [50](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ISortedCdps.sol#L50), [57](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ISortedCdps.sol#L57), [59](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ISortedCdps.sol#L59), [61](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ISortedCdps.sol#L61), [63](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ISortedCdps.sol#L63), [69](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ISortedCdps.sol#L69), [71](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ISortedCdps.sol#L71), [77](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ISortedCdps.sol#L77), [79](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ISortedCdps.sol#L79) ):

```solidity
14:     function remove(bytes32 _id) external;

16:     function batchRemove(bytes32[] memory _ids) external;

18:     function reInsert(bytes32 _id, uint256 _newICR, bytes32 _prevId, bytes32 _nextId) external;

20:     function contains(bytes32 _id) external view returns (bool);

22:     function isFull() external view returns (bool);

24:     function isEmpty() external view returns (bool);

26:     function getSize() external view returns (uint256);

28:     function getMaxSize() external view returns (uint256);

30:     function getFirst() external view returns (bytes32);

32:     function getLast() external view returns (bytes32);

34:     function getNext(bytes32 _id) external view returns (bytes32);

36:     function getPrev(bytes32 _id) external view returns (bytes32);

38:     function validInsertPosition(

44:     function findInsertPosition(

50:     function insert(

57:     function getOwnerAddress(bytes32 _id) external pure returns (address);

59:     function nonExistId() external view returns (bytes32);

61:     function cdpCountOf(address owner) external view returns (uint256);

63:     function getCdpCountOf(

69:     function getCdpsOf(address owner) external view returns (bytes32[] memory);

71:     function getAllCdpsOf(

77:     function cdpOfOwnerByIndex(address owner, uint256 index) external view returns (bytes32);

79:     function cdpOfOwnerByIdx(
```

- *LeverageMacroBase.sol* ( [15](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LeverageMacroBase.sol#L15), [39](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LeverageMacroBase.sol#L39), [43](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LeverageMacroBase.sol#L43), [51](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LeverageMacroBase.sol#L51) ):

```solidity
15:     function Cdps(bytes32) external view returns (ICdpManagerData.Cdp memory);

39:     function owner() public virtual returns (address) {

43:     function _assertOwner() internal {

51:     constructor(
```

- *LeverageMacroDelegateTarget.sol* ( [7](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LeverageMacroDelegateTarget.sol#L7), [41](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LeverageMacroDelegateTarget.sol#L41) ):

```solidity
7:     function owner() external view returns (address);

41:     constructor(
```

- *LeverageMacroFactory.sol* ( [21](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LeverageMacroFactory.sol#L21) ):

```solidity
21:     constructor(
```

- *LeverageMacroReference.sol* ( [17](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LeverageMacroReference.sol#L17), [44](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LeverageMacroReference.sol#L44) ):

```solidity
17:     constructor(

44:     function owner() public override returns (address) {
```

- *LiquidationLibrary.sol* ( [14](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LiquidationLibrary.sol#L14), [61](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LiquidationLibrary.sol#L61), [135](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LiquidationLibrary.sol#L135), [186](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LiquidationLibrary.sol#L186), [223](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LiquidationLibrary.sol#L223), [295](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LiquidationLibrary.sol#L295), [384](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LiquidationLibrary.sol#L384), [397](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LiquidationLibrary.sol#L397), [450](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LiquidationLibrary.sol#L450), [466](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LiquidationLibrary.sol#L466), [503](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LiquidationLibrary.sol#L503), [544](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LiquidationLibrary.sol#L544), [570](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LiquidationLibrary.sol#L570), [608](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LiquidationLibrary.sol#L608), [642](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LiquidationLibrary.sol#L642), [733](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LiquidationLibrary.sol#L733), [807](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LiquidationLibrary.sol#L807), [839](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LiquidationLibrary.sol#L839), [862](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LiquidationLibrary.sol#L862), [896](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LiquidationLibrary.sol#L896), [908](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LiquidationLibrary.sol#L908) ):

```solidity
14:     constructor(

61:     function _liquidateIndividualCdpSetup(

135:     function _liquidateIndividualCdpSetupCDP(

186:     function _liquidateCdpInGivenMode(

223:     function _liquidateIndividualCdpSetupCDPInNormalMode(

295:     function _liquidateIndividualCdpSetupCDPInRecoveryMode(

384:     function _closeCdpByLiquidation(bytes32 _cdpId) private returns (uint256, uint256, uint256) {

397:     function _liquidateCDPPartially(

450:     function _partiallyReduceCdpDebt(

466:     function _reInsertPartialLiquidation(

503:     function _finalizeLiquidation(

544:     function _calculatePartialLiquidationSurplusAndCap(

570:     function _calculateFullLiquidationSurplusAndCap(

608:     function _getLiquidationValuesNormalMode(

642:     function _getLiquidationValuesRecoveryMode(

733:     function _getTotalFromBatchLiquidate_RecoveryMode(

807:     function _getTotalsFromBatchLiquidate_NormalMode(

839:     function _addLiquidationValuesToTotals(

862:     function _redistributeDebt(uint256 _debt) internal {

896:     function _requirePartialLiqDebtSize(

908:     function _requirePartialLiqCollSize(uint256 _entireColl) internal pure {
```

- *PriceFeed.sol* ( [465](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/PriceFeed.sol#L465), [493](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/PriceFeed.sol#L493), [788](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/PriceFeed.sol#L788) ):

```solidity
465:     function _fallbackIsBroken(FallbackResponse memory _response) internal view returns (bool) {

493:     function _responseTimeout(uint256 _timestamp, uint256 _timeout) internal view returns (bool) {

788:     function _formatClAggregateAnswer(
```

- *SimplifiedDiamondLike.sol* ( [44](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SimplifiedDiamondLike.sol#L44), [160](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SimplifiedDiamondLike.sol#L160), [164](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SimplifiedDiamondLike.sol#L164) ):

```solidity
44:     constructor(address _owner) {

160:     receive() external payable {

164:     fallback() external payable {
```

- *SortedCdps.sol* ( [363](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L363), [456](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L456), [591](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L591), [674](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L674) ):

```solidity
363:     function _insert(bytes32 _id, uint256 _NICR, bytes32 _prevId, bytes32 _nextId) internal {

456:     function _remove(bytes32 _id) internal {

591:     function _validInsertPosition(

674:     function _findInsertPosition(
```

</details>

### [N&#x2011;47] Functions missing NatSpec `@return` tag

Functions missing NatSpec `@return` tag

<details>
<summary>There are 168 instances (click to show):</summary>

- *BorrowerOperations.sol* ( [439-445](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L439-L445), [615-618](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L615-L618), [673](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L673), [677-681](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L677-L681), [744-747](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L744-L747), [986-989](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L986-L989), [1004-1012](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L1004-L1012), [1030-1037](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L1030-L1037), [1049-1055](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L1049-L1055) ):

```solidity
439:     function _openCdp(
440:         uint256 _debt,
441:         bytes32 _upperHint,
442:         bytes32 _lowerHint,
443:         uint256 _stEthBalance,
444:         address _borrower
445:     ) internal returns (bytes32) {

615:     function _getPositionManagerApproval(
616:         address _borrower,
617:         address _positionManager
618:     ) internal view returns (PositionManagerApproval) {

673:     function _chainID() private view returns (uint256) {

677:     function _buildDomainSeparator(
678:         bytes32 typeHash,
679:         bytes32 name,
680:         bytes32 version
681:     ) private view returns (bytes32) {

744:     function _getCollSharesChangeFromStEthChange(
745:         uint256 _collReceived,
746:         uint256 _requestedCollWithdrawal
747:     ) internal view returns (uint256 collSharesChange, bool isCollIncrease) {

986:     function _getNewNominalICRFromCdpChange(
987:         AdjustCdpLocals memory vars,
988:         bool _isDebtIncrease
989:     ) internal pure returns (uint256) {

1004:     function _getNewICRFromCdpChange(
1005:         uint256 _collShares,
1006:         uint256 _debt,
1007:         uint256 _collSharesChange,
1008:         bool _isCollIncrease,
1009:         uint256 _debtChange,
1010:         bool _isDebtIncrease,
1011:         uint256 _price
1012:     ) internal view returns (uint256) {

1030:     function _getNewCdpAmounts(
1031:         uint256 _collShares,
1032:         uint256 _debt,
1033:         uint256 _collSharesChange,
1034:         bool _isCollIncrease,
1035:         uint256 _debtChange,
1036:         bool _isDebtIncrease
1037:     ) internal pure returns (uint256, uint256) {

1049:     function _getNewTCRFromCdpChange(
1050:         uint256 _stEthBalanceChange,
1051:         bool _isCollIncrease,
1052:         uint256 _debtChange,
1053:         bool _isDebtIncrease,
1054:         uint256 _price
1055:     ) internal view returns (uint256) {
```

- *CdpManager.sol* ( [272-275](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L272-L275), [489-493](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L489-L493), [523](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L523), [550](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L550), [595-599](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L595-L599), [612-616](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L612-L616), [647](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L647), [655](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L655), [667-670](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L667-L670), [702](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L702), [709](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L709) ):

```solidity
272:     function _isValidFirstRedemptionHint(
273:         bytes32 _firstRedemptionHint,
274:         uint256 _price
275:     ) internal view returns (bool) {

489:     function _getCdpIdsToRemove(
490:         bytes32 _start,
491:         uint256 _total,
492:         bytes32 _end
493:     ) internal view returns (bytes32[] memory) {

523:     function updateStakeAndTotalStakes(bytes32 _cdpId) external override returns (uint256) {

550:     function _addCdpIdToArray(bytes32 _cdpId) internal returns (uint128 index) {

595:     function _checkPotentialRecoveryMode(
596:         uint256 _systemCollShares,
597:         uint256 _systemDebt,
598:         uint256 _price
599:     ) internal view returns (bool) {

612:     function _updateBaseRateFromRedemption(
613:         uint256 _ETHDrawn,
614:         uint256 _price,
615:         uint256 _totalEBTCSupply
616:     ) internal returns (uint256) {

647:     function _calcRedemptionRate(uint256 _baseRate) internal view returns (uint256) {

655:     function _getRedemptionFee(uint256 _ETHDrawn) internal view returns (uint256) {

667:     function _calcRedemptionFee(
668:         uint256 _redemptionRate,
669:         uint256 _ETHDrawn
670:     ) internal pure returns (uint256) {

702:     function _calcDecayedBaseRate() internal view returns (uint256) {

709:     function _minutesPassedSinceLastRedemption() internal view returns (uint256) {
```

- *CdpManagerStorage.sol* ( [304-306](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L304-L306), [327](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L327), [419](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L419), [431](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L431), [441](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L441), [489-493](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L489-L493), [707-711](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L707-L711), [733-735](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L733-L735), [822-824](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L822-L824), [895](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L895) ):

```solidity
304:     function _getPendingRedistributedDebt(
305:         bytes32 _cdpId
306:     ) internal view returns (uint256 pendingEBTCDebtReward, uint256 _debtIndexDiff) {

327:     function _hasRedistributedDebt(bytes32 _cdpId) internal view returns (bool) {

419:     function _updateStakeAndTotalStakes(bytes32 _cdpId) internal returns (uint256) {

431:     function _updateStakeForCdp(bytes32 _cdpId) internal returns (uint256, uint256) {

441:     function _computeNewStake(uint256 _coll) internal view returns (uint256) {

489:     function _computeTCRWithGivenSystemValues(
490:         uint256 _systemCollShares,
491:         uint256 _systemDebt,
492:         uint256 _price
493:     ) internal view returns (uint256) {

707:     function _calculateCR(
708:         uint256 currentCollShare,
709:         uint256 currentDebt,
710:         uint256 _price
711:     ) internal view returns (uint256) {

733:     function _getSyncedDebtAndCollShares(
734:         bytes32 _cdpId
735:     ) internal view returns (CdpDebtAndCollShares memory) {

822:     function _getSyncedCdpDebtAndRedistribution(
823:         bytes32 _cdpId
824:     ) internal view returns (uint256, uint256, uint256) {

895:     function _recoveryModeGracePeriodPassed() internal view returns (bool) {
```

- *Auth.sol* ( [32](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/Auth.sol#L32) ):

```solidity
32:     function isAuthorized(address user, bytes4 functionSig) internal view virtual returns (bool) {
```

- *AuthNoOwner.sol* ( [22](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/AuthNoOwner.sol#L22), [26](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/AuthNoOwner.sol#L26), [30](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/AuthNoOwner.sol#L30) ):

```solidity
22:     function authority() public view returns (Authority) {

26:     function authorityInitialized() public view returns (bool) {

30:     function isAuthorized(address user, bytes4 functionSig) internal view virtual returns (bool) {
```

- *EbtcBase.sol* ( [60](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/EbtcBase.sol#L60), [67](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/EbtcBase.sol#L67), [75](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/EbtcBase.sol#L75), [79](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/EbtcBase.sol#L79), [83-85](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/EbtcBase.sol#L83-L85), [95](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/EbtcBase.sol#L95), [99](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/EbtcBase.sol#L99), [115-118](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/EbtcBase.sol#L115-L118), [124](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/EbtcBase.sol#L124), [134](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/EbtcBase.sol#L134), [140](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/EbtcBase.sol#L140) ):

```solidity
60:     function _calcNetStEthBalance(uint256 _stEthBalance) internal pure returns (uint256) {

67:     function getSystemCollShares() public view returns (uint256 entireSystemColl) {

75:     function _getSystemDebt() internal view returns (uint256 entireSystemDebt) {

79:     function _getCachedTCR(uint256 _price) internal view returns (uint256 TCR) {

83:     function _getTCRWithSystemDebtAndCollShares(
84:         uint256 _price
85:     ) internal view returns (uint256 TCR, uint256 _coll, uint256 _debt) {

95:     function _checkRecoveryMode(uint256 _price) internal view returns (bool) {

99:     function _checkRecoveryModeForTCR(uint256 _tcr) internal view returns (bool) {

115:     function _convertDebtDenominationToBtc(
116:         uint256 _debt,
117:         uint256 _price
118:     ) internal pure returns (uint256) {

124:     function _checkICRAgainstLiqThreshold(uint256 _icr, uint _tcr) internal view returns (bool) {

134:     function _checkICRAgainstMCR(uint256 _icr) internal view returns (bool) {

140:     function _checkICRAgainstTCR(uint256 _icr, uint _tcr) internal view returns (bool) {
```

- *EbtcMath.sol* ( [20](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/EbtcMath.sol#L20), [24](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/EbtcMath.sol#L24), [35](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/EbtcMath.sol#L35), [59](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/EbtcMath.sol#L59), [88](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/EbtcMath.sol#L88), [92](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/EbtcMath.sol#L92), [104-108](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/EbtcMath.sol#L104-L108) ):

```solidity
20:     function _min(uint256 _a, uint256 _b) internal pure returns (uint256) {

24:     function _max(uint256 _a, uint256 _b) internal pure returns (uint256) {

35:     function decMul(uint256 x, uint256 y) internal pure returns (uint256 decProd) {

59:     function _decPow(uint256 _base, uint256 _minutes) internal pure returns (uint256) {

88:     function _getAbsoluteDifference(uint256 _a, uint256 _b) internal pure returns (uint256) {

92:     function _computeNominalCR(uint256 _collShares, uint256 _debt) internal pure returns (uint256) {

104:     function _computeCR(
105:         uint256 _stEthBalance,
106:         uint256 _debt,
107:         uint256 _price
108:     ) internal pure returns (uint256) {
```

- *RolesAuthority.sol* ( [38](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/RolesAuthority.sol#L38), [42-46](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/RolesAuthority.sol#L42-L46), [50](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/RolesAuthority.sol#L50), [63-67](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/RolesAuthority.sol#L63-L67) ):

```solidity
38:     function doesUserHaveRole(address user, uint8 role) public view virtual returns (bool) {

42:     function doesRoleHaveCapability(
43:         uint8 role,
44:         address target,
45:         bytes4 functionSig
46:     ) public view virtual returns (bool) {

50:     function isPublicCapability(address target, bytes4 functionSig) public view returns (bool) {

63:     function canCall(
64:         address user,
65:         address target,
66:         bytes4 functionSig
67:     ) public view virtual override returns (bool) {
```

- *EBTCToken.sol* ( [111](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/EBTCToken.sol#L111), [115](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/EBTCToken.sol#L115), [119](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/EBTCToken.sol#L119), [125](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/EBTCToken.sol#L125), [129](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/EBTCToken.sol#L129), [134-138](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/EBTCToken.sol#L134-L138), [152-155](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/EBTCToken.sol#L152-L155), [160-163](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/EBTCToken.sol#L160-L163), [225](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/EBTCToken.sol#L225), [231](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/EBTCToken.sol#L231), [235-239](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/EBTCToken.sol#L235-L239) ):

```solidity
111:     function totalSupply() external view override returns (uint256) {

115:     function balanceOf(address account) external view override returns (uint256) {

119:     function transfer(address recipient, uint256 amount) external override returns (bool) {

125:     function allowance(address owner, address spender) external view override returns (uint256) {

129:     function approve(address spender, uint256 amount) external override returns (bool) {

134:     function transferFrom(
135:         address sender,
136:         address recipient,
137:         uint256 amount
138:     ) external override returns (bool) {

152:     function increaseAllowance(
153:         address spender,
154:         uint256 addedValue
155:     ) external override returns (bool) {

160:     function decreaseAllowance(
161:         address spender,
162:         uint256 subtractedValue
163:     ) external override returns (bool) {

225:     function nonces(address owner) external view override(IERC2612, PermitNonce) returns (uint256) {

231:     function _chainID() private view returns (uint256) {

235:     function _buildDomainSeparator(
236:         bytes32 typeHash,
237:         bytes32 name,
238:         bytes32 version
239:     ) private view returns (bytes32) {
```

- *HintHelpers.sol* ( [164-168](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/HintHelpers.sol#L164-L168) ):

```solidity
164:     function getApproxHint(
165:         uint256 _CR,
166:         uint256 _numTrials,
167:         uint256 _inputRandomSeed
168:     ) external view returns (bytes32 hint, uint256 diff, uint256 latestRandomSeed) {
```

- *IActivePool.sol* ( [37](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IActivePool.sol#L37), [39](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IActivePool.sol#L39) ):

```solidity
37:     function feeRecipientAddress() external view returns (address);

39:     function getFeeRecipientClaimableCollShares() external view returns (uint256);
```

- *IBorrowerOperations.sol* ( [20-25](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IBorrowerOperations.sol#L20-L25), [27-33](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IBorrowerOperations.sol#L27-L33), [86](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IBorrowerOperations.sol#L86) ):

```solidity
20:     function openCdp(
21:         uint256 _EBTCAmount,
22:         bytes32 _upperHint,
23:         bytes32 _lowerHint,
24:         uint256 _stEthBalance
25:     ) external returns (bytes32);

27:     function openCdpFor(
28:         uint _EBTCAmount,
29:         bytes32 _upperHint,
30:         bytes32 _lowerHint,
31:         uint _collAmount,
32:         address _borrower
33:     ) external returns (bytes32);

86:     function feeRecipientAddress() external view returns (address);
```

- *ICdpManager.sol* ( [11](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManager.sol#L11), [13](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManager.sol#L13), [36](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManager.sol#L36), [42](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManager.sol#L42), [44](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManager.sol#L44), [46](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManager.sol#L46), [48](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManager.sol#L48), [50](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManager.sol#L50), [52](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManager.sol#L52), [54](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManager.sol#L54), [56](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManager.sol#L56), [75](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManager.sol#L75), [77](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManager.sol#L77) ):

```solidity
11:     function getActiveCdpsCount() external view returns (uint256);

13:     function getIdFromCdpIdsArray(uint256 _index) external view returns (bytes32);

36:     function updateStakeAndTotalStakes(bytes32 _cdpId) external returns (uint256);

42:     function getRedemptionRate() external view returns (uint256);

44:     function getRedemptionRateWithDecay() external view returns (uint256);

46:     function getRedemptionFeeWithDecay(uint256 _stETHToRedeem) external view returns (uint256);

48:     function getCdpStatus(bytes32 _cdpId) external view returns (uint256);

50:     function getCdpStake(bytes32 _cdpId) external view returns (uint256);

52:     function getCdpDebt(bytes32 _cdpId) external view returns (uint256);

54:     function getCdpCollShares(bytes32 _cdpId) external view returns (uint256);

56:     function getCdpLiquidatorRewardShares(bytes32 _cdpId) external view returns (uint);

75:     function getCachedTCR(uint256 _price) external view returns (uint256);

77:     function checkRecoveryMode(uint256 _price) external view returns (bool);
```

- *ICdpManagerData.sol* ( [217](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManagerData.sol#L217), [219](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManagerData.sol#L219), [221](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManagerData.sol#L221), [223](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManagerData.sol#L223), [225](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManagerData.sol#L225), [227-230](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManagerData.sol#L227-L230), [236-239](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManagerData.sol#L236-L239), [241](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManagerData.sol#L241), [243](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManagerData.sol#L243), [245](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManagerData.sol#L245), [247](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManagerData.sol#L247), [249](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManagerData.sol#L249), [251](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManagerData.sol#L251), [253](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManagerData.sol#L253), [255](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManagerData.sol#L255), [257](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManagerData.sol#L257), [259-261](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManagerData.sol#L259-L261), [263](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManagerData.sol#L263) ):

```solidity
217:     function totalStakes() external view returns (uint256);

219:     function ebtcToken() external view returns (IEBTCToken);

221:     function systemStEthFeePerUnitIndex() external view returns (uint256);

223:     function systemStEthFeePerUnitIndexError() external view returns (uint256);

225:     function stEthIndex() external view returns (uint256);

227:     function calcFeeUponStakingReward(
228:         uint256 _newIndex,
229:         uint256 _prevIndex
230:     ) external view returns (uint256, uint256, uint256);

236:     function getAccumulatedFeeSplitApplied(
237:         bytes32 _cdpId,
238:         uint256 _systemStEthFeePerUnitIndex
239:     ) external view returns (uint256, uint256);

241:     function getCachedNominalICR(bytes32 _cdpId) external view returns (uint256);

243:     function getCachedICR(bytes32 _cdpId, uint256 _price) external view returns (uint256);

245:     function getSyncedCdpDebt(bytes32 _cdpId) external view returns (uint256);

247:     function getSyncedCdpCollShares(bytes32 _cdpId) external view returns (uint256);

249:     function getSyncedICR(bytes32 _cdpId, uint256 _price) external view returns (uint256);

251:     function getSyncedTCR(uint256 _price) external view returns (uint256);

253:     function getSyncedNominalICR(bytes32 _cdpId) external view returns (uint256);

255:     function getPendingRedistributedDebt(bytes32 _cdpId) external view returns (uint256);

257:     function hasPendingRedistributedDebt(bytes32 _cdpId) external view returns (bool);

259:     function getSyncedDebtAndCollShares(
260:         bytes32 _cdpId
261:     ) external view returns (uint256 debt, uint256 collShares);

263:     function canLiquidateRecoveryMode(uint256 icr, uint256 tcr) external view returns (bool);
```

- *ICollSurplusPool.sol* ( [15](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICollSurplusPool.sol#L15), [17](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICollSurplusPool.sol#L17) ):

```solidity
15:     function getTotalSurplusCollShares() external view returns (uint256);

17:     function getSurplusCollShares(address _account) external view returns (uint256);
```

- *IERC3156FlashLender.sol* ( [28-33](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IERC3156FlashLender.sol#L28-L33) ):

```solidity
28:     function flashLoan(
29:         IERC3156FlashBorrower receiver,
30:         address token,
31:         uint256 amount,
32:         bytes calldata data
33:     ) external returns (bool);
```

- *IEbtcBase.sol* ( [8](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IEbtcBase.sol#L8) ):

```solidity
8:     function priceFeed() external view returns (IPriceFeed);
```

- *IFallbackCaller.sol* ( [13](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IFallbackCaller.sol#L13), [17](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IFallbackCaller.sol#L17) ):

```solidity
13:     function getFallbackResponse() external view returns (uint256, uint256, bool);

17:     function fallbackTimeout() external view returns (uint256);
```

- *IPermitNonce.sol* ( [7](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IPermitNonce.sol#L7), [9](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IPermitNonce.sol#L9) ):

```solidity
7:     function increasePermitNonce() external returns (uint256);

9:     function nonces(address owner) external view returns (uint256);
```

- *IPool.sol* ( [15](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IPool.sol#L15), [17](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IPool.sol#L17) ):

```solidity
15:     function getSystemCollShares() external view returns (uint256);

17:     function getSystemDebt() external view returns (uint256);
```

- *IPositionManagers.sol* ( [18-21](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IPositionManagers.sol#L18-L21), [42](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IPositionManagers.sol#L42), [44](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IPositionManagers.sol#L44), [46](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IPositionManagers.sol#L46) ):

```solidity
18:     function getPositionManagerApproval(
19:         address _borrower,
20:         address _positionManager
21:     ) external view returns (PositionManagerApproval);

42:     function version() external view returns (string memory);

44:     function permitTypeHash() external view returns (bytes32);

46:     function domainSeparator() external view returns (bytes32);
```

- *IPriceFeed.sol* ( [43](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IPriceFeed.sol#L43) ):

```solidity
43:     function fetchPrice() external returns (uint256);
```

- *ISortedCdps.sol* ( [20](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ISortedCdps.sol#L20), [22](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ISortedCdps.sol#L22), [24](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ISortedCdps.sol#L24), [26](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ISortedCdps.sol#L26), [28](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ISortedCdps.sol#L28), [30](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ISortedCdps.sol#L30), [32](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ISortedCdps.sol#L32), [34](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ISortedCdps.sol#L34), [36](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ISortedCdps.sol#L36), [38-42](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ISortedCdps.sol#L38-L42), [44-48](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ISortedCdps.sol#L44-L48), [50-55](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ISortedCdps.sol#L50-L55), [57](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ISortedCdps.sol#L57), [59](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ISortedCdps.sol#L59), [61](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ISortedCdps.sol#L61), [63-67](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ISortedCdps.sol#L63-L67), [69](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ISortedCdps.sol#L69), [71-75](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ISortedCdps.sol#L71-L75), [77](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ISortedCdps.sol#L77), [79-84](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ISortedCdps.sol#L79-L84) ):

```solidity
20:     function contains(bytes32 _id) external view returns (bool);

22:     function isFull() external view returns (bool);

24:     function isEmpty() external view returns (bool);

26:     function getSize() external view returns (uint256);

28:     function getMaxSize() external view returns (uint256);

30:     function getFirst() external view returns (bytes32);

32:     function getLast() external view returns (bytes32);

34:     function getNext(bytes32 _id) external view returns (bytes32);

36:     function getPrev(bytes32 _id) external view returns (bytes32);

38:     function validInsertPosition(
39:         uint256 _ICR,
40:         bytes32 _prevId,
41:         bytes32 _nextId
42:     ) external view returns (bool);

44:     function findInsertPosition(
45:         uint256 _ICR,
46:         bytes32 _prevId,
47:         bytes32 _nextId
48:     ) external view returns (bytes32, bytes32);

50:     function insert(
51:         address owner,
52:         uint256 _ICR,
53:         bytes32 _prevId,
54:         bytes32 _nextId
55:     ) external returns (bytes32);

57:     function getOwnerAddress(bytes32 _id) external pure returns (address);

59:     function nonExistId() external view returns (bytes32);

61:     function cdpCountOf(address owner) external view returns (uint256);

63:     function getCdpCountOf(
64:         address owner,
65:         bytes32 startNodeId,
66:         uint maxNodes
67:     ) external view returns (uint256, bytes32);

69:     function getCdpsOf(address owner) external view returns (bytes32[] memory);

71:     function getAllCdpsOf(
72:         address owner,
73:         bytes32 startNodeId,
74:         uint maxNodes
75:     ) external view returns (bytes32[] memory, uint256, bytes32);

77:     function cdpOfOwnerByIndex(address owner, uint256 index) external view returns (bytes32);

79:     function cdpOfOwnerByIdx(
80:         address owner,
81:         uint256 index,
82:         bytes32 startNodeId,
83:         uint maxNodes
84:     ) external view returns (bytes32, bool);
```

- *LeverageMacroBase.sol* ( [15](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LeverageMacroBase.sol#L15), [39](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LeverageMacroBase.sol#L39), [338](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LeverageMacroBase.sol#L338), [344-350](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LeverageMacroBase.sol#L344-L350), [498-504](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LeverageMacroBase.sol#L498-L504) ):

```solidity
15:     function Cdps(bytes32) external view returns (ICdpManagerData.Cdp memory);

39:     function owner() public virtual returns (address) {

338:     function decodeFLData(bytes calldata data) public view returns (LeverageMacroOperation memory) {

344:     function onFlashLoan(
345:         address initiator,
346:         address token,
347:         uint256 amount,
348:         uint256 fee,
349:         bytes calldata data
350:     ) external returns (bytes32) {

498:     function excessivelySafeCall(
499:         address _target,
500:         uint256 _gas,
501:         uint256 _value,
502:         uint16 _maxCopy,
503:         bytes memory _calldata
504:     ) internal returns (bool, bytes memory) {
```

- *LeverageMacroDelegateTarget.sol* ( [7](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LeverageMacroDelegateTarget.sol#L7), [63](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LeverageMacroDelegateTarget.sol#L63) ):

```solidity
7:     function owner() external view returns (address);

63:     function owner() public override returns (address) {
```

- *LeverageMacroFactory.sol* ( [38](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LeverageMacroFactory.sol#L38), [43](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LeverageMacroFactory.sol#L43) ):

```solidity
38:     function deployNewMacro() external returns (address) {

43:     function deployNewMacro(address _owner) public returns (address) {
```

- *LeverageMacroReference.sol* ( [44](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LeverageMacroReference.sol#L44) ):

```solidity
44:     function owner() public override returns (address) {
```

- *LiquidationLibrary.sol* ( [186-189](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LiquidationLibrary.sol#L186-L189), [223-225](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LiquidationLibrary.sol#L223-L225), [295-297](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LiquidationLibrary.sol#L295-L297), [384](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LiquidationLibrary.sol#L384), [397-399](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LiquidationLibrary.sol#L397-L399), [544-549](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LiquidationLibrary.sol#L544-L549), [570-575](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LiquidationLibrary.sol#L570-L575), [733-738](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LiquidationLibrary.sol#L733-L738), [807-811](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LiquidationLibrary.sol#L807-L811), [839-842](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LiquidationLibrary.sol#L839-L842) ):

```solidity
186:     function _liquidateCdpInGivenMode(
187:         LiquidationLocals memory _liqState,
188:         LiquidationRecoveryModeLocals memory _recoveryState
189:     ) private returns (uint256, uint256, uint256, uint256, uint256) {

223:     function _liquidateIndividualCdpSetupCDPInNormalMode(
224:         LiquidationLocals memory _liqState
225:     ) private returns (LiquidationLocals memory) {

295:     function _liquidateIndividualCdpSetupCDPInRecoveryMode(
296:         LiquidationRecoveryModeLocals memory _recoveryState
297:     ) private returns (LiquidationRecoveryModeLocals memory) {

384:     function _closeCdpByLiquidation(bytes32 _cdpId) private returns (uint256, uint256, uint256) {

397:     function _liquidateCDPPartially(
398:         LiquidationLocals memory _partialState
399:     ) private returns (uint256, uint256) {

544:     function _calculatePartialLiquidationSurplusAndCap(
545:         uint256 _ICR,
546:         uint256 _price,
547:         uint256 _totalDebtToBurn,
548:         uint256 _totalColToSend
549:     ) private view returns (uint256 toLiquidator, uint256 collSurplus, uint256 debtToRedistribute) {

570:     function _calculateFullLiquidationSurplusAndCap(
571:         uint256 _ICR,
572:         uint256 _price,
573:         uint256 _totalDebtToBurn,
574:         uint256 _totalColToSend
575:     ) private view returns (uint256 toLiquidator, uint256 collSurplus, uint256 debtToRedistribute) {

733:     function _getTotalFromBatchLiquidate_RecoveryMode(
734:         uint256 _price,
735:         uint256 _systemCollShares,
736:         uint256 _systemDebt,
737:         bytes32[] memory _cdpArray
738:     ) internal returns (LiquidationTotals memory totals) {

807:     function _getTotalsFromBatchLiquidate_NormalMode(
808:         uint256 _price,
809:         uint256 _TCR,
810:         bytes32[] memory _cdpArray
811:     ) internal returns (LiquidationTotals memory totals) {

839:     function _addLiquidationValuesToTotals(
840:         LiquidationTotals memory oldTotals,
841:         LiquidationValues memory singleLiquidation
842:     ) internal pure returns (LiquidationTotals memory newTotals) {
```

- *PriceFeed.sol* ( [98](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/PriceFeed.sol#L98), [465](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/PriceFeed.sol#L465), [493](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/PriceFeed.sol#L493), [788-793](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/PriceFeed.sol#L788-L793) ):

```solidity
98:     function fetchPrice() external override returns (uint256) {

465:     function _fallbackIsBroken(FallbackResponse memory _response) internal view returns (bool) {

493:     function _responseTimeout(uint256 _timestamp, uint256 _timeout) internal view returns (bool) {

788:     function _formatClAggregateAnswer(
789:         int256 _ethBtcAnswer,
790:         int256 _stEthEthAnswer,
791:         uint8 _ethBtcDecimals,
792:         uint8 _stEthEthDecimals
793:     ) internal view returns (uint256) {
```

- *SimplifiedDiamondLike.sol* ( [83](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SimplifiedDiamondLike.sol#L83) ):

```solidity
83:     function _getStorage() internal pure returns (DiamondLikeStorage storage ds) {
```

- *SortedCdps.sol* ( [237-241](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L237-L241), [299-304](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L299-L304), [591-595](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L591-L595), [674-678](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L674-L678) ):

```solidity
237:     function _cdpCountOf(
238:         address owner,
239:         bytes32 startNodeId,
240:         uint maxNodes
241:     ) internal view returns (uint256, bytes32) {

299:     function _getCdpsOf(
300:         address owner,
301:         bytes32 startNodeId,
302:         uint maxNodes,
303:         uint maxArraySize
304:     ) internal view returns (bytes32[] memory, uint256, bytes32) {

591:     function _validInsertPosition(
592:         uint256 _NICR,
593:         bytes32 _prevId,
594:         bytes32 _nextId
595:     ) internal view returns (bool) {

674:     function _findInsertPosition(
675:         uint256 _NICR,
676:         bytes32 _prevId,
677:         bytes32 _nextId
678:     ) internal view returns (bytes32, bytes32) {
```

</details>

### [N&#x2011;48] State variables should have NatSpec descriptions

It is [recommended](https://docs.soliditylang.org/en/v0.8.20/natspec-format.html#tags) to use the NatSpec tags `@notice`, `@dev`, `@return`, `@inheritdoc` for public state variables, and `@dev` for non-public state variables.

<details>
<summary>There are 53 instances (click to show):</summary>

- *ActivePool.sol* ( [29](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/ActivePool.sol#L29), [31](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/ActivePool.sol#L31), [32](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/ActivePool.sol#L32), [33](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/ActivePool.sol#L33) ):

```solidity
29:     address public feeRecipientAddress;

31:     uint256 internal systemCollShares; // deposited collateral tracker

32:     uint256 internal systemDebt;

33:     uint256 internal feeRecipientCollShares; // coll shares claimable by fee recipient
```

- *BorrowerOperations.sol* ( [57](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L57), [65](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L65) ):

```solidity
57:     address public feeRecipientAddress;

65:     mapping(address => mapping(address => PositionManagerApproval)) public positionManagers;
```

- *CdpManagerStorage.sol* ( [24](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L24), [25](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L25), [142](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L142), [143](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L143), [148](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L148), [159](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L159), [161](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L161), [163](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L163), [166](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L166), [168](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L168), [170](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L170), [173](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L173), [176](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L176), [187](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L187), [190](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L190), [193](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L193), [196](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L196), [198](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L198), [200](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L200), [202](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L202), [205](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L205) ):

```solidity
24:     uint128 public lastGracePeriodStartTimestamp = UNSET_TIMESTAMP; // use max to signify

25:     uint128 public recoveryModeGracePeriodDuration = MINIMUM_GRACE_PERIOD;

142:     uint256 public redemptionFeeFloor = MIN_REDEMPTION_FEE_FLOOR;

143:     bool public redemptionsPaused;

148:     uint256 public minuteDecayFactor = 999037758833783000;

159:     uint256 public beta = 2;

161:     uint256 public baseRate;

163:     uint256 public stakingRewardSplit;

166:     uint256 public lastRedemptionTimestamp;

168:     mapping(bytes32 => Cdp) public Cdps;

170:     uint256 public override totalStakes;

173:     uint256 public totalStakesSnapshot;

176:     uint256 public totalCollateralSnapshot;

187:     uint256 public systemDebtRedistributionIndex;

190:     mapping(bytes32 => uint256) public cdpDebtRedistributionIndex;

193:     uint256 public lastEBTCDebtErrorRedistribution;

196:     uint256 public override stEthIndex;

198:     uint256 public override systemStEthFeePerUnitIndex;

200:     uint256 public override systemStEthFeePerUnitIndexError;

202:     mapping(bytes32 => uint256) public cdpStEthFeePerUnitIndex;

205:     bytes32[] public CdpIds;
```

- *CollSurplusPool.sol* ( [28](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CollSurplusPool.sol#L28), [30](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CollSurplusPool.sol#L30) ):

```solidity
28:     uint256 internal totalSurplusCollShares;

30:     mapping(address => uint256) internal balances;
```

- *Auth.sol* ( [14](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/Auth.sol#L14), [16](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/Auth.sol#L16) ):

```solidity
14:     address public owner;

16:     Authority public authority;
```

- *AuthNoOwner.sol* ( [13](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/AuthNoOwner.sol#L13), [14](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/AuthNoOwner.sol#L14) ):

```solidity
13:     Authority private _authority;

14:     bool private _authorityInitialized;
```

- *ERC3156FlashLender.sol* ( [14](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/ERC3156FlashLender.sol#L14), [15](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/ERC3156FlashLender.sol#L15) ):

```solidity
14:     uint16 public feeBps = 3; // may be subject to future adjustments through protocol governance

15:     bool public flashLoansPaused;
```

- *ReentrancyGuard.sol* ( [11](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/ReentrancyGuard.sol#L11) ):

```solidity
11:     uint256 public locked = OPEN;
```

- *RolesAuthority.sol* ( [26](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/RolesAuthority.sol#L26), [27](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/RolesAuthority.sol#L27), [28](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/RolesAuthority.sol#L28), [30](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/RolesAuthority.sol#L30), [32](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/RolesAuthority.sol#L32), [34](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/RolesAuthority.sol#L34), [36](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/RolesAuthority.sol#L36) ):

```solidity
26:     EnumerableSet.AddressSet internal users;

27:     EnumerableSet.AddressSet internal targets;

28:     mapping(address => EnumerableSet.Bytes32Set) internal enabledFunctionSigsByTarget;

30:     EnumerableSet.Bytes32Set internal enabledFunctionSigsPublic;

32:     mapping(address => bytes32) public getUserRoles;

34:     mapping(address => mapping(bytes4 => CapabilityFlag)) public capabilityFlag;

36:     mapping(address => mapping(bytes4 => bytes32)) public getRolesWithCapability;
```

- *EBTCToken.sol* ( [27](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/EBTCToken.sol#L27), [51](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/EBTCToken.sol#L51), [52](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/EBTCToken.sol#L52) ):

```solidity
27:     uint256 private _totalSupply;

51:     mapping(address => uint256) private _balances;

52:     mapping(address => mapping(address => uint256)) private _allowances;
```

- *Governor.sol* ( [17](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Governor.sol#L17), [30](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Governor.sol#L30) ):

```solidity
17:     bytes32 NO_ROLES = bytes32(0);

30:     mapping(uint8 => string) internal roleNames;
```

- *PriceFeed.sol* ( [29](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/PriceFeed.sol#L29), [45](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/PriceFeed.sol#L45), [48](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/PriceFeed.sol#L48) ):

```solidity
29:     IFallbackCaller public fallbackCaller; // Wrapper contract that calls the fallback system

45:     uint256 public lastGoodPrice;

48:     Status public status;
```

- *SortedCdps.sol* ( [77](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L77), [79](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L79) ):

```solidity
77:     Data public data;

79:     uint256 public nextCdpNonce;
```

</details>

### [N&#x2011;49] Struct names should use CapWords style

It is recommended by the [Solidity Style Guide](https://docs.soliditylang.org/en/latest/style-guide.html#struct-names).

There are 3 instances:

- *HintHelpers.sol* ( [19](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/HintHelpers.sol#L19) ):

```solidity
19:     struct LocalVariables_getRedemptionHints {
```

- *ICdpManagerData.sol* ( [147](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManagerData.sol#L147), [154](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManagerData.sol#L154) ):

```solidity
147:     struct LocalVariables_OuterLiquidationFunction {

154:     struct LocalVariables_LiquidationSequence {
```

### [N&#x2011;50] Functions should be named in mixedCase style

As the [Solidity Style Guide](https://docs.soliditylang.org/en/v0.8.21/style-guide.html#function-names) suggests: functions should be named in mixedCase style.

<details>
<summary>There are 47 instances (click to show):</summary>

- *ActivePool.sol* ( [227](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/ActivePool.sol#L227) ):

```solidity
227:     function _requireCallerIsBOorCdpM() internal view {
```

- *BorrowerOperations.sol* ( [659](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L659), [910](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L910), [917](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L917), [921](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L921), [928](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L928), [986](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L986), [1004](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L1004), [1049](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L1049) ):

```solidity
659:     function DOMAIN_SEPARATOR() external view returns (bytes32) {

910:     function _requireICRisNotBelowMCR(uint256 _newICR) internal pure {

917:     function _requireICRisNotBelowCCR(uint256 _newICR) internal pure {

921:     function _requireNoDecreaseOfICR(uint256 _newICR, uint256 _oldICR) internal pure {

928:     function _requireNewTCRisNotBelowCCR(uint256 _newTCR) internal pure {

986:     function _getNewNominalICRFromCdpChange(

1004:     function _getNewICRFromCdpChange(

1049:     function _getNewTCRFromCdpChange(
```

- *CdpManager.sol* ( [580](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L580), [757](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L757) ):

```solidity
580:     function getCachedTCR(uint256 _price) external view override returns (uint256) {

757:     function _requireTCRisNotBelowMCR(uint256 _price, uint256 _TCR) internal view {
```

- *CdpManagerStorage.sol* ( [489](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L489), [673](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L673), [684](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L684), [701](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L701), [707](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L707), [864](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L864), [874](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L874) ):

```solidity
489:     function _computeTCRWithGivenSystemValues(

673:     function getCachedNominalICR(bytes32 _cdpId) external view returns (uint256) {

684:     function getSyncedNominalICR(bytes32 _cdpId) external view returns (uint256) {

701:     function getCachedICR(bytes32 _cdpId, uint256 _price) public view returns (uint256) {

707:     function _calculateCR(

864:     function getSyncedICR(bytes32 _cdpId, uint256 _price) public view returns (uint256) {

874:     function getSyncedTCR(uint256 _price) public view returns (uint256) {
```

- *EbtcBase.sol* ( [79](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/EbtcBase.sol#L79), [83](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/EbtcBase.sol#L83), [99](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/EbtcBase.sol#L99), [124](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/EbtcBase.sol#L124), [134](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/EbtcBase.sol#L134), [140](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/EbtcBase.sol#L140) ):

```solidity
79:     function _getCachedTCR(uint256 _price) internal view returns (uint256 TCR) {

83:     function _getTCRWithSystemDebtAndCollShares(

99:     function _checkRecoveryModeForTCR(uint256 _tcr) internal view returns (bool) {

124:     function _checkICRAgainstLiqThreshold(uint256 _icr, uint _tcr) internal view returns (bool) {

134:     function _checkICRAgainstMCR(uint256 _icr) internal view returns (bool) {

140:     function _checkICRAgainstTCR(uint256 _icr, uint _tcr) internal view returns (bool) {
```

- *EbtcMath.sol* ( [92](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/EbtcMath.sol#L92), [104](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/EbtcMath.sol#L104) ):

```solidity
92:     function _computeNominalCR(uint256 _collShares, uint256 _debt) internal pure returns (uint256) {

104:     function _computeCR(
```

- *EBTCToken.sol* ( [176](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/EBTCToken.sol#L176), [314](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/EBTCToken.sol#L314), [323](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/EBTCToken.sol#L323) ):

```solidity
176:     function DOMAIN_SEPARATOR() external view returns (bytes32) {

314:     function _requireCallerIsBOorCdpMOrAuth() internal view {

323:     function _requireCallerIsCdpM() internal view {
```

- *HintHelpers.sol* ( [203](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/HintHelpers.sol#L203), [212](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/HintHelpers.sol#L212) ):

```solidity
203:     function computeNominalCR(uint256 _coll, uint256 _debt) external pure returns (uint256) {

212:     function computeCR(
```

- *ICdpManager.sol* ( [75](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManager.sol#L75) ):

```solidity
75:     function getCachedTCR(uint256 _price) external view returns (uint256);
```

- *ICdpManagerData.sol* ( [241](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManagerData.sol#L241), [243](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManagerData.sol#L243), [249](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManagerData.sol#L249), [251](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManagerData.sol#L251), [253](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManagerData.sol#L253) ):

```solidity
241:     function getCachedNominalICR(bytes32 _cdpId) external view returns (uint256);

243:     function getCachedICR(bytes32 _cdpId, uint256 _price) external view returns (uint256);

249:     function getSyncedICR(bytes32 _cdpId, uint256 _price) external view returns (uint256);

251:     function getSyncedTCR(uint256 _price) external view returns (uint256);

253:     function getSyncedNominalICR(bytes32 _cdpId) external view returns (uint256);
```

- *LeverageMacroBase.sol* ( [15](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LeverageMacroBase.sol#L15), [338](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LeverageMacroBase.sol#L338) ):

```solidity
15:     function Cdps(bytes32) external view returns (ICdpManagerData.Cdp memory);

338:     function decodeFLData(bytes calldata data) public view returns (LeverageMacroOperation memory) {
```

- *LiquidationLibrary.sol* ( [135](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LiquidationLibrary.sol#L135), [223](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LiquidationLibrary.sol#L223), [295](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LiquidationLibrary.sol#L295), [397](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LiquidationLibrary.sol#L397), [733](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LiquidationLibrary.sol#L733), [807](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LiquidationLibrary.sol#L807) ):

```solidity
135:     function _liquidateIndividualCdpSetupCDP(

223:     function _liquidateIndividualCdpSetupCDPInNormalMode(

295:     function _liquidateIndividualCdpSetupCDPInRecoveryMode(

397:     function _liquidateCDPPartially(

733:     function _getTotalFromBatchLiquidate_RecoveryMode(

807:     function _getTotalsFromBatchLiquidate_NormalMode(
```

- *PriceFeed.sol* ( [775](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/PriceFeed.sol#L775) ):

```solidity
775:     function _checkHealthyCLResponse(uint80 _roundId, int256 _answer) internal view returns (bool) {
```

- *SortedCdps.sol* ( [719](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L719) ):

```solidity
719:     function _requireCallerIsBOorCdpM() internal view {
```

</details>

### [N&#x2011;51] Variable names for `immutable`s should use UPPER_CASE_WITH_UNDERSCORES

For `immutable` variable names, each word should use all capital letters, with underscores separating each word (UPPER_CASE_WITH_UNDERSCORES)

<details>
<summary>There are 44 instances (click to show):</summary>

- *ActivePool.sol* ( [26](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/ActivePool.sol#L26), [27](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/ActivePool.sol#L27), [28](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/ActivePool.sol#L28), [34](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/ActivePool.sol#L34) ):

```solidity
26:     address public immutable borrowerOperationsAddress;

27:     address public immutable cdpManagerAddress;

28:     address public immutable collSurplusPoolAddress;

34:     ICollateralToken public immutable collateral;
```

- *BorrowerOperations.sol* ( [53](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L53), [55](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L55), [59](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L59), [62](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L62) ):

```solidity
53:     ICdpManager public immutable cdpManager;

55:     ICollSurplusPool public immutable collSurplusPool;

59:     IEBTCToken public immutable ebtcToken;

62:     ISortedCdps public immutable sortedCdps;
```

- *CdpManagerStorage.sol* ( [126](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L126), [128](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L128), [130](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L130), [132](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L132), [135](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L135), [152](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L152) ):

```solidity
126:     address public immutable borrowerOperationsAddress;

128:     ICollSurplusPool immutable collSurplusPool;

130:     IEBTCToken public immutable override ebtcToken;

132:     address public immutable liquidationLibrary;

135:     ISortedCdps public immutable sortedCdps;

152:     uint256 internal immutable deploymentStartTime;
```

- *CollSurplusPool.sol* ( [21](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CollSurplusPool.sol#L21), [22](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CollSurplusPool.sol#L22), [23](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CollSurplusPool.sol#L23), [24](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CollSurplusPool.sol#L24), [25](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CollSurplusPool.sol#L25) ):

```solidity
21:     address public immutable borrowerOperationsAddress;

22:     address public immutable cdpManagerAddress;

23:     address public immutable activePoolAddress;

24:     address public immutable feeRecipientAddress;

25:     ICollateralToken public immutable collateral;
```

- *EbtcBase.sol* ( [41](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/EbtcBase.sol#L41), [43](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/EbtcBase.sol#L43), [46](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/EbtcBase.sol#L46) ):

```solidity
41:     IActivePool public immutable activePool;

43:     IPriceFeed public immutable override priceFeed;

46:     ICollateralToken public immutable collateral;
```

- *EBTCToken.sol* ( [55](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/EBTCToken.sol#L55), [56](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/EBTCToken.sol#L56) ):

```solidity
55:     address public immutable cdpManagerAddress;

56:     address public immutable borrowerOperationsAddress;
```

- *HintHelpers.sol* ( [14](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/HintHelpers.sol#L14), [15](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/HintHelpers.sol#L15) ):

```solidity
14:     ISortedCdps public immutable sortedCdps;

15:     ICdpManager public immutable cdpManager;
```

- *LeverageMacroBase.sol* ( [29](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LeverageMacroBase.sol#L29), [30](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LeverageMacroBase.sol#L30), [31](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LeverageMacroBase.sol#L31), [32](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LeverageMacroBase.sol#L32), [33](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LeverageMacroBase.sol#L33), [34](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LeverageMacroBase.sol#L34), [35](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LeverageMacroBase.sol#L35) ):

```solidity
29:     IBorrowerOperations public immutable borrowerOperations;

30:     IActivePool public immutable activePool;

31:     ICdpCdps public immutable cdpManager;

32:     IEBTCToken public immutable ebtcToken;

33:     ISortedCdps public immutable sortedCdps;

34:     ICollateralToken public immutable stETH;

35:     bool internal immutable willSweep;
```

- *LeverageMacroFactory.sol* ( [12](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LeverageMacroFactory.sol#L12), [13](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LeverageMacroFactory.sol#L13), [14](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LeverageMacroFactory.sol#L14), [15](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LeverageMacroFactory.sol#L15), [16](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LeverageMacroFactory.sol#L16), [17](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LeverageMacroFactory.sol#L17) ):

```solidity
12:     address public immutable borrowerOperations;

13:     address public immutable activePool;

14:     address public immutable cdpManager;

15:     address public immutable ebtcToken;

16:     address public immutable stETH;

17:     address public immutable sortedCdps;
```

- *LeverageMacroReference.sol* ( [12](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LeverageMacroReference.sol#L12) ):

```solidity
12:     address internal immutable theOwner;
```

- *SimplifiedDiamondLike.sol* ( [42](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SimplifiedDiamondLike.sol#L42) ):

```solidity
42:     address public immutable owner;
```

- *SortedCdps.sol* ( [54](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L54), [56](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L56), [58](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L58) ):

```solidity
54:     address public immutable borrowerOperationsAddress;

56:     ICdpManager public immutable cdpManager;

58:     uint256 public immutable maxSize;
```

</details>

### [N&#x2011;52] Modifiers should be named in mixedCase style

As the [Solidity Style Guide](https://docs.soliditylang.org/en/latest/style-guide.html#modifier-names) suggests: modifiers should be named in mixedCase style. Use mixedCase. Examples: `onlyBy`, `onlyAfter`, `onlyDuringThePreSale`.

There are 2 instances:

- *BorrowerOperations.sol* ( [144](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L144) ):

```solidity
144:     modifier nonReentrantSelfAndCdpM() {
```

- *CdpManagerStorage.sol* ( [241](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L241) ):

```solidity
241:     modifier nonReentrantSelfAndBOps() {
```

### [N&#x2011;53] Variables should be named in mixedCase style

As the [Solidity Style Guide](https://docs.soliditylang.org/en/latest/style-guide.html#naming-styles) suggests: arguments, local variables and mutable state variables should be named in mixedCase style.

<details>
<summary>There are 88 instances (click to show):</summary>

- *BorrowerOperations.sol* ( [79](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L79), [80](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L80), [81](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L81), [91](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L91), [92](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L92), [421](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L421), [482](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L482), [570](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L570), [910](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L910), [917](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L917), [921](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L921), [921](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L921), [928](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L928), [999](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L999), [1022](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L1022), [1065](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L1065) ):

```solidity
/// @audit oldICR
79:         uint256 oldICR;

/// @audit newICR
80:         uint256 newICR;

/// @audit newTCR
81:         uint256 newTCR;

/// @audit ICR
91:         uint256 ICR;

/// @audit NICR
92:         uint256 NICR;

/// @audit newNICR
421:             uint256 newNICR = _getNewNominalICRFromCdpChange(vars, _isDebtIncrease);

/// @audit newTCR
482:         uint256 newTCR = _getNewTCRFromCdpChange(

/// @audit newTCR
570:         uint256 newTCR = _getNewTCRFromCdpChange(

/// @audit _newICR
910:     function _requireICRisNotBelowMCR(uint256 _newICR) internal pure {

/// @audit _newICR
917:     function _requireICRisNotBelowCCR(uint256 _newICR) internal pure {

/// @audit _newICR
921:     function _requireNoDecreaseOfICR(uint256 _newICR, uint256 _oldICR) internal pure {

/// @audit _oldICR
921:     function _requireNoDecreaseOfICR(uint256 _newICR, uint256 _oldICR) internal pure {

/// @audit _newTCR
928:     function _requireNewTCRisNotBelowCCR(uint256 _newTCR) internal pure {

/// @audit newNICR
999:         uint256 newNICR = EbtcMath._computeNominalCR(newCollShares, newDebt);

/// @audit newICR
1022:         uint256 newICR = EbtcMath._computeCR(

/// @audit newTCR
1065:         uint256 newTCR = EbtcMath._computeCR(systemStEthBalance, systemDebt, _price);
```

- *CdpManager.sol* ( [193](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L193), [246](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L246), [325](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L325), [600](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L600), [613](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L613), [615](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L615), [621](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L621), [655](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L655), [669](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L669), [757](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L757) ):

```solidity
/// @audit newNICR
193:             uint256 newNICR = EbtcMath._computeNominalCR(newColl, newDebt);

/// @audit _EBTC
246:         uint256 _EBTC,

/// @audit _partialRedemptionHintNICR
325:         uint256 _partialRedemptionHintNICR,

/// @audit TCR
600:         uint256 TCR = _computeTCRWithGivenSystemValues(_systemCollShares, _systemDebt, _price);

/// @audit _ETHDrawn
613:         uint256 _ETHDrawn,

/// @audit _totalEBTCSupply
615:         uint256 _totalEBTCSupply

/// @audit redeemedEBTCFraction
621:         uint256 redeemedEBTCFraction = (collateral.getPooledEthByShares(_ETHDrawn) * _price) /

/// @audit _ETHDrawn
655:     function _getRedemptionFee(uint256 _ETHDrawn) internal view returns (uint256) {

/// @audit _ETHDrawn
669:         uint256 _ETHDrawn

/// @audit _TCR
757:     function _requireTCRisNotBelowMCR(uint256 _price, uint256 _TCR) internal view {
```

- *CdpManagerStorage.sol* ( [93](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L93), [168](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L168), [193](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L193), [205](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L205), [306](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L306), [652](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L652), [674](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L674), [676](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L676), [693](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L693), [702](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L702), [703](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L703), [721](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L721) ):

```solidity
/// @audit newTCR
93:         uint256 newTCR = EbtcMath._computeCR(

/// @audit Cdps
168:     mapping(bytes32 => Cdp) public Cdps;

/// @audit lastEBTCDebtErrorRedistribution
193:     uint256 public lastEBTCDebtErrorRedistribution;

/// @audit CdpIds
205:     bytes32[] public CdpIds;

/// @audit pendingEBTCDebtReward
306:     ) internal view returns (uint256 pendingEBTCDebtReward, uint256 _debtIndexDiff) {

/// @audit CdpOwnersArrayLength
652:     function _requireMoreThanOneCdpInSystem(uint256 CdpOwnersArrayLength) internal view {

/// @audit currentEBTCDebt
674:         (uint256 currentEBTCDebt, uint256 currentCollShares) = getSyncedDebtAndCollShares(_cdpId);

/// @audit NICR
676:         uint256 NICR = EbtcMath._computeNominalCR(currentCollShares, currentEBTCDebt);

/// @audit NICR
693:         uint256 NICR = EbtcMath._computeNominalCR(_newColl, _newDebt);

/// @audit currentEBTCDebt
702:         (uint256 currentEBTCDebt, uint256 currentCollShares) = getSyncedDebtAndCollShares(_cdpId);

/// @audit ICR
703:         uint256 ICR = _calculateCR(currentCollShares, currentEBTCDebt, _price);

/// @audit pendingEBTCDebtReward
721:     ) public view returns (uint256 pendingEBTCDebtReward) {
```

- *EbtcBase.sol* ( [79](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/EbtcBase.sol#L79), [85](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/EbtcBase.sol#L85) ):

```solidity
/// @audit TCR
79:     function _getCachedTCR(uint256 _price) internal view returns (uint256 TCR) {

/// @audit TCR
85:     ) internal view returns (uint256 TCR, uint256 _coll, uint256 _debt) {
```

- *EbtcMath.sol* ( [36](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/EbtcMath.sol#L36) ):

```solidity
/// @audit prod_xy
36:         uint256 prod_xy = x * y;
```

- *Governor.sol* ( [17](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Governor.sol#L17) ):

```solidity
/// @audit NO_ROLES
17:     bytes32 NO_ROLES = bytes32(0);
```

- *HintHelpers.sol* ( [49](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/HintHelpers.sol#L49), [57](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/HintHelpers.sol#L57), [139](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/HintHelpers.sol#L139), [165](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/HintHelpers.sol#L165), [186](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/HintHelpers.sol#L186) ):

```solidity
/// @audit _EBTCamount
49:         uint256 _EBTCamount,

/// @audit partialRedemptionHintNICR
57:             uint256 partialRedemptionHintNICR,

/// @audit maxRedeemableEBTC
139:         uint256 maxRedeemableEBTC = EbtcMath._min(vars.remainingEbtcToRedeem, currentCdpDebt);

/// @audit _CR
165:         uint256 _CR,

/// @audit currentNICR
186:             uint256 currentNICR = cdpManager.getSyncedNominalICR(_cId);
```

- *IActivePool.sol* ( [9](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IActivePool.sol#L9) ):

```solidity
/// @audit _EBTCDebt
9:     event ActivePoolEBTCDebtUpdated(uint256 _EBTCDebt);
```

- *IBorrowerOperations.sol* ( [21](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IBorrowerOperations.sol#L21), [28](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IBorrowerOperations.sol#L28) ):

```solidity
/// @audit _EBTCAmount
21:         uint256 _EBTCAmount,

/// @audit _EBTCAmount
28:         uint _EBTCAmount,
```

- *ICdpManager.sol* ( [27](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManager.sol#L27), [31](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManager.sol#L31) ):

```solidity
/// @audit _EBTCAmount
27:         uint256 _EBTCAmount,

/// @audit _partialRedemptionHintNICR
31:         uint256 _partialRedemptionHintNICR,
```

- *ICdpManagerData.sol* ( [122](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManagerData.sol#L122), [126](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManagerData.sol#L126), [142](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManagerData.sol#L142), [156](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManagerData.sol#L156), [162](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManagerData.sol#L162), [171](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManagerData.sol#L171) ):

```solidity
/// @audit ICR
122:         uint256 ICR;

/// @audit TCR
126:         uint256 TCR;

/// @audit ICR
142:         uint256 ICR;

/// @audit ICR
156:         uint256 ICR;

/// @audit TCR
162:         uint256 TCR;

/// @audit partialRedemptionHintNICR
171:         uint256 partialRedemptionHintNICR;
```

- *IRecoveryModeGracePeriod.sol* ( [6](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IRecoveryModeGracePeriod.sol#L6) ):

```solidity
/// @audit TCR
6:     event TCRNotified(uint256 TCR); /// NOTE: Mostly for debugging to ensure synch
```

- *ISortedCdps.sol* ( [9](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ISortedCdps.sol#L9), [18](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ISortedCdps.sol#L18), [39](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ISortedCdps.sol#L39), [45](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ISortedCdps.sol#L45), [52](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ISortedCdps.sol#L52) ):

```solidity
/// @audit _NICR
9:     event NodeAdded(bytes32 _id, uint _NICR);

/// @audit _newICR
18:     function reInsert(bytes32 _id, uint256 _newICR, bytes32 _prevId, bytes32 _nextId) external;

/// @audit _ICR
39:         uint256 _ICR,

/// @audit _ICR
45:         uint256 _ICR,

/// @audit _ICR
52:         uint256 _ICR,
```

- *LeverageMacroBase.sol* ( [265](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LeverageMacroBase.sol#L265), [325](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LeverageMacroBase.sol#L325) ):

```solidity
/// @audit OperationData
265:         bytes OperationData; // Generic Operation Data, which we'll decode to use

/// @audit _EBTCChange
325:         uint256 _EBTCChange;
```

- *LiquidationLibrary.sol* ( [74](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LiquidationLibrary.sol#L74), [75](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LiquidationLibrary.sol#L75), [468](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LiquidationLibrary.sol#L468), [545](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LiquidationLibrary.sol#L545), [571](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LiquidationLibrary.sol#L571), [610](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LiquidationLibrary.sol#L610), [692](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LiquidationLibrary.sol#L692), [745](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LiquidationLibrary.sol#L745), [809](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LiquidationLibrary.sol#L809), [878](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LiquidationLibrary.sol#L878), [882](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LiquidationLibrary.sol#L882) ):

```solidity
/// @audit _ICR
74:         uint256 _ICR = getCachedICR(_cdpId, _price); // @audit syncAccounting already called, guarenteed to be synced

/// @audit _TCR
75:         (uint256 _TCR, uint256 systemColl, uint256 systemDebt) = _getTCRWithSystemDebtAndCollShares(

/// @audit _newNICR
468:         uint256 _newNICR,

/// @audit _ICR
545:         uint256 _ICR,

/// @audit _ICR
571:         uint256 _ICR,

/// @audit _TCR
610:         uint256 _TCR,

/// @audit _TCR
692:         (uint256 _TCR, uint256 systemColl, uint256 systemDebt) = _getTCRWithSystemDebtAndCollShares(

/// @audit _TCR
745:         uint256 _TCR = _computeTCRWithGivenSystemValues(

/// @audit _TCR
809:         uint256 _TCR,

/// @audit EBTCDebtNumerator
878:         uint256 EBTCDebtNumerator = (_debt * DECIMAL_PRECISION) + lastEBTCDebtErrorRedistribution;

/// @audit EBTCDebtRewardPerUnitStaked
882:         uint256 EBTCDebtRewardPerUnitStaked = EBTCDebtNumerator / _totalStakes;
```

- *PriceFeed.sol* ( [60](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/PriceFeed.sol#L60), [61](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/PriceFeed.sol#L61) ):

```solidity
/// @audit _collEthCLFeed
60:         address _collEthCLFeed,

/// @audit _ethBtcCLFeed
61:         address _ethBtcCLFeed
```

- *SortedCdps.sol* ( [346](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L346), [363](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L363), [500](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L500), [584](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L584), [592](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L592), [619](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L619), [642](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L642), [667](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L667), [675](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L675) ):

```solidity
/// @audit _NICR
346:         uint256 _NICR,

/// @audit _NICR
363:     function _insert(bytes32 _id, uint256 _NICR, bytes32 _prevId, bytes32 _nextId) internal {

/// @audit _newNICR
500:         uint256 _newNICR,

/// @audit _NICR
584:         uint256 _NICR,

/// @audit _NICR
592:         uint256 _NICR,

/// @audit _NICR
619:     function _descendList(uint256 _NICR, bytes32 _startId) internal view returns (bytes32, bytes32) {

/// @audit _NICR
642:     function _ascendList(uint256 _NICR, bytes32 _startId) internal view returns (bytes32, bytes32) {

/// @audit _NICR
667:         uint256 _NICR,

/// @audit _NICR
675:         uint256 _NICR,
```

</details>

### [N&#x2011;54] Order of contract layout does not follow the Solidity Style Guide

As suggested by the [Solidity Style Guide](https://docs.soliditylang.org/en/v0.8.20/style-guide.html#order-of-layout):
- Layout contract elements in the following order: `pragma statements`, `import statements`, `interfaces`, `libraries`, `contracts`.
- Inside each contract, library or interface, use the following order: `type declarations`, `state variables`, `events`, `errors`, `modifiers`, `functions`.

<details>
<summary>There are 12 instances (click to show):</summary>

- *BorrowerOperations.sol* ( [144](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L144) ):

```solidity
/// @audit â Out of order with constructor ()
144:     modifier nonReentrantSelfAndCdpM() {
```

- *CdpManagerStorage.sol* ( [122](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L122), [241](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L241) ):

```solidity
/// @audit â Out of order with function setGracePeriod()
122:     string public constant NAME = "CdpManager";

/// @audit â Out of order with constructor ()
241:     modifier nonReentrantSelfAndBOps() {
```

- *Auth.sol* ( [14](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/Auth.sol#L14), [26](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/Auth.sol#L26) ):

```solidity
/// @audit â Out of order with event AuthorityUpdated
14:     address public owner;

/// @audit â Out of order with constructor ()
26:     modifier requiresAuth() virtual {
```

- *AuthNoOwner.sol* ( [13](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/AuthNoOwner.sol#L13) ):

```solidity
/// @audit â Out of order with event AuthorityUpdated
13:     Authority private _authority;
```

- *RolesAuthority.sol* ( [26](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/RolesAuthority.sol#L26) ):

```solidity
/// @audit â Out of order with constructor ()
26:     EnumerableSet.AddressSet internal users;
```

- *ICdpManagerData.sol* ( [77](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManagerData.sol#L77) ):

```solidity
/// @audit â Out of order with event CdpFeeSplitApplied
77:     enum CdpOperation {
```

- *IPriceFeed.sol* ( [34](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IPriceFeed.sol#L34) ):

```solidity
/// @audit â Out of order with event UnhealthyFallbackCaller
34:     enum Status {
```

- *LeverageMacroBase.sol* ( [70](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LeverageMacroBase.sol#L70), [284](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LeverageMacroBase.sol#L284) ):

```solidity
/// @audit â Out of order with constructor ()
70:     enum FlashLoanType {

/// @audit â Out of order with function _doCheckValueType()
284:     enum OperationType {
```

- *SimplifiedDiamondLike.sol* ( [94](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SimplifiedDiamondLike.sol#L94) ):

```solidity
/// @audit â Out of order with function _getStorage()
94:     enum OperationType {
```

</details>

### [N&#x2011;55] Missing zero address check in functions with address parameters

Adding a zero address check for each address type parameter can prevent errors.

<details>
<summary>There are 32 instances (click to show):</summary>

- *ActivePool.sol* ( [100](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/ActivePool.sol#L100), [129-133](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/ActivePool.sol#L129-L133), [261-266](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/ActivePool.sol#L261-L266) ):

```solidity
/// @audit `_account not checked`
100:     function transferSystemCollShares(address _account, uint256 _shares) public override {

/// @audit `_account not checked`
129:     function transferSystemCollSharesAndLiquidatorReward(
130:         address _account,
131:         uint256 _shares,
132:         uint256 _liquidatorRewardShares
133:     ) external override {

/// @audit `token not checked`
261:     function flashLoan(
262:         IERC3156FlashBorrower receiver,
263:         address token,
264:         uint256 amount,
265:         bytes calldata data
266:     ) external override returns (bool) {
```

- *BorrowerOperations.sol* ( [187-193](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L187-L193), [628-631](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L628-L631), [647](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L647), [653](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L653), [706-714](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L706-L714), [1077-1082](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L1077-L1082) ):

```solidity
/// @audit `_borrower not checked`
187:     function openCdpFor(
188:         uint256 _debt,
189:         bytes32 _upperHint,
190:         bytes32 _lowerHint,
191:         uint256 _stEthBalance,
192:         address _borrower
193:     ) external override nonReentrantSelfAndCdpM returns (bytes32) {

/// @audit `_positionManager not checked`
628:     function setPositionManagerApproval(
629:         address _positionManager,
630:         PositionManagerApproval _approval
631:     ) external override {

/// @audit `_positionManager not checked`
647:     function revokePositionManagerApproval(address _positionManager) external override {

/// @audit `_borrower not checked`
653:     function renouncePositionManagerApproval(address _borrower) external override {

/// @audit `_positionManager not checked`
706:     function permitPositionManagerApproval(
707:         address _borrower,
708:         address _positionManager,
709:         PositionManagerApproval _approval,
710:         uint256 _deadline,
711:         uint8 v,
712:         bytes32 r,
713:         bytes32 s
714:     ) external override {

/// @audit `token not checked`
1077:     function flashLoan(
1078:         IERC3156FlashBorrower receiver,
1079:         address token,
1080:         uint256 amount,
1081:         bytes calldata data
1082:     ) external override returns (bool) {
```

- *CdpManager.sol* ( [538-543](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L538-L543), [905-911](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L905-L911), [946-953](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L946-L953) ):

```solidity
/// @audit `_borrower not checked`
538:     function closeCdp(
539:         bytes32 _cdpId,
540:         address _borrower,
541:         uint256 _debt,
542:         uint256 _coll
543:     ) external override {

/// @audit `_borrower not checked`
905:     function initializeCdp(
906:         bytes32 _cdpId,
907:         uint256 _debt,
908:         uint256 _coll,
909:         uint256 _liquidatorRewardShares,
910:         address _borrower
911:     ) external {

/// @audit `_borrower not checked`
946:     function updateCdp(
947:         bytes32 _cdpId,
948:         address _borrower,
949:         uint256 _coll,
950:         uint256 _debt,
951:         uint256 _newColl,
952:         uint256 _newDebt
953:     ) external {
```

- *CollSurplusPool.sol* ( [77](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CollSurplusPool.sol#L77), [89](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CollSurplusPool.sol#L89) ):

```solidity
/// @audit `_account not checked`
77:     function increaseSurplusCollShares(address _account, uint256 _amount) external override {

/// @audit `_account not checked`
89:     function claimSurplusCollShares(address _account) external override {
```

- *Auth.sol* ( [42](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/Auth.sol#L42), [52](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/Auth.sol#L52) ):

```solidity
/// @audit `newAuthority not checked`
42:     function setAuthority(Authority newAuthority) public virtual {

/// @audit `newOwner not checked`
52:     function transferOwnership(address newOwner) public virtual requiresAuth {
```

- *AuthNoOwner.sol* ( [38](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/AuthNoOwner.sol#L38) ):

```solidity
/// @audit `newAuthority not checked`
38:     function setAuthority(address newAuthority) public virtual {
```

- *RolesAuthority.sol* ( [85-89](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/RolesAuthority.sol#L85-L89), [106-111](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/RolesAuthority.sol#L106-L111), [133](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/RolesAuthority.sol#L133), [147](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/RolesAuthority.sol#L147) ):

```solidity
/// @audit `target not checked`
85:     function setPublicCapability(
86:         address target,
87:         bytes4 functionSig,
88:         bool enabled
89:     ) public virtual requiresAuth {

/// @audit `target not checked`
106:     function setRoleCapability(
107:         uint8 role,
108:         address target,
109:         bytes4 functionSig,
110:         bool enabled
111:     ) public virtual requiresAuth {

/// @audit `target not checked`
133:     function burnCapability(address target, bytes4 functionSig) public virtual requiresAuth {

/// @audit `user not checked`
147:     function setUserRole(address user, uint8 role, bool enabled) public virtual requiresAuth {
```

- *EBTCToken.sol* ( [85](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/EBTCToken.sol#L85), [95](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/EBTCToken.sol#L95), [129](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/EBTCToken.sol#L129), [134-138](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/EBTCToken.sol#L134-L138), [152-155](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/EBTCToken.sol#L152-L155), [160-163](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/EBTCToken.sol#L160-L163), [199-207](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/EBTCToken.sol#L199-L207) ):

```solidity
/// @audit `_account not checked`
85:     function mint(address _account, uint256 _amount) external override {

/// @audit `_account not checked`
95:     function burn(address _account, uint256 _amount) external override {

/// @audit `spender not checked`
129:     function approve(address spender, uint256 amount) external override returns (bool) {

/// @audit `sender not checked`
134:     function transferFrom(
135:         address sender,
136:         address recipient,
137:         uint256 amount
138:     ) external override returns (bool) {

/// @audit `spender not checked`
152:     function increaseAllowance(
153:         address spender,
154:         uint256 addedValue
155:     ) external override returns (bool) {

/// @audit `spender not checked`
160:     function decreaseAllowance(
161:         address spender,
162:         uint256 subtractedValue
163:     ) external override returns (bool) {

/// @audit `spender not checked`
199:     function permit(
200:         address owner,
201:         address spender,
202:         uint256 amount,
203:         uint256 deadline,
204:         uint8 v,
205:         bytes32 r,
206:         bytes32 s
207:     ) external override {
```

- *LeverageMacroBase.sol* ( [234](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LeverageMacroBase.sol#L234) ):

```solidity
/// @audit `token not checked`
234:     function sweepToken(address token, uint256 amount) public {
```

- *LeverageMacroFactory.sol* ( [43](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LeverageMacroFactory.sol#L43) ):

```solidity
/// @audit `_owner not checked`
43:     function deployNewMacro(address _owner) public returns (address) {
```

- *SimplifiedDiamondLike.sol* ( [51](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SimplifiedDiamondLike.sol#L51) ):

```solidity
/// @audit `handler not checked`
51:     function setFallbackHandler(bytes4 sig, address handler) external {
```

- *SortedCdps.sol* ( [344-349](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L344-L349) ):

```solidity
/// @audit `owner not checked`
344:     function insert(
345:         address owner,
346:         uint256 _NICR,
347:         bytes32 _prevId,
348:         bytes32 _nextId
349:     ) external override returns (bytes32) {
```

</details>

### [N&#x2011;56] Named imports of parent contracts are missing

Consider adding named imports for all parent contracts.

<details>
<summary>There are 40 instances (click to show):</summary>

- *ActivePool.sol* ( [22](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/ActivePool.sol#L22) ):

```solidity
/// @audit IActivePool
/// @audit ERC3156FlashLender
/// @audit ReentrancyGuard
/// @audit BaseMath
/// @audit AuthNoOwner
22: contract ActivePool is IActivePool, ERC3156FlashLender, ReentrancyGuard, BaseMath, AuthNoOwner {
```

- *BorrowerOperations.sol* ( [21-27](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L21-L27) ):

```solidity
/// @audit EbtcBase
/// @audit ReentrancyGuard
/// @audit IBorrowerOperations
/// @audit ERC3156FlashLender
/// @audit AuthNoOwner
/// @audit PermitNonce
21: contract BorrowerOperations is
22:     EbtcBase,
23:     ReentrancyGuard,
24:     IBorrowerOperations,
25:     ERC3156FlashLender,
26:     AuthNoOwner,
27:     PermitNonce
```

- *CdpManager.sol* ( [16](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L16) ):

```solidity
/// @audit CdpManagerStorage
/// @audit ICdpManager
/// @audit Proxy
16: contract CdpManager is CdpManagerStorage, ICdpManager, Proxy {
```

- *CdpManagerStorage.sol* ( [19](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L19) ):

```solidity
/// @audit EbtcBase
/// @audit ReentrancyGuard
/// @audit ICdpManagerData
/// @audit AuthNoOwner
19: contract CdpManagerStorage is EbtcBase, ReentrancyGuard, ICdpManagerData, AuthNoOwner {
```

- *CollSurplusPool.sol* ( [16](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CollSurplusPool.sol#L16) ):

```solidity
/// @audit ICollSurplusPool
/// @audit ReentrancyGuard
/// @audit AuthNoOwner
16: contract CollSurplusPool is ICollSurplusPool, ReentrancyGuard, AuthNoOwner {
```

- *ERC3156FlashLender.sol* ( [8](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/ERC3156FlashLender.sol#L8) ):

```solidity
/// @audit IERC3156FlashLender
8: abstract contract ERC3156FlashLender is IERC3156FlashLender {
```

- *EbtcBase.sol* ( [16](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/EbtcBase.sol#L16) ):

```solidity
/// @audit BaseMath
/// @audit IEbtcBase
16: contract EbtcBase is BaseMath, IEbtcBase {
```

- *EBTCToken.sol* ( [26](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/EBTCToken.sol#L26) ):

```solidity
/// @audit IEBTCToken
/// @audit AuthNoOwner
/// @audit PermitNonce
26: contract EBTCToken is IEBTCToken, AuthNoOwner, PermitNonce {
```

- *HintHelpers.sol* ( [11](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/HintHelpers.sol#L11) ):

```solidity
/// @audit EbtcBase
11: contract HintHelpers is EbtcBase {
```

- *IActivePool.sol* ( [7](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IActivePool.sol#L7) ):

```solidity
/// @audit IPool
7: interface IActivePool is IPool {
```

- *IBorrowerOperations.sol* ( [7](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IBorrowerOperations.sol#L7) ):

```solidity
/// @audit IPositionManagers
7: interface IBorrowerOperations is IPositionManagers {
```

- *ICdpManager.sol* ( [9](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManager.sol#L9) ):

```solidity
/// @audit IEbtcBase
/// @audit ICdpManagerData
9: interface ICdpManager is IEbtcBase, ICdpManagerData {
```

- *ICdpManagerData.sol* ( [13](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManagerData.sol#L13) ):

```solidity
/// @audit IRecoveryModeGracePeriod
13: interface ICdpManagerData is IRecoveryModeGracePeriod {
```

- *IEBTCToken.sol* ( [8](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IEBTCToken.sol#L8) ):

```solidity
/// @audit IERC20
/// @audit IERC2612
8: interface IEBTCToken is IERC20, IERC2612 {
```

- *LiquidationLibrary.sol* ( [13](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LiquidationLibrary.sol#L13) ):

```solidity
/// @audit CdpManagerStorage
13: contract LiquidationLibrary is CdpManagerStorage {
```

- *PriceFeed.sol* ( [21](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/PriceFeed.sol#L21) ):

```solidity
/// @audit BaseMath
/// @audit IPriceFeed
/// @audit AuthNoOwner
21: contract PriceFeed is BaseMath, IPriceFeed, AuthNoOwner {
```

- *SortedCdps.sol* ( [51](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L51) ):

```solidity
/// @audit ISortedCdps
51: contract SortedCdps is ISortedCdps {
```

</details>

### [N&#x2011;57] Constants should be put on the left side of comparisons

Putting constants on the left side of comparison statements is a best practice known as [Yoda conditions](https://en.wikipedia.org/wiki/Yoda_conditions).
Although solidity's static typing system prevents accidental assignments within conditionals, adopting this practice can improve code readability and consistency, especially when working across multiple languages.

<details>
<summary>There are 119 instances (click to show):</summary>

- *ActivePool.sol* ( [61](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/ActivePool.sol#L61), [394](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/ActivePool.sol#L394), [407](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/ActivePool.sol#L407) ):

```solidity
/// @audit put `address(0)` on the left
61:         if (_authorityAddress != address(0)) {

/// @audit put `address(0)` on the left
394:             _feeRecipientAddress != address(0),

/// @audit put `MAX_FEE_BPS` on the left
407:         require(_newFee <= MAX_FEE_BPS, "ERC3156FlashLender: _newFee should <= MAX_FEE_BPS");
```

- *BorrowerOperations.sol* ( [124](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L124), [145](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L145), [735](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L735), [748](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L748), [808](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L808), [808](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L808), [819](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L819), [819](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L819), [819](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L819), [826](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L826), [831](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L831), [847](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L847), [912](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L912), [918](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L918), [930](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L930), [941](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L941), [1142](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L1142), [1155](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L1155) ):

```solidity
/// @audit put `address(0)` on the left
124:         if (_authorityAddress != address(0)) {

/// @audit put `OPEN` on the left
145:         require(locked == OPEN, "BorrowerOperations: Reentrancy in nonReentrant call");

/// @audit put `address(0)` on the left
735:             recoveredAddress != address(0) && recoveredAddress == _borrower,

/// @audit put `0` on the left
748:         if (_collReceived != 0) {

/// @audit put `0` on the left
808:             _stEthBalanceIncrease == 0 || _stEthBalanceDecrease == 0,

/// @audit put `0` on the left
808:             _stEthBalanceIncrease == 0 || _stEthBalanceDecrease == 0,

/// @audit put `0` on the left
819:             _stEthBalanceIncrease != 0 || _stEthBalanceDecrease != 0 || _debtChange != 0,

/// @audit put `0` on the left
819:             _stEthBalanceIncrease != 0 || _stEthBalanceDecrease != 0 || _debtChange != 0,

/// @audit put `0` on the left
819:             _stEthBalanceIncrease != 0 || _stEthBalanceDecrease != 0 || _debtChange != 0,

/// @audit put `1` on the left
826:         require(status == 1, "BorrowerOperations: Cdp does not exist or is closed");

/// @audit put `0` on the left
831:         require(status == 0, "BorrowerOperations: Cdp is active or has been previously closed");

/// @audit put `0` on the left
847:             _stEthBalanceDecrease == 0,

/// @audit put `MCR` on the left
912:             _newICR >= MCR,

/// @audit put `CCR` on the left
918:         require(_newICR >= CCR, "BorrowerOperations: Operation must leave cdp with ICR >= CCR");

/// @audit put `CCR` on the left
930:             _newTCR >= CCR,

/// @audit put `MIN_NET_STETH_BALANCE` on the left
941:             _stEthBalance >= MIN_NET_STETH_BALANCE,

/// @audit put `address(0)` on the left
1142:             _feeRecipientAddress != address(0),

/// @audit put `MAX_FEE_BPS` on the left
1155:         require(_newFee <= MAX_FEE_BPS, "ERC3156FlashLender: _newFee should <= MAX_FEE_BPS");
```

- *CdpManager.sol* ( [159](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L159), [332](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L332), [369](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L369), [377](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L377), [389](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L389), [434](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L434), [497](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L497), [678](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L678), [694](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L694), [758](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L758), [763](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L763), [775](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L775), [790](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L790), [794](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L794), [809](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L809), [813](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L813) ):

```solidity
/// @audit put `0` on the left
159:         if (newDebt == 0) {

/// @audit put `false` on the left
332:         require(redemptionsPaused == false, "CdpManager: Redemptions Paused");

/// @audit put `address(0)` on the left
369:             while (currentBorrower != address(0) && getSyncedICR(_cId, totals.price) < MCR) {

/// @audit put `0` on the left
377:         if (_maxIterations == 0) {

/// @audit put `address(0)` on the left
389:             currentBorrower != address(0) && totals.remainingDebtToRedeem > 0 && _maxIterations > 0

/// @audit put `1` on the left
434:         if (_numCdpsFullyRedeemed == 1) {

/// @audit put `bytes32(0)` on the left
497:         while (_cnt > 0 && _id != bytes32(0)) {

/// @audit put `DECIMAL_PRECISION` on the left
678:         require(decayedBaseRate <= DECIMAL_PRECISION, "CdpManager: baseRate too large!"); // The baseRate can decay to 0

/// @audit put `SECONDS_IN_ONE_MINUTE` on the left
694:         if (timePassed >= SECONDS_IN_ONE_MINUTE) {

/// @audit put `MCR` on the left
758:         require(_TCR >= MCR, "CdpManager: Cannot redeem when TCR < MCR");

/// @audit put `DECIMAL_PRECISION` on the left
763:             _maxFeePercentage >= redemptionFeeFloor && _maxFeePercentage <= DECIMAL_PRECISION,

/// @audit put `MAX_REWARD_SPLIT` on the left
775:             _stakingRewardSplit <= MAX_REWARD_SPLIT,

/// @audit put `MIN_REDEMPTION_FEE_FLOOR` on the left
790:             _redemptionFeeFloor >= MIN_REDEMPTION_FEE_FLOOR,

/// @audit put `DECIMAL_PRECISION` on the left
794:             _redemptionFeeFloor <= DECIMAL_PRECISION,

/// @audit put `MIN_MINUTE_DECAY_FACTOR` on the left
809:             _minuteDecayFactor >= MIN_MINUTE_DECAY_FACTOR,

/// @audit put `MAX_MINUTE_DECAY_FACTOR` on the left
813:             _minuteDecayFactor <= MAX_MINUTE_DECAY_FACTOR,
```

- *CdpManagerStorage.sol* ( [52](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L52), [66](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L66), [113](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L113), [242](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L242), [443](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L443), [624](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L624), [625](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L625), [899](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L899) ):

```solidity
/// @audit put `UNSET_TIMESTAMP` on the left
52:         if (lastGracePeriodStartTimestamp == UNSET_TIMESTAMP) {

/// @audit put `UNSET_TIMESTAMP` on the left
66:         if (lastGracePeriodStartTimestamp != UNSET_TIMESTAMP) {

/// @audit put `MINIMUM_GRACE_PERIOD` on the left
113:             _gracePeriod >= MINIMUM_GRACE_PERIOD,

/// @audit put `OPEN` on the left
242:         require(locked == OPEN, "CdpManager: Reentrancy in nonReentrant call");

/// @audit put `0` on the left
443:         if (totalCollateralSnapshot == 0) {

/// @audit put `0` on the left
624:             _cdpStEthFeePerUnitIndex == 0 ||

/// @audit put `0` on the left
625:             _cdpCol == 0 ||

/// @audit put `UNSET_TIMESTAMP` on the left
899:             cachedLastGracePeriodStartTimestamp != UNSET_TIMESTAMP &&
```

- *CollSurplusPool.sol* ( [55](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CollSurplusPool.sol#L55) ):

```solidity
/// @audit put `address(0)` on the left
55:         if (_authorityAddress != address(0)) {
```

- *EbtcMath.sol* ( [64](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/EbtcMath.sol#L64) ):

```solidity
/// @audit put `0` on the left
64:         if (_minutes == 0) {
```

- *ReentrancyGuard.sol* ( [14](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/ReentrancyGuard.sol#L14) ):

```solidity
/// @audit put `OPEN` on the left
14:         require(locked == OPEN, "ReentrancyGuard: Reentrancy in nonReentrant call");
```

- *RolesAuthority.sol* ( [158](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/RolesAuthority.sol#L158) ):

```solidity
/// @audit put `bytes32(0)` on the left
158:             if (getUserRoles[user] == bytes32(0)) {
```

- *EBTCToken.sol* ( [247](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/EBTCToken.sol#L247), [248](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/EBTCToken.sol#L248), [263](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/EBTCToken.sol#L263), [271](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/EBTCToken.sol#L271), [286](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/EBTCToken.sol#L286), [287](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/EBTCToken.sol#L287), [297](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/EBTCToken.sol#L297) ):

```solidity
/// @audit put `address(0)` on the left
247:         require(sender != address(0), "EBTCToken: zero sender!");

/// @audit put `address(0)` on the left
248:         require(recipient != address(0), "EBTCToken: zero recipient!");

/// @audit put `address(0)` on the left
263:         require(account != address(0), "EBTCToken: mint to zero recipient!");

/// @audit put `address(0)` on the left
271:         require(account != address(0), "EBTCToken: burn from zero account!");

/// @audit put `address(0)` on the left
286:         require(owner != address(0), "EBTCToken: zero approve owner!");

/// @audit put `address(0)` on the left
287:         require(spender != address(0), "EBTCToken: zero approve spender!");

/// @audit put `address(0)` on the left
297:             _recipient != address(0) && _recipient != address(this),
```

- *HintHelpers.sol* ( [69](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/HintHelpers.sol#L69), [78](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/HintHelpers.sol#L78), [85](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/HintHelpers.sol#L85), [171](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/HintHelpers.sol#L171) ):

```solidity
/// @audit put `address(0)` on the left
69:                 vars.currentCdpUser != address(0) &&

/// @audit put `0` on the left
78:         if (_maxIterations == 0) {

/// @audit put `address(0)` on the left
85:                 vars.currentCdpUser != address(0) &&

/// @audit put `0` on the left
171:         if (arrayLength == 0) {
```

- *LiquidationLibrary.sol* ( [56](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LiquidationLibrary.sol#L56), [80](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LiquidationLibrary.sol#L80), [90](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LiquidationLibrary.sol#L90), [144](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LiquidationLibrary.sol#L144), [158](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LiquidationLibrary.sol#L158), [159](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LiquidationLibrary.sol#L159), [417](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LiquidationLibrary.sol#L417), [681](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LiquidationLibrary.sol#L681), [756](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LiquidationLibrary.sol#L756), [819](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LiquidationLibrary.sol#L819), [863](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LiquidationLibrary.sol#L863), [910](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LiquidationLibrary.sol#L910) ):

```solidity
/// @audit put `0` on the left
56:         require(_partialAmount != 0, "LiquidationLibrary: use `liquidate` for 100%");

/// @audit put `MCR` on the left
80:         if (_ICR >= MCR) {

/// @audit put `UNSET_TIMESTAMP` on the left
90:                 cachedLastGracePeriodStartTimestamp != UNSET_TIMESTAMP,

/// @audit put `0` on the left
144:         if (_liqState.partialAmount == 0) {

/// @audit put `0` on the left
158:                 liquidationValues.totalCollToSendToLiquidator == 0 &&

/// @audit put `0` on the left
159:                 liquidationValues.debtToBurn == 0

/// @audit put `0` on the left
417:         if (newColl == 0) {

/// @audit put `0` on the left
681:             _cdpArray.length != 0,

/// @audit put `bytes32(0)` on the left
756:             if (vars.cdpId != bytes32(0) && Cdps[vars.cdpId].status == Status.active) {

/// @audit put `bytes32(0)` on the left
819:             if (vars.cdpId != bytes32(0) && Cdps[vars.cdpId].status == Status.active) {

/// @audit put `0` on the left
863:         if (_debt == 0) {

/// @audit put `MIN_NET_STETH_BALANCE` on the left
910:             _entireColl >= MIN_NET_STETH_BALANCE,
```

- *PriceFeed.sol* ( [363](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/PriceFeed.sol#L363), [420](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/PriceFeed.sol#L420), [422](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/PriceFeed.sol#L422), [471](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/PriceFeed.sol#L471), [475](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/PriceFeed.sol#L475), [532](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/PriceFeed.sol#L532), [541](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/PriceFeed.sol#L541), [695](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/PriceFeed.sol#L695), [695](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/PriceFeed.sol#L695), [776](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/PriceFeed.sol#L776), [777](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/PriceFeed.sol#L777) ):

```solidity
/// @audit put `address(0)` on the left
363:         if (_fallbackCaller != address(0)) {

/// @audit put `0` on the left
420:             _response.timestampEthBtc == 0 ||

/// @audit put `0` on the left
422:             _response.timestampStEthEth == 0 ||

/// @audit put `0` on the left
471:         if (_response.timestamp == 0 || _response.timestamp > block.timestamp) {

/// @audit put `0` on the left
475:         if (_response.answer == 0) {

/// @audit put `0` on the left
532:         if (minPrice == 0) return false;

/// @audit put `MAX_PRICE_DIFFERENCE_BETWEEN_ORACLES` on the left
541:         return percentPriceDifference <= MAX_PRICE_DIFFERENCE_BETWEEN_ORACLES;

/// @audit put `0` on the left
695:         if (_currentRoundEthBtcId == 0 || _currentRoundStEthEthId == 0) {

/// @audit put `0` on the left
695:         if (_currentRoundEthBtcId == 0 || _currentRoundStEthEthId == 0) {

/// @audit put `0` on the left
776:         if (_answer <= 0) return false;

/// @audit put `0` on the left
777:         if (_roundId == 0) return false;
```

- *SimplifiedDiamondLike.sol* ( [56](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SimplifiedDiamondLike.sol#L56), [187](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SimplifiedDiamondLike.sol#L187) ):

```solidity
/// @audit put `0x94b24d09` on the left
56:         require(sig != 0x94b24d09);

/// @audit put `address(0)` on the left
187:         require(facet != address(0), "Diamond: Function does not exist");
```

- *SortedCdps.sol* ( [89](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L89), [181](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L181), [185](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L185), [244](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L244), [248](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L248), [305](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L305), [316](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L316), [318](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L318), [369](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L369), [382](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L382), [382](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L382), [386](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L386), [391](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L391), [428](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L428), [428](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L428), [437](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L437), [442](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L442), [520](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L520), [523](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L523), [523](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L523), [523](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L523), [537](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L537), [596](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L596), [596](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L596), [599](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L599), [602](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L602), [629](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L629), [652](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L652), [682](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L682), [689](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L689), [696](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L696), [696](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L696), [699](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L699), [702](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L702) ):

```solidity
/// @audit put `0` on the left
89:         if (_size == 0) {

/// @audit put `dummyId` on the left
181:         bytes32 _currentCdpId = (startNodeId == dummyId ? data.tail : startNodeId);

/// @audit put `dummyId` on the left
185:         while (_currentCdpId != dummyId) {

/// @audit put `dummyId` on the left
244:         bytes32 _currentCdpId = (startNodeId == dummyId ? data.tail : startNodeId);

/// @audit put `dummyId` on the left
248:         while (_currentCdpId != dummyId) {

/// @audit put `0` on the left
305:         if (maxArraySize == 0) {

/// @audit put `dummyId` on the left
316:         bytes32 _currentCdpId = (startNodeId == dummyId ? data.tail : startNodeId);

/// @audit put `dummyId` on the left
318:         while (_currentCdpId != dummyId) {

/// @audit put `dummyId` on the left
369:         require(_id != dummyId, "SortedCdps: Id cannot be zero");

/// @audit put `dummyId` on the left
382:         if (prevId == dummyId && nextId == dummyId) {

/// @audit put `dummyId` on the left
382:         if (prevId == dummyId && nextId == dummyId) {

/// @audit put `dummyId` on the left
386:         } else if (prevId == dummyId) {

/// @audit put `dummyId` on the left
391:         } else if (nextId == dummyId) {

/// @audit put `dummyId` on the left
428:             _firstPrev != dummyId || _lastNext != dummyId,

/// @audit put `dummyId` on the left
428:             _firstPrev != dummyId || _lastNext != dummyId,

/// @audit put `dummyId` on the left
437:         if (_firstPrev != dummyId) {

/// @audit put `dummyId` on the left
442:         if (_lastNext != dummyId) {

/// @audit put `dummyId` on the left
520:         bool _exist = _id != dummyId && (data.head == _id || data.tail == _id);

/// @audit put `dummyId` on the left
523:             _exist = _id != dummyId && (_node.nextId != dummyId && _node.prevId != dummyId);

/// @audit put `dummyId` on the left
523:             _exist = _id != dummyId && (_node.nextId != dummyId && _node.prevId != dummyId);

/// @audit put `dummyId` on the left
523:             _exist = _id != dummyId && (_node.nextId != dummyId && _node.prevId != dummyId);

/// @audit put `0` on the left
537:         return data.size == 0;

/// @audit put `dummyId` on the left
596:         if (_prevId == dummyId && _nextId == dummyId) {

/// @audit put `dummyId` on the left
596:         if (_prevId == dummyId && _nextId == dummyId) {

/// @audit put `dummyId` on the left
599:         } else if (_prevId == dummyId) {

/// @audit put `dummyId` on the left
602:         } else if (_nextId == dummyId) {

/// @audit put `dummyId` on the left
629:         while (prevId != dummyId && !_validInsertPosition(_NICR, prevId, nextId)) {

/// @audit put `dummyId` on the left
652:         while (nextId != dummyId && !_validInsertPosition(_NICR, prevId, nextId)) {

/// @audit put `dummyId` on the left
682:         if (prevId != dummyId) {

/// @audit put `dummyId` on the left
689:         if (nextId != dummyId) {

/// @audit put `dummyId` on the left
696:         if (prevId == dummyId && nextId == dummyId) {

/// @audit put `dummyId` on the left
696:         if (prevId == dummyId && nextId == dummyId) {

/// @audit put `dummyId` on the left
699:         } else if (prevId == dummyId) {

/// @audit put `dummyId` on the left
702:         } else if (nextId == dummyId) {
```

</details>

### [N&#x2011;58] Each interfaces should be defined in a separate file

Each interface should be defined in a separate file, making it easier to import, and easier to develop and maintain. This is the strategy adopted by most popular libraries.

There are 2 instances:

- *LeverageMacroBase.sol* ( [14](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LeverageMacroBase.sol#L14) ):

```solidity
14: interface ICdpCdps {
```

- *LeverageMacroDelegateTarget.sol* ( [6](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LeverageMacroDelegateTarget.sol#L6) ):

```solidity
6: interface IOwnerLike {
```

### [N&#x2011;59] Put all system-wide constants in one file

Putting all the system-wide constants in a single file improves code readability, makes it easier to understand the basic configuration and limitations of the system, and makes maintenance easier.

<details>
<summary>There are 31 instances (click to show):</summary>

- *ActivePool.sol* ( [24](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/ActivePool.sol#L24) ):

```solidity
24:     string public constant NAME = "ActivePool";
```

- *BorrowerOperations.sol* ( [29](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L29) ):

```solidity
29:     string public constant NAME = "BorrowerOperations";
```

- *CdpManagerStorage.sol* ( [21](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L21), [22](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L22), [122](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L122), [139](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L139), [141](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L141), [149](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L149), [150](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L150) ):

```solidity
21:     uint128 public constant UNSET_TIMESTAMP = type(uint128).max;

22:     uint128 public constant MINIMUM_GRACE_PERIOD = 15 minutes;

122:     string public constant NAME = "CdpManager";

139:     uint256 public constant SECONDS_IN_ONE_MINUTE = 60;

141:     uint256 public constant MIN_REDEMPTION_FEE_FLOOR = (DECIMAL_PRECISION * 5) / 1000; // 0.5%

149:     uint256 public constant MIN_MINUTE_DECAY_FACTOR = 1; // Non-zero

150:     uint256 public constant MAX_MINUTE_DECAY_FACTOR = 999999999999999999; // Corresponds to a very fast decay rate, but not too extreme
```

- *CollSurplusPool.sol* ( [19](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CollSurplusPool.sol#L19) ):

```solidity
19:     string public constant NAME = "CollSurplusPool";
```

- *ERC3156FlashLender.sol* ( [9](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/ERC3156FlashLender.sol#L9), [10](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/ERC3156FlashLender.sol#L10), [11](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/ERC3156FlashLender.sol#L11) ):

```solidity
9:     uint256 public constant MAX_BPS = 10_000;

10:     uint256 public constant MAX_FEE_BPS = 1_000; // 10%

11:     bytes32 public constant FLASH_SUCCESS_VALUE = keccak256("ERC3156FlashBorrower.onFlashLoan");
```

- *EbtcBase.sol* ( [19](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/EbtcBase.sol#L19), [22](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/EbtcBase.sol#L22), [25](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/EbtcBase.sol#L25), [28](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/EbtcBase.sol#L28), [31](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/EbtcBase.sol#L31), [33](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/EbtcBase.sol#L33), [35](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/EbtcBase.sol#L35), [37](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/EbtcBase.sol#L37), [39](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/EbtcBase.sol#L39) ):

```solidity
19:     uint256 public constant LICR = 1030000000000000000; // 103%

22:     uint256 public constant MCR = 1100000000000000000; // 110%

25:     uint256 public constant CCR = 1250000000000000000; // 125%

28:     uint256 public constant LIQUIDATOR_REWARD = 2e17;

31:     uint256 public constant MIN_NET_STETH_BALANCE = 2e18;

33:     uint256 public constant PERCENT_DIVISOR = 200; // dividing by 200 yields 0.5%

35:     uint256 public constant BORROWING_FEE_FLOOR = 0; // 0.5%

37:     uint256 public constant STAKING_REWARD_SPLIT = 5_000; // taking 50% cut from staking reward

39:     uint256 public constant MAX_REWARD_SPLIT = 10_000;
```

- *EbtcMath.sol* ( [7](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/EbtcMath.sol#L7) ):

```solidity
7:     uint256 public constant MAX_TCR = type(uint256).max;
```

- *HintHelpers.sol* ( [12](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/HintHelpers.sol#L12) ):

```solidity
12:     string public constant NAME = "HintHelpers";
```

- *PriceFeed.sol* ( [22](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/PriceFeed.sol#L22), [32](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/PriceFeed.sol#L32), [33](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/PriceFeed.sol#L33), [36](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/PriceFeed.sol#L36), [42](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/PriceFeed.sol#L42) ):

```solidity
22:     string public constant NAME = "PriceFeed";

32:     uint256 public constant TIMEOUT_ETH_BTC_FEED = 4800; // 1 hours & 20min: 60 * 80

33:     uint256 public constant TIMEOUT_STETH_ETH_FEED = 90000; // 25 hours: 60 * 60 * 25

36:     uint256 public constant MAX_PRICE_DEVIATION_FROM_PREVIOUS_ROUND = 5e17; // 50%

42:     uint256 public constant MAX_PRICE_DIFFERENCE_BETWEEN_ORACLES = 5e16; // 5%
```

- *SortedCdps.sol* ( [52](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L52), [80-81](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L80-L81) ):

```solidity
52:     string public constant NAME = "SortedCdps";

80:     bytes32 public constant dummyId =
81:         0x0000000000000000000000000000000000000000000000000000000000000000;
```

</details>

### [N&#x2011;60] `else`-block not required

One level of nesting can be removed by not having an `else` block when the `if`-block always jumps at the end. For example:
```solidity
if (condition) {
    body1...
    return x;
} else {
    body2...
}
```
can be changed to:
```solidity
if (condition) {
    body1...
    return x;
}
body2...
```

<details>
<summary>There are 18 instances (click to show):</summary>

- *BorrowerOperations.sol* ( [666-668](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L666-L668) ):

```solidity
666:         if (_chainID() == _CACHED_CHAIN_ID) {
667:             return _CACHED_DOMAIN_SEPARATOR;
668:         } else {
```

- *CdpManagerStorage.sol* ( [636-641](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L636-L641), [765-776](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L765-L776) ):

```solidity
636:         if (_scaledCdpColl > _feeSplitDistributed) {
637:             return (
638:                 _feeSplitDistributed,
639:                 (_scaledCdpColl - _feeSplitDistributed) / DECIMAL_PRECISION
640:             );
641:         } else {

765:         if (_newIndex > _oldIndex && totalStakes > 0) {
766:             /// @audit-ok We don't take the fee if we had a negative rebase
767:             (
768:                 uint256 _feeTaken,
769:                 uint256 _deltaFeePerUnit,
770:                 uint256 _perUnitError
771:             ) = calcFeeUponStakingReward(_newIndex, _oldIndex);
772: 
773:             // calculate new split per stake unit
774:             uint256 _newPerUnit = systemStEthFeePerUnitIndex + _deltaFeePerUnit;
775:             return (_feeTaken, _newPerUnit, _perUnitError);
776:         } else {
```

- *EbtcMath.sol* ( [93-97](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/EbtcMath.sol#L93-L97), [109-115](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/EbtcMath.sol#L109-L115) ):

```solidity
93:         if (_debt > 0) {
94:             return (_collShares * NICR_PRECISION) / _debt;
95:         }
96:         // Return the maximal value for uint256 if the Cdp has a debt of 0. Represents "infinite" CR.
97:         else {

109:         if (_debt > 0) {
110:             uint256 newCollRatio = (_stEthBalance * _price) / _debt;
111: 
112:             return newCollRatio;
113:         }
114:         // Return the maximal value for uint256 if the Cdp has a debt of 0. Represents "infinite" CR.
115:         else {
```

- *RolesAuthority.sol* ( [70-72](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/RolesAuthority.sol#L70-L72), [72-74](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/RolesAuthority.sol#L72-L74) ):

```solidity
70:         if (flag == CapabilityFlag.Burned) {
71:             return false;
72:         } else if (flag == CapabilityFlag.Public) {

72:         } else if (flag == CapabilityFlag.Public) {
73:             return true;
74:         } else {
```

- *EBTCToken.sol* ( [183-185](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/EBTCToken.sol#L183-L185) ):

```solidity
183:         if (_chainID() == _CACHED_CHAIN_ID) {
184:             return _CACHED_DOMAIN_SEPARATOR;
185:         } else {
```

- *HintHelpers.sol* ( [93-112](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/HintHelpers.sol#L93-L112) ):

```solidity
93:                 if (currentCdpDebt > vars.remainingEbtcToRedeem) {
94:                     uint256 _cachedEbtcToRedeem = vars.remainingEbtcToRedeem;
95:                     (
96:                         partialRedemptionNewColl,
97:                         partialRedemptionHintNICR
98:                     ) = _calculateCdpStateAfterPartialRedemption(vars, currentCdpDebt, _price);
99: 
100:                     // If the partial redemption would leave the CDP with less than the minimum allowed coll, bail out of partial redemption and return only the fully redeemable
101:                     if (
102:                         collateral.getPooledEthByShares(partialRedemptionNewColl) <
103:                         MIN_NET_STETH_BALANCE
104:                     ) {
105:                         partialRedemptionHintNICR = 0; //reset to 0 as there is no partial redemption in this case
106:                         partialRedemptionNewColl = 0;
107:                         vars.remainingEbtcToRedeem = _cachedEbtcToRedeem;
108:                     } else {
109:                         vars.remainingEbtcToRedeem = 0;
110:                     }
111:                     break;
112:                 } else {
```

- *LeverageMacroBase.sol* ( [245-248](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LeverageMacroBase.sol#L245-L248) ):

```solidity
245:         if (check.operator == Operator.skip) {
246:             // Early return
247:             return;
248:         } else if (check.operator == Operator.gte) {
```

- *LiquidationLibrary.sol* ( [190-209](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LiquidationLibrary.sol#L190-L209) ):

```solidity
190:         if (_liqState.recoveryModeAtStart) {
191:             LiquidationRecoveryModeLocals
192:                 memory _outputState = _liquidateIndividualCdpSetupCDPInRecoveryMode(_recoveryState);
193: 
194:             // housekeeping leftover collateral for liquidated CDP
195:             if (_outputState.totalSurplusCollShares > 0) {
196:                 activePool.transferSystemCollShares(
197:                     address(collSurplusPool),
198:                     _outputState.totalSurplusCollShares
199:                 );
200:             }
201: 
202:             return (
203:                 _outputState.totalDebtToBurn,
204:                 _outputState.totalCollSharesToSend,
205:                 _outputState.totalDebtToRedistribute,
206:                 _outputState.totalLiquidatorRewardCollShares,
207:                 _outputState.totalSurplusCollShares
208:             );
209:         } else {
```

- *SortedCdps.sol* ( [189-191](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L189-L191), [596-599](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L596-L599), [599-602](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L599-L602), [602-605](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L602-L605), [696-699](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L696-L699), [699-702](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L699-L702), [702-705](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L702-L705) ):

```solidity
189:                 if (_currentIndex == index) {
190:                     return (_currentCdpId, true);
191:                 } else {

596:         if (_prevId == dummyId && _nextId == dummyId) {
597:             // `(null, null)` is a valid insert position if the list is empty
598:             return isEmpty();
599:         } else if (_prevId == dummyId) {

599:         } else if (_prevId == dummyId) {
600:             // `(null, _nextId)` is a valid insert position if `_nextId` is the head of the list
601:             return data.head == _nextId && _NICR >= cdpManager.getCachedNominalICR(_nextId);
602:         } else if (_nextId == dummyId) {

602:         } else if (_nextId == dummyId) {
603:             // `(_prevId, null)` is a valid insert position if `_prevId` is the tail of the list
604:             return data.tail == _prevId && _NICR <= cdpManager.getCachedNominalICR(_prevId);
605:         } else {

696:         if (prevId == dummyId && nextId == dummyId) {
697:             // No hint - descend list starting from head
698:             return _descendList(_NICR, data.head);
699:         } else if (prevId == dummyId) {

699:         } else if (prevId == dummyId) {
700:             // No `prevId` for hint - ascend list starting from `nextId`
701:             return _ascendList(_NICR, nextId);
702:         } else if (nextId == dummyId) {

702:         } else if (nextId == dummyId) {
703:             // No `nextId` for hint - descend list starting from `prevId`
704:             return _descendList(_NICR, prevId);
705:         } else {
```

</details>

### [N&#x2011;61] Redundant return statement in a function with named return variables

Because the return variable (or its default value) has been assigned, explicit return at the end of the function is unnecessary, as it is returned automatically.

<details>
<summary>There are 3 instances (click to show):</summary>

- *CdpManager.sol* ( [135-234](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L135-L234), [550-563](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L550-L563) ):

```solidity
135:     function _redeemCollateralFromCdp(
136:         SingleRedemptionInputs memory _redeemColFromCdp
137:     ) internal returns (SingleRedemptionValues memory singleRedemption) {
138:         // Determine the remaining amount (lot) to be redeemed,
139:         // capped by the entire debt of the Cdp minus the liquidation reserve
140:         singleRedemption.debtToRedeem = EbtcMath._min(
141:             _redeemColFromCdp.maxEBTCamount,
142:             Cdps[_redeemColFromCdp.cdpId].debt /// @audit Redeem everything
143:         );
144: 
145:         singleRedemption.collSharesDrawn = collateral.getSharesByPooledEth(
146:             (singleRedemption.debtToRedeem * DECIMAL_PRECISION) / _redeemColFromCdp.price
147:         );
148: 
149:         // Repurposing this struct here to avoid stack too deep.
150:         CdpDebtAndCollShares memory _oldDebtAndColl = CdpDebtAndCollShares(
151:             Cdps[_redeemColFromCdp.cdpId].debt,
152:             Cdps[_redeemColFromCdp.cdpId].coll
153:         );
154: 
155:         // Decrease the debt and collateral of the current Cdp according to the EBTC lot and corresponding ETH to send
156:         uint256 newDebt = _oldDebtAndColl.debt - singleRedemption.debtToRedeem;
157:         uint256 newColl = _oldDebtAndColl.collShares - singleRedemption.collSharesDrawn;
158: 
159:         if (newDebt == 0) {
...... OMITTED ......
210:                 _redeemColFromCdp.cdpId,
211:                 newNICR,
212:                 _redeemColFromCdp.upperPartialRedemptionHint,
213:                 _redeemColFromCdp.lowerPartialRedemptionHint
214:             );
215: 
216:             Cdps[_redeemColFromCdp.cdpId].debt = newDebt;
217:             Cdps[_redeemColFromCdp.cdpId].coll = newColl;
218:             _updateStakeAndTotalStakes(_redeemColFromCdp.cdpId);
219: 
220:             emit CdpUpdated(
221:                 _redeemColFromCdp.cdpId,
222:                 ISortedCdps(sortedCdps).getOwnerAddress(_redeemColFromCdp.cdpId),
223:                 msg.sender,
224:                 _oldDebtAndColl.debt,
225:                 _oldDebtAndColl.collShares,
226:                 newDebt,
227:                 newColl,
228:                 Cdps[_redeemColFromCdp.cdpId].stake,
229:                 CdpOperation.redeemCollateral
230:             );
231:         }
232: 
233:         return singleRedemption;
234:     }

550:     function _addCdpIdToArray(bytes32 _cdpId) internal returns (uint128 index) {
551:         /* Max array size is 2**128 - 1, i.e. ~3e30 cdps. No risk of overflow, since cdps have minimum EBTC
552:         debt of liquidation reserve plus MIN_NET_DEBT.
553:         3e30 EBTC dwarfs the value of all wealth in the world ( which is < 1e15 USD). */
554: 
555:         // Push the Cdpowner to the array
556:         CdpIds.push(_cdpId);
557: 
558:         // Record the index of the new Cdpowner on their Cdp struct
559:         index = uint128(CdpIds.length - 1);
560:         Cdps[_cdpId].arrayIndex = index;
561: 
562:         return index;
563:     }
```

- *LiquidationLibrary.sol* ( [839-860](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LiquidationLibrary.sol#L839-L860) ):

```solidity
839:     function _addLiquidationValuesToTotals(
840:         LiquidationTotals memory oldTotals,
841:         LiquidationValues memory singleLiquidation
842:     ) internal pure returns (LiquidationTotals memory newTotals) {
843:         // Tally all the values with their respective running totals
844:         newTotals.totalDebtInSequence =
845:             oldTotals.totalDebtInSequence +
846:             singleLiquidation.entireCdpDebt;
847:         newTotals.totalDebtToBurn = oldTotals.totalDebtToBurn + singleLiquidation.debtToBurn;
848:         newTotals.totalCollToSendToLiquidator =
849:             oldTotals.totalCollToSendToLiquidator +
850:             singleLiquidation.totalCollToSendToLiquidator;
851:         newTotals.totalDebtToRedistribute =
852:             oldTotals.totalDebtToRedistribute +
853:             singleLiquidation.debtToRedistribute;
854:         newTotals.totalCollSurplus = oldTotals.totalCollSurplus + singleLiquidation.collSurplus;
855:         newTotals.totalCollReward =
856:             oldTotals.totalCollReward +
857:             singleLiquidation.liquidatorCollSharesReward;
858: 
859:         return newTotals;
860:     }
```

</details>

### [N&#x2011;62] Large multiples of ten should use scientific notation

Use a scientific notation rather than decimal literals (e.g. `1e6` instead of `1000000`), for better code readability.

<details>
<summary>There are 10 instances (click to show):</summary>

- *CdpManagerStorage.sol* ( [141](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L141) ):

```solidity
/// @audit 1000 -> 1e3
141:     uint256 public constant MIN_REDEMPTION_FEE_FLOOR = (DECIMAL_PRECISION * 5) / 1000; // 0.5%
```

- *ERC3156FlashLender.sol* ( [9](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/ERC3156FlashLender.sol#L9), [10](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/ERC3156FlashLender.sol#L10) ):

```solidity
/// @audit 10_000 -> 1e4
9:     uint256 public constant MAX_BPS = 10_000;

/// @audit 1_000 -> 1e3
10:     uint256 public constant MAX_FEE_BPS = 1_000; // 10%
```

- *EbtcBase.sol* ( [22](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/EbtcBase.sol#L22), [25](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/EbtcBase.sol#L25), [37](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/EbtcBase.sol#L37), [39](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/EbtcBase.sol#L39) ):

```solidity
/// @audit 1100000000000000000 -> 11e17
22:     uint256 public constant MCR = 1100000000000000000; // 110%

/// @audit 1250000000000000000 -> 125e16
25:     uint256 public constant CCR = 1250000000000000000; // 125%

/// @audit 5_000 -> 5e3
37:     uint256 public constant STAKING_REWARD_SPLIT = 5_000; // taking 50% cut from staking reward

/// @audit 10_000 -> 1e4
39:     uint256 public constant MAX_REWARD_SPLIT = 10_000;
```

- *EbtcMath.sol* ( [60](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/EbtcMath.sol#L60), [61](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/EbtcMath.sol#L61) ):

```solidity
/// @audit 525600000 -> 5256e5
60:         if (_minutes > 525600000) {

/// @audit 525600000 -> 5256e5
61:             _minutes = 525600000;
```

- *PriceFeed.sol* ( [33](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/PriceFeed.sol#L33) ):

```solidity
/// @audit 90000 -> 9e4
33:     uint256 public constant TIMEOUT_STETH_ETH_FEED = 90000; // 25 hours: 60 * 60 * 25
```

</details>

### [N&#x2011;63] `TODO`s left in the code

TODOs may signal that a feature is missing or not ready for audit, consider resolving the issue and removing the TODO comment

There is 1 instance:

- *CdpManager.sol* ( [79](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L79) ):

```solidity
79:     //    Cdp ICR     |       Liquidation Behavior (TODO gas compensation?)
```

### [N&#x2011;64] High cyclomatic complexity

Consider breaking down these blocks into more manageable units, by splitting things into utility functions, by reducing nesting, and by using early returns.

<details>
<summary>There are 5 instances (click to show):</summary>

- *CdpManager.sol* ( [320-485](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L320-L485) ):

```solidity
320:     function redeemCollateral(
321:         uint256 _debt,
322:         bytes32 _firstRedemptionHint,
323:         bytes32 _upperPartialRedemptionHint,
324:         bytes32 _lowerPartialRedemptionHint,
325:         uint256 _partialRedemptionHintNICR,
326:         uint256 _maxIterations,
327:         uint256 _maxFeePercentage
328:     ) external override nonReentrantSelfAndBOps {
329:         RedemptionTotals memory totals;
330: 
331:         // early check to ensure redemption is not paused
332:         require(redemptionsPaused == false, "CdpManager: Redemptions Paused");
333: 
334:         _requireValidMaxFeePercentage(_maxFeePercentage);
335: 
336:         _syncGlobalAccounting(); // Apply state, we will syncGracePeriod at end of function
337: 
338:         totals.price = priceFeed.fetchPrice();
339:         {
340:             (
341:                 uint256 tcrAtStart,
342:                 uint256 systemCollSharesAtStart,
343:                 uint256 systemDebtAtStart
344:             ) = _getTCRWithSystemDebtAndCollShares(totals.price);
...... OMITTED ......
461:             totals.systemCollSharesAtStart - totals.collSharesDrawn - totals.totalCollSharesSurplus,
462:             totals.systemDebtAtStart - totals.debtToRedeem,
463:             totals.price
464:         );
465: 
466:         emit Redemption(
467:             _debt,
468:             totals.debtToRedeem,
469:             totals.collSharesDrawn,
470:             totals.feeCollShares,
471:             msg.sender
472:         );
473: 
474:         // Burn the total eBTC that is redeemed
475:         ebtcToken.burn(msg.sender, totals.debtToRedeem);
476: 
477:         // Update Active Pool eBTC debt internal accounting
478:         activePool.decreaseSystemDebt(totals.debtToRedeem);
479: 
480:         // Allocate the stETH fee to the FeeRecipient
481:         activePool.allocateSystemCollSharesToFeeRecipient(totals.feeCollShares);
482: 
483:         // CEI: Send the stETH drawn to the redeemer
484:         activePool.transferSystemCollShares(msg.sender, totals.collSharesToRedeemer);
485:     }
```

- *LeverageMacroBase.sol* ( [118-211](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LeverageMacroBase.sol#L118-L211) ):

```solidity
118:     function doOperation(
119:         FlashLoanType flType,
120:         uint256 borrowAmount,
121:         LeverageMacroOperation calldata operation,
122:         PostOperationCheck postCheckType,
123:         PostCheckParams calldata checkParams
124:     ) external {
125:         _assertOwner();
126: 
127:         // Call FL Here, then the stuff below needs to happen inside the FL
128:         if (operation.amountToTransferIn > 0) {
129:             IERC20(operation.tokenToTransferIn).safeTransferFrom(
130:                 msg.sender,
131:                 address(this),
132:                 operation.amountToTransferIn
133:             );
134:         }
135: 
136:         /**
137:          * SETUP FOR POST CALL CHECK
138:          */
139:         uint256 initialCdpIndex;
140:         if (postCheckType == PostOperationCheck.openCdp) {
141:             // How to get owner
142:             // sortedCdps.existCdpOwners(_cdpId);
...... OMITTED ......
187:             ICdpManagerData.Cdp memory cdpInfo = cdpManager.Cdps(checkParams.cdpId);
188: 
189:             _doCheckValueType(checkParams.expectedDebt, cdpInfo.debt);
190:             _doCheckValueType(checkParams.expectedCollateral, cdpInfo.coll);
191:             require(
192:                 cdpInfo.status == checkParams.expectedStatus,
193:                 "!LeverageMacroReference: adjustCDP status check"
194:             );
195:         }
196: 
197:         // Post check type: Close, ensure it has the status we want
198:         if (postCheckType == PostOperationCheck.isClosed) {
199:             ICdpManagerData.Cdp memory cdpInfo = cdpManager.Cdps(checkParams.cdpId);
200: 
201:             require(
202:                 cdpInfo.status == checkParams.expectedStatus,
203:                 "!LeverageMacroReference: closeCDP status check"
204:             );
205:         }
206: 
207:         // Sweep here if it's Reference, do not if it's delegate
208:         if (willSweep) {
209:             sweepToCaller();
210:         }
211:     }
```

- *LiquidationLibrary.sol* ( [570-604](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LiquidationLibrary.sol#L570-L604) ):

```solidity
570:     function _calculateFullLiquidationSurplusAndCap(
571:         uint256 _ICR,
572:         uint256 _price,
573:         uint256 _totalDebtToBurn,
574:         uint256 _totalColToSend
575:     ) private view returns (uint256 toLiquidator, uint256 collSurplus, uint256 debtToRedistribute) {
576:         uint256 _incentiveColl;
577: 
578:         if (_ICR > LICR) {
579:             _incentiveColl = (_totalDebtToBurn * (_ICR > MCR ? MCR : _ICR)) / _price;
580: 
581:             // Convert back to shares
582:             toLiquidator = collateral.getSharesByPooledEth(_incentiveColl);
583:         } else {
584:             // for full liquidation, there would be some bad debt to redistribute
585:             _incentiveColl = collateral.getPooledEthByShares(_totalColToSend);
586: 
587:             // Since it's full and there's bad debt we use spot conversion to
588:             // Determine the amount of debt that willl be repaid after adding the LICR discount
589:             // Basically this is buying underwater Coll
590:             // By repaying debt at 3% discount
591:             // Can there be a rounding error where the _debtToRepay > debtToBurn?
592:             uint256 _debtToRepay = (_incentiveColl * _price) / LICR;
593: 
594:             debtToRedistribute = _debtToRepay < _totalDebtToBurn
595:                 ? _totalDebtToBurn - _debtToRepay //  Bad Debt (to be redistributed) is (CdpDebt - Repaid)
596:                 : 0; // Else 0 (note we may underpay per the comment above, althought that may be imaginary)
597: 
598:             // now CDP owner should have zero surplus to claim
599:             toLiquidator = _totalColToSend;
600:         }
601: 
602:         toLiquidator = toLiquidator < _totalColToSend ? toLiquidator : _totalColToSend;
603:         collSurplus = (toLiquidator == _totalColToSend) ? 0 : _totalColToSend - toLiquidator;
604:     }
```

- *PriceFeed.sol* ( [606-681](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/PriceFeed.sol#L606-L681) ):

```solidity
606:     function _getCurrentChainlinkResponse()
607:         internal
608:         view
609:         returns (ChainlinkResponse memory chainlinkResponse)
610:     {
611:         // Fetch decimals for both feeds:
612:         uint8 ethBtcDecimals;
613:         uint8 stEthEthDecimals;
614: 
615:         try ETH_BTC_CL_FEED.decimals() returns (uint8 decimals) {
616:             // If call to Chainlink succeeds, record the current decimal precision
617:             ethBtcDecimals = decimals;
618:         } catch {
619:             // If call to Chainlink aggregator reverts, return a zero response with success = false
620:             return chainlinkResponse;
621:         }
622: 
623:         try STETH_ETH_CL_FEED.decimals() returns (uint8 decimals) {
624:             // If call to Chainlink succeeds, record the current decimal precision
625:             stEthEthDecimals = decimals;
626:         } catch {
627:             // If call to Chainlink aggregator reverts, return a zero response with success = false
628:             return chainlinkResponse;
629:         }
630: 
...... OMITTED ......
657:         ) {
658:             stEthEthAnswer = answer;
659:             chainlinkResponse.roundStEthEthId = roundId;
660:             chainlinkResponse.timestampStEthEth = timestamp;
661:         } catch {
662:             // If call to Chainlink aggregator reverts, return a zero response with success = false
663:             return chainlinkResponse;
664:         }
665: 
666:         if (
667:             _checkHealthyCLResponse(chainlinkResponse.roundEthBtcId, ethBtcAnswer) &&
668:             _checkHealthyCLResponse(chainlinkResponse.roundStEthEthId, stEthEthAnswer)
669:         ) {
670:             chainlinkResponse.answer = _formatClAggregateAnswer(
671:                 ethBtcAnswer,
672:                 stEthEthAnswer,
673:                 ethBtcDecimals,
674:                 stEthEthDecimals
675:             );
676:         } else {
677:             return chainlinkResponse;
678:         }
679: 
680:         chainlinkResponse.success = true;
681:     }
```

- *SortedCdps.sol* ( [674-709](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L674-L709) ):

```solidity
674:     function _findInsertPosition(
675:         uint256 _NICR,
676:         bytes32 _prevId,
677:         bytes32 _nextId
678:     ) internal view returns (bytes32, bytes32) {
679:         bytes32 prevId = _prevId;
680:         bytes32 nextId = _nextId;
681: 
682:         if (prevId != dummyId) {
683:             if (!contains(prevId) || _NICR > cdpManager.getCachedNominalICR(prevId)) {
684:                 // `prevId` does not exist anymore or now has a smaller NICR than the given NICR
685:                 prevId = dummyId;
686:             }
687:         }
688: 
689:         if (nextId != dummyId) {
690:             if (!contains(nextId) || _NICR < cdpManager.getCachedNominalICR(nextId)) {
691:                 // `nextId` does not exist anymore or now has a larger NICR than the given NICR
692:                 nextId = dummyId;
693:             }
694:         }
695: 
696:         if (prevId == dummyId && nextId == dummyId) {
697:             // No hint - descend list starting from head
698:             return _descendList(_NICR, data.head);
699:         } else if (prevId == dummyId) {
700:             // No `prevId` for hint - ascend list starting from `nextId`
701:             return _ascendList(_NICR, nextId);
702:         } else if (nextId == dummyId) {
703:             // No `nextId` for hint - descend list starting from `prevId`
704:             return _descendList(_NICR, prevId);
705:         } else {
706:             // Descend list starting from `prevId`
707:             return _descendList(_NICR, prevId);
708:         }
709:     }
```

</details>

### [N&#x2011;65] Typos

All typos should be corrected.

<details>
<summary>There are 30 instances (click to show):</summary>

- *ActivePool.sol* ( [239](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/ActivePool.sol#L239), [315](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/ActivePool.sol#L315) ):

```solidity
/// @audit recieved
239:     /// @notice Notify that stETH collateral shares have been recieved, updating internal accounting accordingly

/// @audit calcualted
315:     /// @return The flashloan fee calcualted for given token and loan amount
```

- *BorrowerOperations.sol* ( [478](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L478), [692](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L692), [780](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L780), [1113](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L1113) ):

```solidity
/// @audit thatn
478:             In normal mode, ICR must be greater thatn MCR

/// @audit Positon
692:     /// @return EIP712 compatible hash of Positon Manager permit

/// @audit exclsuive
780:     /// @param _sharesToTrack coll as shares (exclsuive of liquidator reward shares)

/// @audit calcualted
1113:     /// @return The flashloan fee calcualted for given token and loan amount
```

- *CdpManager.sol* ( [14](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L14) ):

```solidity
/// @audit Oeprations
14: /// @notice Except for redemption, end user typically will interact with BorrowerOeprations for individual Cdp actions
```

- *CdpManagerStorage.sol* ( [324](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L324), [361](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L361), [716](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L716), [727](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L727) ):

```solidity
/// @audit occured
324:      * this indicates that redistributions have occured since the snapshot was made, and the user therefore has

/// @audit occured
361:         // If any collShares or debt changes occured

/// @audit calcualted
716:     /// @notice Return the pending extra debt assigned to the Cdp from liquidation redistribution, calcualted by Cdp's stake

/// @audit gloabl
727:     /// @param _cdpId The CdpId whose debt redistribution tracking index to be queried against the gloabl one
```

- *CollSurplusPool.sol* ( [14](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CollSurplusPool.sol#L14) ):

```solidity
/// @audit colateral
14: /// @dev While an owner could have multiple different sized Cdps, the remaining surplus colateral from all of its closed Cdp
```

- *AuthNoOwner.sol* ( [53](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/AuthNoOwner.sol#L53) ):

```solidity
/// @audit flexiblity
53:     /// @notice Changed constructor to initialize to allow flexiblity of constructor vs initializer use
```

- *EbtcBase.sol* ( [141](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/EbtcBase.sol#L141) ):

```solidity
/// @audit overal
141:         /// @audit is _icr <= _tcr more dangerous for overal system safety?
```

- *HintHelpers.sol* ( [161](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/HintHelpers.sol#L161) ):

```solidity
/// @audit ouput
161:     Submitting numTrials = k * sqrt(length), with k = 15 makes it very, very likely that the ouput address will 
```

- *LeverageMacroDelegateTarget.sol* ( [31](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LeverageMacroDelegateTarget.sol#L31) ):

```solidity
/// @audit inteded
31:  *      Add the inteded allowances (see above)
```

- *LiquidationLibrary.sol* ( [74](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LiquidationLibrary.sol#L74), [383](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LiquidationLibrary.sol#L383), [588](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LiquidationLibrary.sol#L588), [596](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LiquidationLibrary.sol#L596) ):

```solidity
/// @audit guarenteed
74:         uint256 _ICR = getCachedICR(_cdpId, _price); // @audit syncAccounting already called, guarenteed to be synced

/// @audit emmiting
383:     // without emmiting events

/// @audit willl
588:             // Determine the amount of debt that willl be repaid after adding the LICR discount

/// @audit althought
596:                 : 0; // Else 0 (note we may underpay per the comment above, althought that may be imaginary)
```

- *PriceFeed.sol* ( [14](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/PriceFeed.sol#L14), [167](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/PriceFeed.sol#L167), [360](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/PriceFeed.sol#L360), [364](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/PriceFeed.sol#L364), [374](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/PriceFeed.sol#L374), [377](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/PriceFeed.sol#L377), [386](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/PriceFeed.sol#L386), [694](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/PriceFeed.sol#L694) ):

```solidity
/// @audit conjuction
14:  * stETH:ETH, which are used to aggregate the price feed of stETH:BTC in conjuction.

/// @audit legitmate
167:                  * two consecutive rounds was likely a legitmate market price movement, and so continue using Chainlink

/// @audit Caler
360:         IFallbackCaller newFallbackCaler = IFallbackCaller(_fallbackCaller);

/// @audit Caler
364:             try newFallbackCaler.getFallbackResponse() returns (

/// @audit Caler
374:                     !_responseTimeout(fallbackResponse.timestamp, newFallbackCaler.fallbackTimeout())

/// @audit Caler
377:                     fallbackCaller = newFallbackCaler;

/// @audit Caler
386:             fallbackCaller = newFallbackCaler;

/// @audit indentical
694:         // Behavior should be indentical to following block if this revert was caught
```

- *SimplifiedDiamondLike.sol* ( [16](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SimplifiedDiamondLike.sol#L16) ):

```solidity
/// @audit overriden
16:  *  Per solidity, hardcoded functions are switched into, meaning they cannot be overriden (although you could set a callbackHandler that cannot be reached)
```

- *SortedCdps.sol* ( [151](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L151) ):

```solidity
/// @audit seach
151:     /// @param startNodeId the seach traversal will start at this given CDP instead of the tail of the list
```

</details>

### [N&#x2011;66] Consider bounding input array length

The functions below take in an unbounded array, and make function calls for entries in the array. While the function will revert if it eventually runs out of gas, it may be a nicer user experience to require() that the length of the array is below some reasonable maximum, so that the user doesn't have to use up a full transaction's gas only to see that the transaction reverts.

<details>
<summary>There are 8 instances (click to show):</summary>

- *Governor.sol* ( [122](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Governor.sol#L122) ):

```solidity
122:         for (uint8 i = 0; i < roleIds.length; i++) {
```

- *LeverageMacroBase.sol* ( [385](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LeverageMacroBase.sol#L385), [438](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LeverageMacroBase.sol#L438) ):

```solidity
385:         for (uint256 i; i < swapLength; ) {

438:             for (uint256 i; i < length; ++i) {
```

- *LiquidationLibrary.sol* ( [753](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LiquidationLibrary.sol#L753), [816](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LiquidationLibrary.sol#L816) ):

```solidity
753:         for (vars.i = _start; ; ) {

816:         for (vars.i = _start; ; ) {
```

- *SimplifiedDiamondLike.sol* ( [114](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SimplifiedDiamondLike.sol#L114) ):

```solidity
114:         for (uint256 i; i < length; ) {
```

- *SortedCdps.sol* ( [432](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L432), [449](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L449) ):

```solidity
432:         for (uint256 i = 0; i < _len; ++i) {

449:         for (uint i = 0; i < _len; ++i) {
```

</details>

### [N&#x2011;67] Unnecessary casting

Unnecessary castings can be removed.

There are 2 instances:

- *CdpManager.sol* ( [222](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L222) ):

```solidity
/// @audit ISortedCdps(sortedCdps)
222:                 ISortedCdps(sortedCdps).getOwnerAddress(_redeemColFromCdp.cdpId),
```

- *CdpManagerStorage.sol* ( [392](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L392) ):

```solidity
/// @audit ISortedCdps(sortedCdps)
392:                 ISortedCdps(sortedCdps).getOwnerAddress(_cdpId),
```

### [N&#x2011;68] Unused contract variables

The following state variables are defined but not used.
It is recommended to check the code for logical omissions that cause them not to be used. If it's determined that they are not needed anywhere, it's best to remove them from the codebase to improve code clarity and minimize confusion.

There are 2 instances:

- *RolesAuthority.sol* ( [30](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/RolesAuthority.sol#L30) ):

```solidity
30:     EnumerableSet.Bytes32Set internal enabledFunctionSigsPublic;
```

- *Governor.sol* ( [17](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Governor.sol#L17) ):

```solidity
17:     bytes32 NO_ROLES = bytes32(0);
```

### [N&#x2011;69] Unused function parameters

Function parameters that are defined but not used may be logical errors and need to be checked to see if any logic is missing.
If the parameter is not really needed, it should be removed, otherwise it will repeatedly cause confusion and make code maintenance difficult.
If the parameter cannot be removed directly (for example, if it is an override function), its name should be removed and some comment can be appended.

There are 2 instances:

- *LeverageMacroBase.sol* ( [344-350](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LeverageMacroBase.sol#L344-L350) ):

```solidity
/// @audit amount
/// @audit fee
344:     function onFlashLoan(
345:         address initiator,
346:         address token,
347:         uint256 amount,
348:         uint256 fee,
349:         bytes calldata data
350:     ) external returns (bytes32) {
```

### [N&#x2011;70] Unused local variables

The following local variables are not used. It is recommended to check the code for logical omissions that cause them not to be used. If it's determined that they are not needed anywhere, it's best to remove them from the codebase to improve code clarity and minimize confusion.

There are 6 instances:

- *CdpManager.sol* ( [922](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L922) ):

```solidity
922:         uint256 index = _addCdpIdToArray(_cdpId);
```

- *CdpManagerStorage.sol* ( [357](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L357), [687](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L687) ):

```solidity
357:             uint _pendingDebt,

687:         (uint256 _newColl, uint256 _newDebt, , uint256 _pendingDebt, ) = _calcSyncedAccounting(
```

- *LeverageMacroBase.sol* ( [465](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LeverageMacroBase.sol#L465) ):

```solidity
465:         bytes32 _cdpId = borrowerOperations.openCdp(
```

- *PriceFeed.sol* ( [656](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/PriceFeed.sol#L656), [744](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/PriceFeed.sol#L744) ):

```solidity
656:             uint80 /* answeredInRound */

744:             uint80 /* answeredInRound */
```

### [N&#x2011;71] Unused named return

Declaring named returns, but not using them, is confusing to the reader. Consider either completely removing them (by declaring just the type without a name), or remove the return statement and do a variable assignment. This would improve the readability of the code, and it may also help reduce regressions during future code refactors.

<details>
<summary>There are 8 instances (click to show):</summary>

- *CdpManager.sol* ( [570](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L570) ):

```solidity
/// @audit entireSystemDebt
570:     function getSystemDebt() public view returns (uint256 entireSystemDebt) {
```

- *CdpManagerStorage.sol* ( [719-721](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L719-L721) ):

```solidity
/// @audit pendingEBTCDebtReward
719:     function getPendingRedistributedDebt(
720:         bytes32 _cdpId
721:     ) public view returns (uint256 pendingEBTCDebtReward) {
```

- *EbtcBase.sol* ( [67](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/EbtcBase.sol#L67), [75](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/EbtcBase.sol#L75), [83-85](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/EbtcBase.sol#L83-L85) ):

```solidity
/// @audit entireSystemColl
67:     function getSystemCollShares() public view returns (uint256 entireSystemColl) {

/// @audit entireSystemDebt
75:     function _getSystemDebt() internal view returns (uint256 entireSystemDebt) {

/// @audit _coll
/// @audit _debt
83:     function _getTCRWithSystemDebtAndCollShares(
84:         uint256 _price
85:     ) internal view returns (uint256 TCR, uint256 _coll, uint256 _debt) {
```

- *Governor.sol* ( [146](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Governor.sol#L146) ):

```solidity
/// @audit roleName
146:     function getRoleName(uint8 role) external view returns (string memory roleName) {
```

- *LiquidationLibrary.sol* ( [544-549](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LiquidationLibrary.sol#L544-L549) ):

```solidity
/// @audit debtToRedistribute
544:     function _calculatePartialLiquidationSurplusAndCap(
545:         uint256 _ICR,
546:         uint256 _price,
547:         uint256 _totalDebtToBurn,
548:         uint256 _totalColToSend
549:     ) private view returns (uint256 toLiquidator, uint256 collSurplus, uint256 debtToRedistribute) {
```

</details>

### [N&#x2011;72] Use delete instead of assigning values to `false`

The `delete` keyword more closely matches the semantics of what is being done, and draws more attention to the changing of state, which may lead to a more thorough audit of its associated logic.

There is 1 instance:

- *LiquidationLibrary.sol* ( [742](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LiquidationLibrary.sol#L742) ):

```solidity
742:         vars.backToNormalMode = false;
```

### [N&#x2011;73] Consider using `delete` rather than assigning zero to clear values

The `delete` keyword more closely matches the semantics of what is being done, and draws more attention to the changing of state, which may lead to a more thorough audit of its associated logic.

<details>
<summary>There are 11 instances (click to show):</summary>

- *CdpManagerStorage.sol* ( [272](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L272), [273](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L273), [274](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L274), [276](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L276), [277](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L277), [413](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L413) ):

```solidity
272:         Cdps[_cdpId].coll = 0;

273:         Cdps[_cdpId].debt = 0;

274:         Cdps[_cdpId].liquidatorRewardShares = 0;

276:         cdpDebtRedistributionIndex[_cdpId] = 0;

277:         cdpStEthFeePerUnitIndex[_cdpId] = 0;

413:         Cdps[_cdpId].stake = 0;
```

- *CollSurplusPool.sol* ( [94](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CollSurplusPool.sol#L94) ):

```solidity
94:         balances[_account] = 0;
```

- *HintHelpers.sol* ( [105](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/HintHelpers.sol#L105), [106](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/HintHelpers.sol#L106), [109](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/HintHelpers.sol#L109) ):

```solidity
105:                         partialRedemptionHintNICR = 0; //reset to 0 as there is no partial redemption in this case

106:                         partialRedemptionNewColl = 0;

109:                         vars.remainingEbtcToRedeem = 0;
```

- *LiquidationLibrary.sol* ( [264](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LiquidationLibrary.sol#L264) ):

```solidity
264:                 _collSurplus = 0;
```

</details>

### [N&#x2011;74] Consider using EIP-5267 to securely describe EIP-712 domains

[EIP-5267](https://eips.ethereum.org/EIPS/eip-5267) is a standard which allows for the retrieval and description of EIP-712 hash domains. This allows external tools to allow users to not just view the struct fields being signed, but the fields the domain the signature contains as well. This is especially useful when a project may exist on multiple chains and or in multiple contracts, and allows users/tools to verify that the signature is for the right fork, chain, version, contract, etc.

There are 2 instances:

- *BorrowerOperations.sol* ( [677-683](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L677-L683) ):

```solidity
677:     function _buildDomainSeparator(
678:         bytes32 typeHash,
679:         bytes32 name,
680:         bytes32 version
681:     ) private view returns (bytes32) {
682:         return keccak256(abi.encode(typeHash, name, version, _chainID(), address(this)));
683:     }
```

- *EBTCToken.sol* ( [235-241](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/EBTCToken.sol#L235-L241) ):

```solidity
235:     function _buildDomainSeparator(
236:         bytes32 typeHash,
237:         bytes32 name,
238:         bytes32 version
239:     ) private view returns (bytes32) {
240:         return keccak256(abi.encode(typeHash, name, version, _chainID(), address(this)));
241:     }
```

### [N&#x2011;75] Use the latest Solidity version

Upgrading to the [latest solidity version](https://github.com/ethereum/solc-js/tags) (0.8.19 for L2s) can optimize gas usage, take advantage of new features and improve overall contract efficiency. Where possible, based on compatibility requirements, it is recommended to use newer/latest solidity version to take advantage of the latest optimizations and features.

<details>
<summary>There are 39 instances (click to show):</summary>

- *ActivePool.sol* ( [3](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/ActivePool.sol#L3) ):

```solidity
3: pragma solidity 0.8.17;
```

- *BorrowerOperations.sol* ( [3](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L3) ):

```solidity
3: pragma solidity 0.8.17;
```

- *CdpManager.sol* ( [3](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L3) ):

```solidity
3: pragma solidity 0.8.17;
```

- *CdpManagerStorage.sol* ( [3](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L3) ):

```solidity
3: pragma solidity 0.8.17;
```

- *CollSurplusPool.sol* ( [3](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CollSurplusPool.sol#L3) ):

```solidity
3: pragma solidity 0.8.17;
```

- *Auth.sol* ( [2](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/Auth.sol#L2) ):

```solidity
2: pragma solidity 0.8.17;
```

- *AuthNoOwner.sol* ( [2](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/AuthNoOwner.sol#L2) ):

```solidity
2: pragma solidity 0.8.17;
```

- *ERC3156FlashLender.sol* ( [3](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/ERC3156FlashLender.sol#L3) ):

```solidity
3: pragma solidity 0.8.17;
```

- *EbtcBase.sol* ( [3](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/EbtcBase.sol#L3) ):

```solidity
3: pragma solidity 0.8.17;
```

- *EbtcMath.sol* ( [3](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/EbtcMath.sol#L3) ):

```solidity
3: pragma solidity 0.8.17;
```

- *ReentrancyGuard.sol* ( [2](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/ReentrancyGuard.sol#L2) ):

```solidity
2: pragma solidity 0.8.17;
```

- *RolesAuthority.sol* ( [2](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/RolesAuthority.sol#L2) ):

```solidity
2: pragma solidity 0.8.17;
```

- *EBTCToken.sol* ( [3](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/EBTCToken.sol#L3) ):

```solidity
3: pragma solidity 0.8.17;
```

- *Governor.sol* ( [2](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Governor.sol#L2) ):

```solidity
2: pragma solidity 0.8.17;
```

- *HintHelpers.sol* ( [3](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/HintHelpers.sol#L3) ):

```solidity
3: pragma solidity 0.8.17;
```

- *IActivePool.sol* ( [3](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IActivePool.sol#L3) ):

```solidity
3: pragma solidity 0.8.17;
```

- *IBorrowerOperations.sol* ( [3](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IBorrowerOperations.sol#L3) ):

```solidity
3: pragma solidity 0.8.17;
```

- *ICdpManager.sol* ( [3](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManager.sol#L3) ):

```solidity
3: pragma solidity 0.8.17;
```

- *ICdpManagerData.sol* ( [3](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManagerData.sol#L3) ):

```solidity
3: pragma solidity 0.8.17;
```

- *ICollSurplusPool.sol* ( [3](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICollSurplusPool.sol#L3) ):

```solidity
3: pragma solidity 0.8.17;
```

- *IEBTCToken.sol* ( [3](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IEBTCToken.sol#L3) ):

```solidity
3: pragma solidity 0.8.17;
```

- *IERC3156FlashBorrower.sol* ( [3](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IERC3156FlashBorrower.sol#L3) ):

```solidity
3: pragma solidity 0.8.17;
```

- *IERC3156FlashLender.sol* ( [3](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IERC3156FlashLender.sol#L3) ):

```solidity
3: pragma solidity 0.8.17;
```

- *IEbtcBase.sol* ( [3](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IEbtcBase.sol#L3) ):

```solidity
3: pragma solidity 0.8.17;
```

- *IFallbackCaller.sol* ( [3](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IFallbackCaller.sol#L3) ):

```solidity
3: pragma solidity 0.8.17;
```

- *IPermitNonce.sol* ( [3](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IPermitNonce.sol#L3) ):

```solidity
3: pragma solidity 0.8.17;
```

- *IPool.sol* ( [3](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IPool.sol#L3) ):

```solidity
3: pragma solidity 0.8.17;
```

- *IPositionManagers.sol* ( [3](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IPositionManagers.sol#L3) ):

```solidity
3: pragma solidity 0.8.17;
```

- *IPriceFeed.sol* ( [3](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IPriceFeed.sol#L3) ):

```solidity
3: pragma solidity 0.8.17;
```

- *IRecoveryModeGracePeriod.sol* ( [2](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IRecoveryModeGracePeriod.sol#L2) ):

```solidity
2: pragma solidity 0.8.17;
```

- *ISortedCdps.sol* ( [3](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ISortedCdps.sol#L3) ):

```solidity
3: pragma solidity 0.8.17;
```

- *LeverageMacroBase.sol* ( [2](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LeverageMacroBase.sol#L2) ):

```solidity
2: pragma solidity 0.8.17;
```

- *LeverageMacroDelegateTarget.sol* ( [2](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LeverageMacroDelegateTarget.sol#L2) ):

```solidity
2: pragma solidity 0.8.17;
```

- *LeverageMacroFactory.sol* ( [2](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LeverageMacroFactory.sol#L2) ):

```solidity
2: pragma solidity 0.8.17;
```

- *LeverageMacroReference.sol* ( [2](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LeverageMacroReference.sol#L2) ):

```solidity
2: pragma solidity 0.8.17;
```

- *LiquidationLibrary.sol* ( [3](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LiquidationLibrary.sol#L3) ):

```solidity
3: pragma solidity 0.8.17;
```

- *PriceFeed.sol* ( [3](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/PriceFeed.sol#L3) ):

```solidity
3: pragma solidity 0.8.17;
```

- *SimplifiedDiamondLike.sol* ( [2](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SimplifiedDiamondLike.sol#L2) ):

```solidity
2: pragma solidity 0.8.17;
```

- *SortedCdps.sol* ( [3](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L3) ):

```solidity
3: pragma solidity 0.8.17;
```

</details>

### [N&#x2011;76] Named mappings are recommended

[Named mappings](https://docs.soliditylang.org/en/v0.8.18/types.html#mapping-types) (with syntax `mapping(KeyType KeyName? => ValueType ValueName?)`) are recommended.It can make the mapping variables clearer, more readable and easier to maintain.

<details>
<summary>There are 18 instances (click to show):</summary>

- *BorrowerOperations.sol* ( [65](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L65), [65](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L65) ):

```solidity
65:     mapping(address => mapping(address => PositionManagerApproval)) public positionManagers;

65:     mapping(address => mapping(address => PositionManagerApproval)) public positionManagers;
```

- *CdpManagerStorage.sol* ( [168](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L168), [190](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L190), [202](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L202) ):

```solidity
168:     mapping(bytes32 => Cdp) public Cdps;

190:     mapping(bytes32 => uint256) public cdpDebtRedistributionIndex;

202:     mapping(bytes32 => uint256) public cdpStEthFeePerUnitIndex;
```

- *CollSurplusPool.sol* ( [30](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CollSurplusPool.sol#L30) ):

```solidity
30:     mapping(address => uint256) internal balances;
```

- *RolesAuthority.sol* ( [28](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/RolesAuthority.sol#L28), [32](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/RolesAuthority.sol#L32), [34](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/RolesAuthority.sol#L34), [34](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/RolesAuthority.sol#L34), [36](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/RolesAuthority.sol#L36), [36](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/RolesAuthority.sol#L36) ):

```solidity
28:     mapping(address => EnumerableSet.Bytes32Set) internal enabledFunctionSigsByTarget;

32:     mapping(address => bytes32) public getUserRoles;

34:     mapping(address => mapping(bytes4 => CapabilityFlag)) public capabilityFlag;

34:     mapping(address => mapping(bytes4 => CapabilityFlag)) public capabilityFlag;

36:     mapping(address => mapping(bytes4 => bytes32)) public getRolesWithCapability;

36:     mapping(address => mapping(bytes4 => bytes32)) public getRolesWithCapability;
```

- *EBTCToken.sol* ( [51](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/EBTCToken.sol#L51), [52](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/EBTCToken.sol#L52), [52](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/EBTCToken.sol#L52) ):

```solidity
51:     mapping(address => uint256) private _balances;

52:     mapping(address => mapping(address => uint256)) private _allowances;

52:     mapping(address => mapping(address => uint256)) private _allowances;
```

- *Governor.sol* ( [30](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Governor.sol#L30) ):

```solidity
30:     mapping(uint8 => string) internal roleNames;
```

- *SimplifiedDiamondLike.sol* ( [34](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SimplifiedDiamondLike.sol#L34) ):

```solidity
34:         mapping(bytes4 => address) callbackHandler;
```

- *SortedCdps.sol* ( [74](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L74) ):

```solidity
74:         mapping(bytes32 => Node) nodes; // Track the corresponding ids for each node in the list
```

</details>

### [N&#x2011;77] Whitespace in Expressions

See the [Whitespace in Expressions](https://docs.soliditylang.org/en/latest/style-guide.html#whitespace-in-expressions) section of the Solidity Style Guide.

<details>
<summary>There are 32 instances (click to show):</summary>

- *CdpManagerStorage.sol* ( [686](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L686), [687](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L687), [687](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L687), [722](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L722), [748](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L748), [748](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L748), [748](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L748), [840](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L840), [840](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L840), [850](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L850), [851](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L851), [851](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L851), [851](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L851), [851](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L851), [876](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L876), [876](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L876) ):

```solidity
/// @audit Whitespace inside parenthesis
686:         (, uint256 _newGlobalSplitIdx, ) = _calcSyncedGlobalAccounting(_newIndex, _oldIndex);

/// @audit Whitespace inside parenthesis
687:         (uint256 _newColl, uint256 _newDebt, , uint256 _pendingDebt, ) = _calcSyncedAccounting(

/// @audit Whitespace before a comma
687:         (uint256 _newColl, uint256 _newDebt, , uint256 _pendingDebt, ) = _calcSyncedAccounting(

/// @audit Whitespace inside parenthesis
722:         (uint256 _pendingDebt, ) = _getPendingRedistributedDebt(_cdpId);

/// @audit Whitespace inside parenthesis
748:         (uint256 _newColl, uint256 _newDebt, , , ) = _calcSyncedAccounting(

/// @audit Whitespace before a comma
748:         (uint256 _newColl, uint256 _newDebt, , , ) = _calcSyncedAccounting(

/// @audit Whitespace before a comma
748:         (uint256 _newColl, uint256 _newDebt, , , ) = _calcSyncedAccounting(

/// @audit Whitespace inside parenthesis
840:         (uint256 _newDebt, , ) = _getSyncedCdpDebtAndRedistribution(_cdpId);

/// @audit Whitespace before a comma
840:         (uint256 _newDebt, , ) = _getSyncedCdpDebtAndRedistribution(_cdpId);

/// @audit Whitespace inside parenthesis
850:         (, uint256 _newGlobalSplitIdx, ) = _calcSyncedGlobalAccounting(_newIndex, _oldIndex);

/// @audit Whitespace inside parenthesis
851:         (uint256 _newColl, , , , ) = _calcSyncedAccounting(

/// @audit Whitespace before a comma
851:         (uint256 _newColl, , , , ) = _calcSyncedAccounting(

/// @audit Whitespace before a comma
851:         (uint256 _newColl, , , , ) = _calcSyncedAccounting(

/// @audit Whitespace before a comma
851:         (uint256 _newColl, , , , ) = _calcSyncedAccounting(

/// @audit Whitespace inside parenthesis
876:         (uint256 _feeTaken, , ) = _calcSyncedGlobalAccounting(_newIndex, _oldIndex);

/// @audit Whitespace before a comma
876:         (uint256 _feeTaken, , ) = _calcSyncedGlobalAccounting(_newIndex, _oldIndex);
```

- *EbtcBase.sol* ( [80](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/EbtcBase.sol#L80), [80](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/EbtcBase.sol#L80) ):

```solidity
/// @audit Whitespace inside parenthesis
80:         (TCR, , ) = _getTCRWithSystemDebtAndCollShares(_price);

/// @audit Whitespace before a comma
80:         (TCR, , ) = _getTCRWithSystemDebtAndCollShares(_price);
```

- *LeverageMacroBase.sol* ( [385](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LeverageMacroBase.sol#L385), [414](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LeverageMacroBase.sol#L414) ):

```solidity
/// @audit Whitespace inside parenthesis
385:         for (uint256 i; i < swapLength; ) {

/// @audit Whitespace inside parenthesis
414:         (bool success, ) = excessivelySafeCall(
```

- *LiquidationLibrary.sol* ( [409](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LiquidationLibrary.sol#L409), [753](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LiquidationLibrary.sol#L753), [753](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LiquidationLibrary.sol#L753), [816](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LiquidationLibrary.sol#L816), [816](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LiquidationLibrary.sol#L816) ):

```solidity
/// @audit Whitespace inside parenthesis
409:         (uint256 _partialColl, uint256 newColl, ) = _calculatePartialLiquidationSurplusAndCap(

/// @audit Whitespace inside parenthesis
753:         for (vars.i = _start; ; ) {

/// @audit Whitespace before a semicolon
753:         for (vars.i = _start; ; ) {

/// @audit Whitespace inside parenthesis
816:         for (vars.i = _start; ; ) {

/// @audit Whitespace before a semicolon
816:         for (vars.i = _start; ; ) {
```

- *SimplifiedDiamondLike.sol* ( [114](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SimplifiedDiamondLike.sol#L114) ):

```solidity
/// @audit Whitespace inside parenthesis
114:         for (uint256 i; i < length; ) {
```

- *SortedCdps.sol* ( [144](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L144), [217](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L217), [273](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L273), [275](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L275), [275](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L275), [293](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L293) ):

```solidity
/// @audit Whitespace inside parenthesis
144:         (bytes32 _cdpId, ) = _cdpOfOwnerByIndex(owner, index, dummyId, 0);

/// @audit Whitespace inside parenthesis
217:         (uint256 _cnt, ) = _cdpCountOf(owner, dummyId, 0);

/// @audit Whitespace inside parenthesis
273:         (uint _ownedCount, ) = _cdpCountOf(owner, dummyId, 0);

/// @audit Whitespace inside parenthesis
275:             (bytes32[] memory _allCdps, , ) = _getCdpsOf(owner, dummyId, 0, _ownedCount);

/// @audit Whitespace before a comma
275:             (bytes32[] memory _allCdps, , ) = _getCdpsOf(owner, dummyId, 0, _ownedCount);

/// @audit Whitespace inside parenthesis
293:         (uint _ownedCount, ) = _cdpCountOf(owner, startNodeId, maxNodes);
```

</details>

### [N&#x2011;78] Use a struct to encapsulate multiple function parameters

If a function has too many parameters, replacing them with a struct can improve code readability and maintainability, increase reusability, and reduce the likelihood of errors when passing the parameters.

<details>
<summary>There are 8 instances (click to show):</summary>

- *BorrowerOperations.sol* ( [107-116](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L107-L116), [300-308](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L300-L308), [328-336](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L328-L336), [706-714](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L706-L714), [1004-1012](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L1004-L1012) ):

```solidity
107:     constructor(
108:         address _cdpManagerAddress,
109:         address _activePoolAddress,
110:         address _collSurplusPoolAddress,
111:         address _priceFeedAddress,
112:         address _sortedCdpsAddress,
113:         address _ebtcTokenAddress,
114:         address _feeRecipientAddress,
115:         address _collTokenAddress
116:     ) EbtcBase(_activePoolAddress, _priceFeedAddress, _collTokenAddress) {

300:     function adjustCdpWithColl(
301:         bytes32 _cdpId,
302:         uint256 _stEthBalanceDecrease,
303:         uint256 _debtChange,
304:         bool _isDebtIncrease,
305:         bytes32 _upperHint,
306:         bytes32 _lowerHint,
307:         uint256 _stEthBalanceIncrease
308:     ) external override nonReentrantSelfAndCdpM {

328:     function _adjustCdpInternal(
329:         bytes32 _cdpId,
330:         uint256 _stEthBalanceDecrease,
331:         uint256 _debtChange,
332:         bool _isDebtIncrease,
333:         bytes32 _upperHint,
334:         bytes32 _lowerHint,
335:         uint256 _stEthBalanceIncrease
336:     ) internal {

706:     function permitPositionManagerApproval(
707:         address _borrower,
708:         address _positionManager,
709:         PositionManagerApproval _approval,
710:         uint256 _deadline,
711:         uint8 v,
712:         bytes32 r,
713:         bytes32 s
714:     ) external override {

1004:     function _getNewICRFromCdpChange(
1005:         uint256 _collShares,
1006:         uint256 _debt,
1007:         uint256 _collSharesChange,
1008:         bool _isCollIncrease,
1009:         uint256 _debtChange,
1010:         bool _isDebtIncrease,
1011:         uint256 _price
1012:     ) internal view returns (uint256) {
```

- *CdpManager.sol* ( [30-52](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L30-L52), [320-328](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L320-L328) ):

```solidity
30:     constructor(
31:         address _liquidationLibraryAddress,
32:         address _authorityAddress,
33:         address _borrowerOperationsAddress,
34:         address _collSurplusPoolAddress,
35:         address _ebtcTokenAddress,
36:         address _sortedCdpsAddress,
37:         address _activePoolAddress,
38:         address _priceFeedAddress,
39:         address _collTokenAddress
40:     )
41:         CdpManagerStorage(
42:             _liquidationLibraryAddress,
43:             _authorityAddress,
44:             _borrowerOperationsAddress,
45:             _collSurplusPoolAddress,
46:             _ebtcTokenAddress,
47:             _sortedCdpsAddress,
48:             _activePoolAddress,
49:             _priceFeedAddress,
50:             _collTokenAddress
51:         )
52:     {

320:     function redeemCollateral(
321:         uint256 _debt,
322:         bytes32 _firstRedemptionHint,
323:         bytes32 _upperPartialRedemptionHint,
324:         bytes32 _lowerPartialRedemptionHint,
325:         uint256 _partialRedemptionHintNICR,
326:         uint256 _maxIterations,
327:         uint256 _maxFeePercentage
328:     ) external override nonReentrantSelfAndBOps {
```

- *LiquidationLibrary.sol* ( [14-34](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LiquidationLibrary.sol#L14-L34) ):

```solidity
14:     constructor(
15:         address _borrowerOperationsAddress,
16:         address _collSurplusPool,
17:         address _ebtcToken,
18:         address _sortedCdps,
19:         address _activePool,
20:         address _priceFeed,
21:         address _collateral
22:     )
23:         CdpManagerStorage(
24:             address(0),
25:             address(0),
26:             _borrowerOperationsAddress,
27:             _collSurplusPool,
28:             _ebtcToken,
29:             _sortedCdps,
30:             _activePool,
31:             _priceFeed,
32:             _collateral
33:         )
34:     {}
```

</details>

### [N&#x2011;79] Returning a struct instead of a bunch of variables is better

If a function returns [too many variables](https://docs.soliditylang.org/en/v0.8.21/contracts.html#returning-multiple-values), replacing them with a struct can improve code readability, maintainability and reusability.

<details>
<summary>There are 3 instances (click to show):</summary>

- *CdpManagerStorage.sol* ( [787-791](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L787-L791) ):

```solidity
787:     function _calcSyncedAccounting(
788:         bytes32 _cdpId,
789:         uint256 _cdpPerUnitIdx,
790:         uint256 _systemStEthFeePerUnitIndex
791:     ) internal view returns (uint256, uint256, uint256, uint256, uint256) {
```

- *HintHelpers.sol* ( [48-60](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/HintHelpers.sol#L48-L60) ):

```solidity
48:     function getRedemptionHints(
49:         uint256 _EBTCamount,
50:         uint256 _price,
51:         uint256 _maxIterations
52:     )
53:         external
54:         view
55:         returns (
56:             bytes32 firstRedemptionHint,
57:             uint256 partialRedemptionHintNICR,
58:             uint256 truncatedEBTCamount,
59:             uint256 partialRedemptionNewColl
60:         )
```

- *LiquidationLibrary.sol* ( [186-189](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LiquidationLibrary.sol#L186-L189) ):

```solidity
186:     function _liquidateCdpInGivenMode(
187:         LiquidationLocals memory _liqState,
188:         LiquidationRecoveryModeLocals memory _recoveryState
189:     ) private returns (uint256, uint256, uint256, uint256, uint256) {
```

</details>

### [N&#x2011;80] Events that mark critical parameter changes should contain both the old and the new value

This should especially be done if the new value is not required to be different from the old value.

<details>
<summary>There are 23 instances (click to show):</summary>

- *ActivePool.sol* ( [173](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/ActivePool.sol#L173), [399](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/ActivePool.sol#L399) ):

```solidity
173:         emit SystemCollSharesUpdated(cachedSystemCollShares);

399:         emit FeeRecipientAddressChanged(_feeRecipientAddress);
```

- *BorrowerOperations.sol* ( [1149](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L1149) ):

```solidity
1149:         emit FeeRecipientAddressChanged(_feeRecipientAddress);
```

- *CdpManager.sol* ( [630](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L630), [698](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L698), [782](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L782), [801](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L801), [824](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L824), [836](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L836) ):

```solidity
630:         emit BaseRateUpdated(newBaseRate);

698:             emit LastRedemptionTimestampUpdated(block.timestamp);

782:         emit StakingRewardSplitSet(_stakingRewardSplit);

801:         emit RedemptionFeeFloorSet(_redemptionFeeFloor);

824:         emit MinuteDecayFactorSet(_minuteDecayFactor);

836:         emit BetaSet(_beta);
```

- *CdpManagerStorage.sol* ( [55](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L55), [119](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L119), [340](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L340), [414](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L414), [425](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L425), [481](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L481) ):

```solidity
55:             emit GracePeriodStart();

119:         emit GracePeriodDurationSet(_gracePeriod);

340:         emit CdpDebtRedistributionIndexUpdated(_cdpId, _systemDebtRedistributionIndex);

414:         emit TotalStakesUpdated(_newTotalStakes);

425:         emit TotalStakesUpdated(_newTotalStakes);

481:         emit CdpArrayIndexUpdated(idToMove, index);
```

- *CollSurplusPool.sol* ( [83](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CollSurplusPool.sol#L83) ):

```solidity
83:         emit SurplusCollSharesUpdated(_account, newAmount);
```

- *Auth.sol* ( [49](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/Auth.sol#L49) ):

```solidity
49:         emit AuthorityUpdated(msg.sender, newAuthority);
```

- *AuthNoOwner.sol* ( [50](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/AuthNoOwner.sol#L50) ):

```solidity
50:         emit AuthorityUpdated(msg.sender, Authority(newAuthority));
```

- *RolesAuthority.sol* ( [101](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/RolesAuthority.sol#L101), [129](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/RolesAuthority.sol#L129), [163](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/RolesAuthority.sol#L163) ):

```solidity
101:         emit PublicCapabilityUpdated(target, functionSig, enabled);

129:         emit RoleCapabilityUpdated(role, target, functionSig, enabled);

163:         emit UserRoleUpdated(user, role, enabled);
```

- *Governor.sol* ( [157](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Governor.sol#L157) ):

```solidity
157:         emit RoleNameSet(role, roleName);
```

- *PriceFeed.sol* ( [548](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/PriceFeed.sol#L548) ):

```solidity
548:         emit PriceFeedStatusChanged(_status);
```

</details>

### [N&#x2011;81] Contract variables should have comments

Consider adding some comments on non-public contract variables to explain what they are supposed to do. This will help for future code reviews.

<details>
<summary>There are 21 instances (click to show):</summary>

- *ActivePool.sol* ( [32](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/ActivePool.sol#L32) ):

```solidity
32:     uint256 internal systemDebt;
```

- *BorrowerOperations.sol* ( [46](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L46), [48](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L48), [49](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L49) ):

```solidity
46:     uint256 private immutable _CACHED_CHAIN_ID;

48:     bytes32 private immutable _HASHED_NAME;

49:     bytes32 private immutable _HASHED_VERSION;
```

- *CdpManagerStorage.sol* ( [128](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L128), [152](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L152) ):

```solidity
128:     ICollSurplusPool immutable collSurplusPool;

152:     uint256 internal immutable deploymentStartTime;
```

- *AuthNoOwner.sol* ( [13](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/AuthNoOwner.sol#L13), [14](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/AuthNoOwner.sol#L14) ):

```solidity
13:     Authority private _authority;

14:     bool private _authorityInitialized;
```

- *RolesAuthority.sol* ( [26](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/RolesAuthority.sol#L26), [27](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/RolesAuthority.sol#L27), [28](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/RolesAuthority.sol#L28), [30](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/RolesAuthority.sol#L30) ):

```solidity
26:     EnumerableSet.AddressSet internal users;

27:     EnumerableSet.AddressSet internal targets;

28:     mapping(address => EnumerableSet.Bytes32Set) internal enabledFunctionSigsByTarget;

30:     EnumerableSet.Bytes32Set internal enabledFunctionSigsPublic;
```

- *EBTCToken.sol* ( [27](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/EBTCToken.sol#L27), [45](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/EBTCToken.sol#L45), [47](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/EBTCToken.sol#L47), [48](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/EBTCToken.sol#L48), [52](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/EBTCToken.sol#L52) ):

```solidity
27:     uint256 private _totalSupply;

45:     uint256 private immutable _CACHED_CHAIN_ID;

47:     bytes32 private immutable _HASHED_NAME;

48:     bytes32 private immutable _HASHED_VERSION;

52:     mapping(address => mapping(address => uint256)) private _allowances;
```

- *Governor.sol* ( [17](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Governor.sol#L17), [30](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Governor.sol#L30) ):

```solidity
17:     bytes32 NO_ROLES = bytes32(0);

30:     mapping(uint8 => string) internal roleNames;
```

- *LeverageMacroBase.sol* ( [35](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LeverageMacroBase.sol#L35) ):

```solidity
35:     bool internal immutable willSweep;
```

- *LeverageMacroReference.sol* ( [12](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LeverageMacroReference.sol#L12) ):

```solidity
12:     address internal immutable theOwner;
```

</details>

### [N&#x2011;82] File is missing NatSpec

It is recommended that Solidity contracts are fully annotated using NatSpec

There are 15 instances:

- [*ERC3156FlashLender.sol*](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/ERC3156FlashLender.sol)

- [*IActivePool.sol*](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IActivePool.sol)

- [*IBorrowerOperations.sol*](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IBorrowerOperations.sol)

- [*ICdpManager.sol*](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManager.sol)

- [*ICdpManagerData.sol*](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManagerData.sol)

- [*ICollSurplusPool.sol*](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICollSurplusPool.sol)

- [*IEBTCToken.sol*](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IEBTCToken.sol)

- [*IEbtcBase.sol*](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IEbtcBase.sol)

- [*IFallbackCaller.sol*](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IFallbackCaller.sol)

- [*IPermitNonce.sol*](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IPermitNonce.sol)

- [*IPool.sol*](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IPool.sol)

- [*IPositionManagers.sol*](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IPositionManagers.sol)

- [*IPriceFeed.sol*](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IPriceFeed.sol)

- [*IRecoveryModeGracePeriod.sol*](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IRecoveryModeGracePeriod.sol)

- [*ISortedCdps.sol*](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ISortedCdps.sol)

### [N&#x2011;83] Modifier declarations should have NatSpec descriptions

Modifier declarations should have NatSpec descriptions

There are 3 instances:

- *Auth.sol* ( [26](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/Auth.sol#L26) ):

```solidity
26:     modifier requiresAuth() virtual {
```

- *AuthNoOwner.sol* ( [16](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/AuthNoOwner.sol#L16) ):

```solidity
16:     modifier requiresAuth() virtual {
```

- *ReentrancyGuard.sol* ( [13](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/ReentrancyGuard.sol#L13) ):

```solidity
13:     modifier nonReentrant() virtual {
```

### [N&#x2011;84] Empty bytes check is missing

Passing empty bytes to a function can cause unexpected behavior, such as certain operations failing, producing incorrect results, or wasting gas. It is recommended to check that all byte parameters are not empty.

<details>
<summary>There are 3 instances (click to show):</summary>

- *ActivePool.sol* ( [261-266](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/ActivePool.sol#L261-L266) ):

```solidity
/// @audit data
261:     function flashLoan(
262:         IERC3156FlashBorrower receiver,
263:         address token,
264:         uint256 amount,
265:         bytes calldata data
266:     ) external override returns (bool) {
```

- *BorrowerOperations.sol* ( [1077-1082](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L1077-L1082) ):

```solidity
/// @audit data
1077:     function flashLoan(
1078:         IERC3156FlashBorrower receiver,
1079:         address token,
1080:         uint256 amount,
1081:         bytes calldata data
1082:     ) external override returns (bool) {
```

- *LeverageMacroBase.sol* ( [344-350](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LeverageMacroBase.sol#L344-L350) ):

```solidity
/// @audit data
344:     function onFlashLoan(
345:         address initiator,
346:         address token,
347:         uint256 amount,
348:         uint256 fee,
349:         bytes calldata data
350:     ) external returns (bytes32) {
```

</details>

### [N&#x2011;85] Contract functions should use an `interface`

All `external`/`public` functions should extend an `interface`. This is useful to ensure that the whole API is extracted and can be more easily integrated by other projects.

<details>
<summary>There are 63 instances (click to show):</summary>

- *ActivePool.sol* ( [371](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/ActivePool.sol#L371), [404](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/ActivePool.sol#L404), [417](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/ActivePool.sol#L417) ):

```solidity
371:     function sweepToken(address token, uint256 amount) public nonReentrant requiresAuth {

404:     function setFeeBps(uint256 _newFee) external requiresAuth {

417:     function setFlashLoansPaused(bool _paused) external requiresAuth {
```

- *BorrowerOperations.sol* ( [659](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L659), [1140](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L1140), [1154](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L1154), [1167](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L1167) ):

```solidity
659:     function DOMAIN_SEPARATOR() external view returns (bytes32) {

1140:     function setFeeRecipientAddress(address _feeRecipientAddress) external requiresAuth {

1154:     function setFeeBps(uint256 _newFee) external requiresAuth {

1167:     function setFlashLoansPaused(bool _paused) external requiresAuth {
```

- *CdpManager.sol* ( [570](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L570), [717](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L717), [727-731](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L727-L731), [773](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L773), [788](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L788), [807](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L807), [830](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L830), [843](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L843) ):

```solidity
570:     function getSystemDebt() public view returns (uint256 entireSystemDebt) {

717:     function getDeploymentStartTime() public view returns (uint256) {

727:     function checkPotentialRecoveryMode(
728:         uint256 _systemCollShares,
729:         uint256 _systemDebt,
730:         uint256 _price
731:     ) external view returns (bool) {

773:     function setStakingRewardSplit(uint256 _stakingRewardSplit) external requiresAuth {

788:     function setRedemptionFeeFloor(uint256 _redemptionFeeFloor) external requiresAuth {

807:     function setMinuteDecayFactor(uint256 _minuteDecayFactor) external requiresAuth {

830:     function setBeta(uint256 _beta) external requiresAuth {

843:     function setRedemptionsPaused(bool _paused) external requiresAuth {
```

- *CdpManagerStorage.sol* ( [111](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L111) ):

```solidity
111:     function setGracePeriod(uint128 _gracePeriod) external requiresAuth {
```

- *CollSurplusPool.sol* ( [142](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CollSurplusPool.sol#L142) ):

```solidity
142:     function sweepToken(address token, uint256 amount) public nonReentrant requiresAuth {
```

- *Auth.sol* ( [42](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/Auth.sol#L42), [52](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/Auth.sol#L52) ):

```solidity
42:     function setAuthority(Authority newAuthority) public virtual {

52:     function transferOwnership(address newOwner) public virtual requiresAuth {
```

- *AuthNoOwner.sol* ( [22](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/AuthNoOwner.sol#L22), [26](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/AuthNoOwner.sol#L26), [38](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/AuthNoOwner.sol#L38) ):

```solidity
22:     function authority() public view returns (Authority) {

26:     function authorityInitialized() public view returns (bool) {

38:     function setAuthority(address newAuthority) public virtual {
```

- *EbtcBase.sol* ( [67](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/EbtcBase.sol#L67) ):

```solidity
67:     function getSystemCollShares() public view returns (uint256 entireSystemColl) {
```

- *RolesAuthority.sol* ( [38](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/RolesAuthority.sol#L38), [42-46](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/RolesAuthority.sol#L42-L46), [50](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/RolesAuthority.sol#L50), [85-89](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/RolesAuthority.sol#L85-L89), [106-111](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/RolesAuthority.sol#L106-L111), [133](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/RolesAuthority.sol#L133), [147](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/RolesAuthority.sol#L147) ):

```solidity
38:     function doesUserHaveRole(address user, uint8 role) public view virtual returns (bool) {

42:     function doesRoleHaveCapability(
43:         uint8 role,
44:         address target,
45:         bytes4 functionSig
46:     ) public view virtual returns (bool) {

50:     function isPublicCapability(address target, bytes4 functionSig) public view returns (bool) {

85:     function setPublicCapability(
86:         address target,
87:         bytes4 functionSig,
88:         bool enabled
89:     ) public virtual requiresAuth {

106:     function setRoleCapability(
107:         uint8 role,
108:         address target,
109:         bytes4 functionSig,
110:         bool enabled
111:     ) public virtual requiresAuth {

133:     function burnCapability(address target, bytes4 functionSig) public virtual requiresAuth {

147:     function setUserRole(address user, uint8 role, bool enabled) public virtual requiresAuth {
```

- *EBTCToken.sol* ( [104](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/EBTCToken.sol#L104), [176](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/EBTCToken.sol#L176) ):

```solidity
104:     function burn(uint256 _amount) external {

176:     function DOMAIN_SEPARATOR() external view returns (bytes32) {
```

- *Governor.sol* ( [43](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Governor.sol#L43), [73](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Governor.sol#L73), [96](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Governor.sol#L96), [120](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Governor.sol#L120), [131-133](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Governor.sol#L131-L133), [146](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Governor.sol#L146), [154](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Governor.sol#L154) ):

```solidity
43:     function getUsersByRole(uint8 role) external view returns (address[] memory usersWithRole) {

73:     function getRolesForUser(address user) external view returns (uint8[] memory rolesForUser) {

96:     function getRolesFromByteMap(bytes32 byteMap) public pure returns (uint8[] memory roleIds) {

120:     function getByteMapFromRoles(uint8[] memory roleIds) public pure returns (bytes32) {

131:     function getEnabledFunctionsInTarget(
132:         address _target
133:     ) public view returns (bytes4[] memory _funcs) {

146:     function getRoleName(uint8 role) external view returns (string memory roleName) {

154:     function setRoleName(uint8 role, string memory roleName) external requiresAuth {
```

- *HintHelpers.sol* ( [48-55](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/HintHelpers.sol#L48-L55), [164-168](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/HintHelpers.sol#L164-L168), [203](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/HintHelpers.sol#L203), [212-216](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/HintHelpers.sol#L212-L216) ):

```solidity
48:     function getRedemptionHints(
49:         uint256 _EBTCamount,
50:         uint256 _price,
51:         uint256 _maxIterations
52:     )
53:         external
54:         view
55:         returns (

164:     function getApproxHint(
165:         uint256 _CR,
166:         uint256 _numTrials,
167:         uint256 _inputRandomSeed
168:     ) external view returns (bytes32 hint, uint256 diff, uint256 latestRandomSeed) {

203:     function computeNominalCR(uint256 _coll, uint256 _debt) external pure returns (uint256) {

212:     function computeCR(
213:         uint256 _coll,
214:         uint256 _debt,
215:         uint256 _price
216:     ) external pure returns (uint256) {
```

- *LeverageMacroBase.sol* ( [39](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LeverageMacroBase.sol#L39), [118-124](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LeverageMacroBase.sol#L118-L124), [214](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LeverageMacroBase.sol#L214), [234](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LeverageMacroBase.sol#L234), [338](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LeverageMacroBase.sol#L338), [344-350](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LeverageMacroBase.sol#L344-L350) ):

```solidity
39:     function owner() public virtual returns (address) {

118:     function doOperation(
119:         FlashLoanType flType,
120:         uint256 borrowAmount,
121:         LeverageMacroOperation calldata operation,
122:         PostOperationCheck postCheckType,
123:         PostCheckParams calldata checkParams
124:     ) external {

214:     function sweepToCaller() public {

234:     function sweepToken(address token, uint256 amount) public {

338:     function decodeFLData(bytes calldata data) public view returns (LeverageMacroOperation memory) {

344:     function onFlashLoan(
345:         address initiator,
346:         address token,
347:         uint256 amount,
348:         uint256 fee,
349:         bytes calldata data
350:     ) external returns (bytes32) {
```

- *LeverageMacroDelegateTarget.sol* ( [63](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LeverageMacroDelegateTarget.sol#L63) ):

```solidity
63:     function owner() public override returns (address) {
```

- *LeverageMacroFactory.sol* ( [38](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LeverageMacroFactory.sol#L38), [43](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LeverageMacroFactory.sol#L43) ):

```solidity
38:     function deployNewMacro() external returns (address) {

43:     function deployNewMacro(address _owner) public returns (address) {
```

- *LeverageMacroReference.sol* ( [44](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LeverageMacroReference.sol#L44), [50](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LeverageMacroReference.sol#L50) ):

```solidity
44:     function owner() public override returns (address) {

50:     function resetApprovals() external {
```

- *LiquidationLibrary.sol* ( [40](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LiquidationLibrary.sol#L40), [50-55](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LiquidationLibrary.sol#L50-L55), [679](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LiquidationLibrary.sol#L679) ):

```solidity
40:     function liquidate(bytes32 _cdpId) external nonReentrantSelfAndBOps {

50:     function partiallyLiquidate(
51:         bytes32 _cdpId,
52:         uint256 _partialAmount,
53:         bytes32 _upperPartialHint,
54:         bytes32 _lowerPartialHint
55:     ) external nonReentrantSelfAndBOps {

679:     function batchLiquidateCdps(bytes32[] memory _cdpArray) external nonReentrantSelfAndBOps {
```

- *PriceFeed.sol* ( [358](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/PriceFeed.sol#L358) ):

```solidity
358:     function setFallbackCaller(address _fallbackCaller) external requiresAuth {
```

- *SimplifiedDiamondLike.sol* ( [51](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SimplifiedDiamondLike.sol#L51), [66](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SimplifiedDiamondLike.sol#L66), [76](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SimplifiedDiamondLike.sol#L76), [110](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SimplifiedDiamondLike.sol#L110) ):

```solidity
51:     function setFallbackHandler(bytes4 sig, address handler) external {

66:     function setAllowAnyCall(bool allowNonCallbacks) external {

76:     function enableCallbackForCall() external {

110:     function execute(Operation[] calldata ops) external payable {
```

- *SortedCdps.sol* ( [105-109](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L105-L109) ):

```solidity
105:     function toCdpId(
106:         address owner,
107:         uint256 blockHeight,
108:         uint256 nonce
109:     ) public pure returns (bytes32) {
```

</details>

### [N&#x2011;86] Don't define functions with the same name in a contract

In Solidity, while function overriding allows for functions with the same name to coexist, it is advisable to avoid this practice to enhance code readability and maintainability. Having multiple functions with the same name, even with different parameters or in inherited contracts, can cause confusion and increase the likelihood of errors during development, testing, and debugging. Using distinct and descriptive function names not only clarifies the purpose and behavior of each function, but also helps prevent unintended function calls or incorrect overriding. By adopting a clear and consistent naming convention, developers can create more comprehensible and maintainable smart contracts.

There are 2 instances:

- *EBTCToken.sol* ( [104](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/EBTCToken.sol#L104) ):

```solidity
/// @audit Different function with same name found on line 95
104:     function burn(uint256 _amount) external {
```

- *LeverageMacroFactory.sol* ( [43](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LeverageMacroFactory.sol#L43) ):

```solidity
/// @audit Different function with same name found on line 38
43:     function deployNewMacro(address _owner) public returns (address) {
```

### [N&#x2011;87] Interface files should not use fixed compiler versions

Interfaces should not use fixed compiler versions, since they may be used by projects using a different version.

<details>
<summary>There are 16 instances (click to show):</summary>

- *IActivePool.sol* ( [3](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IActivePool.sol#L3) ):

```solidity
3: pragma solidity 0.8.17;
```

- *IBorrowerOperations.sol* ( [3](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IBorrowerOperations.sol#L3) ):

```solidity
3: pragma solidity 0.8.17;
```

- *ICdpManager.sol* ( [3](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManager.sol#L3) ):

```solidity
3: pragma solidity 0.8.17;
```

- *ICdpManagerData.sol* ( [3](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManagerData.sol#L3) ):

```solidity
3: pragma solidity 0.8.17;
```

- *ICollSurplusPool.sol* ( [3](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICollSurplusPool.sol#L3) ):

```solidity
3: pragma solidity 0.8.17;
```

- *IEBTCToken.sol* ( [3](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IEBTCToken.sol#L3) ):

```solidity
3: pragma solidity 0.8.17;
```

- *IERC3156FlashBorrower.sol* ( [3](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IERC3156FlashBorrower.sol#L3) ):

```solidity
3: pragma solidity 0.8.17;
```

- *IERC3156FlashLender.sol* ( [3](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IERC3156FlashLender.sol#L3) ):

```solidity
3: pragma solidity 0.8.17;
```

- *IEbtcBase.sol* ( [3](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IEbtcBase.sol#L3) ):

```solidity
3: pragma solidity 0.8.17;
```

- *IFallbackCaller.sol* ( [3](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IFallbackCaller.sol#L3) ):

```solidity
3: pragma solidity 0.8.17;
```

- *IPermitNonce.sol* ( [3](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IPermitNonce.sol#L3) ):

```solidity
3: pragma solidity 0.8.17;
```

- *IPool.sol* ( [3](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IPool.sol#L3) ):

```solidity
3: pragma solidity 0.8.17;
```

- *IPositionManagers.sol* ( [3](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IPositionManagers.sol#L3) ):

```solidity
3: pragma solidity 0.8.17;
```

- *IPriceFeed.sol* ( [3](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IPriceFeed.sol#L3) ):

```solidity
3: pragma solidity 0.8.17;
```

- *IRecoveryModeGracePeriod.sol* ( [2](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IRecoveryModeGracePeriod.sol#L2) ):

```solidity
2: pragma solidity 0.8.17;
```

- *ISortedCdps.sol* ( [3](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ISortedCdps.sol#L3) ):

```solidity
3: pragma solidity 0.8.17;
```

</details>

### [N&#x2011;88] Multiple mappings with same keys can be combined into a single struct mapping for readability

Well-organized data structures make code reviews easier, which may lead to fewer bugs. Consider combining related mappings into mappings to structs, so it's clear what data is related.

There are 5 instances:

- *CdpManagerStorage.sol* ( [168](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L168), [190](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L190), [202](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L202) ):

```solidity
168:     mapping(bytes32 => Cdp) public Cdps;

190:     mapping(bytes32 => uint256) public cdpDebtRedistributionIndex;

202:     mapping(bytes32 => uint256) public cdpStEthFeePerUnitIndex;
```

- *EBTCToken.sol* ( [51](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/EBTCToken.sol#L51), [52](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/EBTCToken.sol#L52) ):

```solidity
51:     mapping(address => uint256) private _balances;

52:     mapping(address => mapping(address => uint256)) private _allowances;
```

### [N&#x2011;89] Control structures do not follow the Solidity Style Guide

Refer to the [Solidity style guide - Control Structures](https://docs.soliditylang.org/en/v0.8.20/style-guide.html#control-structures).

<details>
<summary>There are 32 instances (click to show):</summary>

- *BorrowerOperations.sol* ( [21-28](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L21-L28) ):

```solidity
21: contract BorrowerOperations is
22:     EbtcBase,
23:     ReentrancyGuard,
24:     IBorrowerOperations,
25:     ERC3156FlashLender,
26:     AuthNoOwner,
27:     PermitNonce
28: {
```

- *CdpManager.sol* ( [201](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L201), [276](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L276), [388](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L388), [408](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L408) ):

```solidity
201:             if (

276:         if (

388:         while (

408:                 if (singleRedemption.cancelledPartial) break;
```

- *CdpManagerStorage.sol* ( [623](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L623) ):

```solidity
623:         if (
```

- *HintHelpers.sol* ( [48-61](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/HintHelpers.sol#L48-L61), [68](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/HintHelpers.sol#L68), [84](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/HintHelpers.sol#L84), [101](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/HintHelpers.sol#L101) ):

```solidity
48:     function getRedemptionHints(
49:         uint256 _EBTCamount,
50:         uint256 _price,
51:         uint256 _maxIterations
52:     )
53:         external
54:         view
55:         returns (
56:             bytes32 firstRedemptionHint,
57:             uint256 partialRedemptionHintNICR,
58:             uint256 truncatedEBTCamount,
59:             uint256 partialRedemptionNewColl
60:         )
61:     {

68:             while (

84:             while (

101:                     if (
```

- *LiquidationLibrary.sol* ( [157](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LiquidationLibrary.sol#L157), [759](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LiquidationLibrary.sol#L759) ):

```solidity
157:             if (

759:                 if (
```

- *PriceFeed.sol* ( [191](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/PriceFeed.sol#L191), [226](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/PriceFeed.sol#L226), [239](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/PriceFeed.sol#L239), [327](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/PriceFeed.sol#L327), [364](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/PriceFeed.sol#L364), [372](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/PriceFeed.sol#L372), [419](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/PriceFeed.sol#L419), [509](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/PriceFeed.sol#L509), [532](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/PriceFeed.sol#L532), [582-586](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/PriceFeed.sol#L582-L586), [588](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/PriceFeed.sol#L588), [606-610](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/PriceFeed.sol#L606-L610), [634](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/PriceFeed.sol#L634), [650](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/PriceFeed.sol#L650), [666](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/PriceFeed.sol#L666), [722](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/PriceFeed.sol#L722), [738](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/PriceFeed.sol#L738), [754](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/PriceFeed.sol#L754), [776](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/PriceFeed.sol#L776), [777](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/PriceFeed.sol#L777) ):

```solidity
191:             if (

226:                 if (

239:             if (

327:             if (

364:             try newFallbackCaler.getFallbackResponse() returns (

372:                 if (

419:         if (

509:         if (

532:         if (minPrice == 0) return false;

582:     function _getCurrentFallbackResponse()
583:         internal
584:         view
585:         returns (FallbackResponse memory fallbackResponse)
586:     {

588:             try fallbackCaller.getFallbackResponse() returns (

606:     function _getCurrentChainlinkResponse()
607:         internal
608:         view
609:         returns (ChainlinkResponse memory chainlinkResponse)
610:     {

634:         try ETH_BTC_CL_FEED.latestRoundData() returns (

650:         try STETH_ETH_CL_FEED.latestRoundData() returns (

666:         if (

722:         try ETH_BTC_CL_FEED.getRoundData(_currentRoundEthBtcId - 1) returns (

738:         try STETH_ETH_CL_FEED.getRoundData(_currentRoundStEthEthId - 1) returns (

754:         if (

776:         if (_answer <= 0) return false;

777:         if (_roundId == 0) return false;
```

</details>

### [N&#x2011;90] Do not cache constants

Instead of caching constants, using the defined constants directly can make code more consistent and less prone to errors.

There is 1 instance:

- *SimplifiedDiamondLike.sol* ( [84](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SimplifiedDiamondLike.sol#L84) ):

```solidity
/// @audit DIAMOND_STORAGE_POSITION
84:         bytes32 position = DIAMOND_STORAGE_POSITION;
```

### [N&#x2011;91] Function state mutability can be restricted to view

Function state mutability can be restricted to view

There are 2 instances:

- *LeverageMacroBase.sol* ( [39](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LeverageMacroBase.sol#L39), [244](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LeverageMacroBase.sol#L244) ):

```solidity
39:     function owner() public virtual returns (address) {

244:     function _doCheckValueType(CheckValueAndType memory check, uint256 valueToCheck) internal {
```

### [N&#x2011;92] Functions contain the same code

The functions below have the same implementation as is seen in other files. The functions should be refactored into functions of a common base contract.

<details>
<summary>There are 10 instances (click to show):</summary>

- *BorrowerOperations.sol* ( [659-661](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L659-L661), [665-671](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L665-L671), [673-675](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L673-L675), [677-683](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L677-L683), [687-689](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L687-L689) ):

```solidity
/// @audit Seen on line 176 of contracts/EBTCToken.sol
659:     function DOMAIN_SEPARATOR() external view returns (bytes32) {
660:         return domainSeparator();
661:     }

/// @audit Seen on line 182 of contracts/EBTCToken.sol
665:     function domainSeparator() public view override returns (bytes32) {
666:         if (_chainID() == _CACHED_CHAIN_ID) {
667:             return _CACHED_DOMAIN_SEPARATOR;
668:         } else {
669:             return _buildDomainSeparator(_TYPE_HASH, _HASHED_NAME, _HASHED_VERSION);
670:         }
671:     }

/// @audit Seen on line 231 of contracts/EBTCToken.sol
673:     function _chainID() private view returns (uint256) {
674:         return block.chainid;
675:     }

/// @audit Seen on line 235 of contracts/EBTCToken.sol
677:     function _buildDomainSeparator(
678:         bytes32 typeHash,
679:         bytes32 name,
680:         bytes32 version
681:     ) private view returns (bytes32) {
682:         return keccak256(abi.encode(typeHash, name, version, _chainID(), address(this)));
683:     }

/// @audit Seen on line 349 of contracts/EBTCToken.sol
687:     function version() external pure override returns (string memory) {
688:         return _VERSION;
689:     }
```

- *EBTCToken.sol* ( [176-178](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/EBTCToken.sol#L176-L178), [182-188](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/EBTCToken.sol#L182-L188), [231-233](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/EBTCToken.sol#L231-L233), [235-241](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/EBTCToken.sol#L235-L241), [349-351](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/EBTCToken.sol#L349-L351) ):

```solidity
/// @audit Seen on line 659 of contracts/BorrowerOperations.sol
176:     function DOMAIN_SEPARATOR() external view returns (bytes32) {
177:         return domainSeparator();
178:     }

/// @audit Seen on line 665 of contracts/BorrowerOperations.sol
182:     function domainSeparator() public view override returns (bytes32) {
183:         if (_chainID() == _CACHED_CHAIN_ID) {
184:             return _CACHED_DOMAIN_SEPARATOR;
185:         } else {
186:             return _buildDomainSeparator(_TYPE_HASH, _HASHED_NAME, _HASHED_VERSION);
187:         }
188:     }

/// @audit Seen on line 673 of contracts/BorrowerOperations.sol
231:     function _chainID() private view returns (uint256) {
232:         return block.chainid;
233:     }

/// @audit Seen on line 677 of contracts/BorrowerOperations.sol
235:     function _buildDomainSeparator(
236:         bytes32 typeHash,
237:         bytes32 name,
238:         bytes32 version
239:     ) private view returns (bytes32) {
240:         return keccak256(abi.encode(typeHash, name, version, _chainID(), address(this)));
241:     }

/// @audit Seen on line 687 of contracts/BorrowerOperations.sol
349:     function version() external pure override returns (string memory) {
350:         return _VERSION;
351:     }
```

</details>

### [N&#x2011;93] Inconsistent spacing in comments

The comments below are in the `//x` format, which differs from the commonly used idiomatic comment syntax of `//<space>x`. It is recommended to use a consistent comment syntax throughout.

There is 1 instance:

- *HintHelpers.sol* ( [105](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/HintHelpers.sol#L105) ):

```solidity
105:                         partialRedemptionHintNICR = 0; //reset to 0 as there is no partial redemption in this case
```

### [N&#x2011;94] Missing event for critical changes

Events should be emitted when critical changes are made to the contracts.

<details>
<summary>There are 9 instances (click to show):</summary>

- *BorrowerOperations.sol* ( [439-445](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L439-L445) ):

```solidity
439:     function _openCdp(
440:         uint256 _debt,
441:         bytes32 _upperHint,
442:         bytes32 _lowerHint,
443:         uint256 _stEthBalance,
444:         address _borrower
445:     ) internal returns (bytes32) {
```

- *CdpManager.sol* ( [550-563](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L550-L563), [977-979](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L977-L979), [984-986](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L984-L986) ):

```solidity
550:     function _addCdpIdToArray(bytes32 _cdpId) internal returns (uint128 index) {
551:         /* Max array size is 2**128 - 1, i.e. ~3e30 cdps. No risk of overflow, since cdps have minimum EBTC
552:         debt of liquidation reserve plus MIN_NET_DEBT.
553:         3e30 EBTC dwarfs the value of all wealth in the world ( which is < 1e15 USD). */
554: 
555:         // Push the Cdpowner to the array
556:         CdpIds.push(_cdpId);
557: 
558:         // Record the index of the new Cdpowner on their Cdp struct
559:         index = uint128(CdpIds.length - 1);
560:         Cdps[_cdpId].arrayIndex = index;
561: 
562:         return index;
563:     }

977:     function _setCdpCollShares(bytes32 _cdpId, uint256 _newColl) internal {
978:         Cdps[_cdpId].coll = _newColl;
979:     }

984:     function _setCdpDebt(bytes32 _cdpId, uint256 _newDebt) internal {
985:         Cdps[_cdpId].debt = _newDebt;
986:     }
```

- *CdpManagerStorage.sol* ( [260](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L260), [431-438](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L431-L438) ):

```solidity
260:     function _closeCdpWithoutRemovingSortedCdps(bytes32 _cdpId, Status closedStatus) internal {

431:     function _updateStakeForCdp(bytes32 _cdpId) internal returns (uint256, uint256) {
432:         Cdp storage _cdp = Cdps[_cdpId];
433:         uint256 newStake = _computeNewStake(_cdp.coll);
434:         uint256 oldStake = _cdp.stake;
435:         _cdp.stake = newStake;
436: 
437:         return (newStake, oldStake);
438:     }
```

- *SimplifiedDiamondLike.sol* ( [51-61](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SimplifiedDiamondLike.sol#L51-L61), [66-71](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SimplifiedDiamondLike.sol#L66-L71), [129-131](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SimplifiedDiamondLike.sol#L129-L131) ):

```solidity
51:     function setFallbackHandler(bytes4 sig, address handler) external {
52:         require(msg.sender == owner);
53: 
54:         // NOTE: We prob don't need this due to how solidity works
55:         // "execute((address,bool,uint128,uint128,bool,uint8,bytes)[])": "94b24d09"
56:         require(sig != 0x94b24d09);
57: 
58:         DiamondLikeStorage storage s = _getStorage();
59: 
60:         s.callbackHandler[sig] = handler;
61:     }

66:     function setAllowAnyCall(bool allowNonCallbacks) external {
67:         require(msg.sender == owner);
68: 
69:         DiamondLikeStorage storage s = _getStorage();
70:         s.settings.allowNonCallback = allowNonCallbacks;
71:     }

129:     function _setCallbackEnabledForCall(DiamondLikeStorage storage ds, bool _enabled) internal {
130:         ds.settings.callbackEnabledForCall = _enabled;
131:     }
```

</details>

### [N&#x2011;95] Non-assembly method available

There are some automated tools that will flag a project as having higher complexity if there is inline-assembly, so it's best to avoid using it where it's not necessary. In addition, most assembly methods can be replaced by non-assembly methods, for example:
- `assembly{ g := gas() }` => `uint256 g = gasleft()`
- `assembly{ id := chainid() }` => `uint256 id = block.chainid`
- `assembly { r := mulmod(a, b, d) }` => `uint256 m = mulmod(x, y, k)`
- `assembly { size := extcodesize() }` => `uint256 size = address(a).code.length`
- etc.

There are 2 instances:

- *SimplifiedDiamondLike.sol* ( [144](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SimplifiedDiamondLike.sol#L144), [149](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SimplifiedDiamondLike.sol#L149) ):

```solidity
144:                 success := delegatecall(txGas, to, add(data, 0x20), mload(data), 0, 0)

149:                 success := call(txGas, to, value, add(data, 0x20), mload(data), 0, 0)
```

### [N&#x2011;96] Duplicated `require()`/`revert()` checks should be refactored

Refactoring duplicate `require()`/`revert()` checks into a modifier or function can make the code more concise, readable and maintainable, and less likely to make errors or omissions when modifying the `require()` or `revert()`.

There are 4 instances:

- *ActivePool.sol* ( [137](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/ActivePool.sol#L137) ):

```solidity
/// @audit Duplicated on line 162
137:         require(cachedSystemCollShares >= _shares, "ActivePool: Insufficient collateral shares");
```

- *RolesAuthority.sol* ( [90-93](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/RolesAuthority.sol#L90-L93) ):

```solidity
/// @audit Duplicated on line 134
90:         require(
91:             capabilityFlag[target][functionSig] != CapabilityFlag.Burned,
92:             "RolesAuthority: Capability Burned"
93:         );
```

- *SimplifiedDiamondLike.sol* ( [52](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SimplifiedDiamondLike.sol#L52) ):

```solidity
/// @audit Duplicated on line 67
52:         require(msg.sender == owner);
```

- *SortedCdps.sol* ( [458](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L458) ):

```solidity
/// @audit Duplicated on line 506
458:         require(contains(_id), "SortedCdps: List does not contain the id");
```

### [N&#x2011;97] Consider adding emergency-stop functionality

Adding a way to quickly halt protocol functionality in an emergency, rather than having to pause individual contracts one-by-one, will make in-progress hack mitigation faster and much less stressful.

<details>
<summary>There are 11 instances (click to show):</summary>

- *ActivePool.sol* ( [22](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/ActivePool.sol#L22) ):

```solidity
22: contract ActivePool is IActivePool, ERC3156FlashLender, ReentrancyGuard, BaseMath, AuthNoOwner {
```

- *BorrowerOperations.sol* ( [21-27](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L21-L27) ):

```solidity
21: contract BorrowerOperations is
22:     EbtcBase,
23:     ReentrancyGuard,
24:     IBorrowerOperations,
25:     ERC3156FlashLender,
26:     AuthNoOwner,
27:     PermitNonce
```

- *CdpManager.sol* ( [16](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L16) ):

```solidity
16: contract CdpManager is CdpManagerStorage, ICdpManager, Proxy {
```

- *CdpManagerStorage.sol* ( [19](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L19) ):

```solidity
19: contract CdpManagerStorage is EbtcBase, ReentrancyGuard, ICdpManagerData, AuthNoOwner {
```

- *CollSurplusPool.sol* ( [16](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CollSurplusPool.sol#L16) ):

```solidity
16: contract CollSurplusPool is ICollSurplusPool, ReentrancyGuard, AuthNoOwner {
```

- *AuthNoOwner.sol* ( [10](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/AuthNoOwner.sol#L10) ):

```solidity
10: contract AuthNoOwner {
```

- *RolesAuthority.sol* ( [12](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/RolesAuthority.sol#L12) ):

```solidity
12: contract RolesAuthority is IRolesAuthority, Auth, Authority {
```

- *EBTCToken.sol* ( [26](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/EBTCToken.sol#L26) ):

```solidity
26: contract EBTCToken is IEBTCToken, AuthNoOwner, PermitNonce {
```

- *Governor.sol* ( [13](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Governor.sol#L13) ):

```solidity
13: contract Governor is RolesAuthority {
```

- *LiquidationLibrary.sol* ( [13](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LiquidationLibrary.sol#L13) ):

```solidity
13: contract LiquidationLibrary is CdpManagerStorage {
```

- *PriceFeed.sol* ( [21](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/PriceFeed.sol#L21) ):

```solidity
21: contract PriceFeed is BaseMath, IPriceFeed, AuthNoOwner {
```

</details>

### [N&#x2011;98] Avoid the use of sensitive terms

Use [alternative variants](https://www.zdnet.com/article/mysql-drops-master-slave-and-blacklist-whitelist-terminology/), e.g. allowlist/denylist instead of whitelist/blacklist.

<details>
<summary>There are 9 instances (click to show):</summary>

- *BorrowerOperations.sol* ( [462](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L462) ):

```solidity
462:         // Sanity check
```

- *Auth.sol* ( [8](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/Auth.sol#L8) ):

```solidity
8: /// @author Modified from Dappsys (https://github.com/dapphub/ds-auth/blob/master/src/auth.sol)
```

- *AuthNoOwner.sol* ( [9](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/AuthNoOwner.sol#L9) ):

```solidity
9: /// @author Modified from Dappsys (https://github.com/dapphub/ds-auth/blob/master/src/auth.sol)
```

- *ReentrancyGuard.sol* ( [6](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/ReentrancyGuard.sol#L6) ):

```solidity
6: /// @author Modified from OpenZeppelin (https://github.com/OpenZeppelin/openzeppelin-contracts/blob/master/contracts/security/ReentrancyGuard.sol)
```

- *RolesAuthority.sol* ( [11](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/RolesAuthority.sol#L11) ):

```solidity
11: /// @author Modified from Dappsys (https://github.com/dapphub/ds-roles/blob/master/src/roles.sol)
```

- *EBTCToken.sol* ( [13](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/EBTCToken.sol#L13), [244](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/EBTCToken.sol#L244) ):

```solidity
13:  * https://github.com/OpenZeppelin/openzeppelin-contracts/blob/master/contracts/token/ERC20/ERC20.sol

244:     // Warning: sanity checks (for sender and recipient) should have been done before calling these internal functions
```

- *Governor.sol* ( [12](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Governor.sol#L12) ):

```solidity
12: /// @author Modified from Dappsys (https://github.com/dapphub/ds-roles/blob/master/src/roles.sol)
```

- *SortedCdps.sol* ( [30](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L30) ):

```solidity
30:  * https://github.com/livepeer/protocol/blob/master/contracts/libraries/SortedDoublyLL.sol
```

</details>

### [N&#x2011;99] Enable IR-based code generation

The IR-based code generator was introduced with an aim to not only allow code generation to be more transparent and auditable but also to enable more powerful optimization passes that span across functions.
You can enable it on the command line using `--via-ir` or with the option `{"viaIR": true}`.
This will take longer to compile, but you can just simple test it before deploying and if you got a better benchmark then you can add --via-ir to your deploy command
More on: https://docs.soliditylang.org/en/v0.8.17/ir-breaking-changes.html

There is 1 instance:

- Global finding

### [N&#x2011;100] Contracts should have NatSpec `@dev` tags

The `@dev` tag is used to explain extra details to developers.

<details>
<summary>There are 30 instances (click to show):</summary>

- *Auth.sol* ( [9](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/Auth.sol#L9) ):

```solidity
9: abstract contract Auth {
```

- *AuthNoOwner.sol* ( [10](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/AuthNoOwner.sol#L10) ):

```solidity
10: contract AuthNoOwner {
```

- *ERC3156FlashLender.sol* ( [8](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/ERC3156FlashLender.sol#L8) ):

```solidity
8: abstract contract ERC3156FlashLender is IERC3156FlashLender {
```

- *EbtcBase.sol* ( [16](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/EbtcBase.sol#L16) ):

```solidity
16: contract EbtcBase is BaseMath, IEbtcBase {
```

- *EbtcMath.sol* ( [5](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/EbtcMath.sol#L5) ):

```solidity
5: library EbtcMath {
```

- *ReentrancyGuard.sol* ( [7](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/ReentrancyGuard.sol#L7) ):

```solidity
7: abstract contract ReentrancyGuard {
```

- *RolesAuthority.sol* ( [12](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/RolesAuthority.sol#L12) ):

```solidity
12: contract RolesAuthority is IRolesAuthority, Auth, Authority {
```

- *EBTCToken.sol* ( [26](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/EBTCToken.sol#L26) ):

```solidity
26: contract EBTCToken is IEBTCToken, AuthNoOwner, PermitNonce {
```

- *Governor.sol* ( [13](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Governor.sol#L13) ):

```solidity
13: contract Governor is RolesAuthority {
```

- *IActivePool.sol* ( [7](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IActivePool.sol#L7) ):

```solidity
7: interface IActivePool is IPool {
```

- *IBorrowerOperations.sol* ( [7](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IBorrowerOperations.sol#L7) ):

```solidity
7: interface IBorrowerOperations is IPositionManagers {
```

- *ICdpManager.sol* ( [9](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManager.sol#L9) ):

```solidity
9: interface ICdpManager is IEbtcBase, ICdpManagerData {
```

- *ICdpManagerData.sol* ( [13](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManagerData.sol#L13) ):

```solidity
13: interface ICdpManagerData is IRecoveryModeGracePeriod {
```

- *ICollSurplusPool.sol* ( [5](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICollSurplusPool.sol#L5) ):

```solidity
5: interface ICollSurplusPool {
```

- *IEBTCToken.sol* ( [8](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IEBTCToken.sol#L8) ):

```solidity
8: interface IEBTCToken is IERC20, IERC2612 {
```

- *IERC3156FlashBorrower.sol* ( [5](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IERC3156FlashBorrower.sol#L5) ):

```solidity
5: interface IERC3156FlashBorrower {
```

- *IERC3156FlashLender.sol* ( [7](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IERC3156FlashLender.sol#L7) ):

```solidity
7: interface IERC3156FlashLender {
```

- *IEbtcBase.sol* ( [7](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IEbtcBase.sol#L7) ):

```solidity
7: interface IEbtcBase {
```

- *IFallbackCaller.sol* ( [5](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IFallbackCaller.sol#L5) ):

```solidity
5: interface IFallbackCaller {
```

- *IPermitNonce.sol* ( [5](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IPermitNonce.sol#L5) ):

```solidity
5: interface IPermitNonce {
```

- *IPool.sol* ( [6](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IPool.sol#L6) ):

```solidity
6: interface IPool {
```

- *IPositionManagers.sol* ( [5](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IPositionManagers.sol#L5) ):

```solidity
5: interface IPositionManagers {
```

- *IPriceFeed.sol* ( [5](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IPriceFeed.sol#L5) ):

```solidity
5: interface IPriceFeed {
```

- *IRecoveryModeGracePeriod.sol* ( [5](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IRecoveryModeGracePeriod.sol#L5) ):

```solidity
5: interface IRecoveryModeGracePeriod {
```

- *ISortedCdps.sol* ( [6](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ISortedCdps.sol#L6) ):

```solidity
6: interface ISortedCdps {
```

- *LeverageMacroBase.sol* ( [14](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LeverageMacroBase.sol#L14) ):

```solidity
14: interface ICdpCdps {
```

- *LeverageMacroDelegateTarget.sol* ( [6](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LeverageMacroDelegateTarget.sol#L6) ):

```solidity
6: interface IOwnerLike {
```

- *LeverageMacroFactory.sol* ( [11](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LeverageMacroFactory.sol#L11) ):

```solidity
11: contract LeverageMacroFactory {
```

- *PriceFeed.sol* ( [21](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/PriceFeed.sol#L21) ):

```solidity
21: contract PriceFeed is BaseMath, IPriceFeed, AuthNoOwner {
```

- *SortedCdps.sol* ( [51](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L51) ):

```solidity
51: contract SortedCdps is ISortedCdps {
```

</details>

### [N&#x2011;101] Missing NatSpec `@dev` from event declaration

Some events have an incomplete NatSpec: add a `@dev` notation to describe the event to improve the code documentation.

<details>
<summary>There are 56 instances (click to show):</summary>

- *Auth.sol* ( [10](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/Auth.sol#L10), [12](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/Auth.sol#L12) ):

```solidity
10:     event OwnershipTransferred(address indexed user, address indexed newOwner);

12:     event AuthorityUpdated(address indexed user, Authority indexed newAuthority);
```

- *AuthNoOwner.sol* ( [11](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/AuthNoOwner.sol#L11) ):

```solidity
11:     event AuthorityUpdated(address indexed user, Authority indexed newAuthority);
```

- *Governor.sol* ( [32](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Governor.sol#L32) ):

```solidity
32:     event RoleNameSet(uint8 indexed role, string indexed name);
```

- *IActivePool.sol* ( [9](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IActivePool.sol#L9), [10](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IActivePool.sol#L10), [11](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IActivePool.sol#L11), [12](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IActivePool.sol#L12), [13](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IActivePool.sol#L13), [14](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IActivePool.sol#L14), [20](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IActivePool.sol#L20) ):

```solidity
9:     event ActivePoolEBTCDebtUpdated(uint256 _EBTCDebt);

10:     event SystemCollSharesUpdated(uint256 _coll);

11:     event FeeRecipientAddressChanged(address indexed _feeRecipientAddress);

12:     event FeeRecipientClaimableCollSharesIncreased(uint256 _coll, uint256 _fee);

13:     event FeeRecipientClaimableCollSharesDecreased(uint256 _coll, uint256 _fee);

14:     event FlashLoanSuccess(

20:     event SweepTokenSuccess(address indexed _token, uint256 _amount, address indexed _recipient);
```

- *IBorrowerOperations.sol* ( [10](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IBorrowerOperations.sol#L10), [11](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IBorrowerOperations.sol#L11) ):

```solidity
10:     event FeeRecipientAddressChanged(address indexed _feeRecipientAddress);

11:     event FlashLoanSuccess(
```

- *ICdpManagerData.sol* ( [16](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManagerData.sol#L16), [17](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManagerData.sol#L17), [18](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManagerData.sol#L18), [19](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManagerData.sol#L19), [20](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManagerData.sol#L20), [21](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManagerData.sol#L21), [23](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManagerData.sol#L23), [24](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManagerData.sol#L24), [31](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManagerData.sol#L31), [42](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManagerData.sol#L42), [51](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManagerData.sol#L51), [60](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManagerData.sol#L60), [61](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManagerData.sol#L61), [62](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManagerData.sol#L62), [63](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManagerData.sol#L63), [64](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManagerData.sol#L64), [65](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManagerData.sol#L65), [66](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManagerData.sol#L66), [67](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManagerData.sol#L67), [68](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManagerData.sol#L68), [69](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManagerData.sol#L69) ):

```solidity
16:     event FeeRecipientAddressChanged(address indexed _feeRecipientAddress);

17:     event StakingRewardSplitSet(uint256 _stakingRewardSplit);

18:     event RedemptionFeeFloorSet(uint256 _redemptionFeeFloor);

19:     event MinuteDecayFactorSet(uint256 _minuteDecayFactor);

20:     event BetaSet(uint256 _beta);

21:     event RedemptionsPaused(bool _paused);

23:     event Liquidation(uint256 _liquidatedDebt, uint256 _liquidatedColl, uint256 _liqReward);

24:     event Redemption(

31:     event CdpUpdated(

42:     event CdpLiquidated(

51:     event CdpPartiallyLiquidated(

60:     event BaseRateUpdated(uint256 _baseRate);

61:     event LastRedemptionTimestampUpdated(uint256 _lastFeeOpTime);

62:     event TotalStakesUpdated(uint256 _newTotalStakes);

63:     event SystemSnapshotsUpdated(uint256 _totalStakesSnapshot, uint256 _totalCollateralSnapshot);

64:     event SystemDebtRedistributionIndexUpdated(uint256 _systemDebtRedistributionIndex);

65:     event CdpDebtRedistributionIndexUpdated(bytes32 _cdpId, uint256 _cdpDebtRedistributionIndex);

66:     event CdpArrayIndexUpdated(bytes32 _cdpId, uint256 _newIndex);

67:     event StEthIndexUpdated(uint256 _oldIndex, uint256 _newIndex, uint256 _updTimestamp);

68:     event CollateralFeePerUnitUpdated(uint256 _oldPerUnit, uint256 _newPerUnit, uint256 _feeTaken);

69:     event CdpFeeSplitApplied(
```

- *ICollSurplusPool.sol* ( [8](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICollSurplusPool.sol#L8), [9](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICollSurplusPool.sol#L9), [11](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICollSurplusPool.sol#L11) ):

```solidity
8:     event SurplusCollSharesUpdated(address indexed _account, uint256 _newBalance);

9:     event CollSharesTransferred(address indexed _to, uint256 _amount);

11:     event SweepTokenSuccess(address indexed _token, uint256 _amount, address indexed _recipient);
```

- *IERC3156FlashLender.sol* ( [8](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IERC3156FlashLender.sol#L8), [9](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IERC3156FlashLender.sol#L9), [10](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IERC3156FlashLender.sol#L10) ):

```solidity
8:     event FlashFeeSet(address indexed _setter, uint256 _oldFee, uint256 _newFee);

9:     event MaxFlashFeeSet(address indexed _setter, uint256 _oldMaxFee, uint256 _newMaxFee);

10:     event FlashLoansPaused(address indexed _setter, bool _paused);
```

- *IFallbackCaller.sol* ( [7](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IFallbackCaller.sol#L7) ):

```solidity
7:     event FallbackTimeOutChanged(uint256 _oldTimeOut, uint256 _newTimeOut);
```

- *IPool.sol* ( [9](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IPool.sol#L9), [10](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IPool.sol#L10), [11](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IPool.sol#L11) ):

```solidity
9:     event ETHBalanceUpdated(uint256 _newBalance);

10:     event EBTCBalanceUpdated(uint256 _newBalance);

11:     event CollSharesTransferred(address indexed _to, uint256 _amount);
```

- *IPositionManagers.sol* ( [12](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IPositionManagers.sol#L12) ):

```solidity
12:     event PositionManagerApprovalSet(
```

- *IPriceFeed.sol* ( [7](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IPriceFeed.sol#L7), [8](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IPriceFeed.sol#L8), [9](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IPriceFeed.sol#L9), [13](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IPriceFeed.sol#L13) ):

```solidity
7:     event LastGoodPriceUpdated(uint256 _lastGoodPrice);

8:     event PriceFeedStatusChanged(Status newStatus);

9:     event FallbackCallerChanged(

13:     event UnhealthyFallbackCaller(address indexed _fallbackCaller, uint256 timestamp);
```

- *IRecoveryModeGracePeriod.sol* ( [6](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IRecoveryModeGracePeriod.sol#L6), [9](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IRecoveryModeGracePeriod.sol#L9), [10](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IRecoveryModeGracePeriod.sol#L10), [11](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IRecoveryModeGracePeriod.sol#L11) ):

```solidity
6:     event TCRNotified(uint256 TCR); /// NOTE: Mostly for debugging to ensure synch

9:     event GracePeriodStart();

10:     event GracePeriodEnd();

11:     event GracePeriodDurationSet(uint256 _recoveryModeGracePeriodDuration);
```

- *ISortedCdps.sol* ( [9](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ISortedCdps.sol#L9), [10](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ISortedCdps.sol#L10) ):

```solidity
9:     event NodeAdded(bytes32 _id, uint _NICR);

10:     event NodeRemoved(bytes32 _id);
```

- *LeverageMacroFactory.sol* ( [19](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LeverageMacroFactory.sol#L19) ):

```solidity
19:     event DeployNewMacro(address indexed sender, address indexed newContractAddress);
```

</details>

### [N&#x2011;102] Missing NatSpec `@notice` from event declaration

Some events have an incomplete NatSpec: add a @notice notation to describe the event to improve the code documentation.

<details>
<summary>There are 56 instances (click to show):</summary>

- *Auth.sol* ( [10](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/Auth.sol#L10), [12](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/Auth.sol#L12) ):

```solidity
10:     event OwnershipTransferred(address indexed user, address indexed newOwner);

12:     event AuthorityUpdated(address indexed user, Authority indexed newAuthority);
```

- *AuthNoOwner.sol* ( [11](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/AuthNoOwner.sol#L11) ):

```solidity
11:     event AuthorityUpdated(address indexed user, Authority indexed newAuthority);
```

- *Governor.sol* ( [32](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Governor.sol#L32) ):

```solidity
32:     event RoleNameSet(uint8 indexed role, string indexed name);
```

- *IActivePool.sol* ( [9](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IActivePool.sol#L9), [10](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IActivePool.sol#L10), [11](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IActivePool.sol#L11), [12](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IActivePool.sol#L12), [13](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IActivePool.sol#L13), [14](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IActivePool.sol#L14), [20](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IActivePool.sol#L20) ):

```solidity
9:     event ActivePoolEBTCDebtUpdated(uint256 _EBTCDebt);

10:     event SystemCollSharesUpdated(uint256 _coll);

11:     event FeeRecipientAddressChanged(address indexed _feeRecipientAddress);

12:     event FeeRecipientClaimableCollSharesIncreased(uint256 _coll, uint256 _fee);

13:     event FeeRecipientClaimableCollSharesDecreased(uint256 _coll, uint256 _fee);

14:     event FlashLoanSuccess(

20:     event SweepTokenSuccess(address indexed _token, uint256 _amount, address indexed _recipient);
```

- *IBorrowerOperations.sol* ( [10](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IBorrowerOperations.sol#L10), [11](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IBorrowerOperations.sol#L11) ):

```solidity
10:     event FeeRecipientAddressChanged(address indexed _feeRecipientAddress);

11:     event FlashLoanSuccess(
```

- *ICdpManagerData.sol* ( [16](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManagerData.sol#L16), [17](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManagerData.sol#L17), [18](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManagerData.sol#L18), [19](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManagerData.sol#L19), [20](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManagerData.sol#L20), [21](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManagerData.sol#L21), [23](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManagerData.sol#L23), [24](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManagerData.sol#L24), [31](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManagerData.sol#L31), [42](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManagerData.sol#L42), [51](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManagerData.sol#L51), [60](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManagerData.sol#L60), [61](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManagerData.sol#L61), [62](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManagerData.sol#L62), [63](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManagerData.sol#L63), [64](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManagerData.sol#L64), [65](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManagerData.sol#L65), [66](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManagerData.sol#L66), [67](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManagerData.sol#L67), [68](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManagerData.sol#L68), [69](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManagerData.sol#L69) ):

```solidity
16:     event FeeRecipientAddressChanged(address indexed _feeRecipientAddress);

17:     event StakingRewardSplitSet(uint256 _stakingRewardSplit);

18:     event RedemptionFeeFloorSet(uint256 _redemptionFeeFloor);

19:     event MinuteDecayFactorSet(uint256 _minuteDecayFactor);

20:     event BetaSet(uint256 _beta);

21:     event RedemptionsPaused(bool _paused);

23:     event Liquidation(uint256 _liquidatedDebt, uint256 _liquidatedColl, uint256 _liqReward);

24:     event Redemption(

31:     event CdpUpdated(

42:     event CdpLiquidated(

51:     event CdpPartiallyLiquidated(

60:     event BaseRateUpdated(uint256 _baseRate);

61:     event LastRedemptionTimestampUpdated(uint256 _lastFeeOpTime);

62:     event TotalStakesUpdated(uint256 _newTotalStakes);

63:     event SystemSnapshotsUpdated(uint256 _totalStakesSnapshot, uint256 _totalCollateralSnapshot);

64:     event SystemDebtRedistributionIndexUpdated(uint256 _systemDebtRedistributionIndex);

65:     event CdpDebtRedistributionIndexUpdated(bytes32 _cdpId, uint256 _cdpDebtRedistributionIndex);

66:     event CdpArrayIndexUpdated(bytes32 _cdpId, uint256 _newIndex);

67:     event StEthIndexUpdated(uint256 _oldIndex, uint256 _newIndex, uint256 _updTimestamp);

68:     event CollateralFeePerUnitUpdated(uint256 _oldPerUnit, uint256 _newPerUnit, uint256 _feeTaken);

69:     event CdpFeeSplitApplied(
```

- *ICollSurplusPool.sol* ( [8](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICollSurplusPool.sol#L8), [9](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICollSurplusPool.sol#L9), [11](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICollSurplusPool.sol#L11) ):

```solidity
8:     event SurplusCollSharesUpdated(address indexed _account, uint256 _newBalance);

9:     event CollSharesTransferred(address indexed _to, uint256 _amount);

11:     event SweepTokenSuccess(address indexed _token, uint256 _amount, address indexed _recipient);
```

- *IERC3156FlashLender.sol* ( [8](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IERC3156FlashLender.sol#L8), [9](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IERC3156FlashLender.sol#L9), [10](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IERC3156FlashLender.sol#L10) ):

```solidity
8:     event FlashFeeSet(address indexed _setter, uint256 _oldFee, uint256 _newFee);

9:     event MaxFlashFeeSet(address indexed _setter, uint256 _oldMaxFee, uint256 _newMaxFee);

10:     event FlashLoansPaused(address indexed _setter, bool _paused);
```

- *IFallbackCaller.sol* ( [7](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IFallbackCaller.sol#L7) ):

```solidity
7:     event FallbackTimeOutChanged(uint256 _oldTimeOut, uint256 _newTimeOut);
```

- *IPool.sol* ( [9](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IPool.sol#L9), [10](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IPool.sol#L10), [11](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IPool.sol#L11) ):

```solidity
9:     event ETHBalanceUpdated(uint256 _newBalance);

10:     event EBTCBalanceUpdated(uint256 _newBalance);

11:     event CollSharesTransferred(address indexed _to, uint256 _amount);
```

- *IPositionManagers.sol* ( [12](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IPositionManagers.sol#L12) ):

```solidity
12:     event PositionManagerApprovalSet(
```

- *IPriceFeed.sol* ( [7](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IPriceFeed.sol#L7), [8](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IPriceFeed.sol#L8), [9](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IPriceFeed.sol#L9), [13](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IPriceFeed.sol#L13) ):

```solidity
7:     event LastGoodPriceUpdated(uint256 _lastGoodPrice);

8:     event PriceFeedStatusChanged(Status newStatus);

9:     event FallbackCallerChanged(

13:     event UnhealthyFallbackCaller(address indexed _fallbackCaller, uint256 timestamp);
```

- *IRecoveryModeGracePeriod.sol* ( [6](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IRecoveryModeGracePeriod.sol#L6), [9](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IRecoveryModeGracePeriod.sol#L9), [10](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IRecoveryModeGracePeriod.sol#L10), [11](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IRecoveryModeGracePeriod.sol#L11) ):

```solidity
6:     event TCRNotified(uint256 TCR); /// NOTE: Mostly for debugging to ensure synch

9:     event GracePeriodStart();

10:     event GracePeriodEnd();

11:     event GracePeriodDurationSet(uint256 _recoveryModeGracePeriodDuration);
```

- *ISortedCdps.sol* ( [9](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ISortedCdps.sol#L9), [10](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ISortedCdps.sol#L10) ):

```solidity
9:     event NodeAdded(bytes32 _id, uint _NICR);

10:     event NodeRemoved(bytes32 _id);
```

- *LeverageMacroFactory.sol* ( [19](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LeverageMacroFactory.sol#L19) ):

```solidity
19:     event DeployNewMacro(address indexed sender, address indexed newContractAddress);
```

</details>

### [N&#x2011;103] Missing NatSpec `@dev` from function declaration

Some functions have an incomplete NatSpec: add a `@dev` notation to describe the function to improve the code documentation.

<details>
<summary>There are 369 instances (click to show):</summary>

- *ActivePool.sol* ( [89](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/ActivePool.sol#L89), [181](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/ActivePool.sol#L181), [219](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/ActivePool.sol#L219), [227](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/ActivePool.sol#L227), [235](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/ActivePool.sol#L235), [242](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/ActivePool.sol#L242), [317](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/ActivePool.sol#L317), [404](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/ActivePool.sol#L404), [417](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/ActivePool.sol#L417) ):

```solidity
89:     function getFeeRecipientClaimableCollShares() external view override returns (uint256) {

181:     function _transferCollSharesWithContractHooks(address _account, uint256 _shares) internal {

219:     function _requireCallerIsBorrowerOperations() internal view {

227:     function _requireCallerIsBOorCdpM() internal view {

235:     function _requireCallerIsCdpManager() internal view {

242:     function increaseSystemCollShares(uint256 _value) external override {

317:     function flashFee(address token, uint256 amount) public view override returns (uint256) {

404:     function setFeeBps(uint256 _newFee) external requiresAuth {

417:     function setFlashLoansPaused(bool _paused) external requiresAuth {
```

- *BorrowerOperations.sol* ( [107](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L107), [168](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L168), [328](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L328), [439](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L439), [599](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L599), [608](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L608), [615](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L615), [628](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L628), [635](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L635), [647](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L647), [653](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L653), [659](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L659), [665](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L665), [673](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L673), [677](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L677), [687](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L687), [693](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L693), [706](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L706), [744](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L744), [760](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L760), [796](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L796), [803](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L803), [813](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L813), [824](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L824), [829](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L829), [834](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L834), [838](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L838), [845](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L845), [852](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L852), [910](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L910), [917](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L917), [921](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L921), [928](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L928), [935](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L935), [939](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L939), [946](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L946), [953](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L953), [963](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L963), [986](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L986), [1004](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L1004), [1030](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L1030), [1049](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L1049), [1077](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L1077), [1114](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L1114), [1124](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L1124), [1140](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L1140), [1154](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L1154), [1167](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L1167) ):

```solidity
107:     constructor(

168:     function openCdp(

328:     function _adjustCdpInternal(

439:     function _openCdp(

599:     function claimSurplusCollShares() external override {

608:     function getPositionManagerApproval(

615:     function _getPositionManagerApproval(

628:     function setPositionManagerApproval(

635:     function _setPositionManagerApproval(

647:     function revokePositionManagerApproval(address _positionManager) external override {

653:     function renouncePositionManagerApproval(address _borrower) external override {

659:     function DOMAIN_SEPARATOR() external view returns (bytes32) {

665:     function domainSeparator() public view override returns (bytes32) {

673:     function _chainID() private view returns (uint256) {

677:     function _buildDomainSeparator(

687:     function version() external pure override returns (string memory) {

693:     function permitTypeHash() external pure override returns (bytes32) {

706:     function permitPositionManagerApproval(

744:     function _getCollSharesChangeFromStEthChange(

760:     function _processTokenMovesFromAdjustment(MoveTokensParams memory _varMvTokens) internal {

796:     function _repayDebt(address _account, uint256 _debt) internal {

803:     function _requireSingularCollChange(

813:     function _requireNonZeroAdjustment(

824:     function _requireCdpisActive(ICdpManager _cdpManager, bytes32 _cdpId) internal view {

829:     function _requireCdpIsNonExistent(bytes32 _cdpId) internal view {

834:     function _requireNonZeroDebtChange(uint _debtChange) internal pure {

838:     function _requireNotInRecoveryMode(uint256 _tcr) internal view {

845:     function _requireNoStEthBalanceDecrease(uint256 _stEthBalanceDecrease) internal pure {

852:     function _requireValidAdjustmentInCurrentMode(

910:     function _requireICRisNotBelowMCR(uint256 _newICR) internal pure {

917:     function _requireICRisNotBelowCCR(uint256 _newICR) internal pure {

921:     function _requireNoDecreaseOfICR(uint256 _newICR, uint256 _oldICR) internal pure {

928:     function _requireNewTCRisNotBelowCCR(uint256 _newTCR) internal pure {

935:     function _requireNonZeroDebt(uint256 _debt) internal pure {

939:     function _requireAtLeastMinNetStEthBalance(uint256 _stEthBalance) internal pure {

946:     function _requireValidDebtRepayment(uint256 _currentDebt, uint256 _debtRepayment) internal pure {

953:     function _requireSufficientEbtcTokenBalance(

963:     function _requireBorrowerOrPositionManagerAndUpdateManagerApproval(address _borrower) internal {

986:     function _getNewNominalICRFromCdpChange(

1004:     function _getNewICRFromCdpChange(

1030:     function _getNewCdpAmounts(

1049:     function _getNewTCRFromCdpChange(

1077:     function flashLoan(

1114:     function flashFee(address token, uint256 amount) public view override returns (uint256) {

1124:     function maxFlashLoan(address token) public view override returns (uint256) {

1140:     function setFeeRecipientAddress(address _feeRecipientAddress) external requiresAuth {

1154:     function setFeeBps(uint256 _newFee) external requiresAuth {

1167:     function setFlashLoansPaused(bool _paused) external requiresAuth {
```

- *CdpManager.sol* ( [66](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L66), [73](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L73), [135](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L135), [244](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L244), [320](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L320), [489](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L489), [514](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L514), [550](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L550), [595](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L595), [612](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L612), [638](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L638), [643](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L643), [647](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L647), [655](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L655), [661](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L661), [667](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L667), [676](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L676), [689](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L689), [702](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L702), [709](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L709), [717](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L717), [727](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L727), [737](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L737), [753](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L753), [757](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L757), [761](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L761), [856](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L856), [863](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L863), [871](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L871), [879](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L879), [977](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L977), [984](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L984) ):

```solidity
66:     function getActiveCdpsCount() external view override returns (uint256) {

73:     function getIdFromCdpIdsArray(uint256 _index) external view override returns (bytes32) {

135:     function _redeemCollateralFromCdp(

244:     function _closeCdpByRedemption(

320:     function redeemCollateral(

489:     function _getCdpIdsToRemove(

514:     function syncAccounting(bytes32 _cdpId) external virtual override {

550:     function _addCdpIdToArray(bytes32 _cdpId) internal returns (uint128 index) {

595:     function _checkPotentialRecoveryMode(

612:     function _updateBaseRateFromRedemption(

638:     function getRedemptionRate() public view override returns (uint256) {

643:     function getRedemptionRateWithDecay() public view override returns (uint256) {

647:     function _calcRedemptionRate(uint256 _baseRate) internal view returns (uint256) {

655:     function _getRedemptionFee(uint256 _ETHDrawn) internal view returns (uint256) {

661:     function getRedemptionFeeWithDecay(

667:     function _calcRedemptionFee(

676:     function _decayBaseRate() internal {

689:     function _updateLastRedemptionTimestamp() internal {

702:     function _calcDecayedBaseRate() internal view returns (uint256) {

709:     function _minutesPassedSinceLastRedemption() internal view returns (uint256) {

717:     function getDeploymentStartTime() public view returns (uint256) {

727:     function checkPotentialRecoveryMode(

737:     function _requireEbtcBalanceCoversRedemptionAndWithinSupply(

753:     function _requireAmountGreaterThanZero(uint256 _amount) internal pure {

757:     function _requireTCRisNotBelowMCR(uint256 _price, uint256 _TCR) internal view {

761:     function _requireValidMaxFeePercentage(uint256 _maxFeePercentage) internal view {

856:     function getCdpStatus(bytes32 _cdpId) external view override returns (uint256) {

863:     function getCdpStake(bytes32 _cdpId) external view override returns (uint256) {

871:     function getCdpDebt(bytes32 _cdpId) external view override returns (uint256) {

879:     function getCdpCollShares(bytes32 _cdpId) external view override returns (uint256) {

977:     function _setCdpCollShares(bytes32 _cdpId, uint256 _newColl) internal {

984:     function _setCdpDebt(bytes32 _cdpId, uint256 _newDebt) internal {
```

- *CdpManagerStorage.sol* ( [73](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L73), [111](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L111), [217](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L217), [255](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L255), [260](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L260), [293](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L293), [327](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L327), [410](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L410), [419](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L419), [431](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L431), [441](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L441), [463](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L463), [489](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L489), [509](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L509), [534](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L534), [539](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L539), [552](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L552), [574](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L574), [592](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L592), [616](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L616), [648](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L648), [652](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L652), [659](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L659), [707](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L707), [719](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L719), [728](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L728), [733](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L733), [822](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L822) ):

```solidity
73:     function _syncGracePeriod() internal {

111:     function setGracePeriod(uint128 _gracePeriod) external requiresAuth {

217:     constructor(

255:     function _closeCdp(bytes32 _cdpId, Status closedStatus) internal {

260:     function _closeCdpWithoutRemovingSortedCdps(bytes32 _cdpId, Status closedStatus) internal {

293:     function _updateSystemSnapshotsExcludeCollRemainder(uint256 _collRemainder) internal {

327:     function _hasRedistributedDebt(bytes32 _cdpId) internal view returns (bool) {

410:     function _removeStake(bytes32 _cdpId) internal {

419:     function _updateStakeAndTotalStakes(bytes32 _cdpId) internal returns (uint256) {

431:     function _updateStakeForCdp(bytes32 _cdpId) internal returns (uint256, uint256) {

441:     function _computeNewStake(uint256 _coll) internal view returns (uint256) {

463:     function _removeCdp(bytes32 _cdpId, uint256 cdpIdsArrayLength) internal {

489:     function _computeTCRWithGivenSystemValues(

509:     function _syncGlobalAccounting() internal {

534:     function _readStEthIndex() internal view returns (uint256, uint256) {

539:     function _syncStEthIndex(uint256 _oldIndex, uint256 _newIndex) internal {

552:     function calcFeeUponStakingReward(

574:     function _takeSplitAndUpdateFeePerUnit(

592:     function _applyAccumulatedFeeSplit(

616:     function getAccumulatedFeeSplitApplied(

648:     function _requireCdpIsActive(bytes32 _cdpId) internal view {

652:     function _requireMoreThanOneCdpInSystem(uint256 CdpOwnersArrayLength) internal view {

659:     function _requireCallerIsBorrowerOperations() internal view {

707:     function _calculateCR(

719:     function getPendingRedistributedDebt(

728:     function hasPendingRedistributedDebt(bytes32 _cdpId) public view returns (bool) {

733:     function _getSyncedDebtAndCollShares(

822:     function _getSyncedCdpDebtAndRedistribution(
```

- *CollSurplusPool.sol* ( [61](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CollSurplusPool.sol#L61), [67](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CollSurplusPool.sol#L67), [112](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CollSurplusPool.sol#L112), [119](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CollSurplusPool.sol#L119), [123](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CollSurplusPool.sol#L123) ):

```solidity
61:     function getTotalSurplusCollShares() external view override returns (uint256) {

67:     function getSurplusCollShares(address _account) external view override returns (uint256) {

112:     function _requireCallerIsBorrowerOperations() internal view {

119:     function _requireCallerIsCdpManager() internal view {

123:     function _requireCallerIsActivePool() internal view {
```

- *Auth.sol* ( [18](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/Auth.sol#L18), [32](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/Auth.sol#L32), [42](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/Auth.sol#L42), [52](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/Auth.sol#L52) ):

```solidity
18:     constructor(address _owner, Authority _authority) {

32:     function isAuthorized(address user, bytes4 functionSig) internal view virtual returns (bool) {

42:     function setAuthority(Authority newAuthority) public virtual {

52:     function transferOwnership(address newOwner) public virtual requiresAuth {
```

- *AuthNoOwner.sol* ( [22](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/AuthNoOwner.sol#L22), [26](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/AuthNoOwner.sol#L26), [30](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/AuthNoOwner.sol#L30), [38](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/AuthNoOwner.sol#L38), [55](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/AuthNoOwner.sol#L55) ):

```solidity
22:     function authority() public view returns (Authority) {

26:     function authorityInitialized() public view returns (bool) {

30:     function isAuthorized(address user, bytes4 functionSig) internal view virtual returns (bool) {

38:     function setAuthority(address newAuthority) public virtual {

55:     function _initializeAuthority(address newAuthority) internal {
```

- *EbtcBase.sol* ( [52](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/EbtcBase.sol#L52), [60](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/EbtcBase.sol#L60), [75](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/EbtcBase.sol#L75), [79](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/EbtcBase.sol#L79), [83](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/EbtcBase.sol#L83), [95](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/EbtcBase.sol#L95), [99](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/EbtcBase.sol#L99), [103](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/EbtcBase.sol#L103), [115](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/EbtcBase.sol#L115) ):

```solidity
52:     constructor(address _activePoolAddress, address _priceFeedAddress, address _collateralAddress) {

60:     function _calcNetStEthBalance(uint256 _stEthBalance) internal pure returns (uint256) {

75:     function _getSystemDebt() internal view returns (uint256 entireSystemDebt) {

79:     function _getCachedTCR(uint256 _price) internal view returns (uint256 TCR) {

83:     function _getTCRWithSystemDebtAndCollShares(

95:     function _checkRecoveryMode(uint256 _price) internal view returns (bool) {

99:     function _checkRecoveryModeForTCR(uint256 _tcr) internal view returns (bool) {

103:     function _requireUserAcceptsFee(

115:     function _convertDebtDenominationToBtc(
```

- *EbtcMath.sol* ( [20](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/EbtcMath.sol#L20), [24](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/EbtcMath.sol#L24), [35](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/EbtcMath.sol#L35), [59](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/EbtcMath.sol#L59), [88](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/EbtcMath.sol#L88), [92](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/EbtcMath.sol#L92) ):

```solidity
20:     function _min(uint256 _a, uint256 _b) internal pure returns (uint256) {

24:     function _max(uint256 _a, uint256 _b) internal pure returns (uint256) {

35:     function decMul(uint256 x, uint256 y) internal pure returns (uint256 decProd) {

59:     function _decPow(uint256 _base, uint256 _minutes) internal pure returns (uint256) {

88:     function _getAbsoluteDifference(uint256 _a, uint256 _b) internal pure returns (uint256) {

92:     function _computeNominalCR(uint256 _collShares, uint256 _debt) internal pure returns (uint256) {
```

- *RolesAuthority.sol* ( [20](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/RolesAuthority.sol#L20), [38](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/RolesAuthority.sol#L38), [42](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/RolesAuthority.sol#L42), [50](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/RolesAuthority.sol#L50), [63](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/RolesAuthority.sol#L63), [106](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/RolesAuthority.sol#L106), [133](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/RolesAuthority.sol#L133), [147](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/RolesAuthority.sol#L147) ):

```solidity
20:     constructor(address _owner, Authority _authority) Auth(_owner, _authority) {}

38:     function doesUserHaveRole(address user, uint8 role) public view virtual returns (bool) {

42:     function doesRoleHaveCapability(

50:     function isPublicCapability(address target, bytes4 functionSig) public view returns (bool) {

63:     function canCall(

106:     function setRoleCapability(

133:     function burnCapability(address target, bytes4 functionSig) public virtual requiresAuth {

147:     function setUserRole(address user, uint8 role, bool enabled) public virtual requiresAuth {
```

- *EBTCToken.sol* ( [61](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/EBTCToken.sol#L61), [111](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/EBTCToken.sol#L111), [115](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/EBTCToken.sol#L115), [119](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/EBTCToken.sol#L119), [125](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/EBTCToken.sol#L125), [129](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/EBTCToken.sol#L129), [134](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/EBTCToken.sol#L134), [152](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/EBTCToken.sol#L152), [160](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/EBTCToken.sol#L160), [176](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/EBTCToken.sol#L176), [182](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/EBTCToken.sol#L182), [199](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/EBTCToken.sol#L199), [231](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/EBTCToken.sol#L231), [235](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/EBTCToken.sol#L235), [246](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/EBTCToken.sol#L246), [262](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/EBTCToken.sol#L262), [270](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/EBTCToken.sol#L270), [285](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/EBTCToken.sol#L285), [295](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/EBTCToken.sol#L295), [306](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/EBTCToken.sol#L306), [323](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/EBTCToken.sol#L323), [331](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/EBTCToken.sol#L331), [337](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/EBTCToken.sol#L337), [343](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/EBTCToken.sol#L343), [349](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/EBTCToken.sol#L349), [355](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/EBTCToken.sol#L355) ):

```solidity
61:     constructor(

111:     function totalSupply() external view override returns (uint256) {

115:     function balanceOf(address account) external view override returns (uint256) {

119:     function transfer(address recipient, uint256 amount) external override returns (bool) {

125:     function allowance(address owner, address spender) external view override returns (uint256) {

129:     function approve(address spender, uint256 amount) external override returns (bool) {

134:     function transferFrom(

152:     function increaseAllowance(

160:     function decreaseAllowance(

176:     function DOMAIN_SEPARATOR() external view returns (bytes32) {

182:     function domainSeparator() public view override returns (bytes32) {

199:     function permit(

231:     function _chainID() private view returns (uint256) {

235:     function _buildDomainSeparator(

246:     function _transfer(address sender, address recipient, uint256 amount) internal {

262:     function _mint(address account, uint256 amount) internal {

270:     function _burn(address account, uint256 amount) internal {

285:     function _approve(address owner, address spender, uint256 amount) internal {

295:     function _requireValidRecipient(address _recipient) internal view {

306:     function _requireCallerIsBorrowerOperations() internal view {

323:     function _requireCallerIsCdpM() internal view {

331:     function name() external pure override returns (string memory) {

337:     function symbol() external pure override returns (string memory) {

343:     function decimals() external pure override returns (uint8) {

349:     function version() external pure override returns (string memory) {

355:     function permitTypeHash() external pure override returns (bytes32) {
```

- *Governor.sol* ( [36](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Governor.sol#L36), [96](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Governor.sol#L96), [120](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Governor.sol#L120), [131](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Governor.sol#L131), [146](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Governor.sol#L146) ):

```solidity
36:     constructor(address _owner) RolesAuthority(_owner, Authority(address(this))) {}

96:     function getRolesFromByteMap(bytes32 byteMap) public pure returns (uint8[] memory roleIds) {

120:     function getByteMapFromRoles(uint8[] memory roleIds) public pure returns (bytes32) {

131:     function getEnabledFunctionsInTarget(

146:     function getRoleName(uint8 role) external view returns (string memory roleName) {
```

- *HintHelpers.sol* ( [27](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/HintHelpers.sol#L27), [48](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/HintHelpers.sol#L48), [164](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/HintHelpers.sol#L164), [203](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/HintHelpers.sol#L203), [212](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/HintHelpers.sol#L212) ):

```solidity
27:     constructor(

48:     function getRedemptionHints(

164:     function getApproxHint(

203:     function computeNominalCR(uint256 _coll, uint256 _debt) external pure returns (uint256) {

212:     function computeCR(
```

- *IActivePool.sol* ( [23](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IActivePool.sol#L23), [25](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IActivePool.sol#L25), [27](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IActivePool.sol#L27), [33](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IActivePool.sol#L33), [35](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IActivePool.sol#L35), [37](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IActivePool.sol#L37), [39](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IActivePool.sol#L39), [41](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IActivePool.sol#L41) ):

```solidity
23:     function transferSystemCollShares(address _account, uint256 _amount) external;

25:     function increaseSystemCollShares(uint256 _value) external;

27:     function transferSystemCollSharesAndLiquidatorReward(

33:     function allocateSystemCollSharesToFeeRecipient(uint256 _shares) external;

35:     function claimFeeRecipientCollShares(uint256 _shares) external;

37:     function feeRecipientAddress() external view returns (address);

39:     function getFeeRecipientClaimableCollShares() external view returns (uint256);

41:     function setFeeRecipientAddress(address _feeRecipientAddress) external;
```

- *IBorrowerOperations.sol* ( [20](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IBorrowerOperations.sol#L20), [27](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IBorrowerOperations.sol#L27), [35](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IBorrowerOperations.sol#L35), [42](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IBorrowerOperations.sol#L42), [49](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IBorrowerOperations.sol#L49), [56](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IBorrowerOperations.sol#L56), [63](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IBorrowerOperations.sol#L63), [65](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IBorrowerOperations.sol#L65), [74](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IBorrowerOperations.sol#L74), [84](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IBorrowerOperations.sol#L84), [86](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IBorrowerOperations.sol#L86) ):

```solidity
20:     function openCdp(

27:     function openCdpFor(

35:     function addColl(

42:     function withdrawColl(

49:     function withdrawDebt(

56:     function repayDebt(

63:     function closeCdp(bytes32 _cdpId) external;

65:     function adjustCdp(

74:     function adjustCdpWithColl(

84:     function claimSurplusCollShares() external;

86:     function feeRecipientAddress() external view returns (address);
```

- *ICdpManager.sol* ( [11](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManager.sol#L11), [13](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManager.sol#L13), [15](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManager.sol#L15), [17](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManager.sol#L17), [24](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManager.sol#L24), [26](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManager.sol#L26), [36](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManager.sol#L36), [38](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManager.sol#L38), [40](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManager.sol#L40), [42](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManager.sol#L42), [44](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManager.sol#L44), [46](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManager.sol#L46), [48](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManager.sol#L48), [50](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManager.sol#L50), [52](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManager.sol#L52), [54](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManager.sol#L54), [56](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManager.sol#L56), [58](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManager.sol#L58), [66](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManager.sol#L66), [75](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManager.sol#L75), [77](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManager.sol#L77) ):

```solidity
11:     function getActiveCdpsCount() external view returns (uint256);

13:     function getIdFromCdpIdsArray(uint256 _index) external view returns (bytes32);

15:     function liquidate(bytes32 _cdpId) external;

17:     function partiallyLiquidate(

24:     function batchLiquidateCdps(bytes32[] calldata _cdpArray) external;

26:     function redeemCollateral(

36:     function updateStakeAndTotalStakes(bytes32 _cdpId) external returns (uint256);

38:     function syncAccounting(bytes32 _cdpId) external;

40:     function closeCdp(bytes32 _cdpId, address _borrower, uint256 _debt, uint256 _coll) external;

42:     function getRedemptionRate() external view returns (uint256);

44:     function getRedemptionRateWithDecay() external view returns (uint256);

46:     function getRedemptionFeeWithDecay(uint256 _stETHToRedeem) external view returns (uint256);

48:     function getCdpStatus(bytes32 _cdpId) external view returns (uint256);

50:     function getCdpStake(bytes32 _cdpId) external view returns (uint256);

52:     function getCdpDebt(bytes32 _cdpId) external view returns (uint256);

54:     function getCdpCollShares(bytes32 _cdpId) external view returns (uint256);

56:     function getCdpLiquidatorRewardShares(bytes32 _cdpId) external view returns (uint);

58:     function initializeCdp(

66:     function updateCdp(

75:     function getCachedTCR(uint256 _price) external view returns (uint256);

77:     function checkRecoveryMode(uint256 _price) external view returns (bool);
```

- *ICdpManagerData.sol* ( [217](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManagerData.sol#L217), [219](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManagerData.sol#L219), [221](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManagerData.sol#L221), [223](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManagerData.sol#L223), [225](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManagerData.sol#L225), [227](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManagerData.sol#L227), [232](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManagerData.sol#L232), [234](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManagerData.sol#L234), [236](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManagerData.sol#L236), [241](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManagerData.sol#L241), [243](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManagerData.sol#L243), [245](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManagerData.sol#L245), [247](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManagerData.sol#L247), [249](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManagerData.sol#L249), [251](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManagerData.sol#L251), [253](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManagerData.sol#L253), [255](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManagerData.sol#L255), [257](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManagerData.sol#L257), [259](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManagerData.sol#L259), [263](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManagerData.sol#L263) ):

```solidity
217:     function totalStakes() external view returns (uint256);

219:     function ebtcToken() external view returns (IEBTCToken);

221:     function systemStEthFeePerUnitIndex() external view returns (uint256);

223:     function systemStEthFeePerUnitIndexError() external view returns (uint256);

225:     function stEthIndex() external view returns (uint256);

227:     function calcFeeUponStakingReward(

232:     function syncGlobalAccounting() external; // Accrues StEthFeeSplit without influencing Grace Period

234:     function syncGlobalAccountingAndGracePeriod() external; // Accrues StEthFeeSplit and influences Grace Period

236:     function getAccumulatedFeeSplitApplied(

241:     function getCachedNominalICR(bytes32 _cdpId) external view returns (uint256);

243:     function getCachedICR(bytes32 _cdpId, uint256 _price) external view returns (uint256);

245:     function getSyncedCdpDebt(bytes32 _cdpId) external view returns (uint256);

247:     function getSyncedCdpCollShares(bytes32 _cdpId) external view returns (uint256);

249:     function getSyncedICR(bytes32 _cdpId, uint256 _price) external view returns (uint256);

251:     function getSyncedTCR(uint256 _price) external view returns (uint256);

253:     function getSyncedNominalICR(bytes32 _cdpId) external view returns (uint256);

255:     function getPendingRedistributedDebt(bytes32 _cdpId) external view returns (uint256);

257:     function hasPendingRedistributedDebt(bytes32 _cdpId) external view returns (bool);

259:     function getSyncedDebtAndCollShares(

263:     function canLiquidateRecoveryMode(uint256 icr, uint256 tcr) external view returns (bool);
```

- *ICollSurplusPool.sol* ( [15](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICollSurplusPool.sol#L15), [17](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICollSurplusPool.sol#L17), [19](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICollSurplusPool.sol#L19), [21](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICollSurplusPool.sol#L21), [23](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICollSurplusPool.sol#L23) ):

```solidity
15:     function getTotalSurplusCollShares() external view returns (uint256);

17:     function getSurplusCollShares(address _account) external view returns (uint256);

19:     function increaseSurplusCollShares(address _account, uint256 _amount) external;

21:     function claimSurplusCollShares(address _account) external;

23:     function increaseTotalSurplusCollShares(uint256 _value) external;
```

- *IEBTCToken.sol* ( [11](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IEBTCToken.sol#L11), [13](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IEBTCToken.sol#L13) ):

```solidity
11:     function mint(address _account, uint256 _amount) external;

13:     function burn(address _account, uint256 _amount) external;
```

- *IEbtcBase.sol* ( [8](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IEbtcBase.sol#L8) ):

```solidity
8:     function priceFeed() external view returns (IPriceFeed);
```

- *IFallbackCaller.sol* ( [13](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IFallbackCaller.sol#L13), [17](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IFallbackCaller.sol#L17), [21](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IFallbackCaller.sol#L21) ):

```solidity
13:     function getFallbackResponse() external view returns (uint256, uint256, bool);

17:     function fallbackTimeout() external view returns (uint256);

21:     function setFallbackTimeout(uint256 newFallbackTimeout) external;
```

- *IPermitNonce.sol* ( [7](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IPermitNonce.sol#L7), [9](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IPermitNonce.sol#L9) ):

```solidity
7:     function increasePermitNonce() external returns (uint256);

9:     function nonces(address owner) external view returns (uint256);
```

- *IPool.sol* ( [15](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IPool.sol#L15), [17](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IPool.sol#L17), [19](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IPool.sol#L19), [21](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IPool.sol#L21) ):

```solidity
15:     function getSystemCollShares() external view returns (uint256);

17:     function getSystemDebt() external view returns (uint256);

19:     function increaseSystemDebt(uint256 _amount) external;

21:     function decreaseSystemDebt(uint256 _amount) external;
```

- *IPositionManagers.sol* ( [18](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IPositionManagers.sol#L18), [23](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IPositionManagers.sol#L23), [28](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IPositionManagers.sol#L28), [30](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IPositionManagers.sol#L30), [32](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IPositionManagers.sol#L32), [42](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IPositionManagers.sol#L42), [44](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IPositionManagers.sol#L44), [46](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IPositionManagers.sol#L46) ):

```solidity
18:     function getPositionManagerApproval(

23:     function setPositionManagerApproval(

28:     function revokePositionManagerApproval(address _positionManager) external;

30:     function renouncePositionManagerApproval(address _borrower) external;

32:     function permitPositionManagerApproval(

42:     function version() external view returns (string memory);

44:     function permitTypeHash() external view returns (bytes32);

46:     function domainSeparator() external view returns (bytes32);
```

- *IPriceFeed.sol* ( [43](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IPriceFeed.sol#L43) ):

```solidity
43:     function fetchPrice() external returns (uint256);
```

- *IRecoveryModeGracePeriod.sol* ( [13](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IRecoveryModeGracePeriod.sol#L13), [15](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IRecoveryModeGracePeriod.sol#L15) ):

```solidity
13:     function notifyStartGracePeriod(uint256 tcr) external;

15:     function notifyEndGracePeriod(uint256 tcr) external;
```

- *ISortedCdps.sol* ( [14](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ISortedCdps.sol#L14), [16](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ISortedCdps.sol#L16), [18](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ISortedCdps.sol#L18), [20](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ISortedCdps.sol#L20), [22](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ISortedCdps.sol#L22), [24](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ISortedCdps.sol#L24), [26](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ISortedCdps.sol#L26), [28](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ISortedCdps.sol#L28), [30](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ISortedCdps.sol#L30), [32](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ISortedCdps.sol#L32), [34](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ISortedCdps.sol#L34), [36](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ISortedCdps.sol#L36), [38](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ISortedCdps.sol#L38), [44](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ISortedCdps.sol#L44), [50](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ISortedCdps.sol#L50), [57](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ISortedCdps.sol#L57), [59](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ISortedCdps.sol#L59), [61](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ISortedCdps.sol#L61), [63](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ISortedCdps.sol#L63), [69](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ISortedCdps.sol#L69), [71](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ISortedCdps.sol#L71), [77](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ISortedCdps.sol#L77), [79](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ISortedCdps.sol#L79) ):

```solidity
14:     function remove(bytes32 _id) external;

16:     function batchRemove(bytes32[] memory _ids) external;

18:     function reInsert(bytes32 _id, uint256 _newICR, bytes32 _prevId, bytes32 _nextId) external;

20:     function contains(bytes32 _id) external view returns (bool);

22:     function isFull() external view returns (bool);

24:     function isEmpty() external view returns (bool);

26:     function getSize() external view returns (uint256);

28:     function getMaxSize() external view returns (uint256);

30:     function getFirst() external view returns (bytes32);

32:     function getLast() external view returns (bytes32);

34:     function getNext(bytes32 _id) external view returns (bytes32);

36:     function getPrev(bytes32 _id) external view returns (bytes32);

38:     function validInsertPosition(

44:     function findInsertPosition(

50:     function insert(

57:     function getOwnerAddress(bytes32 _id) external pure returns (address);

59:     function nonExistId() external view returns (bytes32);

61:     function cdpCountOf(address owner) external view returns (uint256);

63:     function getCdpCountOf(

69:     function getCdpsOf(address owner) external view returns (bytes32[] memory);

71:     function getAllCdpsOf(

77:     function cdpOfOwnerByIndex(address owner, uint256 index) external view returns (bytes32);

79:     function cdpOfOwnerByIdx(
```

- *LeverageMacroBase.sol* ( [15](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LeverageMacroBase.sol#L15), [39](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LeverageMacroBase.sol#L39), [43](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LeverageMacroBase.sol#L43), [51](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LeverageMacroBase.sol#L51), [118](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LeverageMacroBase.sol#L118), [214](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LeverageMacroBase.sol#L214), [338](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LeverageMacroBase.sol#L338), [344](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LeverageMacroBase.sol#L344) ):

```solidity
15:     function Cdps(bytes32) external view returns (ICdpManagerData.Cdp memory);

39:     function owner() public virtual returns (address) {

43:     function _assertOwner() internal {

51:     constructor(

118:     function doOperation(

214:     function sweepToCaller() public {

338:     function decodeFLData(bytes calldata data) public view returns (LeverageMacroOperation memory) {

344:     function onFlashLoan(
```

- *LeverageMacroDelegateTarget.sol* ( [7](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LeverageMacroDelegateTarget.sol#L7), [41](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LeverageMacroDelegateTarget.sol#L41) ):

```solidity
7:     function owner() external view returns (address);

41:     constructor(
```

- *LeverageMacroFactory.sol* ( [21](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LeverageMacroFactory.sol#L21), [38](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LeverageMacroFactory.sol#L38), [43](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LeverageMacroFactory.sol#L43) ):

```solidity
21:     constructor(

38:     function deployNewMacro() external returns (address) {

43:     function deployNewMacro(address _owner) public returns (address) {
```

- *LeverageMacroReference.sol* ( [17](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LeverageMacroReference.sol#L17), [44](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LeverageMacroReference.sol#L44) ):

```solidity
17:     constructor(

44:     function owner() public override returns (address) {
```

- *LiquidationLibrary.sol* ( [14](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LiquidationLibrary.sol#L14), [61](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LiquidationLibrary.sol#L61), [135](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LiquidationLibrary.sol#L135), [186](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LiquidationLibrary.sol#L186), [223](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LiquidationLibrary.sol#L223), [295](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LiquidationLibrary.sol#L295), [384](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LiquidationLibrary.sol#L384), [397](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LiquidationLibrary.sol#L397), [450](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LiquidationLibrary.sol#L450), [466](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LiquidationLibrary.sol#L466), [503](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LiquidationLibrary.sol#L503), [544](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LiquidationLibrary.sol#L544), [570](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LiquidationLibrary.sol#L570), [608](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LiquidationLibrary.sol#L608), [642](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LiquidationLibrary.sol#L642), [733](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LiquidationLibrary.sol#L733), [807](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LiquidationLibrary.sol#L807), [839](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LiquidationLibrary.sol#L839), [862](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LiquidationLibrary.sol#L862), [896](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LiquidationLibrary.sol#L896), [908](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LiquidationLibrary.sol#L908) ):

```solidity
14:     constructor(

61:     function _liquidateIndividualCdpSetup(

135:     function _liquidateIndividualCdpSetupCDP(

186:     function _liquidateCdpInGivenMode(

223:     function _liquidateIndividualCdpSetupCDPInNormalMode(

295:     function _liquidateIndividualCdpSetupCDPInRecoveryMode(

384:     function _closeCdpByLiquidation(bytes32 _cdpId) private returns (uint256, uint256, uint256) {

397:     function _liquidateCDPPartially(

450:     function _partiallyReduceCdpDebt(

466:     function _reInsertPartialLiquidation(

503:     function _finalizeLiquidation(

544:     function _calculatePartialLiquidationSurplusAndCap(

570:     function _calculateFullLiquidationSurplusAndCap(

608:     function _getLiquidationValuesNormalMode(

642:     function _getLiquidationValuesRecoveryMode(

733:     function _getTotalFromBatchLiquidate_RecoveryMode(

807:     function _getTotalsFromBatchLiquidate_NormalMode(

839:     function _addLiquidationValuesToTotals(

862:     function _redistributeDebt(uint256 _debt) internal {

896:     function _requirePartialLiqDebtSize(

908:     function _requirePartialLiqCollSize(uint256 _entireColl) internal pure {
```

- *PriceFeed.sol* ( [57](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/PriceFeed.sol#L57), [445](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/PriceFeed.sol#L445), [465](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/PriceFeed.sol#L465), [485](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/PriceFeed.sol#L485), [493](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/PriceFeed.sol#L493), [503](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/PriceFeed.sol#L503), [526](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/PriceFeed.sol#L526), [546](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/PriceFeed.sol#L546), [553](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/PriceFeed.sol#L553), [561](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/PriceFeed.sol#L561), [571](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/PriceFeed.sol#L571), [582](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/PriceFeed.sol#L582), [606](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/PriceFeed.sol#L606), [687](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/PriceFeed.sol#L687), [775](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/PriceFeed.sol#L775), [788](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/PriceFeed.sol#L788) ):

```solidity
57:     constructor(

445:     function _chainlinkPriceChangeAboveMax(

465:     function _fallbackIsBroken(FallbackResponse memory _response) internal view returns (bool) {

485:     function _fallbackIsFrozen(

493:     function _responseTimeout(uint256 _timestamp, uint256 _timeout) internal view returns (bool) {

503:     function _bothOraclesLiveAndUnbrokenAndSimilarPrice(

526:     function _bothOraclesSimilarPrice(

546:     function _changeStatus(Status _status) internal {

553:     function _storePrice(uint256 _currentPrice) internal {

561:     function _storeFallbackPrice(

571:     function _storeChainlinkPrice(uint256 _answer) internal returns (uint256) {

582:     function _getCurrentFallbackResponse()

606:     function _getCurrentChainlinkResponse()

687:     function _getPrevChainlinkResponse(

775:     function _checkHealthyCLResponse(uint80 _roundId, int256 _answer) internal view returns (bool) {

788:     function _formatClAggregateAnswer(
```

- *SimplifiedDiamondLike.sol* ( [44](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SimplifiedDiamondLike.sol#L44), [51](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SimplifiedDiamondLike.sol#L51), [66](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SimplifiedDiamondLike.sol#L66), [76](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SimplifiedDiamondLike.sol#L76), [110](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SimplifiedDiamondLike.sol#L110), [160](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SimplifiedDiamondLike.sol#L160), [164](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SimplifiedDiamondLike.sol#L164) ):

```solidity
44:     constructor(address _owner) {

51:     function setFallbackHandler(bytes4 sig, address handler) external {

66:     function setAllowAnyCall(bool allowNonCallbacks) external {

76:     function enableCallbackForCall() external {

110:     function execute(Operation[] calldata ops) external payable {

160:     receive() external payable {

164:     fallback() external payable {
```

- *SortedCdps.sol* ( [130](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L130), [227](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L227), [344](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L344), [363](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L363), [410](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L410), [456](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L456), [498](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L498), [591](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L591), [674](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L674) ):

```solidity
130:     function nonExistId() public pure override returns (bytes32) {

227:     function getCdpCountOf(

344:     function insert(

363:     function _insert(bytes32 _id, uint256 _NICR, bytes32 _prevId, bytes32 _nextId) internal {

410:     function remove(bytes32 _id) external override {

456:     function _remove(bytes32 _id) internal {

498:     function reInsert(

591:     function _validInsertPosition(

674:     function _findInsertPosition(
```

</details>

### [N&#x2011;104] Missing NatSpec `@notice` from function declaration

Some functions have an incomplete NatSpec: add a `@notice` notation to describe the function to improve the code documentation.

<details>
<summary>There are 327 instances (click to show):</summary>

- *BorrowerOperations.sol* ( [107](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L107), [328](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L328), [439](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L439), [615](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L615), [635](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L635), [673](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L673), [677](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L677), [744](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L744), [790](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L790), [796](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L796), [803](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L803), [813](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L813), [824](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L824), [829](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L829), [834](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L834), [838](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L838), [845](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L845), [852](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L852), [910](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L910), [917](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L917), [921](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L921), [928](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L928), [935](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L935), [939](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L939), [946](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L946), [953](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L953), [963](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L963), [986](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L986), [1004](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L1004), [1030](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L1030), [1049](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L1049) ):

```solidity
107:     constructor(

328:     function _adjustCdpInternal(

439:     function _openCdp(

615:     function _getPositionManagerApproval(

635:     function _setPositionManagerApproval(

673:     function _chainID() private view returns (uint256) {

677:     function _buildDomainSeparator(

744:     function _getCollSharesChangeFromStEthChange(

790:     function _withdrawDebt(address _account, uint256 _debt) internal {

796:     function _repayDebt(address _account, uint256 _debt) internal {

803:     function _requireSingularCollChange(

813:     function _requireNonZeroAdjustment(

824:     function _requireCdpisActive(ICdpManager _cdpManager, bytes32 _cdpId) internal view {

829:     function _requireCdpIsNonExistent(bytes32 _cdpId) internal view {

834:     function _requireNonZeroDebtChange(uint _debtChange) internal pure {

838:     function _requireNotInRecoveryMode(uint256 _tcr) internal view {

845:     function _requireNoStEthBalanceDecrease(uint256 _stEthBalanceDecrease) internal pure {

852:     function _requireValidAdjustmentInCurrentMode(

910:     function _requireICRisNotBelowMCR(uint256 _newICR) internal pure {

917:     function _requireICRisNotBelowCCR(uint256 _newICR) internal pure {

921:     function _requireNoDecreaseOfICR(uint256 _newICR, uint256 _oldICR) internal pure {

928:     function _requireNewTCRisNotBelowCCR(uint256 _newTCR) internal pure {

935:     function _requireNonZeroDebt(uint256 _debt) internal pure {

939:     function _requireAtLeastMinNetStEthBalance(uint256 _stEthBalance) internal pure {

946:     function _requireValidDebtRepayment(uint256 _currentDebt, uint256 _debtRepayment) internal pure {

953:     function _requireSufficientEbtcTokenBalance(

963:     function _requireBorrowerOrPositionManagerAndUpdateManagerApproval(address _borrower) internal {

986:     function _getNewNominalICRFromCdpChange(

1004:     function _getNewICRFromCdpChange(

1030:     function _getNewCdpAmounts(

1049:     function _getNewTCRFromCdpChange(
```

- *CdpManager.sol* ( [244](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L244), [489](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L489), [550](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L550), [595](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L595), [612](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L612), [638](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L638), [643](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L643), [647](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L647), [655](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L655), [661](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L661), [667](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L667), [676](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L676), [689](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L689), [702](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L702), [709](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L709), [717](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L717), [737](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L737), [753](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L753), [757](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L757), [761](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L761) ):

```solidity
244:     function _closeCdpByRedemption(

489:     function _getCdpIdsToRemove(

550:     function _addCdpIdToArray(bytes32 _cdpId) internal returns (uint128 index) {

595:     function _checkPotentialRecoveryMode(

612:     function _updateBaseRateFromRedemption(

638:     function getRedemptionRate() public view override returns (uint256) {

643:     function getRedemptionRateWithDecay() public view override returns (uint256) {

647:     function _calcRedemptionRate(uint256 _baseRate) internal view returns (uint256) {

655:     function _getRedemptionFee(uint256 _ETHDrawn) internal view returns (uint256) {

661:     function getRedemptionFeeWithDecay(

667:     function _calcRedemptionFee(

676:     function _decayBaseRate() internal {

689:     function _updateLastRedemptionTimestamp() internal {

702:     function _calcDecayedBaseRate() internal view returns (uint256) {

709:     function _minutesPassedSinceLastRedemption() internal view returns (uint256) {

717:     function getDeploymentStartTime() public view returns (uint256) {

737:     function _requireEbtcBalanceCoversRedemptionAndWithinSupply(

753:     function _requireAmountGreaterThanZero(uint256 _amount) internal pure {

757:     function _requireTCRisNotBelowMCR(uint256 _price, uint256 _TCR) internal view {

761:     function _requireValidMaxFeePercentage(uint256 _maxFeePercentage) internal view {
```

- *CdpManagerStorage.sol* ( [49](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L49), [73](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L73), [87](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L87), [255](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L255), [260](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L260), [293](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L293), [304](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L304), [327](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L327), [336](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L336), [344](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L344), [410](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L410), [419](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L419), [431](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L431), [441](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L441), [463](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L463), [489](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L489), [509](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L509), [534](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L534), [539](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L539), [574](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L574), [592](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L592), [648](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L648), [652](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L652), [659](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L659), [707](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L707), [728](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L728), [733](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L733), [761](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L761), [787](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L787), [822](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L822), [890](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L890), [895](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L895) ):

```solidity
49:     function _startGracePeriod(uint256 _tcr) internal {

73:     function _syncGracePeriod() internal {

87:     function _syncGracePeriodForGivenValues(

255:     function _closeCdp(bytes32 _cdpId, Status closedStatus) internal {

260:     function _closeCdpWithoutRemovingSortedCdps(bytes32 _cdpId, Status closedStatus) internal {

293:     function _updateSystemSnapshotsExcludeCollRemainder(uint256 _collRemainder) internal {

304:     function _getPendingRedistributedDebt(

327:     function _hasRedistributedDebt(bytes32 _cdpId) internal view returns (bool) {

336:     function _updateRedistributedDebtIndex(bytes32 _cdpId) internal {

344:     function _syncAccounting(bytes32 _cdpId) internal {

410:     function _removeStake(bytes32 _cdpId) internal {

419:     function _updateStakeAndTotalStakes(bytes32 _cdpId) internal returns (uint256) {

431:     function _updateStakeForCdp(bytes32 _cdpId) internal returns (uint256, uint256) {

441:     function _computeNewStake(uint256 _coll) internal view returns (uint256) {

463:     function _removeCdp(bytes32 _cdpId, uint256 cdpIdsArrayLength) internal {

489:     function _computeTCRWithGivenSystemValues(

509:     function _syncGlobalAccounting() internal {

534:     function _readStEthIndex() internal view returns (uint256, uint256) {

539:     function _syncStEthIndex(uint256 _oldIndex, uint256 _newIndex) internal {

574:     function _takeSplitAndUpdateFeePerUnit(

592:     function _applyAccumulatedFeeSplit(

648:     function _requireCdpIsActive(bytes32 _cdpId) internal view {

652:     function _requireMoreThanOneCdpInSystem(uint256 CdpOwnersArrayLength) internal view {

659:     function _requireCallerIsBorrowerOperations() internal view {

707:     function _calculateCR(

728:     function hasPendingRedistributedDebt(bytes32 _cdpId) public view returns (bool) {

733:     function _getSyncedDebtAndCollShares(

761:     function _calcSyncedGlobalAccounting(

787:     function _calcSyncedAccounting(

822:     function _getSyncedCdpDebtAndRedistribution(

890:     function canLiquidateRecoveryMode(uint256 icr, uint256 tcr) public view returns (bool) {

895:     function _recoveryModeGracePeriodPassed() internal view returns (bool) {
```

- *CollSurplusPool.sol* ( [61](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CollSurplusPool.sol#L61), [67](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CollSurplusPool.sol#L67), [112](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CollSurplusPool.sol#L112), [119](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CollSurplusPool.sol#L119), [123](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CollSurplusPool.sol#L123) ):

```solidity
61:     function getTotalSurplusCollShares() external view override returns (uint256) {

67:     function getSurplusCollShares(address _account) external view override returns (uint256) {

112:     function _requireCallerIsBorrowerOperations() internal view {

119:     function _requireCallerIsCdpManager() internal view {

123:     function _requireCallerIsActivePool() internal view {
```

- *Auth.sol* ( [18](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/Auth.sol#L18), [32](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/Auth.sol#L32), [42](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/Auth.sol#L42), [52](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/Auth.sol#L52) ):

```solidity
18:     constructor(address _owner, Authority _authority) {

32:     function isAuthorized(address user, bytes4 functionSig) internal view virtual returns (bool) {

42:     function setAuthority(Authority newAuthority) public virtual {

52:     function transferOwnership(address newOwner) public virtual requiresAuth {
```

- *AuthNoOwner.sol* ( [22](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/AuthNoOwner.sol#L22), [26](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/AuthNoOwner.sol#L26), [30](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/AuthNoOwner.sol#L30), [38](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/AuthNoOwner.sol#L38) ):

```solidity
22:     function authority() public view returns (Authority) {

26:     function authorityInitialized() public view returns (bool) {

30:     function isAuthorized(address user, bytes4 functionSig) internal view virtual returns (bool) {

38:     function setAuthority(address newAuthority) public virtual {
```

- *EbtcBase.sol* ( [60](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/EbtcBase.sol#L60), [79](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/EbtcBase.sol#L79), [83](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/EbtcBase.sol#L83), [95](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/EbtcBase.sol#L95), [99](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/EbtcBase.sol#L99), [103](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/EbtcBase.sol#L103), [115](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/EbtcBase.sol#L115), [124](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/EbtcBase.sol#L124), [134](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/EbtcBase.sol#L134), [140](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/EbtcBase.sol#L140) ):

```solidity
60:     function _calcNetStEthBalance(uint256 _stEthBalance) internal pure returns (uint256) {

79:     function _getCachedTCR(uint256 _price) internal view returns (uint256 TCR) {

83:     function _getTCRWithSystemDebtAndCollShares(

95:     function _checkRecoveryMode(uint256 _price) internal view returns (bool) {

99:     function _checkRecoveryModeForTCR(uint256 _tcr) internal view returns (bool) {

103:     function _requireUserAcceptsFee(

115:     function _convertDebtDenominationToBtc(

124:     function _checkICRAgainstLiqThreshold(uint256 _icr, uint _tcr) internal view returns (bool) {

134:     function _checkICRAgainstMCR(uint256 _icr) internal view returns (bool) {

140:     function _checkICRAgainstTCR(uint256 _icr, uint _tcr) internal view returns (bool) {
```

- *EbtcMath.sol* ( [20](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/EbtcMath.sol#L20), [24](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/EbtcMath.sol#L24), [35](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/EbtcMath.sol#L35), [59](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/EbtcMath.sol#L59), [88](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/EbtcMath.sol#L88), [92](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/EbtcMath.sol#L92), [104](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/EbtcMath.sol#L104) ):

```solidity
20:     function _min(uint256 _a, uint256 _b) internal pure returns (uint256) {

24:     function _max(uint256 _a, uint256 _b) internal pure returns (uint256) {

35:     function decMul(uint256 x, uint256 y) internal pure returns (uint256 decProd) {

59:     function _decPow(uint256 _base, uint256 _minutes) internal pure returns (uint256) {

88:     function _getAbsoluteDifference(uint256 _a, uint256 _b) internal pure returns (uint256) {

92:     function _computeNominalCR(uint256 _collShares, uint256 _debt) internal pure returns (uint256) {

104:     function _computeCR(
```

- *RolesAuthority.sol* ( [20](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/RolesAuthority.sol#L20), [38](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/RolesAuthority.sol#L38), [42](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/RolesAuthority.sol#L42), [50](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/RolesAuthority.sol#L50), [147](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/RolesAuthority.sol#L147) ):

```solidity
20:     constructor(address _owner, Authority _authority) Auth(_owner, _authority) {}

38:     function doesUserHaveRole(address user, uint8 role) public view virtual returns (bool) {

42:     function doesRoleHaveCapability(

50:     function isPublicCapability(address target, bytes4 functionSig) public view returns (bool) {

147:     function setUserRole(address user, uint8 role, bool enabled) public virtual requiresAuth {
```

- *EBTCToken.sol* ( [61](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/EBTCToken.sol#L61), [111](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/EBTCToken.sol#L111), [115](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/EBTCToken.sol#L115), [119](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/EBTCToken.sol#L119), [125](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/EBTCToken.sol#L125), [129](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/EBTCToken.sol#L129), [134](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/EBTCToken.sol#L134), [152](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/EBTCToken.sol#L152), [160](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/EBTCToken.sol#L160), [225](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/EBTCToken.sol#L225), [231](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/EBTCToken.sol#L231), [235](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/EBTCToken.sol#L235), [246](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/EBTCToken.sol#L246), [262](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/EBTCToken.sol#L262), [270](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/EBTCToken.sol#L270), [285](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/EBTCToken.sol#L285), [295](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/EBTCToken.sol#L295), [306](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/EBTCToken.sol#L306), [314](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/EBTCToken.sol#L314), [323](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/EBTCToken.sol#L323) ):

```solidity
61:     constructor(

111:     function totalSupply() external view override returns (uint256) {

115:     function balanceOf(address account) external view override returns (uint256) {

119:     function transfer(address recipient, uint256 amount) external override returns (bool) {

125:     function allowance(address owner, address spender) external view override returns (uint256) {

129:     function approve(address spender, uint256 amount) external override returns (bool) {

134:     function transferFrom(

152:     function increaseAllowance(

160:     function decreaseAllowance(

225:     function nonces(address owner) external view override(IERC2612, PermitNonce) returns (uint256) {

231:     function _chainID() private view returns (uint256) {

235:     function _buildDomainSeparator(

246:     function _transfer(address sender, address recipient, uint256 amount) internal {

262:     function _mint(address account, uint256 amount) internal {

270:     function _burn(address account, uint256 amount) internal {

285:     function _approve(address owner, address spender, uint256 amount) internal {

295:     function _requireValidRecipient(address _recipient) internal view {

306:     function _requireCallerIsBorrowerOperations() internal view {

314:     function _requireCallerIsBOorCdpMOrAuth() internal view {

323:     function _requireCallerIsCdpM() internal view {
```

- *HintHelpers.sol* ( [27](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/HintHelpers.sol#L27), [164](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/HintHelpers.sol#L164) ):

```solidity
27:     constructor(

164:     function getApproxHint(
```

- *IActivePool.sol* ( [23](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IActivePool.sol#L23), [25](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IActivePool.sol#L25), [27](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IActivePool.sol#L27), [33](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IActivePool.sol#L33), [35](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IActivePool.sol#L35), [37](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IActivePool.sol#L37), [39](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IActivePool.sol#L39), [41](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IActivePool.sol#L41) ):

```solidity
23:     function transferSystemCollShares(address _account, uint256 _amount) external;

25:     function increaseSystemCollShares(uint256 _value) external;

27:     function transferSystemCollSharesAndLiquidatorReward(

33:     function allocateSystemCollSharesToFeeRecipient(uint256 _shares) external;

35:     function claimFeeRecipientCollShares(uint256 _shares) external;

37:     function feeRecipientAddress() external view returns (address);

39:     function getFeeRecipientClaimableCollShares() external view returns (uint256);

41:     function setFeeRecipientAddress(address _feeRecipientAddress) external;
```

- *IBorrowerOperations.sol* ( [20](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IBorrowerOperations.sol#L20), [27](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IBorrowerOperations.sol#L27), [35](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IBorrowerOperations.sol#L35), [42](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IBorrowerOperations.sol#L42), [49](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IBorrowerOperations.sol#L49), [56](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IBorrowerOperations.sol#L56), [63](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IBorrowerOperations.sol#L63), [65](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IBorrowerOperations.sol#L65), [74](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IBorrowerOperations.sol#L74), [84](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IBorrowerOperations.sol#L84), [86](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IBorrowerOperations.sol#L86) ):

```solidity
20:     function openCdp(

27:     function openCdpFor(

35:     function addColl(

42:     function withdrawColl(

49:     function withdrawDebt(

56:     function repayDebt(

63:     function closeCdp(bytes32 _cdpId) external;

65:     function adjustCdp(

74:     function adjustCdpWithColl(

84:     function claimSurplusCollShares() external;

86:     function feeRecipientAddress() external view returns (address);
```

- *ICdpManager.sol* ( [11](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManager.sol#L11), [13](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManager.sol#L13), [15](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManager.sol#L15), [17](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManager.sol#L17), [24](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManager.sol#L24), [26](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManager.sol#L26), [36](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManager.sol#L36), [38](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManager.sol#L38), [40](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManager.sol#L40), [42](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManager.sol#L42), [44](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManager.sol#L44), [46](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManager.sol#L46), [48](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManager.sol#L48), [50](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManager.sol#L50), [52](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManager.sol#L52), [54](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManager.sol#L54), [56](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManager.sol#L56), [58](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManager.sol#L58), [66](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManager.sol#L66), [75](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManager.sol#L75), [77](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManager.sol#L77) ):

```solidity
11:     function getActiveCdpsCount() external view returns (uint256);

13:     function getIdFromCdpIdsArray(uint256 _index) external view returns (bytes32);

15:     function liquidate(bytes32 _cdpId) external;

17:     function partiallyLiquidate(

24:     function batchLiquidateCdps(bytes32[] calldata _cdpArray) external;

26:     function redeemCollateral(

36:     function updateStakeAndTotalStakes(bytes32 _cdpId) external returns (uint256);

38:     function syncAccounting(bytes32 _cdpId) external;

40:     function closeCdp(bytes32 _cdpId, address _borrower, uint256 _debt, uint256 _coll) external;

42:     function getRedemptionRate() external view returns (uint256);

44:     function getRedemptionRateWithDecay() external view returns (uint256);

46:     function getRedemptionFeeWithDecay(uint256 _stETHToRedeem) external view returns (uint256);

48:     function getCdpStatus(bytes32 _cdpId) external view returns (uint256);

50:     function getCdpStake(bytes32 _cdpId) external view returns (uint256);

52:     function getCdpDebt(bytes32 _cdpId) external view returns (uint256);

54:     function getCdpCollShares(bytes32 _cdpId) external view returns (uint256);

56:     function getCdpLiquidatorRewardShares(bytes32 _cdpId) external view returns (uint);

58:     function initializeCdp(

66:     function updateCdp(

75:     function getCachedTCR(uint256 _price) external view returns (uint256);

77:     function checkRecoveryMode(uint256 _price) external view returns (bool);
```

- *ICdpManagerData.sol* ( [217](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManagerData.sol#L217), [219](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManagerData.sol#L219), [221](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManagerData.sol#L221), [223](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManagerData.sol#L223), [225](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManagerData.sol#L225), [227](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManagerData.sol#L227), [232](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManagerData.sol#L232), [234](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManagerData.sol#L234), [236](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManagerData.sol#L236), [241](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManagerData.sol#L241), [243](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManagerData.sol#L243), [245](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManagerData.sol#L245), [247](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManagerData.sol#L247), [249](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManagerData.sol#L249), [251](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManagerData.sol#L251), [253](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManagerData.sol#L253), [255](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManagerData.sol#L255), [257](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManagerData.sol#L257), [259](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManagerData.sol#L259), [263](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManagerData.sol#L263) ):

```solidity
217:     function totalStakes() external view returns (uint256);

219:     function ebtcToken() external view returns (IEBTCToken);

221:     function systemStEthFeePerUnitIndex() external view returns (uint256);

223:     function systemStEthFeePerUnitIndexError() external view returns (uint256);

225:     function stEthIndex() external view returns (uint256);

227:     function calcFeeUponStakingReward(

232:     function syncGlobalAccounting() external; // Accrues StEthFeeSplit without influencing Grace Period

234:     function syncGlobalAccountingAndGracePeriod() external; // Accrues StEthFeeSplit and influences Grace Period

236:     function getAccumulatedFeeSplitApplied(

241:     function getCachedNominalICR(bytes32 _cdpId) external view returns (uint256);

243:     function getCachedICR(bytes32 _cdpId, uint256 _price) external view returns (uint256);

245:     function getSyncedCdpDebt(bytes32 _cdpId) external view returns (uint256);

247:     function getSyncedCdpCollShares(bytes32 _cdpId) external view returns (uint256);

249:     function getSyncedICR(bytes32 _cdpId, uint256 _price) external view returns (uint256);

251:     function getSyncedTCR(uint256 _price) external view returns (uint256);

253:     function getSyncedNominalICR(bytes32 _cdpId) external view returns (uint256);

255:     function getPendingRedistributedDebt(bytes32 _cdpId) external view returns (uint256);

257:     function hasPendingRedistributedDebt(bytes32 _cdpId) external view returns (bool);

259:     function getSyncedDebtAndCollShares(

263:     function canLiquidateRecoveryMode(uint256 icr, uint256 tcr) external view returns (bool);
```

- *ICollSurplusPool.sol* ( [15](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICollSurplusPool.sol#L15), [17](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICollSurplusPool.sol#L17), [19](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICollSurplusPool.sol#L19), [21](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICollSurplusPool.sol#L21), [23](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICollSurplusPool.sol#L23) ):

```solidity
15:     function getTotalSurplusCollShares() external view returns (uint256);

17:     function getSurplusCollShares(address _account) external view returns (uint256);

19:     function increaseSurplusCollShares(address _account, uint256 _amount) external;

21:     function claimSurplusCollShares(address _account) external;

23:     function increaseTotalSurplusCollShares(uint256 _value) external;
```

- *IEBTCToken.sol* ( [11](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IEBTCToken.sol#L11), [13](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IEBTCToken.sol#L13) ):

```solidity
11:     function mint(address _account, uint256 _amount) external;

13:     function burn(address _account, uint256 _amount) external;
```

- *IERC3156FlashBorrower.sol* ( [15](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IERC3156FlashBorrower.sol#L15) ):

```solidity
15:     function onFlashLoan(
```

- *IERC3156FlashLender.sol* ( [15](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IERC3156FlashLender.sol#L15), [21](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IERC3156FlashLender.sol#L21), [28](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IERC3156FlashLender.sol#L28) ):

```solidity
15:     function maxFlashLoan(address token) external view returns (uint256);

21:     function flashFee(address token, uint256 amount) external view returns (uint256);

28:     function flashLoan(
```

- *IEbtcBase.sol* ( [8](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IEbtcBase.sol#L8) ):

```solidity
8:     function priceFeed() external view returns (IPriceFeed);
```

- *IFallbackCaller.sol* ( [13](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IFallbackCaller.sol#L13), [17](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IFallbackCaller.sol#L17), [21](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IFallbackCaller.sol#L21) ):

```solidity
13:     function getFallbackResponse() external view returns (uint256, uint256, bool);

17:     function fallbackTimeout() external view returns (uint256);

21:     function setFallbackTimeout(uint256 newFallbackTimeout) external;
```

- *IPermitNonce.sol* ( [7](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IPermitNonce.sol#L7), [9](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IPermitNonce.sol#L9) ):

```solidity
7:     function increasePermitNonce() external returns (uint256);

9:     function nonces(address owner) external view returns (uint256);
```

- *IPool.sol* ( [15](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IPool.sol#L15), [17](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IPool.sol#L17), [19](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IPool.sol#L19), [21](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IPool.sol#L21) ):

```solidity
15:     function getSystemCollShares() external view returns (uint256);

17:     function getSystemDebt() external view returns (uint256);

19:     function increaseSystemDebt(uint256 _amount) external;

21:     function decreaseSystemDebt(uint256 _amount) external;
```

- *IPositionManagers.sol* ( [18](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IPositionManagers.sol#L18), [23](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IPositionManagers.sol#L23), [28](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IPositionManagers.sol#L28), [30](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IPositionManagers.sol#L30), [32](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IPositionManagers.sol#L32), [42](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IPositionManagers.sol#L42), [44](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IPositionManagers.sol#L44), [46](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IPositionManagers.sol#L46) ):

```solidity
18:     function getPositionManagerApproval(

23:     function setPositionManagerApproval(

28:     function revokePositionManagerApproval(address _positionManager) external;

30:     function renouncePositionManagerApproval(address _borrower) external;

32:     function permitPositionManagerApproval(

42:     function version() external view returns (string memory);

44:     function permitTypeHash() external view returns (bytes32);

46:     function domainSeparator() external view returns (bytes32);
```

- *IPriceFeed.sol* ( [43](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IPriceFeed.sol#L43) ):

```solidity
43:     function fetchPrice() external returns (uint256);
```

- *IRecoveryModeGracePeriod.sol* ( [13](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IRecoveryModeGracePeriod.sol#L13), [15](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IRecoveryModeGracePeriod.sol#L15) ):

```solidity
13:     function notifyStartGracePeriod(uint256 tcr) external;

15:     function notifyEndGracePeriod(uint256 tcr) external;
```

- *ISortedCdps.sol* ( [14](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ISortedCdps.sol#L14), [16](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ISortedCdps.sol#L16), [18](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ISortedCdps.sol#L18), [20](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ISortedCdps.sol#L20), [22](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ISortedCdps.sol#L22), [24](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ISortedCdps.sol#L24), [26](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ISortedCdps.sol#L26), [28](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ISortedCdps.sol#L28), [30](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ISortedCdps.sol#L30), [32](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ISortedCdps.sol#L32), [34](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ISortedCdps.sol#L34), [36](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ISortedCdps.sol#L36), [38](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ISortedCdps.sol#L38), [44](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ISortedCdps.sol#L44), [50](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ISortedCdps.sol#L50), [57](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ISortedCdps.sol#L57), [59](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ISortedCdps.sol#L59), [61](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ISortedCdps.sol#L61), [63](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ISortedCdps.sol#L63), [69](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ISortedCdps.sol#L69), [71](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ISortedCdps.sol#L71), [77](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ISortedCdps.sol#L77), [79](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ISortedCdps.sol#L79) ):

```solidity
14:     function remove(bytes32 _id) external;

16:     function batchRemove(bytes32[] memory _ids) external;

18:     function reInsert(bytes32 _id, uint256 _newICR, bytes32 _prevId, bytes32 _nextId) external;

20:     function contains(bytes32 _id) external view returns (bool);

22:     function isFull() external view returns (bool);

24:     function isEmpty() external view returns (bool);

26:     function getSize() external view returns (uint256);

28:     function getMaxSize() external view returns (uint256);

30:     function getFirst() external view returns (bytes32);

32:     function getLast() external view returns (bytes32);

34:     function getNext(bytes32 _id) external view returns (bytes32);

36:     function getPrev(bytes32 _id) external view returns (bytes32);

38:     function validInsertPosition(

44:     function findInsertPosition(

50:     function insert(

57:     function getOwnerAddress(bytes32 _id) external pure returns (address);

59:     function nonExistId() external view returns (bytes32);

61:     function cdpCountOf(address owner) external view returns (uint256);

63:     function getCdpCountOf(

69:     function getCdpsOf(address owner) external view returns (bytes32[] memory);

71:     function getAllCdpsOf(

77:     function cdpOfOwnerByIndex(address owner, uint256 index) external view returns (bytes32);

79:     function cdpOfOwnerByIdx(
```

- *LeverageMacroBase.sol* ( [15](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LeverageMacroBase.sol#L15), [39](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LeverageMacroBase.sol#L39), [43](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LeverageMacroBase.sol#L43), [51](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LeverageMacroBase.sol#L51), [244](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LeverageMacroBase.sol#L244), [291](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LeverageMacroBase.sol#L291), [382](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LeverageMacroBase.sol#L382), [398](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LeverageMacroBase.sol#L398), [435](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LeverageMacroBase.sol#L435), [450](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LeverageMacroBase.sol#L450), [460](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LeverageMacroBase.sol#L460), [474](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LeverageMacroBase.sol#L474), [482](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LeverageMacroBase.sol#L482) ):

```solidity
15:     function Cdps(bytes32) external view returns (ICdpManagerData.Cdp memory);

39:     function owner() public virtual returns (address) {

43:     function _assertOwner() internal {

51:     constructor(

244:     function _doCheckValueType(CheckValueAndType memory check, uint256 valueToCheck) internal {

291:     function _handleOperation(LeverageMacroOperation memory operation) internal {

382:     function _doSwaps(SwapOperation[] memory swapData) internal {

398:     function _doSwap(SwapOperation memory swapData) internal {

435:     function _doSwapChecks(SwapCheck[] memory swapChecks) internal {

450:     function _ensureNotSystem(address addy) internal {

460:     function _openCdpCallback(bytes memory data) internal {

474:     function _closeCdpCallback(bytes memory data) internal {

482:     function _adjustCdpCallback(bytes memory data) internal {
```

- *LeverageMacroDelegateTarget.sol* ( [7](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LeverageMacroDelegateTarget.sol#L7), [41](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LeverageMacroDelegateTarget.sol#L41), [63](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LeverageMacroDelegateTarget.sol#L63) ):

```solidity
7:     function owner() external view returns (address);

41:     constructor(

63:     function owner() public override returns (address) {
```

- *LeverageMacroFactory.sol* ( [21](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LeverageMacroFactory.sol#L21) ):

```solidity
21:     constructor(
```

- *LeverageMacroReference.sol* ( [17](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LeverageMacroReference.sol#L17), [44](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LeverageMacroReference.sol#L44) ):

```solidity
17:     constructor(

44:     function owner() public override returns (address) {
```

- *LiquidationLibrary.sol* ( [14](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LiquidationLibrary.sol#L14), [61](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LiquidationLibrary.sol#L61), [135](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LiquidationLibrary.sol#L135), [186](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LiquidationLibrary.sol#L186), [223](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LiquidationLibrary.sol#L223), [295](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LiquidationLibrary.sol#L295), [384](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LiquidationLibrary.sol#L384), [397](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LiquidationLibrary.sol#L397), [450](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LiquidationLibrary.sol#L450), [466](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LiquidationLibrary.sol#L466), [503](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LiquidationLibrary.sol#L503), [544](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LiquidationLibrary.sol#L544), [570](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LiquidationLibrary.sol#L570), [608](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LiquidationLibrary.sol#L608), [642](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LiquidationLibrary.sol#L642), [733](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LiquidationLibrary.sol#L733), [807](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LiquidationLibrary.sol#L807), [839](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LiquidationLibrary.sol#L839), [862](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LiquidationLibrary.sol#L862), [896](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LiquidationLibrary.sol#L896), [908](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LiquidationLibrary.sol#L908) ):

```solidity
14:     constructor(

61:     function _liquidateIndividualCdpSetup(

135:     function _liquidateIndividualCdpSetupCDP(

186:     function _liquidateCdpInGivenMode(

223:     function _liquidateIndividualCdpSetupCDPInNormalMode(

295:     function _liquidateIndividualCdpSetupCDPInRecoveryMode(

384:     function _closeCdpByLiquidation(bytes32 _cdpId) private returns (uint256, uint256, uint256) {

397:     function _liquidateCDPPartially(

450:     function _partiallyReduceCdpDebt(

466:     function _reInsertPartialLiquidation(

503:     function _finalizeLiquidation(

544:     function _calculatePartialLiquidationSurplusAndCap(

570:     function _calculateFullLiquidationSurplusAndCap(

608:     function _getLiquidationValuesNormalMode(

642:     function _getLiquidationValuesRecoveryMode(

733:     function _getTotalFromBatchLiquidate_RecoveryMode(

807:     function _getTotalsFromBatchLiquidate_NormalMode(

839:     function _addLiquidationValuesToTotals(

862:     function _redistributeDebt(uint256 _debt) internal {

896:     function _requirePartialLiqDebtSize(

908:     function _requirePartialLiqCollSize(uint256 _entireColl) internal pure {
```

- *PriceFeed.sol* ( [465](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/PriceFeed.sol#L465), [493](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/PriceFeed.sol#L493), [788](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/PriceFeed.sol#L788) ):

```solidity
465:     function _fallbackIsBroken(FallbackResponse memory _response) internal view returns (bool) {

493:     function _responseTimeout(uint256 _timestamp, uint256 _timeout) internal view returns (bool) {

788:     function _formatClAggregateAnswer(
```

- *SimplifiedDiamondLike.sol* ( [44](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SimplifiedDiamondLike.sol#L44), [83](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SimplifiedDiamondLike.sol#L83), [129](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SimplifiedDiamondLike.sol#L129), [134](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SimplifiedDiamondLike.sol#L134), [160](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SimplifiedDiamondLike.sol#L160), [164](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SimplifiedDiamondLike.sol#L164) ):

```solidity
44:     constructor(address _owner) {

83:     function _getStorage() internal pure returns (DiamondLikeStorage storage ds) {

129:     function _setCallbackEnabledForCall(DiamondLikeStorage storage ds, bool _enabled) internal {

134:     function _executeOne(Operation calldata op) internal {

160:     receive() external payable {

164:     fallback() external payable {
```

- *SortedCdps.sol* ( [155](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L155), [237](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L237), [286](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L286), [299](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L299), [363](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L363), [456](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L456), [519](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L519), [530](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L530), [536](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L536), [542](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L542), [548](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L548), [554](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L554), [560](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L560), [567](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L567), [574](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L574), [583](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L583), [591](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L591), [619](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L619), [642](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L642), [666](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L666), [674](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L674), [714](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L714), [719](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L719) ):

```solidity
155:     function cdpOfOwnerByIdx(

237:     function _cdpCountOf(

286:     function getAllCdpsOf(

299:     function _getCdpsOf(

363:     function _insert(bytes32 _id, uint256 _NICR, bytes32 _prevId, bytes32 _nextId) internal {

456:     function _remove(bytes32 _id) internal {

519:     function contains(bytes32 _id) public view override returns (bool) {

530:     function isFull() public view override returns (bool) {

536:     function isEmpty() public view override returns (bool) {

542:     function getSize() external view override returns (uint256) {

548:     function getMaxSize() external view override returns (uint256) {

554:     function getFirst() external view override returns (bytes32) {

560:     function getLast() external view override returns (bytes32) {

567:     function getNext(bytes32 _id) external view override returns (bytes32) {

574:     function getPrev(bytes32 _id) external view override returns (bytes32) {

583:     function validInsertPosition(

591:     function _validInsertPosition(

619:     function _descendList(uint256 _NICR, bytes32 _startId) internal view returns (bytes32, bytes32) {

642:     function _ascendList(uint256 _NICR, bytes32 _startId) internal view returns (bytes32, bytes32) {

666:     function findInsertPosition(

674:     function _findInsertPosition(

714:     function _requireCallerIsCdpManager() internal view {

719:     function _requireCallerIsBOorCdpM() internal view {
```

</details>

### [N&#x2011;105] Missing NatSpec `@dev` from modifier declaration

Some modifiers have an incomplete NatSpec: add a `@dev` notation to describe the modifier to improve the code documentation.

There are 3 instances:

- *Auth.sol* ( [26](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/Auth.sol#L26) ):

```solidity
26:     modifier requiresAuth() virtual {
```

- *AuthNoOwner.sol* ( [16](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/AuthNoOwner.sol#L16) ):

```solidity
16:     modifier requiresAuth() virtual {
```

- *ReentrancyGuard.sol* ( [13](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/ReentrancyGuard.sol#L13) ):

```solidity
13:     modifier nonReentrant() virtual {
```

### [N&#x2011;106] Missing NatSpec `@notice` from modifier declaration

Some modifiers have an incomplete NatSpec: add a `@notice` notation to describe the modifier to improve the code documentation.

There are 3 instances:

- *Auth.sol* ( [26](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/Auth.sol#L26) ):

```solidity
26:     modifier requiresAuth() virtual {
```

- *AuthNoOwner.sol* ( [16](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/AuthNoOwner.sol#L16) ):

```solidity
16:     modifier requiresAuth() virtual {
```

- *ReentrancyGuard.sol* ( [13](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/ReentrancyGuard.sol#L13) ):

```solidity
13:     modifier nonReentrant() virtual {
```

### [N&#x2011;107] Contracts should have full test coverage

While 100% code coverage does not guarantee that there are no bugs, it often will catch easy-to-find bugs, and will ensure that there are fewer regressions when the code invariably has to be modified. Furthermore, in order to get full coverage, code authors will often have to re-organize their code so that it is more modular, so that each component can be tested separately, which reduces interdependencies between modules and layers, and makes for code that is easier to reason about and audit.

There is 1 instance:

- Global finding

### [N&#x2011;108] Large or complicated code bases should implement invariant tests

This includes: large code bases, or code with lots of inline-assembly, complicated math, or complicated interactions between multiple contracts.
Invariant fuzzers such as Echidna require the test writer to come up with invariants which should not be violated under any circumstances, and the fuzzer tests various inputs and function calls to ensure that the invariants always hold.
Even code with 100% code coverage can still have bugs due to the order of the operations a user performs, and invariant fuzzers may help significantly.

There is 1 instance:

- Global finding

### [N&#x2011;109] Top-level declarations should be separated by at least two lines

-

<details>
<summary>There are 138 instances (click to show):</summary>

- *ActivePool.sol* ( [3-5](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/ActivePool.sol#L3-L5) ):

```solidity
3: pragma solidity 0.8.17;
4: 
5: import "./Interfaces/IActivePool.sol";
```

- *BorrowerOperations.sol* ( [3-5](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L3-L5), [437-439](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L437-L439), [613-615](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L613-L615), [633-635](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L633-L635), [671-673](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L671-L673), [675-677](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L675-L677), [811-813](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L811-L813), [822-824](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L822-L824), [827-829](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L827-L829), [832-834](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L832-L834), [836-838](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L836-L838), [843-845](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L843-L845), [850-852](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L850-L852), [908-910](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L908-L910), [915-917](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L915-L917), [919-921](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L919-L921), [926-928](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L926-L928), [933-935](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L933-L935), [937-939](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L937-L939), [944-946](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L944-L946), [951-953](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L951-L953), [961-963](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L961-L963), [1028-1030](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L1028-L1030), [1047-1049](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol#L1047-L1049) ):

```solidity
3: pragma solidity 0.8.17;
4: 
5: import "./Interfaces/IBorrowerOperations.sol";

437:     }
438: 
439:     function _openCdp(

613:     }
614: 
615:     function _getPositionManagerApproval(

633:     }
634: 
635:     function _setPositionManagerApproval(

671:     }
672: 
673:     function _chainID() private view returns (uint256) {

675:     }
676: 
677:     function _buildDomainSeparator(

811:     }
812: 
813:     function _requireNonZeroAdjustment(

822:     }
823: 
824:     function _requireCdpisActive(ICdpManager _cdpManager, bytes32 _cdpId) internal view {

827:     }
828: 
829:     function _requireCdpIsNonExistent(bytes32 _cdpId) internal view {

832:     }
833: 
834:     function _requireNonZeroDebtChange(uint _debtChange) internal pure {

836:     }
837: 
838:     function _requireNotInRecoveryMode(uint256 _tcr) internal view {

843:     }
844: 
845:     function _requireNoStEthBalanceDecrease(uint256 _stEthBalanceDecrease) internal pure {

850:     }
851: 
852:     function _requireValidAdjustmentInCurrentMode(

908:     }
909: 
910:     function _requireICRisNotBelowMCR(uint256 _newICR) internal pure {

915:     }
916: 
917:     function _requireICRisNotBelowCCR(uint256 _newICR) internal pure {

919:     }
920: 
921:     function _requireNoDecreaseOfICR(uint256 _newICR, uint256 _oldICR) internal pure {

926:     }
927: 
928:     function _requireNewTCRisNotBelowCCR(uint256 _newTCR) internal pure {

933:     }
934: 
935:     function _requireNonZeroDebt(uint256 _debt) internal pure {

937:     }
938: 
939:     function _requireAtLeastMinNetStEthBalance(uint256 _stEthBalance) internal pure {

944:     }
945: 
946:     function _requireValidDebtRepayment(uint256 _currentDebt, uint256 _debtRepayment) internal pure {

951:     }
952: 
953:     function _requireSufficientEbtcTokenBalance(

961:     }
962: 
963:     function _requireBorrowerOrPositionManagerAndUpdateManagerApproval(address _borrower) internal {

1028:     }
1029: 
1030:     function _getNewCdpAmounts(

1047:     }
1048: 
1049:     function _getNewTCRFromCdpChange(
```

- *CdpManager.sol* ( [3-5](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L3-L5), [645-647](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L645-L647), [653-655](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L653-L655), [665-667](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L665-L667), [674-676](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L674-L676), [700-702](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L700-L702), [707-709](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L707-L709), [751-753](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L751-L753), [755-757](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L755-L757), [759-761](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol#L759-L761) ):

```solidity
3: pragma solidity 0.8.17;
4: 
5: import "./Interfaces/ICdpManager.sol";

645:     }
646: 
647:     function _calcRedemptionRate(uint256 _baseRate) internal view returns (uint256) {

653:     }
654: 
655:     function _getRedemptionFee(uint256 _ETHDrawn) internal view returns (uint256) {

665:     }
666: 
667:     function _calcRedemptionFee(

674:     }
675: 
676:     function _decayBaseRate() internal {

700:     }
701: 
702:     function _calcDecayedBaseRate() internal view returns (uint256) {

707:     }
708: 
709:     function _minutesPassedSinceLastRedemption() internal view returns (uint256) {

751:     }
752: 
753:     function _requireAmountGreaterThanZero(uint256 _amount) internal pure {

755:     }
756: 
757:     function _requireTCRisNotBelowMCR(uint256 _price, uint256 _TCR) internal view {

759:     }
760: 
761:     function _requireValidMaxFeePercentage(uint256 _maxFeePercentage) internal view {
```

- *CdpManagerStorage.sol* ( [3-5](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L3-L5), [71-73](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L71-L73), [253-255](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L253-L255), [258-260](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L258-L260), [507-509](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L507-L509), [650-652](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L650-L652), [657-659](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L657-L659), [705-707](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol#L705-L707) ):

```solidity
3: pragma solidity 0.8.17;
4: 
5: import "./Interfaces/ICdpManager.sol";

71:     }
72: 
73:     function _syncGracePeriod() internal {

253:     }
254: 
255:     function _closeCdp(bytes32 _cdpId, Status closedStatus) internal {

258:     }
259: 
260:     function _closeCdpWithoutRemovingSortedCdps(bytes32 _cdpId, Status closedStatus) internal {

507:     }
508: 
509:     function _syncGlobalAccounting() internal {

650:     }
651: 
652:     function _requireMoreThanOneCdpInSystem(uint256 CdpOwnersArrayLength) internal view {

657:     }
658: 
659:     function _requireCallerIsBorrowerOperations() internal view {

705:     }
706: 
707:     function _calculateCR(
```

- *CollSurplusPool.sol* ( [3-5](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CollSurplusPool.sol#L3-L5), [117-119](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CollSurplusPool.sol#L117-L119), [121-123](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CollSurplusPool.sol#L121-L123) ):

```solidity
3: pragma solidity 0.8.17;
4: 
5: import "./Interfaces/ICollSurplusPool.sol";

117:     }
118: 
119:     function _requireCallerIsCdpManager() internal view {

121:     }
122: 
123:     function _requireCallerIsActivePool() internal view {
```

- *Auth.sol* ( [2-4](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/Auth.sol#L2-L4), [24-26](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/Auth.sol#L24-L26), [30-32](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/Auth.sol#L30-L32), [40-42](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/Auth.sol#L40-L42), [50-52](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/Auth.sol#L50-L52) ):

```solidity
2: pragma solidity 0.8.17;
3: 
4: import {Authority} from "./Authority.sol";

24:     }
25: 
26:     modifier requiresAuth() virtual {

30:     }
31: 
32:     function isAuthorized(address user, bytes4 functionSig) internal view virtual returns (bool) {

40:     }
41: 
42:     function setAuthority(Authority newAuthority) public virtual {

50:     }
51: 
52:     function transferOwnership(address newOwner) public virtual requiresAuth {
```

- *AuthNoOwner.sol* ( [2-4](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/AuthNoOwner.sol#L2-L4), [20-22](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/AuthNoOwner.sol#L20-L22), [24-26](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/AuthNoOwner.sol#L24-L26), [28-30](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/AuthNoOwner.sol#L28-L30), [36-38](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/AuthNoOwner.sol#L36-L38) ):

```solidity
2: pragma solidity 0.8.17;
3: 
4: import {Authority} from "./Authority.sol";

20:     }
21: 
22:     function authority() public view returns (Authority) {

24:     }
25: 
26:     function authorityInitialized() public view returns (bool) {

28:     }
29: 
30:     function isAuthorized(address user, bytes4 functionSig) internal view virtual returns (bool) {

36:     }
37: 
38:     function setAuthority(address newAuthority) public virtual {
```

- *ERC3156FlashLender.sol* ( [3-5](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/ERC3156FlashLender.sol#L3-L5), [6-8](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/ERC3156FlashLender.sol#L6-L8) ):

```solidity
3: pragma solidity 0.8.17;
4: 
5: import "../Interfaces/IERC3156FlashLender.sol";

6: import "../Interfaces/IWETH.sol";
7: 
8: abstract contract ERC3156FlashLender is IERC3156FlashLender {
```

- *EbtcBase.sol* ( [3-5](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/EbtcBase.sol#L3-L5), [77-79](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/EbtcBase.sol#L77-L79), [81-83](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/EbtcBase.sol#L81-L83), [93-95](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/EbtcBase.sol#L93-L95), [97-99](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/EbtcBase.sol#L97-L99), [101-103](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/EbtcBase.sol#L101-L103) ):

```solidity
3: pragma solidity 0.8.17;
4: 
5: import "./BaseMath.sol";

77:     }
78: 
79:     function _getCachedTCR(uint256 _price) internal view returns (uint256 TCR) {

81:     }
82: 
83:     function _getTCRWithSystemDebtAndCollShares(

93:     }
94: 
95:     function _checkRecoveryMode(uint256 _price) internal view returns (bool) {

97:     }
98: 
99:     function _checkRecoveryModeForTCR(uint256 _tcr) internal view returns (bool) {

101:     }
102: 
103:     function _requireUserAcceptsFee(
```

- *EbtcMath.sol* ( [3-5](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/EbtcMath.sol#L3-L5), [3-5](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/EbtcMath.sol#L3-L5), [22-24](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/EbtcMath.sol#L22-L24), [86-88](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/EbtcMath.sol#L86-L88), [90-92](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/EbtcMath.sol#L90-L92) ):

```solidity
3: pragma solidity 0.8.17;
4: 
5: library EbtcMath {

3: pragma solidity 0.8.17;
4: 
5: library EbtcMath {

22:     }
23: 
24:     function _max(uint256 _a, uint256 _b) internal pure returns (uint256) {

86:     }
87: 
88:     function _getAbsoluteDifference(uint256 _a, uint256 _b) internal pure returns (uint256) {

90:     }
91: 
92:     function _computeNominalCR(uint256 _collShares, uint256 _debt) internal pure returns (uint256) {
```

- *RolesAuthority.sol* ( [2-4](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/RolesAuthority.sol#L2-L4), [40-42](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/RolesAuthority.sol#L40-L42), [48-50](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/RolesAuthority.sol#L48-L50) ):

```solidity
2: pragma solidity 0.8.17;
3: 
4: import {IRolesAuthority} from "./IRolesAuthority.sol";

40:     }
41: 
42:     function doesRoleHaveCapability(

48:     }
49: 
50:     function isPublicCapability(address target, bytes4 functionSig) public view returns (bool) {
```

- *EBTCToken.sol* ( [3-5](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/EBTCToken.sol#L3-L5), [113-115](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/EBTCToken.sol#L113-L115), [117-119](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/EBTCToken.sol#L117-L119), [123-125](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/EBTCToken.sol#L123-L125), [127-129](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/EBTCToken.sol#L127-L129), [132-134](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/EBTCToken.sol#L132-L134), [150-152](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/EBTCToken.sol#L150-L152), [158-160](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/EBTCToken.sol#L158-L160), [233-235](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/EBTCToken.sol#L233-L235), [260-262](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/EBTCToken.sol#L260-L262), [268-270](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/EBTCToken.sol#L268-L270), [283-285](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/EBTCToken.sol#L283-L285), [304-306](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/EBTCToken.sol#L304-L306), [321-323](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/EBTCToken.sol#L321-L323) ):

```solidity
3: pragma solidity 0.8.17;
4: 
5: import "./Interfaces/IEBTCToken.sol";

113:     }
114: 
115:     function balanceOf(address account) external view override returns (uint256) {

117:     }
118: 
119:     function transfer(address recipient, uint256 amount) external override returns (bool) {

123:     }
124: 
125:     function allowance(address owner, address spender) external view override returns (uint256) {

127:     }
128: 
129:     function approve(address spender, uint256 amount) external override returns (bool) {

132:     }
133: 
134:     function transferFrom(

150:     }
151: 
152:     function increaseAllowance(

158:     }
159: 
160:     function decreaseAllowance(

233:     }
234: 
235:     function _buildDomainSeparator(

260:     }
261: 
262:     function _mint(address account, uint256 amount) internal {

268:     }
269: 
270:     function _burn(address account, uint256 amount) internal {

283:     }
284: 
285:     function _approve(address owner, address spender, uint256 amount) internal {

304:     }
305: 
306:     function _requireCallerIsBorrowerOperations() internal view {

321:     }
322: 
323:     function _requireCallerIsCdpM() internal view {
```

- *Governor.sol* ( [2-4](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Governor.sol#L2-L4) ):

```solidity
2: pragma solidity 0.8.17;
3: 
4: import {EnumerableSet} from "./Dependencies/EnumerableSet.sol";
```

- *HintHelpers.sol* ( [3-5](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/HintHelpers.sol#L3-L5) ):

```solidity
3: pragma solidity 0.8.17;
4: 
5: import "./Interfaces/ICdpManager.sol";
```

- *IActivePool.sol* ( [3-5](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IActivePool.sol#L3-L5), [5-7](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IActivePool.sol#L5-L7) ):

```solidity
3: pragma solidity 0.8.17;
4: 
5: import "./IPool.sol";

5: import "./IPool.sol";
6: 
7: interface IActivePool is IPool {
```

- *IBorrowerOperations.sol* ( [3-4](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IBorrowerOperations.sol#L3-L4) ):

```solidity
3: pragma solidity 0.8.17;
4: import "./IPositionManagers.sol";
```

- *ICdpManager.sol* ( [3-5](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManager.sol#L3-L5) ):

```solidity
3: pragma solidity 0.8.17;
4: 
5: import "./IEbtcBase.sol";
```

- *ICdpManagerData.sol* ( [3-5](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManagerData.sol#L3-L5), [215-217](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManagerData.sol#L215-L217) ):

```solidity
3: pragma solidity 0.8.17;
4: 
5: import "./ICollSurplusPool.sol";

215:     }
216: 
217:     function totalStakes() external view returns (uint256);
```

- *ICollSurplusPool.sol* ( [3-5](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICollSurplusPool.sol#L3-L5), [3-5](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICollSurplusPool.sol#L3-L5) ):

```solidity
3: pragma solidity 0.8.17;
4: 
5: interface ICollSurplusPool {

3: pragma solidity 0.8.17;
4: 
5: interface ICollSurplusPool {
```

- *IEBTCToken.sol* ( [3-5](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IEBTCToken.sol#L3-L5), [6-8](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IEBTCToken.sol#L6-L8) ):

```solidity
3: pragma solidity 0.8.17;
4: 
5: import "../Dependencies/IERC20.sol";

6: import "../Dependencies/IERC2612.sol";
7: 
8: interface IEBTCToken is IERC20, IERC2612 {
```

- *IERC3156FlashBorrower.sol* ( [3-5](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IERC3156FlashBorrower.sol#L3-L5), [3-5](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IERC3156FlashBorrower.sol#L3-L5) ):

```solidity
3: pragma solidity 0.8.17;
4: 
5: interface IERC3156FlashBorrower {

3: pragma solidity 0.8.17;
4: 
5: interface IERC3156FlashBorrower {
```

- *IERC3156FlashLender.sol* ( [3-5](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IERC3156FlashLender.sol#L3-L5), [5-7](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IERC3156FlashLender.sol#L5-L7) ):

```solidity
3: pragma solidity 0.8.17;
4: 
5: import "./IERC3156FlashBorrower.sol";

5: import "./IERC3156FlashBorrower.sol";
6: 
7: interface IERC3156FlashLender {
```

- *IEbtcBase.sol* ( [3-5](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IEbtcBase.sol#L3-L5), [5-7](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IEbtcBase.sol#L5-L7) ):

```solidity
3: pragma solidity 0.8.17;
4: 
5: import "./IPriceFeed.sol";

5: import "./IPriceFeed.sol";
6: 
7: interface IEbtcBase {
```

- *IFallbackCaller.sol* ( [3-5](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IFallbackCaller.sol#L3-L5), [3-5](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IFallbackCaller.sol#L3-L5) ):

```solidity
3: pragma solidity 0.8.17;
4: 
5: interface IFallbackCaller {

3: pragma solidity 0.8.17;
4: 
5: interface IFallbackCaller {
```

- *IPermitNonce.sol* ( [3-5](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IPermitNonce.sol#L3-L5), [3-5](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IPermitNonce.sol#L3-L5) ):

```solidity
3: pragma solidity 0.8.17;
4: 
5: interface IPermitNonce {

3: pragma solidity 0.8.17;
4: 
5: interface IPermitNonce {
```

- *IPositionManagers.sol* ( [3-5](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IPositionManagers.sol#L3-L5), [3-5](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IPositionManagers.sol#L3-L5) ):

```solidity
3: pragma solidity 0.8.17;
4: 
5: interface IPositionManagers {

3: pragma solidity 0.8.17;
4: 
5: interface IPositionManagers {
```

- *IPriceFeed.sol* ( [3-5](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IPriceFeed.sol#L3-L5), [3-5](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IPriceFeed.sol#L3-L5) ):

```solidity
3: pragma solidity 0.8.17;
4: 
5: interface IPriceFeed {

3: pragma solidity 0.8.17;
4: 
5: interface IPriceFeed {
```

- *LeverageMacroBase.sol* ( [2-4](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LeverageMacroBase.sol#L2-L4), [12-14](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LeverageMacroBase.sol#L12-L14), [41-43](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LeverageMacroBase.sol#L41-L43) ):

```solidity
2: pragma solidity 0.8.17;
3: 
4: import "./Interfaces/IBorrowerOperations.sol";

12: import "./Dependencies/SafeERC20.sol";
13: 
14: interface ICdpCdps {

41:     }
42: 
43:     function _assertOwner() internal {
```

- *LeverageMacroDelegateTarget.sol* ( [2-4](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LeverageMacroDelegateTarget.sol#L2-L4), [4-6](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LeverageMacroDelegateTarget.sol#L4-L6) ):

```solidity
2: pragma solidity 0.8.17;
3: 
4: import {LeverageMacroBase} from "./LeverageMacroBase.sol";

4: import {LeverageMacroBase} from "./LeverageMacroBase.sol";
5: 
6: interface IOwnerLike {
```

- *LeverageMacroFactory.sol* ( [2-4](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LeverageMacroFactory.sol#L2-L4) ):

```solidity
2: pragma solidity 0.8.17;
3: 
4: import {LeverageMacroReference} from "./LeverageMacroReference.sol";
```

- *LeverageMacroReference.sol* ( [2-4](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LeverageMacroReference.sol#L2-L4), [42-44](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LeverageMacroReference.sol#L42-L44) ):

```solidity
2: pragma solidity 0.8.17;
3: 
4: import {LeverageMacroBase} from "./LeverageMacroBase.sol";

42:     }
43: 
44:     function owner() public override returns (address) {
```

- *LiquidationLibrary.sol* ( [3-4](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LiquidationLibrary.sol#L3-L4), [221-223](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LiquidationLibrary.sol#L221-L223), [293-295](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LiquidationLibrary.sol#L293-L295), [448-450](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LiquidationLibrary.sol#L448-L450), [501-503](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LiquidationLibrary.sol#L501-L503), [568-570](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LiquidationLibrary.sol#L568-L570), [640-642](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LiquidationLibrary.sol#L640-L642), [805-807](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LiquidationLibrary.sol#L805-L807), [860-862](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LiquidationLibrary.sol#L860-L862), [906-908](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LiquidationLibrary.sol#L906-L908) ):

```solidity
3: pragma solidity 0.8.17;
4: import "./Interfaces/ICdpManagerData.sol";

221:     }
222: 
223:     function _liquidateIndividualCdpSetupCDPInNormalMode(

293:     }
294: 
295:     function _liquidateIndividualCdpSetupCDPInRecoveryMode(

448:     }
449: 
450:     function _partiallyReduceCdpDebt(

501:     }
502: 
503:     function _finalizeLiquidation(

568:     }
569: 
570:     function _calculateFullLiquidationSurplusAndCap(

640:     }
641: 
642:     function _getLiquidationValuesRecoveryMode(

805:     }
806: 
807:     function _getTotalsFromBatchLiquidate_NormalMode(

860:     }
861: 
862:     function _redistributeDebt(uint256 _debt) internal {

906:     }
907: 
908:     function _requirePartialLiqCollSize(uint256 _entireColl) internal pure {
```

- *PriceFeed.sol* ( [3-5](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/PriceFeed.sol#L3-L5), [463-465](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/PriceFeed.sol#L463-L465), [491-493](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/PriceFeed.sol#L491-L493) ):

```solidity
3: pragma solidity 0.8.17;
4: 
5: import "./Interfaces/IPriceFeed.sol";

463:     }
464: 
465:     function _fallbackIsBroken(FallbackResponse memory _response) internal view returns (bool) {

491:     }
492: 
493:     function _responseTimeout(uint256 _timestamp, uint256 _timeout) internal view returns (bool) {
```

- *SortedCdps.sol* ( [3-5](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L3-L5), [361-363](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L361-L363), [454-456](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L454-L456), [589-591](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L589-L591), [672-674](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol#L672-L674) ):

```solidity
3: pragma solidity 0.8.17;
4: 
5: import "./Interfaces/ISortedCdps.sol";

361:     }
362: 
363:     function _insert(bytes32 _id, uint256 _NICR, bytes32 _prevId, bytes32 _nextId) internal {

454:     }
455: 
456:     function _remove(bytes32 _id) internal {

589:     }
590: 
591:     function _validInsertPosition(

672:     }
673: 
674:     function _findInsertPosition(
```

</details>

### [N&#x2011;110] Consider adding formal verification proofs

Formal verification is the act of proving or disproving the correctness of intended algorithms underlying a system with respect to a certain formal specification/property/invariant, using formal methods of mathematics.

Some tools that are currently available to perform these tests on smart contracts are [SMTChecker](https://docs.soliditylang.org/en/latest/smtchecker.html) and [Certora Prover](https://www.certora.com/).

<details>
<summary>There are 39 instances (click to show):</summary>

- [*ActivePool.sol*](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/ActivePool.sol)

- [*BorrowerOperations.sol*](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/BorrowerOperations.sol)

- [*CdpManager.sol*](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManager.sol)

- [*CdpManagerStorage.sol*](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CdpManagerStorage.sol)

- [*CollSurplusPool.sol*](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/CollSurplusPool.sol)

- [*Auth.sol*](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/Auth.sol)

- [*AuthNoOwner.sol*](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/AuthNoOwner.sol)

- [*ERC3156FlashLender.sol*](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/ERC3156FlashLender.sol)

- [*EbtcBase.sol*](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/EbtcBase.sol)

- [*EbtcMath.sol*](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/EbtcMath.sol)

- [*ReentrancyGuard.sol*](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/ReentrancyGuard.sol)

- [*RolesAuthority.sol*](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Dependencies/RolesAuthority.sol)

- [*EBTCToken.sol*](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/EBTCToken.sol)

- [*Governor.sol*](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Governor.sol)

- [*HintHelpers.sol*](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/HintHelpers.sol)

- [*IActivePool.sol*](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IActivePool.sol)

- [*IBorrowerOperations.sol*](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IBorrowerOperations.sol)

- [*ICdpManager.sol*](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManager.sol)

- [*ICdpManagerData.sol*](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICdpManagerData.sol)

- [*ICollSurplusPool.sol*](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ICollSurplusPool.sol)

- [*IEBTCToken.sol*](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IEBTCToken.sol)

- [*IERC3156FlashBorrower.sol*](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IERC3156FlashBorrower.sol)

- [*IERC3156FlashLender.sol*](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IERC3156FlashLender.sol)

- [*IEbtcBase.sol*](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IEbtcBase.sol)

- [*IFallbackCaller.sol*](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IFallbackCaller.sol)

- [*IPermitNonce.sol*](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IPermitNonce.sol)

- [*IPool.sol*](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IPool.sol)

- [*IPositionManagers.sol*](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IPositionManagers.sol)

- [*IPriceFeed.sol*](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IPriceFeed.sol)

- [*IRecoveryModeGracePeriod.sol*](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/IRecoveryModeGracePeriod.sol)

- [*ISortedCdps.sol*](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/Interfaces/ISortedCdps.sol)

- [*LeverageMacroBase.sol*](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LeverageMacroBase.sol)

- [*LeverageMacroDelegateTarget.sol*](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LeverageMacroDelegateTarget.sol)

- [*LeverageMacroFactory.sol*](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LeverageMacroFactory.sol)

- [*LeverageMacroReference.sol*](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LeverageMacroReference.sol)

- [*LiquidationLibrary.sol*](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LiquidationLibrary.sol)

- [*PriceFeed.sol*](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/PriceFeed.sol)

- [*SimplifiedDiamondLike.sol*](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SimplifiedDiamondLike.sol)

- [*SortedCdps.sol*](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SortedCdps.sol)

</details>

### [N&#x2011;111] Error messages should be descriptive, not cryptic

Consider make these error messages more descriptive.

There are 3 instances:

- *LeverageMacroBase.sol* ( [40](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LeverageMacroBase.sol#L40), [421](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/LeverageMacroBase.sol#L421) ):

```solidity
40:         revert("Must be overridden");

421:         require(success, "Call has failed");
```

- *SimplifiedDiamondLike.sol* ( [179](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/SimplifiedDiamondLike.sol#L179) ):

```solidity
179:             require(ds.settings.callbackEnabledForCall, "Only Enabled Callbacks");
```

### [N&#x2011;112] Numeric values having to do with time should use time units for readability

There are [time units](https://docs.soliditylang.org/en/latest/units-and-global-variables.html#time-units) for seconds, minutes, hours, days, and weeks, and since they're defined, they should be used.

There is 1 instance:

- *PriceFeed.sol* ( [33](https://github.com/code-423n4/2023-10-badger/blob/f2f2e2cf9965a1020661d179af46cb49e993cb7e/packages/contracts/contracts/PriceFeed.sol#L33) ):

```solidity
/// @audit 90000
33:     uint256 public constant TIMEOUT_STETH_ETH_FEED = 90000; // 25 hours: 60 * 60 * 25
```

